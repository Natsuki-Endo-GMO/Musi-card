var nn=Object.defineProperty;var on=(t,e,s)=>e in t?nn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var Ae=(t,e,s)=>(on(t,typeof e!="symbol"?e+"":e,s),s);import{r as j,a as Qr,g as Zr,b as an}from"./vendor-280e31ee.js";import{u as be,L as _e,a as es,b as ln,c as cn,R as dn,d as xe,B as un}from"./router-a8409eb2.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();const hn="modulepreload",mn=function(t){return"/"+t},Cr={},fn=function(e,s,n){if(!s||s.length===0)return e();const o=document.getElementsByTagName("link");return Promise.all(s.map(a=>{if(a=mn(a),a in Cr)return;Cr[a]=!0;const i=a.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!n)for(let u=o.length-1;u>=0;u--){const g=o[u];if(g.href===a&&(!i||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":hn,i||(d.as="script",d.crossOrigin=""),d.href=a,document.head.appendChild(d),i)return new Promise((u,g)=>{d.addEventListener("load",u),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a})};var ts={exports:{}},wt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gn=j,pn=Symbol.for("react.element"),xn=Symbol.for("react.fragment"),bn=Object.prototype.hasOwnProperty,yn=gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wn={key:!0,ref:!0,__self:!0,__source:!0};function rs(t,e,s){var n,o={},a=null,i=null;s!==void 0&&(a=""+s),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)bn.call(e,n)&&!wn.hasOwnProperty(n)&&(o[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)o[n]===void 0&&(o[n]=e[n]);return{$$typeof:pn,type:t,key:a,ref:i,props:o,_owner:yn.current}}wt.Fragment=xn;wt.jsx=rs;wt.jsxs=rs;ts.exports=wt;var r=ts.exports,qt={},kr=Qr;qt.createRoot=kr.createRoot,qt.hydrateRoot=kr.hydrateRoot;function ss(t,e){return function(){return t.apply(e,arguments)}}const{toString:vn}=Object.prototype,{getPrototypeOf:dr}=Object,{iterator:vt,toStringTag:ns}=Symbol,jt=(t=>e=>{const s=vn.call(e);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),ce=t=>(t=t.toLowerCase(),e=>jt(e)===t),Nt=t=>e=>typeof e===t,{isArray:ze}=Array,qe=Nt("undefined");function jn(t){return t!==null&&!qe(t)&&t.constructor!==null&&!qe(t.constructor)&&re(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const os=ce("ArrayBuffer");function Nn(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&os(t.buffer),e}const Sn=Nt("string"),re=Nt("function"),as=Nt("number"),St=t=>t!==null&&typeof t=="object",Cn=t=>t===!0||t===!1,ct=t=>{if(jt(t)!=="object")return!1;const e=dr(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(ns in t)&&!(vt in t)},kn=ce("Date"),En=ce("File"),Rn=ce("Blob"),Ln=ce("FileList"),In=t=>St(t)&&re(t.pipe),Tn=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||re(t.append)&&((e=jt(t))==="formdata"||e==="object"&&re(t.toString)&&t.toString()==="[object FormData]"))},An=ce("URLSearchParams"),[$n,_n,Pn,Bn]=["ReadableStream","Request","Response","Headers"].map(ce),Mn=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ze(t,e,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let n,o;if(typeof t!="object"&&(t=[t]),ze(t))for(n=0,o=t.length;n<o;n++)e.call(null,t[n],n,t);else{const a=s?Object.getOwnPropertyNames(t):Object.keys(t),i=a.length;let l;for(n=0;n<i;n++)l=a[n],e.call(null,t[l],l,t)}}function is(t,e){e=e.toLowerCase();const s=Object.keys(t);let n=s.length,o;for(;n-- >0;)if(o=s[n],e===o.toLowerCase())return o;return null}const ke=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),ls=t=>!qe(t)&&t!==ke;function Kt(){const{caseless:t}=ls(this)&&this||{},e={},s=(n,o)=>{const a=t&&is(e,o)||o;ct(e[a])&&ct(n)?e[a]=Kt(e[a],n):ct(n)?e[a]=Kt({},n):ze(n)?e[a]=n.slice():e[a]=n};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&Ze(arguments[n],s);return e}const On=(t,e,s,{allOwnKeys:n}={})=>(Ze(e,(o,a)=>{s&&re(o)?t[a]=ss(o,s):t[a]=o},{allOwnKeys:n}),t),Un=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Dn=(t,e,s,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),s&&Object.assign(t.prototype,s)},zn=(t,e,s,n)=>{let o,a,i;const l={};if(e=e||{},t==null)return e;do{for(o=Object.getOwnPropertyNames(t),a=o.length;a-- >0;)i=o[a],(!n||n(i,t,e))&&!l[i]&&(e[i]=t[i],l[i]=!0);t=s!==!1&&dr(t)}while(t&&(!s||s(t,e))&&t!==Object.prototype);return e},Fn=(t,e,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=e.length;const n=t.indexOf(e,s);return n!==-1&&n===s},Hn=t=>{if(!t)return null;if(ze(t))return t;let e=t.length;if(!as(e))return null;const s=new Array(e);for(;e-- >0;)s[e]=t[e];return s},Vn=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&dr(Uint8Array)),Jn=(t,e)=>{const n=(t&&t[vt]).call(t);let o;for(;(o=n.next())&&!o.done;){const a=o.value;e.call(t,a[0],a[1])}},Wn=(t,e)=>{let s;const n=[];for(;(s=t.exec(e))!==null;)n.push(s);return n},qn=ce("HTMLFormElement"),Kn=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,o){return n.toUpperCase()+o}),Er=(({hasOwnProperty:t})=>(e,s)=>t.call(e,s))(Object.prototype),Yn=ce("RegExp"),cs=(t,e)=>{const s=Object.getOwnPropertyDescriptors(t),n={};Ze(s,(o,a)=>{let i;(i=e(o,a,t))!==!1&&(n[a]=i||o)}),Object.defineProperties(t,n)},Gn=t=>{cs(t,(e,s)=>{if(re(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=t[s];if(re(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},Xn=(t,e)=>{const s={},n=o=>{o.forEach(a=>{s[a]=!0})};return ze(t)?n(t):n(String(t).split(e)),s},Qn=()=>{},Zn=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function eo(t){return!!(t&&re(t.append)&&t[ns]==="FormData"&&t[vt])}const to=t=>{const e=new Array(10),s=(n,o)=>{if(St(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[o]=n;const a=ze(n)?[]:{};return Ze(n,(i,l)=>{const c=s(i,o+1);!qe(c)&&(a[l]=c)}),e[o]=void 0,a}}return n};return s(t,0)},ro=ce("AsyncFunction"),so=t=>t&&(St(t)||re(t))&&re(t.then)&&re(t.catch),ds=((t,e)=>t?setImmediate:e?((s,n)=>(ke.addEventListener("message",({source:o,data:a})=>{o===ke&&a===s&&n.length&&n.shift()()},!1),o=>{n.push(o),ke.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",re(ke.postMessage)),no=typeof queueMicrotask<"u"?queueMicrotask.bind(ke):typeof process<"u"&&process.nextTick||ds,oo=t=>t!=null&&re(t[vt]),w={isArray:ze,isArrayBuffer:os,isBuffer:jn,isFormData:Tn,isArrayBufferView:Nn,isString:Sn,isNumber:as,isBoolean:Cn,isObject:St,isPlainObject:ct,isReadableStream:$n,isRequest:_n,isResponse:Pn,isHeaders:Bn,isUndefined:qe,isDate:kn,isFile:En,isBlob:Rn,isRegExp:Yn,isFunction:re,isStream:In,isURLSearchParams:An,isTypedArray:Vn,isFileList:Ln,forEach:Ze,merge:Kt,extend:On,trim:Mn,stripBOM:Un,inherits:Dn,toFlatObject:zn,kindOf:jt,kindOfTest:ce,endsWith:Fn,toArray:Hn,forEachEntry:Jn,matchAll:Wn,isHTMLForm:qn,hasOwnProperty:Er,hasOwnProp:Er,reduceDescriptors:cs,freezeMethods:Gn,toObjectSet:Xn,toCamelCase:Kn,noop:Qn,toFiniteNumber:Zn,findKey:is,global:ke,isContextDefined:ls,isSpecCompliantForm:eo,toJSONObject:to,isAsyncFn:ro,isThenable:so,setImmediate:ds,asap:no,isIterable:oo};function $(t,e,s,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),s&&(this.config=s),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}w.inherits($,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:w.toJSONObject(this.config),code:this.code,status:this.status}}});const us=$.prototype,hs={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{hs[t]={value:t}});Object.defineProperties($,hs);Object.defineProperty(us,"isAxiosError",{value:!0});$.from=(t,e,s,n,o,a)=>{const i=Object.create(us);return w.toFlatObject(t,i,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),$.call(i,t.message,e,s,n,o),i.cause=t,i.name=t.name,a&&Object.assign(i,a),i};const ao=null;function Yt(t){return w.isPlainObject(t)||w.isArray(t)}function ms(t){return w.endsWith(t,"[]")?t.slice(0,-2):t}function Rr(t,e,s){return t?t.concat(e).map(function(o,a){return o=ms(o),!s&&a?"["+o+"]":o}).join(s?".":""):e}function io(t){return w.isArray(t)&&!t.some(Yt)}const lo=w.toFlatObject(w,{},null,function(e){return/^is[A-Z]/.test(e)});function Ct(t,e,s){if(!w.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,s=w.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(h,m){return!w.isUndefined(m[h])});const n=s.metaTokens,o=s.visitor||u,a=s.dots,i=s.indexes,c=(s.Blob||typeof Blob<"u"&&Blob)&&w.isSpecCompliantForm(e);if(!w.isFunction(o))throw new TypeError("visitor must be a function");function d(f){if(f===null)return"";if(w.isDate(f))return f.toISOString();if(w.isBoolean(f))return f.toString();if(!c&&w.isBlob(f))throw new $("Blob is not supported. Use a Buffer instead.");return w.isArrayBuffer(f)||w.isTypedArray(f)?c&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function u(f,h,m){let y=f;if(f&&!m&&typeof f=="object"){if(w.endsWith(h,"{}"))h=n?h:h.slice(0,-2),f=JSON.stringify(f);else if(w.isArray(f)&&io(f)||(w.isFileList(f)||w.endsWith(h,"[]"))&&(y=w.toArray(f)))return h=ms(h),y.forEach(function(N,x){!(w.isUndefined(N)||N===null)&&e.append(i===!0?Rr([h],x,a):i===null?h:h+"[]",d(N))}),!1}return Yt(f)?!0:(e.append(Rr(m,h,a),d(f)),!1)}const g=[],p=Object.assign(lo,{defaultVisitor:u,convertValue:d,isVisitable:Yt});function b(f,h){if(!w.isUndefined(f)){if(g.indexOf(f)!==-1)throw Error("Circular reference detected in "+h.join("."));g.push(f),w.forEach(f,function(y,v){(!(w.isUndefined(y)||y===null)&&o.call(e,y,w.isString(v)?v.trim():v,h,p))===!0&&b(y,h?h.concat(v):[v])}),g.pop()}}if(!w.isObject(t))throw new TypeError("data must be an object");return b(t),e}function Lr(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function ur(t,e){this._pairs=[],t&&Ct(t,this,e)}const fs=ur.prototype;fs.append=function(e,s){this._pairs.push([e,s])};fs.toString=function(e){const s=e?function(n){return e.call(this,n,Lr)}:Lr;return this._pairs.map(function(o){return s(o[0])+"="+s(o[1])},"").join("&")};function co(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function gs(t,e,s){if(!e)return t;const n=s&&s.encode||co;w.isFunction(s)&&(s={serialize:s});const o=s&&s.serialize;let a;if(o?a=o(e,s):a=w.isURLSearchParams(e)?e.toString():new ur(e,s).toString(n),a){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class uo{constructor(){this.handlers=[]}use(e,s,n){return this.handlers.push({fulfilled:e,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){w.forEach(this.handlers,function(n){n!==null&&e(n)})}}const Ir=uo,ps={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ho=typeof URLSearchParams<"u"?URLSearchParams:ur,mo=typeof FormData<"u"?FormData:null,fo=typeof Blob<"u"?Blob:null,go={isBrowser:!0,classes:{URLSearchParams:ho,FormData:mo,Blob:fo},protocols:["http","https","file","blob","url","data"]},hr=typeof window<"u"&&typeof document<"u",Gt=typeof navigator=="object"&&navigator||void 0,po=hr&&(!Gt||["ReactNative","NativeScript","NS"].indexOf(Gt.product)<0),xo=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),bo=hr&&window.location.href||"http://localhost",yo=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:hr,hasStandardBrowserEnv:po,hasStandardBrowserWebWorkerEnv:xo,navigator:Gt,origin:bo},Symbol.toStringTag,{value:"Module"})),Q={...yo,...go};function wo(t,e){return Ct(t,new Q.classes.URLSearchParams,Object.assign({visitor:function(s,n,o,a){return Q.isNode&&w.isBuffer(s)?(this.append(n,s.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function vo(t){return w.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function jo(t){const e={},s=Object.keys(t);let n;const o=s.length;let a;for(n=0;n<o;n++)a=s[n],e[a]=t[a];return e}function xs(t){function e(s,n,o,a){let i=s[a++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),c=a>=s.length;return i=!i&&w.isArray(o)?o.length:i,c?(w.hasOwnProp(o,i)?o[i]=[o[i],n]:o[i]=n,!l):((!o[i]||!w.isObject(o[i]))&&(o[i]=[]),e(s,n,o[i],a)&&w.isArray(o[i])&&(o[i]=jo(o[i])),!l)}if(w.isFormData(t)&&w.isFunction(t.entries)){const s={};return w.forEachEntry(t,(n,o)=>{e(vo(n),o,s,0)}),s}return null}function No(t,e,s){if(w.isString(t))try{return(e||JSON.parse)(t),w.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(t)}const mr={transitional:ps,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const n=s.getContentType()||"",o=n.indexOf("application/json")>-1,a=w.isObject(e);if(a&&w.isHTMLForm(e)&&(e=new FormData(e)),w.isFormData(e))return o?JSON.stringify(xs(e)):e;if(w.isArrayBuffer(e)||w.isBuffer(e)||w.isStream(e)||w.isFile(e)||w.isBlob(e)||w.isReadableStream(e))return e;if(w.isArrayBufferView(e))return e.buffer;if(w.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return wo(e,this.formSerializer).toString();if((l=w.isFileList(e))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Ct(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return a||o?(s.setContentType("application/json",!1),No(e)):e}],transformResponse:[function(e){const s=this.transitional||mr.transitional,n=s&&s.forcedJSONParsing,o=this.responseType==="json";if(w.isResponse(e)||w.isReadableStream(e))return e;if(e&&w.isString(e)&&(n&&!this.responseType||o)){const i=!(s&&s.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(l){if(i)throw l.name==="SyntaxError"?$.from(l,$.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Q.classes.FormData,Blob:Q.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};w.forEach(["delete","get","head","post","put","patch"],t=>{mr.headers[t]={}});const fr=mr,So=w.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Co=t=>{const e={};let s,n,o;return t&&t.split(`
`).forEach(function(i){o=i.indexOf(":"),s=i.substring(0,o).trim().toLowerCase(),n=i.substring(o+1).trim(),!(!s||e[s]&&So[s])&&(s==="set-cookie"?e[s]?e[s].push(n):e[s]=[n]:e[s]=e[s]?e[s]+", "+n:n)}),e},Tr=Symbol("internals");function Je(t){return t&&String(t).trim().toLowerCase()}function dt(t){return t===!1||t==null?t:w.isArray(t)?t.map(dt):String(t)}function ko(t){const e=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(t);)e[n[1]]=n[2];return e}const Eo=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ot(t,e,s,n,o){if(w.isFunction(n))return n.call(this,e,s);if(o&&(e=s),!!w.isString(e)){if(w.isString(n))return e.indexOf(n)!==-1;if(w.isRegExp(n))return n.test(e)}}function Ro(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,n)=>s.toUpperCase()+n)}function Lo(t,e){const s=w.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+s,{value:function(o,a,i){return this[n].call(this,e,o,a,i)},configurable:!0})})}class kt{constructor(e){e&&this.set(e)}set(e,s,n){const o=this;function a(l,c,d){const u=Je(c);if(!u)throw new Error("header name must be a non-empty string");const g=w.findKey(o,u);(!g||o[g]===void 0||d===!0||d===void 0&&o[g]!==!1)&&(o[g||c]=dt(l))}const i=(l,c)=>w.forEach(l,(d,u)=>a(d,u,c));if(w.isPlainObject(e)||e instanceof this.constructor)i(e,s);else if(w.isString(e)&&(e=e.trim())&&!Eo(e))i(Co(e),s);else if(w.isObject(e)&&w.isIterable(e)){let l={},c,d;for(const u of e){if(!w.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?w.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}i(l,s)}else e!=null&&a(s,e,n);return this}get(e,s){if(e=Je(e),e){const n=w.findKey(this,e);if(n){const o=this[n];if(!s)return o;if(s===!0)return ko(o);if(w.isFunction(s))return s.call(this,o,n);if(w.isRegExp(s))return s.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=Je(e),e){const n=w.findKey(this,e);return!!(n&&this[n]!==void 0&&(!s||Ot(this,this[n],n,s)))}return!1}delete(e,s){const n=this;let o=!1;function a(i){if(i=Je(i),i){const l=w.findKey(n,i);l&&(!s||Ot(n,n[l],l,s))&&(delete n[l],o=!0)}}return w.isArray(e)?e.forEach(a):a(e),o}clear(e){const s=Object.keys(this);let n=s.length,o=!1;for(;n--;){const a=s[n];(!e||Ot(this,this[a],a,e,!0))&&(delete this[a],o=!0)}return o}normalize(e){const s=this,n={};return w.forEach(this,(o,a)=>{const i=w.findKey(n,a);if(i){s[i]=dt(o),delete s[a];return}const l=e?Ro(a):String(a).trim();l!==a&&delete s[a],s[l]=dt(o),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return w.forEach(this,(n,o)=>{n!=null&&n!==!1&&(s[o]=e&&w.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const n=new this(e);return s.forEach(o=>n.set(o)),n}static accessor(e){const n=(this[Tr]=this[Tr]={accessors:{}}).accessors,o=this.prototype;function a(i){const l=Je(i);n[l]||(Lo(o,i),n[l]=!0)}return w.isArray(e)?e.forEach(a):a(e),this}}kt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);w.reduceDescriptors(kt.prototype,({value:t},e)=>{let s=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[s]=n}}});w.freezeMethods(kt);const le=kt;function Ut(t,e){const s=this||fr,n=e||s,o=le.from(n.headers);let a=n.data;return w.forEach(t,function(l){a=l.call(s,a,o.normalize(),e?e.status:void 0)}),o.normalize(),a}function bs(t){return!!(t&&t.__CANCEL__)}function Fe(t,e,s){$.call(this,t??"canceled",$.ERR_CANCELED,e,s),this.name="CanceledError"}w.inherits(Fe,$,{__CANCEL__:!0});function ys(t,e,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?t(s):e(new $("Request failed with status code "+s.status,[$.ERR_BAD_REQUEST,$.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Io(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function To(t,e){t=t||10;const s=new Array(t),n=new Array(t);let o=0,a=0,i;return e=e!==void 0?e:1e3,function(c){const d=Date.now(),u=n[a];i||(i=d),s[o]=c,n[o]=d;let g=a,p=0;for(;g!==o;)p+=s[g++],g=g%t;if(o=(o+1)%t,o===a&&(a=(a+1)%t),d-i<e)return;const b=u&&d-u;return b?Math.round(p*1e3/b):void 0}}function Ao(t,e){let s=0,n=1e3/e,o,a;const i=(d,u=Date.now())=>{s=u,o=null,a&&(clearTimeout(a),a=null),t.apply(null,d)};return[(...d)=>{const u=Date.now(),g=u-s;g>=n?i(d,u):(o=d,a||(a=setTimeout(()=>{a=null,i(o)},n-g)))},()=>o&&i(o)]}const mt=(t,e,s=3)=>{let n=0;const o=To(50,250);return Ao(a=>{const i=a.loaded,l=a.lengthComputable?a.total:void 0,c=i-n,d=o(c),u=i<=l;n=i;const g={loaded:i,total:l,progress:l?i/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-i)/d:void 0,event:a,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(g)},s)},Ar=(t,e)=>{const s=t!=null;return[n=>e[0]({lengthComputable:s,total:t,loaded:n}),e[1]]},$r=t=>(...e)=>w.asap(()=>t(...e)),$o=Q.hasStandardBrowserEnv?((t,e)=>s=>(s=new URL(s,Q.origin),t.protocol===s.protocol&&t.host===s.host&&(e||t.port===s.port)))(new URL(Q.origin),Q.navigator&&/(msie|trident)/i.test(Q.navigator.userAgent)):()=>!0,_o=Q.hasStandardBrowserEnv?{write(t,e,s,n,o,a){const i=[t+"="+encodeURIComponent(e)];w.isNumber(s)&&i.push("expires="+new Date(s).toGMTString()),w.isString(n)&&i.push("path="+n),w.isString(o)&&i.push("domain="+o),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Po(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Bo(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function ws(t,e,s){let n=!Po(e);return t&&(n||s==!1)?Bo(t,e):e}const _r=t=>t instanceof le?{...t}:t;function Re(t,e){e=e||{};const s={};function n(d,u,g,p){return w.isPlainObject(d)&&w.isPlainObject(u)?w.merge.call({caseless:p},d,u):w.isPlainObject(u)?w.merge({},u):w.isArray(u)?u.slice():u}function o(d,u,g,p){if(w.isUndefined(u)){if(!w.isUndefined(d))return n(void 0,d,g,p)}else return n(d,u,g,p)}function a(d,u){if(!w.isUndefined(u))return n(void 0,u)}function i(d,u){if(w.isUndefined(u)){if(!w.isUndefined(d))return n(void 0,d)}else return n(void 0,u)}function l(d,u,g){if(g in e)return n(d,u);if(g in t)return n(void 0,d)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(d,u,g)=>o(_r(d),_r(u),g,!0)};return w.forEach(Object.keys(Object.assign({},t,e)),function(u){const g=c[u]||o,p=g(t[u],e[u],u);w.isUndefined(p)&&g!==l||(s[u]=p)}),s}const vs=t=>{const e=Re({},t);let{data:s,withXSRFToken:n,xsrfHeaderName:o,xsrfCookieName:a,headers:i,auth:l}=e;e.headers=i=le.from(i),e.url=gs(ws(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(w.isFormData(s)){if(Q.hasStandardBrowserEnv||Q.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[d,...u]=c?c.split(";").map(g=>g.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...u].join("; "))}}if(Q.hasStandardBrowserEnv&&(n&&w.isFunction(n)&&(n=n(e)),n||n!==!1&&$o(e.url))){const d=o&&a&&_o.read(a);d&&i.set(o,d)}return e},Mo=typeof XMLHttpRequest<"u",Oo=Mo&&function(t){return new Promise(function(s,n){const o=vs(t);let a=o.data;const i=le.from(o.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=o,u,g,p,b,f;function h(){b&&b(),f&&f(),o.cancelToken&&o.cancelToken.unsubscribe(u),o.signal&&o.signal.removeEventListener("abort",u)}let m=new XMLHttpRequest;m.open(o.method.toUpperCase(),o.url,!0),m.timeout=o.timeout;function y(){if(!m)return;const N=le.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),C={data:!l||l==="text"||l==="json"?m.responseText:m.response,status:m.status,statusText:m.statusText,headers:N,config:t,request:m};ys(function(T){s(T),h()},function(T){n(T),h()},C),m=null}"onloadend"in m?m.onloadend=y:m.onreadystatechange=function(){!m||m.readyState!==4||m.status===0&&!(m.responseURL&&m.responseURL.indexOf("file:")===0)||setTimeout(y)},m.onabort=function(){m&&(n(new $("Request aborted",$.ECONNABORTED,t,m)),m=null)},m.onerror=function(){n(new $("Network Error",$.ERR_NETWORK,t,m)),m=null},m.ontimeout=function(){let x=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const C=o.transitional||ps;o.timeoutErrorMessage&&(x=o.timeoutErrorMessage),n(new $(x,C.clarifyTimeoutError?$.ETIMEDOUT:$.ECONNABORTED,t,m)),m=null},a===void 0&&i.setContentType(null),"setRequestHeader"in m&&w.forEach(i.toJSON(),function(x,C){m.setRequestHeader(C,x)}),w.isUndefined(o.withCredentials)||(m.withCredentials=!!o.withCredentials),l&&l!=="json"&&(m.responseType=o.responseType),d&&([p,f]=mt(d,!0),m.addEventListener("progress",p)),c&&m.upload&&([g,b]=mt(c),m.upload.addEventListener("progress",g),m.upload.addEventListener("loadend",b)),(o.cancelToken||o.signal)&&(u=N=>{m&&(n(!N||N.type?new Fe(null,t,m):N),m.abort(),m=null)},o.cancelToken&&o.cancelToken.subscribe(u),o.signal&&(o.signal.aborted?u():o.signal.addEventListener("abort",u)));const v=Io(o.url);if(v&&Q.protocols.indexOf(v)===-1){n(new $("Unsupported protocol "+v+":",$.ERR_BAD_REQUEST,t));return}m.send(a||null)})},Uo=(t,e)=>{const{length:s}=t=t?t.filter(Boolean):[];if(e||s){let n=new AbortController,o;const a=function(d){if(!o){o=!0,l();const u=d instanceof Error?d:this.reason;n.abort(u instanceof $?u:new Fe(u instanceof Error?u.message:u))}};let i=e&&setTimeout(()=>{i=null,a(new $(`timeout ${e} of ms exceeded`,$.ETIMEDOUT))},e);const l=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(a):d.removeEventListener("abort",a)}),t=null)};t.forEach(d=>d.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>w.asap(l),c}},Do=Uo,zo=function*(t,e){let s=t.byteLength;if(!e||s<e){yield t;return}let n=0,o;for(;n<s;)o=n+e,yield t.slice(n,o),n=o},Fo=async function*(t,e){for await(const s of Ho(t))yield*zo(s,e)},Ho=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:s,value:n}=await e.read();if(s)break;yield n}}finally{await e.cancel()}},Pr=(t,e,s,n)=>{const o=Fo(t,e);let a=0,i,l=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await o.next();if(d){l(),c.close();return}let g=u.byteLength;if(s){let p=a+=g;s(p)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),o.return()}},{highWaterMark:2})},Et=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",js=Et&&typeof ReadableStream=="function",Vo=Et&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Ns=(t,...e)=>{try{return!!t(...e)}catch{return!1}},Jo=js&&Ns(()=>{let t=!1;const e=new Request(Q.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),Br=64*1024,Xt=js&&Ns(()=>w.isReadableStream(new Response("").body)),ft={stream:Xt&&(t=>t.body)};Et&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!ft[e]&&(ft[e]=w.isFunction(t[e])?s=>s[e]():(s,n)=>{throw new $(`Response type '${e}' is not supported`,$.ERR_NOT_SUPPORT,n)})})})(new Response);const Wo=async t=>{if(t==null)return 0;if(w.isBlob(t))return t.size;if(w.isSpecCompliantForm(t))return(await new Request(Q.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(w.isArrayBufferView(t)||w.isArrayBuffer(t))return t.byteLength;if(w.isURLSearchParams(t)&&(t=t+""),w.isString(t))return(await Vo(t)).byteLength},qo=async(t,e)=>{const s=w.toFiniteNumber(t.getContentLength());return s??Wo(e)},Ko=Et&&(async t=>{let{url:e,method:s,data:n,signal:o,cancelToken:a,timeout:i,onDownloadProgress:l,onUploadProgress:c,responseType:d,headers:u,withCredentials:g="same-origin",fetchOptions:p}=vs(t);d=d?(d+"").toLowerCase():"text";let b=Do([o,a&&a.toAbortSignal()],i),f;const h=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let m;try{if(c&&Jo&&s!=="get"&&s!=="head"&&(m=await qo(u,n))!==0){let C=new Request(e,{method:"POST",body:n,duplex:"half"}),I;if(w.isFormData(n)&&(I=C.headers.get("content-type"))&&u.setContentType(I),C.body){const[T,E]=Ar(m,mt($r(c)));n=Pr(C.body,Br,T,E)}}w.isString(g)||(g=g?"include":"omit");const y="credentials"in Request.prototype;f=new Request(e,{...p,signal:b,method:s.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:y?g:void 0});let v=await fetch(f,p);const N=Xt&&(d==="stream"||d==="response");if(Xt&&(l||N&&h)){const C={};["status","statusText","headers"].forEach(L=>{C[L]=v[L]});const I=w.toFiniteNumber(v.headers.get("content-length")),[T,E]=l&&Ar(I,mt($r(l),!0))||[];v=new Response(Pr(v.body,Br,T,()=>{E&&E(),h&&h()}),C)}d=d||"text";let x=await ft[w.findKey(ft,d)||"text"](v,t);return!N&&h&&h(),await new Promise((C,I)=>{ys(C,I,{data:x,headers:le.from(v.headers),status:v.status,statusText:v.statusText,config:t,request:f})})}catch(y){throw h&&h(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new $("Network Error",$.ERR_NETWORK,t,f),{cause:y.cause||y}):$.from(y,y&&y.code,t,f)}}),Qt={http:ao,xhr:Oo,fetch:Ko};w.forEach(Qt,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Mr=t=>`- ${t}`,Yo=t=>w.isFunction(t)||t===null||t===!1,Ss={getAdapter:t=>{t=w.isArray(t)?t:[t];const{length:e}=t;let s,n;const o={};for(let a=0;a<e;a++){s=t[a];let i;if(n=s,!Yo(s)&&(n=Qt[(i=String(s)).toLowerCase()],n===void 0))throw new $(`Unknown adapter '${i}'`);if(n)break;o[i||"#"+a]=n}if(!n){const a=Object.entries(o).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=e?a.length>1?`since :
`+a.map(Mr).join(`
`):" "+Mr(a[0]):"as no adapter specified";throw new $("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:Qt};function Dt(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Fe(null,t)}function Or(t){return Dt(t),t.headers=le.from(t.headers),t.data=Ut.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Ss.getAdapter(t.adapter||fr.adapter)(t).then(function(n){return Dt(t),n.data=Ut.call(t,t.transformResponse,n),n.headers=le.from(n.headers),n},function(n){return bs(n)||(Dt(t),n&&n.response&&(n.response.data=Ut.call(t,t.transformResponse,n.response),n.response.headers=le.from(n.response.headers))),Promise.reject(n)})}const Cs="1.10.0",Rt={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Rt[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const Ur={};Rt.transitional=function(e,s,n){function o(a,i){return"[Axios v"+Cs+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,l)=>{if(e===!1)throw new $(o(i," has been removed"+(s?" in "+s:"")),$.ERR_DEPRECATED);return s&&!Ur[i]&&(Ur[i]=!0,console.warn(o(i," has been deprecated since v"+s+" and will be removed in the near future"))),e?e(a,i,l):!0}};Rt.spelling=function(e){return(s,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function Go(t,e,s){if(typeof t!="object")throw new $("options must be an object",$.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let o=n.length;for(;o-- >0;){const a=n[o],i=e[a];if(i){const l=t[a],c=l===void 0||i(l,a,t);if(c!==!0)throw new $("option "+a+" must be "+c,$.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new $("Unknown option "+a,$.ERR_BAD_OPTION)}}const ut={assertOptions:Go,validators:Rt},de=ut.validators;class gt{constructor(e){this.defaults=e||{},this.interceptors={request:new Ir,response:new Ir}}async request(e,s){try{return await this._request(e,s)}catch(n){if(n instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(e,s){typeof e=="string"?(s=s||{},s.url=e):s=e||{},s=Re(this.defaults,s);const{transitional:n,paramsSerializer:o,headers:a}=s;n!==void 0&&ut.assertOptions(n,{silentJSONParsing:de.transitional(de.boolean),forcedJSONParsing:de.transitional(de.boolean),clarifyTimeoutError:de.transitional(de.boolean)},!1),o!=null&&(w.isFunction(o)?s.paramsSerializer={serialize:o}:ut.assertOptions(o,{encode:de.function,serialize:de.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),ut.assertOptions(s,{baseUrl:de.spelling("baseURL"),withXsrfToken:de.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let i=a&&w.merge(a.common,a[s.method]);a&&w.forEach(["delete","get","head","post","put","patch","common"],f=>{delete a[f]}),s.headers=le.concat(i,a);const l=[];let c=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(s)===!1||(c=c&&h.synchronous,l.unshift(h.fulfilled,h.rejected))});const d=[];this.interceptors.response.forEach(function(h){d.push(h.fulfilled,h.rejected)});let u,g=0,p;if(!c){const f=[Or.bind(this),void 0];for(f.unshift.apply(f,l),f.push.apply(f,d),p=f.length,u=Promise.resolve(s);g<p;)u=u.then(f[g++],f[g++]);return u}p=l.length;let b=s;for(g=0;g<p;){const f=l[g++],h=l[g++];try{b=f(b)}catch(m){h.call(this,m);break}}try{u=Or.call(this,b)}catch(f){return Promise.reject(f)}for(g=0,p=d.length;g<p;)u=u.then(d[g++],d[g++]);return u}getUri(e){e=Re(this.defaults,e);const s=ws(e.baseURL,e.url,e.allowAbsoluteUrls);return gs(s,e.params,e.paramsSerializer)}}w.forEach(["delete","get","head","options"],function(e){gt.prototype[e]=function(s,n){return this.request(Re(n||{},{method:e,url:s,data:(n||{}).data}))}});w.forEach(["post","put","patch"],function(e){function s(n){return function(a,i,l){return this.request(Re(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}gt.prototype[e]=s(),gt.prototype[e+"Form"]=s(!0)});const ht=gt;class gr{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(a){s=a});const n=this;this.promise.then(o=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](o);n._listeners=null}),this.promise.then=o=>{let a;const i=new Promise(l=>{n.subscribe(l),a=l}).then(o);return i.cancel=function(){n.unsubscribe(a)},i},e(function(a,i,l){n.reason||(n.reason=new Fe(a,i,l),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=n=>{e.abort(n)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let e;return{token:new gr(function(o){e=o}),cancel:e}}}const Xo=gr;function Qo(t){return function(s){return t.apply(null,s)}}function Zo(t){return w.isObject(t)&&t.isAxiosError===!0}const Zt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Zt).forEach(([t,e])=>{Zt[e]=t});const ea=Zt;function ks(t){const e=new ht(t),s=ss(ht.prototype.request,e);return w.extend(s,ht.prototype,e,{allOwnKeys:!0}),w.extend(s,e,null,{allOwnKeys:!0}),s.create=function(o){return ks(Re(t,o))},s}const Y=ks(fr);Y.Axios=ht;Y.CanceledError=Fe;Y.CancelToken=Xo;Y.isCancel=bs;Y.VERSION=Cs;Y.toFormData=Ct;Y.AxiosError=$;Y.Cancel=Y.CanceledError;Y.all=function(e){return Promise.all(e)};Y.spread=Qo;Y.isAxiosError=Zo;Y.mergeConfig=Re;Y.AxiosHeaders=le;Y.formToJSON=t=>xs(w.isHTMLForm(t)?new FormData(t):t);Y.getAdapter=Ss.getAdapter;Y.HttpStatusCode=ea;Y.default=Y;const ta=Y,Dr="4bf253f4685945a5b0c15b8580c167cb",zt=()=>{if({}.VITE_SPOTIFY_REDIRECT_URI)return{}.VITE_SPOTIFY_REDIRECT_URI;if(typeof window<"u"){const{protocol:t,hostname:e}=window.location;return`${t}//${e}/callback`}if(typeof window<"u"){const{protocol:t,hostname:e,port:s}=window.location;return e==="localhost"||e==="127.0.0.1"?`${t}//${e}:${s||"5173"}/callback`:`${t}//${e}/callback`}throw new Error("本番環境では VITE_SPOTIFY_REDIRECT_URI を設定してください")},$e="https://api.spotify.com/v1",ra="https://accounts.spotify.com/authorize",sa="https://accounts.spotify.com/api/token",na=["user-read-private","user-read-email"].join(" ");function oa(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=new Uint8Array(128);return crypto.getRandomValues(s),Array.from(s,o=>t[o%t.length]).join("")}async function aa(t){const s=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",s);return btoa(String.fromCharCode(...new Uint8Array(n))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const Es={getCurrentRedirectUri:()=>zt(),getAuthUrl:async()=>{const t=oa(),e=await aa(t),s=zt(),n=la(32),o=Date.now(),a={codeVerifier:t,timestamp:o,state:n};localStorage.setItem(`spotify_auth_${n}`,JSON.stringify(a)),localStorage.setItem("spotify_current_state",n);const i=new URLSearchParams({client_id:Dr,response_type:"code",redirect_uri:s,scope:na,code_challenge_method:"S256",code_challenge:e,state:n});return`${ra}?${i.toString()}`},getAccessToken:async(t,e)=>{if(!e){const c=localStorage.getItem("spotify_current_state");c&&(e=c)}let s=null,n=null;if(e){const c=localStorage.getItem(`spotify_auth_${e}`);if(c)try{const d=JSON.parse(c);s=d.codeVerifier,n=d.timestamp,console.log("✅ State対応認証データ取得成功:",{state:e.substring(0,10)+"...",hasCodeVerifier:!!s,作成時刻:n?new Date(n).toLocaleTimeString():"unknown"})}catch(d){console.error("❌ 認証データ解析エラー:",d)}}if(!s){s=localStorage.getItem("spotify_code_verifier");const c=localStorage.getItem("spotify_code_verifier_timestamp");c&&(n=parseInt(c)),s&&console.log("⚠️ フォールバック: 古い方式でcode_verifier取得")}if(!s)throw new Error("Code verifier not found - 認証を最初からやり直してください");if(n){const c=Date.now(),d=Math.floor((c-n)/6e4);console.log("🕐 Code Verifier時間確認:",{作成時刻:new Date(n).toLocaleTimeString(),現在時刻:new Date(c).toLocaleTimeString(),経過時間:`${d}分`,制限時間:"10分"}),d>10&&console.warn("⚠️ Code Verifierが10分以上経過しています")}const o=zt(),a={grant_type:"authorization_code",code:t,redirect_uri:o,client_id:Dr,code_verifier:s};console.log("🔄 トークン交換リクエスト開始..."),console.log(`   Redirect URI: ${o}`),console.log("   Client ID: 設定済み"),console.log(`   認証コード: ${t.substring(0,10)}...`),console.log(`   Code Verifier: ${s?"設定済み":"❌ 未設定"}`),console.log(`   Code Verifier長さ: ${s?s.length:0}`),console.log(`   Code Verifier先頭: ${s?s.substring(0,15)+"...":"なし"}`);const i=await fetch(sa,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a)});if(e&&localStorage.removeItem(`spotify_auth_${e}`),localStorage.removeItem("spotify_current_state"),localStorage.removeItem("spotify_code_verifier"),localStorage.removeItem("spotify_code_verifier_timestamp"),!i.ok){e&&localStorage.removeItem(`spotify_auth_${e}`),localStorage.removeItem("spotify_current_state"),localStorage.removeItem("spotify_code_verifier"),localStorage.removeItem("spotify_code_verifier_timestamp");let c="Unknown error";try{const d=await i.json();c=JSON.stringify(d,null,2),console.error("❌ Token exchange失敗:",d)}catch{console.error("❌ Token exchange失敗: レスポンス解析エラー")}throw new Error(`Failed to get access token: ${i.status} - ${c}`)}const l=await i.json();return console.log("✅ Token exchange成功!"),l.access_token}},ve={buildOptimizedQuery:(t,e="track")=>{let s=t.trim();return/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(s)||e==="track"&&s.includes(" ")&&!s.includes("track:")&&!s.includes("artist:")&&s.split(" ").length>=2,s},searchAlbums:async(t,e,s=10)=>{var c;const n=ve.buildOptimizedQuery(t,"album"),a=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(t)?"&market=JP":"",i=await fetch(`${$e}/search?q=${encodeURIComponent(n)}&type=album&limit=${s}${a}`,{headers:{Authorization:`Bearer ${e}`}});if(!i.ok){const d=await i.json().catch(()=>({}));throw new Error(`Failed to search albums: ${i.status} ${((c=d.error)==null?void 0:c.message)||""}`)}return(await i.json()).albums.items.map(d=>{var u,g;return{id:d.id,name:d.name,artist:((u=d.artists[0])==null?void 0:u.name)||"Unknown Artist",image:((g=d.images[0])==null?void 0:g.url)||null,releaseDate:d.release_date,totalTracks:d.total_tracks,spotifyUrl:d.external_urls.spotify}})},searchTracks:async(t,e,s=10)=>{var c;const n=ve.buildOptimizedQuery(t,"track"),a=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(t)?"&market=JP":"",i=await fetch(`${$e}/search?q=${encodeURIComponent(n)}&type=track&limit=${s}${a}`,{headers:{Authorization:`Bearer ${e}`}});if(!i.ok){const d=await i.json().catch(()=>({}));throw new Error(`Failed to search tracks: ${i.status} ${((c=d.error)==null?void 0:c.message)||""}`)}return(await i.json()).tracks.items.map(d=>{var u,g,p,b;return{id:d.id,name:d.name,artist:((u=d.artists[0])==null?void 0:u.name)||"Unknown Artist",album:((g=d.album)==null?void 0:g.name)||"Unknown Album",image:((b=(p=d.album)==null?void 0:p.images[0])==null?void 0:b.url)||null,duration:d.duration_ms,previewUrl:d.preview_url,spotifyUrl:d.external_urls.spotify}})},searchTracksAdvanced:async(t,e,s,n=5)=>{const a=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(t+e)?"&market=JP":"",i=`track:"${t}" artist:"${e}"`,l=await fetch(`${$e}/search?q=${encodeURIComponent(i)}&type=track&limit=${n}${a}`,{headers:{Authorization:`Bearer ${s}`}});if(!l.ok){const d=`${t} ${e}`;return ve.searchTracks(d,s,n)}return(await l.json()).tracks.items.map(d=>{var u,g,p,b;return{id:d.id,name:d.name,artist:((u=d.artists[0])==null?void 0:u.name)||"Unknown Artist",album:((g=d.album)==null?void 0:g.name)||"Unknown Album",image:((b=(p=d.album)==null?void 0:p.images[0])==null?void 0:b.url)||null,duration:d.duration_ms,previewUrl:d.preview_url,spotifyUrl:d.external_urls.spotify}})},searchArtists:async(t,e,s=10)=>{const n=await fetch(`${$e}/search?q=${encodeURIComponent(t)}&type=artist&limit=${s}`,{headers:{Authorization:`Bearer ${e}`}});if(!n.ok)throw new Error("Failed to search artists");return(await n.json()).artists.items.map(a=>{var i,l;return{id:a.id,name:a.name,image:((i=a.images[0])==null?void 0:i.url)||null,followers:((l=a.followers)==null?void 0:l.total)||0,genres:a.genres||[],spotifyUrl:a.external_urls.spotify}})}},ia={getPreviewUrl:(t,e)=>`${$e}/tracks/${t}`,getUserPlaylists:async t=>{const e=await fetch(`${$e}/me/playlists`,{headers:{Authorization:`Bearer ${t}`}});if(!e.ok)throw new Error("Failed to get playlists");return(await e.json()).items.map(n=>{var o;return{id:n.id,name:n.name,description:n.description,image:((o=n.images[0])==null?void 0:o.url)||null,tracksCount:n.tracks.total,spotifyUrl:n.external_urls.spotify}})}};function la(t){if(typeof crypto<"u"&&crypto.getRandomValues){const n=new Uint32Array(t);crypto.getRandomValues(n);const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return Array.from(n,a=>o[a%o.length]).join("")}const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let s="";for(let n=0;n<t;n++)s+=e.charAt(Math.floor(Math.random()*e.length));return s}const ca=Object.freeze(Object.defineProperty({__proto__:null,spotifyAuth:Es,spotifyPreview:ia,spotifySearch:ve},Symbol.toStringTag,{value:"Module"}));let Rs=[];const da=()=>{Rs=[]},he=(t,e,s,n)=>{const o={provider:t,success:e,error:s,fallbackReason:n,timestamp:Date.now()};Rs.push(o),e?console.log(`✅ ${t.toUpperCase()}検索成功`):(console.error(`❌ ${t.toUpperCase()}検索失敗:`,s),n&&console.warn(`🔄 フォールバック理由: ${n}`))};let ue="spotify";const Ls=t=>{ue=t,console.log(`🔄 音楽検索プロバイダーを ${t.toUpperCase()} に切り替えました`)},ua="abfe3677d7f2a1b357dc58df96ede541",ha="https://ws.audioscrobbler.com/2.0/",Is="4bf253f4685945a5b0c15b8580c167cb",zr=t=>!!(t&&t.trim()!==""&&!t.includes("2a96cbd8b46e442fc41c2b86b821562f"));let Ee=null;const ma=()=>{const t=localStorage.getItem("spotify_access_token");t&&(Ee=t,console.log("Spotify トークンをローカルストレージから復元しました"),Ls("spotify"))};ma();const Ts=t=>{Ee=t,localStorage.setItem("spotify_access_token",t),console.log("Spotify アクセストークンが設定されました")},fa=()=>{Ee=null,localStorage.removeItem("spotify_access_token"),localStorage.removeItem("spotify_refresh_token"),localStorage.removeItem("spotify_token_expires"),console.log("Spotify アクセストークンを削除しました")};async function ga(){const t=localStorage.getItem("spotify_refresh_token");if(!t)throw new Error("リフレッシュトークンがありません");const e=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Basic ${btoa(`${Is}:${{}.VITE_SPOTIFY_CLIENT_SECRET||""}`)}`},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:t})});if(!e.ok){const n=await e.json();throw new Error(`Token refresh failed: ${n.error_description||n.error}`)}const s=await e.json();return Ts(s.access_token),localStorage.setItem("spotify_token_expires",(Date.now()+s.expires_in*1e3).toString()),s.refresh_token&&localStorage.setItem("spotify_refresh_token",s.refresh_token),console.log("✅ Spotifyトークンをリフレッシュしました"),s.access_token}async function pa(){if(!Ee)return console.log("❌ アクセストークンが設定されていません"),null;const t=localStorage.getItem("spotify_token_expires");if(!t)return console.log("❌ トークンの有効期限情報がありません"),Ee;const e=Date.now(),s=parseInt(t);if(e>=s-5*60*1e3){console.log("🔄 トークンの有効期限が近いため、リフレッシュします");try{return await ga()}catch(n){return console.error("❌ トークンリフレッシュに失敗:",n),fa(),null}}return Ee}const Fr=async t=>{var s,n,o,a,i;da();const e=await pa();if(!e){const l="Spotify アクセストークンが設定されていないか、リフレッシュに失敗しました";return he("spotify",!1,l,`${l}。Last.fmにフォールバックします。`),pt(t)}try{const l=[],c=t.trim().split(/\s+/),d=c.length>=2,u=await ve.searchTracks(t,e,7),g=await ve.searchAlbums(t,e,3);let p=[];if(d&&c.length<=4)try{const f=c.slice(0,Math.ceil(c.length/2)).join(" "),h=c.slice(Math.ceil(c.length/2)).join(" ");p=await ve.searchTracksAdvanced(f,h,e,3)}catch(f){console.log("Spotify詳細検索失敗（通常の検索結果を使用）:",f)}const b=new Set;return p.forEach(f=>{b.has(f.id)||(l.push({name:f.name,artist:f.artist,image:f.image||void 0,url:f.spotifyUrl,isGeneratedImage:!f.image,provider:"spotify",id:f.id}),b.add(f.id))}),u.forEach(f=>{b.has(f.id)||(l.push({name:f.name,artist:f.artist,image:f.image||void 0,url:f.spotifyUrl,isGeneratedImage:!f.image,provider:"spotify",id:f.id}),b.add(f.id))}),g.forEach(f=>{b.has(f.id)||(l.push({name:f.name,artist:f.artist,image:f.image||void 0,url:f.spotifyUrl,isGeneratedImage:!f.image,provider:"spotify",id:f.id}),b.add(f.id))}),he("spotify",!0),console.log(`Spotify検索完了: ${l.length}件の結果`),l.slice(0,10)}catch(l){const c=((o=(n=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:n.error)==null?void 0:o.message)||(l==null?void 0:l.message)||"Spotify API呼び出しに失敗しました",d=(a=l==null?void 0:l.response)==null?void 0:a.status,u=d?`HTTP ${d}: ${c}`:c;return he("spotify",!1,u,"Spotify検索でエラーが発生したため、Last.fmにフォールバックします"),console.error("Spotify検索エラー詳細:",{status:d,message:c,response:(i=l==null?void 0:l.response)==null?void 0:i.data,error:l}),pt(t)}},pt=async t=>{var e,s,n,o,a,i;try{const l=t.trim();console.log(`Last.fm検索実行: "${l}"`);const d=((s=(e=(await ta.get(ha,{params:{method:"track.search",track:l,api_key:ua,format:"json",limit:15}})).data.results)==null?void 0:e.trackmatches)==null?void 0:s.track)||[];return he("lastfm",!0),console.log(`Last.fm検索結果: ${d.length}件`),Array.isArray(d)?d.map(u=>{var b,f,h,m,y,v;const g=((f=(b=u.image)==null?void 0:b[3])==null?void 0:f["#text"])||((m=(h=u.image)==null?void 0:h[2])==null?void 0:m["#text"])||((v=(y=u.image)==null?void 0:y[1])==null?void 0:v["#text"])||"",p=xa(u.name,u.artist);return{name:u.name,artist:u.artist,image:zr(g)?g:p.image,url:u.url,isGeneratedImage:!zr(g),provider:"lastfm"}}):(he("lastfm",!1,"Last.fm APIの応答形式が予期しない形式です","レスポンスデータの構造が変更された可能性があります"),[])}catch(l){const c=((o=(n=l==null?void 0:l.response)==null?void 0:n.data)==null?void 0:o.message)||(l==null?void 0:l.message)||"Last.fm API呼び出しに失敗しました",d=(a=l==null?void 0:l.response)==null?void 0:a.status,u=d?`HTTP ${d}: ${c}`:c;return he("lastfm",!1,u,"Last.fm APIでエラーが発生しました"),console.error("Last.fm検索エラー詳細:",{status:d,message:c,response:(i=l==null?void 0:l.response)==null?void 0:i.data,error:l}),[]}},xa=(t,e)=>({image:`https://picsum.photos/300/300?random=${Math.floor(Math.random()*1e3)}`,isGenerated:!0}),ba=[{name:"Bohemian Rhapsody",artist:"Queen",image:"https://picsum.photos/300/300?random=1",isGeneratedImage:!0,provider:"lastfm"},{name:"Hotel California",artist:"Eagles",image:"https://picsum.photos/300/300?random=2",isGeneratedImage:!0,provider:"lastfm"},{name:"Imagine",artist:"John Lennon",image:"https://picsum.photos/300/300?random=3",isGeneratedImage:!0,provider:"lastfm"},{name:"Stairway to Heaven",artist:"Led Zeppelin",image:"https://picsum.photos/300/300?random=4",isGeneratedImage:!0,provider:"lastfm"},{name:"Yesterday",artist:"The Beatles",image:"https://picsum.photos/300/300?random=5",isGeneratedImage:!0,provider:"lastfm"},{name:"Smells Like Teen Spirit",artist:"Nirvana",image:"https://picsum.photos/300/300?random=6",isGeneratedImage:!0,provider:"lastfm"},{name:"Like a Rolling Stone",artist:"Bob Dylan",image:"https://picsum.photos/300/300?random=7",isGeneratedImage:!0,provider:"lastfm"},{name:"I Want to Hold Your Hand",artist:"The Beatles",image:"https://picsum.photos/300/300?random=8",isGeneratedImage:!0,provider:"lastfm"},{name:"Johnny B. Goode",artist:"Chuck Berry",image:"https://picsum.photos/300/300?random=9",isGeneratedImage:!0,provider:"lastfm"},{name:"Good Vibrations",artist:"The Beach Boys",image:"https://picsum.photos/300/300?random=10",isGeneratedImage:!0,provider:"lastfm"}],ya=async t=>{const e=ba.filter(s=>s.name.toLowerCase().includes(t.toLowerCase())||s.artist.toLowerCase().includes(t.toLowerCase()));return await new Promise(s=>setTimeout(s,300)),e},wa=()=>{const t=[];return Is&&Ee&&t.push("spotify"),t.push("lastfm"),t},va=async t=>{const e=wa();if(console.log(`🔍 音楽検索開始: "${t}"`),console.log(`📋 利用可能プロバイダー: ${e.map(s=>s.toUpperCase()).join(", ")}`),console.log(`⚙️ 現在のプロバイダー: ${ue.toUpperCase()}`),e.includes(ue))try{switch(ue){case"spotify":return await Fr(t);case"lastfm":return await pt(t);default:{const s=`未サポートのプロバイダー: ${ue}`;throw he(ue,!1,s),new Error(s)}}}catch(s){console.error(`${ue.toUpperCase()}検索エラー:`,s)}else{const s=`${ue.toUpperCase()}は現在利用できません`;he(ue,!1,s,s)}for(const s of e)if(s!==ue)try{switch(console.log(`🔄 ${s.toUpperCase()}にフォールバックします`),s){case"spotify":return await Fr(t);case"lastfm":return await pt(t)}}catch(n){const o=(n==null?void 0:n.message)||`${s}フォールバック失敗`;he(s,!1,o,"フォールバック試行中にエラー"),console.error(`${s.toUpperCase()}フォールバック失敗:`,n)}return console.warn("⚠️ 全てのプロバイダーが利用不可。モックデータを使用します。"),he("lastfm",!1,"全プロバイダー失敗","モックデータにフォールバック"),await ya(t)};async function ja(){const{spotifyAuth:t}=await fn(()=>Promise.resolve().then(()=>ca),void 0);return t.getAuthUrl()}function Na(){const t=be();return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:r.jsxs("div",{className:"container mx-auto px-4 py-16",children:[r.jsxs("div",{className:"text-center mb-16",children:[r.jsxs("h1",{className:"text-7xl font-bold text-gray-900 mb-6",children:["Musi",r.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-cyan-500",children:"Card"})]}),r.jsx("p",{className:"text-gray-600 text-xl mb-8 max-w-2xl mx-auto leading-relaxed",children:"好きな音で、あなたを彩ろう"}),r.jsx("div",{className:"flex justify-center gap-4 mb-8",children:r.jsx(_e,{to:"/login",className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-8 py-4 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 hover:scale-105 text-lg shadow-lg hover:shadow-xl",children:"ログイン / 音楽名刺を作成"})}),r.jsx("div",{className:"flex justify-center",children:r.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg",children:[r.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"サンプル名刺をご覧ください"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx(_e,{to:"/users/alice",className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-6 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 hover:scale-105 shadow-md hover:shadow-lg",children:"Aliceの名刺"}),r.jsx(_e,{to:"/users/bob",className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-xl font-semibold hover:bg-gray-200 transition-all duration-300 hover:scale-105 border border-gray-200",children:"Bobの名刺"})]})]})})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-8 max-w-4xl mx-auto",children:[r.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl mx-auto mb-4 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 3a1 1 0 00-1.447-.894L8.763 6H5a3 3 0 000 6h.28l1.771 5.316A1 1 0 008 18h1a1 1 0 001-1v-4.382l6.553 3.894A1 1 0 0018 16V3z",clipRule:"evenodd"})})}),r.jsx("h3",{className:"text-gray-900 font-semibold text-lg mb-2",children:"洗練されたデザイン"}),r.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"Topsters風のモダンで美しいレイアウト"})]}),r.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-xl mx-auto mb-4 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})}),r.jsx("h3",{className:"text-gray-900 font-semibold text-lg mb-2",children:"簡単シェア"}),r.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"SNSのプロフィールに貼るだけで音楽の趣味を共有"})]}),r.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-400 to-cyan-400 rounded-xl mx-auto mb-4 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("h3",{className:"text-gray-900 font-semibold text-lg mb-2",children:"どこでも表示"}),r.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"PC・スマートフォンどちらでも美しく表示"})]})]}),r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-8 border border-blue-200/50 shadow-lg",children:[r.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-4",children:"🎵 音楽検索機能"}),r.jsx("p",{className:"text-blue-700 mb-4",children:"SpotifyとLast.fmの両方に対応した音楽検索で、豊富な楽曲データベースから選択できます。"}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"🎧 Spotify認証"}),r.jsx("p",{className:"text-blue-600 text-sm",children:"Spotifyにログインして、より豊富な音楽データベースにアクセス"})]}),r.jsxs("button",{onClick:async()=>{const e=await ja();window.open(e,"_blank")},className:"bg-green-500 text-white px-4 py-2 rounded-xl font-semibold hover:bg-green-600 transition-colors duration-300 flex items-center gap-2",children:[r.jsx("span",{children:"🎵"}),"Spotify連携"]})]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[r.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"🎯 Spotify検索"}),r.jsx("p",{className:"text-blue-600 text-sm",children:"高精度な検索結果と豊富なメタデータ"})]}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[r.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"🔄 Last.fmフォールバック"}),r.jsx("p",{className:"text-blue-600 text-sm",children:"Spotifyで見つからない場合の自動フォールバック"})]})]})]}),!1,r.jsx("div",{className:"mt-16 pt-8 border-t border-gray-200/50",children:r.jsx("div",{className:"text-center",children:r.jsx("button",{onClick:()=>t("/admin-login"),className:"text-xs text-gray-300 hover:text-gray-500 transition-colors px-2 py-1 rounded opacity-50 hover:opacity-100",title:"管理者ログイン",children:"⚙️"})})})]})})}function Sa(){const t=be(),[e,s]=j.useState(""),[n,o]=j.useState(""),[a,i]=j.useState(!1),[l,c]=j.useState(!1),d=async u=>{if(u.preventDefault(),!(!e.trim()||!n.trim())){i(!0);try{const g=e.trim().toLowerCase(),p=localStorage.getItem(`musicard_auth_${g}`);if(p){if(JSON.parse(p).password!==n){alert("❌ パスワードが正しくありません");return}console.log(`✅ ユーザー「${e}」でログインしました`)}else if(l){const b={username:g,password:n,createdAt:new Date().toISOString()};localStorage.setItem(`musicard_auth_${g}`,JSON.stringify(b)),console.log(`🆕 新規ユーザー「${e}」を登録しました`)}else{alert("❌ ユーザーが見つかりません。新規登録をしてください。");return}localStorage.setItem("musicard_user",g),localStorage.setItem("musicard_login_time",Date.now().toString()),t("/dashboard")}catch(g){console.error("ログインエラー:",g),alert("ログインに失敗しました")}finally{i(!1)}}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsxs("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:["Musi",r.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-cyan-500",children:"Card"})]}),r.jsx("p",{className:"text-gray-600",children:"音楽名刺でつながろう"})]}),r.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 mb-6",children:[r.jsx("button",{type:"button",onClick:()=>c(!1),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${l?"text-gray-600 hover:text-gray-800":"bg-white text-blue-600 shadow-sm"}`,children:"ログイン"}),r.jsx("button",{type:"button",onClick:()=>c(!0),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${l?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:"新規登録"})]}),r.jsxs("form",{onSubmit:d,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ユーザー名"}),r.jsx("input",{type:"text",value:e,onChange:u=>s(u.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"英数字でユーザー名を入力",required:!0,disabled:a})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"パスワード"}),r.jsx("input",{type:"password",value:n,onChange:u=>o(u.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"パスワードを入力",required:!0,disabled:a}),l&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"パスワードは安全に保管されます"})]}),r.jsx("button",{type:"submit",disabled:!e.trim()||!n.trim()||a,className:"w-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:a?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),l?"登録中...":"ログイン中..."]}):l?"新規登録":"ログイン"})]}),r.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[r.jsx("p",{className:"text-sm text-gray-600 text-center mb-4",children:"または、ゲストとして閲覧"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>t("/users/alice"),className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Aliceの名刺"}),r.jsx("button",{onClick:()=>t("/users/bob"),className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Bobの名刺"})]})]}),!1]})})}function Ca(){const t=be(),[e,s]=j.useState(""),[n,o]=j.useState(""),[a,i]=j.useState(!1),l=async c=>{if(c.preventDefault(),!(!e.trim()||!n.trim())){i(!0);try{if(!({}.VITE_ADMIN_USERS||"admin").split(",").includes(e.toLowerCase())){alert("❌ 管理者権限がありません");return}const u=`musicard_admin_${e.toLowerCase()}`,g=localStorage.getItem(u);if(g){if(JSON.parse(g).password!==n){alert("❌ 管理者パスワードが正しくありません");return}}else{const p={username:e.toLowerCase(),password:n,role:"admin",createdAt:new Date().toISOString()};localStorage.setItem(u,JSON.stringify(p)),console.log(`🛡️ 管理者アカウント「${e}」を作成しました`)}localStorage.setItem("musicard_admin",e.toLowerCase()),localStorage.setItem("musicard_admin_login_time",Date.now().toString()),console.log(`🛡️ 管理者「${e}」でログインしました`),t("/admin")}catch(d){console.error("管理者ログインエラー:",d),alert("ログインに失敗しました")}finally{i(!1)}}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-white to-red-100 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border-t-4 border-red-500",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("div",{className:"w-16 h-16 bg-red-500 rounded-full mx-auto mb-4 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"管理者ログイン"}),r.jsx("p",{className:"text-gray-600",children:"MusiCard Admin Panel"})]}),r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})}),r.jsx("p",{className:"text-red-700 text-sm",children:"管理者のみアクセス可能です"})]})}),r.jsxs("form",{onSubmit:l,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"管理者ユーザー名"}),r.jsx("input",{type:"text",value:e,onChange:c=>s(c.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"管理者ユーザー名",required:!0,disabled:a})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"管理者パスワード"}),r.jsx("input",{type:"password",value:n,onChange:c=>o(c.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"管理者パスワード",required:!0,disabled:a})]}),r.jsx("button",{type:"submit",disabled:!e.trim()||!n.trim()||a,className:"w-full bg-gradient-to-r from-red-500 to-red-600 text-white py-3 rounded-lg font-semibold hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:a?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"ログイン中..."]}):"管理者ログイン"})]}),r.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center",children:r.jsx("button",{onClick:()=>t("/"),className:"text-gray-500 hover:text-gray-700 text-sm transition-colors",children:"← トップページに戻る"})}),!1]})})}const Le=[{id:"light",name:"ライト",background:"bg-gradient-to-br from-gray-50 to-gray-100",textPrimary:"text-gray-800",textSecondary:"text-gray-600",surface:"bg-white/80",surfaceHover:"bg-gray-100",border:"border-gray-300"},{id:"dark",name:"ダーク",background:"bg-black",textPrimary:"text-white",textSecondary:"text-white/80",surface:"bg-white/10",surfaceHover:"bg-white/20",border:"border-white/20"}],Be=[{id:"blue",name:"ブルー",gradient:"from-blue-500 to-blue-600",primary:"blue-500",secondary:"blue-100",primaryHex:"#3B82F6",secondaryHex:"#DBEAFE"},{id:"purple",name:"パープル",gradient:"from-purple-500 to-purple-600",primary:"purple-500",secondary:"purple-100",primaryHex:"#8B5CF6",secondaryHex:"#EDE9FE"},{id:"green",name:"グリーン",gradient:"from-green-500 to-green-600",primary:"green-500",secondary:"green-100",primaryHex:"#10B981",secondaryHex:"#DCFCE7"},{id:"pink",name:"ピンク",gradient:"from-pink-500 to-pink-600",primary:"pink-500",secondary:"pink-100",primaryHex:"#EC4899",secondaryHex:"#FCE7F3"},{id:"orange",name:"オレンジ",gradient:"from-orange-500 to-orange-600",primary:"orange-500",secondary:"orange-100",primaryHex:"#F97316",secondaryHex:"#FED7AA"},{id:"red",name:"レッド",gradient:"from-red-500 to-red-600",primary:"red-500",secondary:"red-100",primaryHex:"#EF4444",secondaryHex:"#FEE2E2"},{id:"indigo",name:"インディゴ",gradient:"from-indigo-500 to-indigo-600",primary:"indigo-500",secondary:"indigo-100",primaryHex:"#6366F1",secondaryHex:"#E0E7FF"},{id:"teal",name:"ティール",gradient:"from-teal-500 to-teal-600",primary:"teal-500",secondary:"teal-100",primaryHex:"#14B8A6",secondaryHex:"#CCFBF1"}],te=[{id:"3x3",name:"3×3 (9セル)",size:3,totalCells:9,centerPositions:[4]},{id:"4x4",name:"4×4 (16セル)",size:4,totalCells:16,centerPositions:[5,6,9,10]},{id:"5x5",name:"5×5 (25セル)",size:5,totalCells:25,centerPositions:[12]},{id:"6x6",name:"6×6 (36セル)",size:6,totalCells:36,centerPositions:[14,15,20,21]}],Hr=["J-POP","K-POP","ロック","メタル","パンク","オルタナティブ","インディー","エレクトロニカ","テクノ","ハウス","ダブステップ","ヒップホップ","R&B","ソウル","ファンク","ジャズ","ブルース","フォーク","カントリー","レゲエ","クラシック","アニメ","ゲーム音楽","ボサノヴァ","ラテン","ワールドミュージック","アンビエント","その他"],He="musicmeisi_users",As="musicmeisi_users_backup",ye=()=>{try{const t=localStorage.getItem(He);if(!t)return console.log("📂 ユーザーデータが見つかりません。新しいストレージを初期化します"),{};const e=JSON.parse(t);console.log(`📂 ${Object.keys(e).length}人のユーザーデータを読み込みました`);const s={};for(const[n,o]of Object.entries(e))Aa(o)?s[n]=o:console.warn(`⚠️ 無効なユーザーデータをスキップ: ${n}`);return s}catch(t){return console.error("❌ ユーザーデータの読み込みに失敗:",t),{}}},ka=t=>{try{const s=ye()[t];if(!s)return null;let n=!1,o={...s};if(s.baseColor||(o.baseColor=Le[0],n=!0,console.log(`🔄 ユーザー「${t}」: baseColorを追加`)),!s.gridLayout)o.gridLayout=te[1],n=!0,console.log(`🔄 ユーザー「${t}」: gridLayoutを追加`);else if(s.gridLayout&&"centerPosition"in s.gridLayout){const a=s.gridLayout,i=te.find(l=>l.size===a.size)||te[1];o.gridLayout=i,n=!0,console.log(`🔄 ユーザー「${t}」: centerPosition → centerPositions に更新`)}return n?(pr(o),console.log(`✅ ユーザー「${t}」のデータマイグレーションが完了しました`),o):s}catch(e){return console.error(`❌ ユーザー「${t}」の読み込みに失敗:`,e),null}},pr=t=>{try{const e=ye();return Lt(e),e[t.username]={...t,updatedAt:new Date().toISOString()},localStorage.setItem(He,JSON.stringify(e)),console.log(`💾 ユーザー「${t.username}」のデータを保存しました`),console.log(`📊 現在の総ユーザー数: ${Object.keys(e).length}人`),!0}catch(e){return console.error(`❌ ユーザー「${t.username}」の保存に失敗:`,e),!1}},Ea=t=>{try{const e=ye();return e[t]?(Lt(e),delete e[t],localStorage.setItem(He,JSON.stringify(e)),console.log(`🗑️ ユーザー「${t}」のデータを削除しました`),console.log(`📊 現在の総ユーザー数: ${Object.keys(e).length}人`),!0):(console.warn(`⚠️ ユーザー「${t}」は存在しません`),!1)}catch(e){return console.error(`❌ ユーザー「${t}」の削除に失敗:`,e),!1}},$s=()=>{try{const t=ye();return Object.entries(t).map(([e,s])=>{var n;return{username:e,displayName:s.displayName||e,songCount:((n=s.songs)==null?void 0:n.length)||0,viewCount:s.viewCount||0,updatedAt:s.updatedAt||s.createdAt||""}}).sort((e,s)=>new Date(s.updatedAt).getTime()-new Date(e.updatedAt).getTime())}catch(t){return console.error("❌ ユーザーリストの取得に失敗:",t),[]}},Ra=t=>{try{const e=ye();return e[t]?(e[t].viewCount=(e[t].viewCount||0)+1,e[t].updatedAt=new Date().toISOString(),localStorage.setItem(He,JSON.stringify(e)),!0):(console.warn(`⚠️ ユーザー「${t}」は存在しません`),!1)}catch(e){return console.error("❌ 訪問者数の更新に失敗:",e),!1}},Lt=t=>{try{const e=t||ye(),s={data:e,timestamp:new Date().toISOString(),userCount:Object.keys(e).length};return localStorage.setItem(As,JSON.stringify(s)),console.log(`💾 バックアップを作成しました (${s.userCount}人のユーザー)`),!0}catch(e){return console.error("❌ バックアップの作成に失敗:",e),!1}},La=()=>{try{const t=localStorage.getItem(As);if(!t)return console.warn("⚠️ バックアップデータが見つかりません"),!1;const e=JSON.parse(t);return localStorage.setItem(He,JSON.stringify(e.data)),console.log(`🔄 バックアップから復元しました (${e.userCount}人のユーザー)`),console.log(`📅 バックアップ作成日時: ${new Date(e.timestamp).toLocaleString()}`),!0}catch(t){return console.error("❌ バックアップからの復元に失敗:",t),!1}},Ia=()=>{try{const t=ye(),e={version:"1.0",exportDate:new Date().toISOString(),userCount:Object.keys(t).length,users:t};return JSON.stringify(e,null,2)}catch(t){return console.error("❌ データのエクスポートに失敗:",t),""}},Ta=t=>{try{const e=JSON.parse(t);if(!e.users||typeof e.users!="object")throw new Error("無効なデータ形式です");return Lt(),localStorage.setItem(He,JSON.stringify(e.users)),console.log(`📥 データをインポートしました (${Object.keys(e.users).length}人のユーザー)`),!0}catch(e){return console.error("❌ データのインポートに失敗:",e),!1}},Aa=t=>!t||typeof t!="object"?!1:["username","displayName","songs","createdAt"].every(s=>s in t),$a=()=>{try{const t=ye(),e=Object.keys(t).length;let s=0,n=0;Object.values(t).forEach(a=>{var i;s+=((i=a.songs)==null?void 0:i.length)||0,n+=a.viewCount||0});const o=new Blob([JSON.stringify(t)]).size;return{totalUsers:e,totalSongs:s,totalViews:n,storageSizeBytes:o,storageSizeKB:Math.round(o/1024*100)/100}}catch(t){return console.error("❌ 統計情報の取得に失敗:",t),{totalUsers:0,totalSongs:0,totalViews:0,storageSizeBytes:0,storageSizeKB:0}}},_s={}.VITE_STORAGE_PROVIDER||"localStorage";class Ps{async loadAllUsers(){return Promise.resolve(ye())}async loadUser(e){return Promise.resolve(ka(e))}async saveUser(e){return Promise.resolve(pr(e))}async incrementViewCount(e){return Promise.resolve(Ra(e))}}class _a{constructor(){Ae(this,"fallback",new Ps)}async loadAllUsers(){try{return console.log("🔄 Vercel Blob実装は準備中です。ローカルストレージにフォールバック中..."),await this.fallback.loadAllUsers()}catch(e){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",e),await this.fallback.loadAllUsers()}}async loadUser(e){try{return await this.fallback.loadUser(e)}catch(s){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",s),await this.fallback.loadUser(e)}}async saveUser(e){try{return await this.fallback.saveUser(e)}catch(s){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",s),await this.fallback.saveUser(e)}}async incrementViewCount(e){try{return await this.fallback.incrementViewCount(e)}catch(s){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",s),await this.fallback.incrementViewCount(e)}}async uploadImage(e,s){try{return console.log(`🖼️ 画像アップロード準備中: ${s}`),new Promise(n=>{const o=new FileReader;o.onloadend=()=>n(o.result),o.readAsDataURL(e)})}catch(n){throw console.error("画像アップロードエラー:",n),n}}}function Pa(){switch(_s){case"vercelBlob":return console.log("🚀 Vercel Blobストレージを使用中（フォールバック付き）"),new _a;case"localStorage":default:return console.log("💾 ローカルストレージを使用中"),new Ps}}const Pe=Pa();function Vr(){return{current:_s,available:["localStorage","vercelBlob"],override:localStorage.getItem("OVERRIDE_STORAGE_PROVIDER"),environment:{}.VITE_STORAGE_PROVIDER}}let Ba=null;try{Ba=require("sharp")}catch{console.warn("⚠️ sharpパッケージが利用できません。画像処理機能が制限されます。")}function Jr(t,e=5){let s;return t instanceof ArrayBuffer||t instanceof Uint8Array?s=t.byteLength:s=t.length||0,s/(1024*1024)<=e}function Wr(t){return["image/jpeg","image/jpg","image/png","image/webp"].includes(t.toLowerCase())}const Ma="/api/upload/image",Se=class Se{constructor(){Ae(this,"uploadCache",new Map)}static getInstance(){return Se.instance||(Se.instance=new Se),Se.instance}async uploadViaAPI(e,s,n){try{const o=new Uint8Array(e);let a="";for(let d=0;d<o.byteLength;d++)a+=String.fromCharCode(o[d]);const i=btoa(a),l=await fetch(Ma,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:i,username:s,type:n})});if(!l.ok)throw new Error(`アップロードに失敗しました: ${l.status}`);const c=await l.json();return console.log(`[API画像アップロード成功] ユーザー: ${s}, タイプ: ${n}, URL: ${c.url}`),{url:c.url,size:e.byteLength,width:0,height:0,format:"jpeg"}}catch(o){throw console.error("API画像アップロードエラー:",o),o}}async uploadUserIcon(e,s){try{if(!Wr(e.type))throw new Error("サポートされていない画像形式です");const n=await e.arrayBuffer();if(!Jr(new Uint8Array(n)))throw new Error("ファイルサイズが大きすぎます（最大5MB）");return await this.uploadViaAPI(n,s,"icon")}catch(n){return console.error("ユーザーアイコンアップロードエラー:",n),this.fallbackUpload(e,s,"icon")}}async uploadAlbumCover(e,s,n){try{if(!Wr(e.type))throw new Error("サポートされていない画像形式です");const o=await e.arrayBuffer();if(!Jr(o))throw new Error("ファイルサイズが大きすぎます（最大5MB）");return await this.uploadViaAPI(o,s,"album")}catch(o){return console.error("アルバムジャケットアップロードエラー:",o),this.fallbackUpload(e,s,"album")}}async uploadFromUrl(e,s,n){try{const o=await fetch(e);if(!o.ok)throw new Error("画像の取得に失敗しました");const a=await o.arrayBuffer();return await this.uploadViaAPI(a,s,n)}catch(o){return console.error("外部画像アップロードエラー:",o),this.fallbackUrlUpload(e,s,n)}}async fallbackUpload(e,s,n){return console.warn("⚠️ API Routeが利用できません。ローカル保存を使用します。"),new Promise(o=>{const a=new FileReader;a.onload=i=>{var c;const l=(c=i.target)==null?void 0:c.result;o({url:l,size:e.size,width:0,height:0,format:e.type.split("/")[1]||"jpeg"})},a.readAsDataURL(e)})}async fallbackUrlUpload(e,s,n){return console.warn("⚠️ API Routeが利用できません。元のURLを使用します。"),{url:e,size:0,width:0,height:0,format:"jpeg"}}async deleteImage(e){try{const s=await fetch("/api/delete/image",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})});if(s.ok)return console.log(`🗑️ 画像を削除: ${e}`),!0;throw new Error(`削除に失敗: ${s.status}`)}catch(s){return console.error("画像削除エラー:",s),!1}}async getStats(){try{const e=await fetch("/api/stats/images");if(e.ok){const s=await e.json();return console.log(`[統計取得成功] ファイル数: ${s.totalFiles}, サイズ: ${s.totalSize}`),s}else throw new Error(`統計取得に失敗: ${e.status}`)}catch(e){return console.error("統計取得エラー:",e),{totalFiles:0,totalSize:0,userIcons:0,albumCovers:0}}}async cleanupOldImages(){try{const e=await fetch("/api/cleanup/images",{method:"POST"});if(e.ok){const s=await e.json();return console.log(`🧹 ${s.deletedCount}件の古い画像を削除しました`),s.deletedCount}return 0}catch(e){return console.error("クリーンアップエラー:",e),0}}};Ae(Se,"instance");let er=Se;const tr=er.getInstance(),Ce=class Ce{constructor(){Ae(this,"cache",new Map)}static getInstance(){return Ce.instance||(Ce.instance=new Ce),Ce.instance}generateCacheKey(e,s,n){const o=btoa(e).replace(/[^a-zA-Z0-9]/g,"");return`${s}/${n}/${o}`}async getCachedImage(e,s,n){const o=this.generateCacheKey(e,s,n),a=this.cache.get(o);if(a){const i=new Date(a.cachedAt);if((new Date().getTime()-i.getTime())/(1e3*60*60*24)<30)return console.log(`📋 キャッシュされた画像を使用: ${e}`),a.url}return null}async cacheExternalImage(e,s,n,o){try{const a=await this.getCachedImage(e,s,n);if(a)return a;const i=await tr.uploadFromUrl(e,s,n),l=this.generateCacheKey(e,s,n),c={url:i.url,cachedAt:new Date().toISOString(),size:i.size,source:o};return this.cache.set(l,c),this.saveCacheToStorage(),console.log(`💾 外部画像をキャッシュ: ${e} → ${i.url}`),i.url}catch(a){throw console.error("外部画像キャッシュエラー:",a),a}}async getSpotifyImage(e,s,n,o){try{const a=await this.getCachedImage(e,s,n);return a||await this.cacheExternalImage(e,s,n,"spotify")}catch(a){if(console.warn("Spotify画像キャッシュエラー:",a),o&&o!==e)try{return await this.getSpotifyImage(o,s,n)}catch(i){console.error("フォールバック画像も失敗:",i)}return this.getDefaultImage(n)}}async getLastfmImage(e,s,n,o){try{const a=await this.getCachedImage(e,s,n);return a||await this.cacheExternalImage(e,s,n,"lastfm")}catch(a){if(console.warn("Last.fm画像キャッシュエラー:",a),o&&o!==e)try{return await this.getLastfmImage(o,s,n)}catch(i){console.error("フォールバック画像も失敗:",i)}return this.getDefaultImage(n)}}getDefaultImage(e){return e==="icon"?"/default-user-icon.png":"/default-album-cover.png"}saveCacheToStorage(){try{const e=Array.from(this.cache.entries());localStorage.setItem("external_image_cache",JSON.stringify(e))}catch(e){console.error("キャッシュ保存エラー:",e)}}loadCacheFromStorage(){try{const e=localStorage.getItem("external_image_cache");if(e){const s=JSON.parse(e);this.cache=new Map(s),console.log(`📋 キャッシュを復元: ${this.cache.size}件`)}}catch(e){console.error("キャッシュ復元エラー:",e)}}cleanupOldCache(){const e=new Date;let s=0;for(const[n,o]of this.cache.entries()){const a=new Date(o.cachedAt);(e.getTime()-a.getTime())/(1e3*60*60*24)>60&&(this.cache.delete(n),s++)}return s>0&&(this.saveCacheToStorage(),console.log(`🧹 古いキャッシュを${s}件削除しました`)),s}getCacheStats(){let e=0,s=0,n=0,o=0;for(const a of this.cache.values())switch(o+=a.size,a.source){case"spotify":e++;break;case"lastfm":s++;break;case"manual":n++;break}return{totalCached:this.cache.size,spotifyImages:e,lastfmImages:s,manualImages:n,totalSize:o}}};Ae(Ce,"instance");let rr=Ce;const Bs=rr.getInstance();typeof window<"u"&&Bs.loadCacheFromStorage();function xr({onSelect:t,placeholder:e="曲名やアーティスト名を検索...",className:s="",username:n=""}){const[o,a]=j.useState(""),[i,l]=j.useState([]),[c,d]=j.useState(!1),[u,g]=j.useState(!1),[p,b]=j.useState(0),[f,h]=j.useState(null),[m,y]=j.useState(!1),[v,N]=j.useState(0),x=j.useRef(null),C=j.useRef(null),I=j.useRef(),T=j.useCallback(async R=>{if(R.trim().length<2){l([]),g(!1);return}d(!0),h(null),y(!1);try{const k=await va(R);if(n&&k.length>0){const D=await Promise.all(k.map(async M=>{if(M.image&&M.image.startsWith("http"))try{const fe=await Bs.cacheExternalImage(M.image,n,"album","manual");return{...M,image:fe}}catch(fe){return console.warn("画像キャッシュエラー:",fe),M}return M}));l(D)}else l(k);g(!0),b(0)}catch(k){console.error("音楽検索エラー:",k),h(k instanceof Error?k.message:"検索中にエラーが発生しました"),l([]),g(!1)}finally{d(!1)}},[n]),E=j.useCallback(()=>{const R=Date.now();if(R-v<1e3){console.log("検索間隔が短すぎます");return}N(R),T(o.trim())},[o,v,T]);j.useEffect(()=>(I.current&&clearTimeout(I.current),o.trim().length>=2?I.current=setTimeout(()=>{T(o)},500):(l([]),g(!1)),()=>{I.current&&clearTimeout(I.current)}),[o,T]);const L=j.useCallback(R=>{if(!(!u||i.length===0))switch(R.key){case"ArrowDown":R.preventDefault(),b(k=>(k+1)%i.length);break;case"ArrowUp":R.preventDefault(),b(k=>(k-1+i.length)%i.length);break;case"Enter":R.preventDefault(),i[p]&&U(i[p]);break;case"Escape":g(!1);break}},[u,i,p]),U=j.useCallback(R=>{t(R),a(""),l([]),g(!1),b(0),h(null)},[t]);j.useEffect(()=>{const R=k=>{C.current&&!C.current.contains(k.target)&&g(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const q=()=>{y(!m)};return r.jsxs("div",{className:`relative ${s}`,children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{ref:x,type:"text",value:o,onChange:R=>a(R.target.value),onKeyDown:L,onFocus:()=>o.trim().length>=2&&i.length>0&&g(!0),className:"w-full px-4 py-3 pr-24 bg-white border border-blue-200 rounded-lg text-blue-900 placeholder-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e}),r.jsxs("div",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[r.jsx("button",{type:"button",onClick:E,disabled:c||o.trim().length<1,className:"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-md transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"手動検索を実行",children:c?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}):r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),f&&r.jsx("button",{type:"button",onClick:q,className:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors duration-200",title:"エラー詳細を表示",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})]})]}),f&&r.jsxs("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[r.jsx("p",{className:"text-sm text-red-600",children:f}),m&&r.jsxs("div",{className:"mt-2 p-2 bg-red-100 rounded text-xs text-red-700",children:[r.jsx("p",{children:"詳細情報:"}),r.jsx("p",{children:"• インターネット接続を確認してください"}),r.jsx("p",{children:"• 検索キーワードを変更してみてください"}),r.jsx("p",{children:"• しばらく時間をおいてから再試行してください"})]})]}),u&&i.length>0&&r.jsx("div",{ref:C,className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-64 overflow-y-auto",children:i.map((R,k)=>r.jsxs("div",{onClick:()=>U(R),className:`flex items-center p-3 cursor-pointer transition-colors duration-200 ${k===p?"bg-blue-500 text-white":"hover:bg-blue-50 text-blue-900"}`,children:[r.jsxs("div",{className:"flex-shrink-0 w-12 h-12 mr-3 relative",children:[r.jsx("img",{src:R.image||`https://picsum.photos/48/48?random=${k}`,alt:`${R.name} by ${R.artist}`,className:"w-full h-full object-cover rounded-lg",onError:D=>{const M=D.target;M.src=`https://picsum.photos/48/48?random=${k}`}}),R.isGeneratedImage&&r.jsx("div",{className:"absolute -top-1 -right-1 bg-orange-500 text-white text-xs px-1 py-0.5 rounded-full",children:"AI"}),R.provider&&r.jsx("div",{className:`absolute -bottom-1 -left-1 text-white text-xs px-1 py-0.5 rounded-full ${R.provider==="spotify"?"bg-green-500":"bg-red-500"}`,children:R.provider==="spotify"?"S":"L"}),n&&R.image&&R.image.includes("blob.vercel-storage.com")&&r.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-500 text-white text-xs px-1 py-0.5 rounded-full",children:"C"})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-medium truncate",children:R.name}),r.jsx("div",{className:"text-sm opacity-75 truncate",children:R.artist})]}),k===p&&r.jsx("div",{className:"flex-shrink-0 ml-2",children:r.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},`${R.name}-${R.artist}-${k}`))})]})}function Ms({onIconChange:t,currentIcon:e,className:s="",username:n=""}){const[o,a]=j.useState(null),[i,l]=j.useState({x:20,y:20,size:60}),[c,d]=j.useState(!1),[u,g]=j.useState(!1),[p,b]=j.useState(!1),[f,h]=j.useState(!1),[m,y]=j.useState(!1),[v,N]=j.useState({x:0,y:0}),[x,C]=j.useState({size:0,mouseX:0,mouseY:0}),[I,T]=j.useState(null),E=j.useRef(null),L=j.useRef(null),U=j.useRef(null),q=j.useRef(null);j.useEffect(()=>{const S=()=>{b(window.innerWidth<=768)};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]);const R=()=>{if(!L.current)return{width:0,height:0};const S=L.current.getBoundingClientRect();return{width:S.width,height:S.height}};j.useEffect(()=>{const S=_=>{_.key==="Escape"&&c&&P()};return c&&(document.addEventListener("keydown",S),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",S),document.body.style.overflow="unset"}},[c]);const k=S=>{var F;const _=(F=S.target.files)==null?void 0:F[0];if(!_)return;const O=5,z=O*1024*1024;if(_.size>z){alert(`ファイルサイズは${O}MB以下にしてください。現在のサイズ: ${(_.size/1024/1024).toFixed(1)}MB`),E.current&&(E.current.value="");return}if(!_.type.startsWith("image/")){alert("画像ファイルを選択してください"),E.current&&(E.current.value="");return}const B=new FileReader;B.onload=V=>{var Z;const X=(Z=V.target)==null?void 0:Z.result;a(X),d(!0),l({x:25,y:25,size:50}),T(null)},B.readAsDataURL(_)},D=S=>{if(!U.current||!L.current)return;U.current.getBoundingClientRect();const _=L.current.getBoundingClientRect(),O=(S.clientX-_.left)/_.width*100,z=(S.clientY-_.top)/_.height*100;O>=i.x&&O<=i.x+i.size&&z>=i.y&&z<=i.y+i.size&&(h(!0),N({x:O-i.x,y:z-i.y}))},M=S=>{if(!(!f&&!m)&&L.current){if(m){const _=S.clientY-x.mouseY,O=R(),z=Math.min(O.width,O.height),B=_/z*100;let F=x.size+B;F=Math.max(10,Math.min(100,F));const V=F/100*z,X=(O.width-V)/O.width*100,Z=(O.height-V)/O.height*100;l(G=>({size:F,x:Math.min(G.x,X),y:Math.min(G.y,Z)}))}else if(f){const _=L.current.getBoundingClientRect(),O=(S.clientX-_.left)/_.width*100,z=(S.clientY-_.top)/_.height*100,B=R(),F=Math.min(B.width,B.height),V=i.size/100*F,X=(B.width-V)/B.width*100,Z=(B.height-V)/B.height*100,G=Math.max(0,Math.min(X,O-v.x)),ie=Math.max(0,Math.min(Z,z-v.y));l(ne=>({...ne,x:G,y:ie}))}}},fe=()=>{h(!1),y(!1)},rt=S=>{if(!U.current||!L.current)return;const _=S.touches[0],O=L.current.getBoundingClientRect(),z=(_.clientX-O.left)/O.width*100,B=(_.clientY-O.top)/O.height*100;z>=i.x&&z<=i.x+i.size&&B>=i.y&&B<=i.y+i.size&&(h(!0),N({x:z-i.x,y:B-i.y}))},st=S=>{if(!f&&!m||!L.current)return;S.preventDefault();const _=S.touches[0];if(m){const O=_.clientY-x.mouseY,z=R(),B=Math.min(z.width,z.height),F=O/B*100;let V=x.size+F;V=Math.max(10,Math.min(100,V));const X=V/100*B,Z=(z.width-X)/z.width*100,G=(z.height-X)/z.height*100;l(ie=>({size:V,x:Math.min(ie.x,Z),y:Math.min(ie.y,G)}))}else if(f){const O=L.current.getBoundingClientRect(),z=(_.clientX-O.left)/O.width*100,B=(_.clientY-O.top)/O.height*100,F=R(),V=Math.min(F.width,F.height),X=i.size/100*V,Z=(F.width-X)/F.width*100,G=(F.height-X)/F.height*100,ie=Math.max(0,Math.min(Z,z-v.x)),ne=Math.max(0,Math.min(G,B-v.y));l(pe=>({...pe,x:ie,y:ne}))}},nt=()=>{h(!1),y(!1)},A=async()=>{if(L.current){g(!0),T(null);try{const S=document.createElement("canvas"),_=S.getContext("2d");if(!_)return;const O=L.current.naturalWidth/L.current.width,z=L.current.naturalHeight/L.current.height,B=Math.min(L.current.width,L.current.height),F=i.size/100*B,V=i.x/100*L.current.width,X=i.y/100*L.current.height,Z=256,G=Math.min(F*Math.min(O,z),Z);S.width=G,S.height=G,_.imageSmoothingEnabled=!0,_.imageSmoothingQuality="high",_.drawImage(L.current,V*O,X*z,F*O,F*z,0,0,G,G);const ie=await new Promise(ne=>{S.toBlob(pe=>{pe&&ne(pe)},"image/jpeg",.85)});if(n){const ne=new File([ie],"icon.jpg",{type:"image/jpeg"}),pe=await tr.uploadUserIcon(ne,n);t(pe.url),console.log("✅ アイコンをストレージにアップロードしました:",pe.url)}else{const ne=S.toDataURL("image/jpeg",.85);t(ne),console.log("⚠️ ユーザー名が設定されていないため、ローカル保存を使用")}a(null),d(!1)}catch(S){console.error("トリミングエラー:",S),T("画像のアップロードに失敗しました。もう一度お試しください。")}finally{g(!1)}}},P=()=>{a(null),d(!1),E.current&&(E.current.value="")},K=S=>{S.target===S.currentTarget&&P()},se=async()=>{if(e&&n)try{await tr.deleteImage(e),console.log("🗑️ アイコンをストレージから削除しました")}catch(S){console.warn("アイコン削除エラー（無視）:",S)}t(""),E.current&&(E.current.value="")},ee=S=>{S.preventDefault(),S.stopPropagation(),y(!0),C({size:i.size,mouseX:S.clientX,mouseY:S.clientY})},Ve=S=>{S.preventDefault(),S.stopPropagation();const _=S.touches[0];y(!0),C({size:i.size,mouseX:_.clientX,mouseY:_.clientY})},ge=S=>{S.key==="Enter"&&(S.preventDefault(),S.stopPropagation(),A())},Ne=()=>!c||!o?null:Qr.createPortal(r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[99999] p-4",onClick:K,style:{position:"fixed",top:0,left:0,right:0,bottom:0},children:r.jsxs("div",{className:`bg-white rounded-xl shadow-2xl p-4 select-none ${p?"w-full h-full max-w-none max-h-none rounded-none":"max-w-2xl w-full max-h-[90vh] overflow-y-auto"}`,onClick:S=>S.stopPropagation(),onKeyDown:ge,tabIndex:0,style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"アイコンをトリミング"}),r.jsx("button",{type:"button",onClick:P,className:"text-gray-400 hover:text-gray-600 transition-colors p-2",disabled:u,children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),I&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600",children:I})}),!1,r.jsx("div",{className:"mb-6",children:r.jsxs("div",{ref:U,className:`relative inline-block ${m?"cursor-se-resize":f?"cursor-grabbing":"cursor-move"} select-none`,style:{maxWidth:"100%",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},onMouseDown:D,onMouseMove:M,onMouseUp:fe,onMouseLeave:fe,onTouchStart:rt,onTouchMove:st,onTouchEnd:nt,children:[r.jsx("img",{ref:L,src:o,alt:"トリミング対象",className:"max-w-full max-h-full object-contain rounded-lg select-none",style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",WebkitTouchCallout:"none",WebkitUserDrag:"none"},draggable:!1}),(()=>{var Nr,Sr;const S=R(),_=Math.min(S.width,S.height);if(S.width===0||S.height===0)return null;const O=(Nr=L.current)==null?void 0:Nr.getBoundingClientRect(),z=(Sr=U.current)==null?void 0:Sr.getBoundingClientRect();console.log("=== デバッグ情報 ==="),console.log("画像サイズ:",S),console.log("画像要素の位置:",O),console.log("コンテナの位置:",z);const B=i.size/100*_,F=i.x/100*S.width,V=i.y/100*S.height,X=(F+B/2)/S.width*100,Z=(V+B/2)/S.height*100,G=B/2,ie=G/S.width*100,ne=G/S.height*100,pe=Math.max(ie,ne);console.log("トリミング枠:",{cropLeft:F,cropTop:V,squareSize:B,radiusPx:G}),console.log("マスク中心座標:",{centerX:X,centerY:Z}),console.log("半径計算:",{radiusPercentX:ie,radiusPercentY:ne,radiusPercent:pe,画像サイズ:S});const Mt=`radial-gradient(ellipse ${ie}% ${ne}% at ${X}% ${Z}%, transparent 97%, black 100%)`;return console.log("マスクスタイル:",Mt),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`absolute inset-0 bg-black bg-opacity-50 pointer-events-none ${f||m?"":"transition-all duration-150"}`,style:{zIndex:5,WebkitMask:Mt,mask:Mt,backgroundColor:"rgba(0, 0, 0, 0.7)"}}),r.jsxs("div",{className:"absolute inset-0 pointer-events-none",style:{zIndex:4},children:[r.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{top:0,left:0,right:0,height:`${V}px`}}),r.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{bottom:0,left:0,right:0,height:`${S.height-V-B}px`}}),r.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{top:`${V}px`,left:0,width:`${F}px`,height:`${B}px`}}),r.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{top:`${V}px`,right:0,width:`${S.width-F-B}px`,height:`${B}px`}})]}),r.jsx("div",{className:`absolute border-2 border-dashed border-white pointer-events-none ${f||m?"":"transition-all duration-150"}`,style:{left:`${F}px`,top:`${V}px`,width:`${B}px`,height:`${B}px`,zIndex:8,opacity:.8}}),r.jsxs("div",{ref:q,className:`absolute border-2 border-white ${f||m?"border-blue-400":""} transition-colors duration-150`,style:{left:`${F}px`,top:`${V}px`,width:`${B}px`,height:`${B}px`,cursor:m?"se-resize":f?"grabbing":"move",transition:f||m?"none":"all 0.15s ease",zIndex:10,pointerEvents:"auto",backgroundColor:"transparent"},title:`正方形サイズ: ${Math.round(B)}px × ${Math.round(B)}px`,children:[r.jsxs("div",{className:"relative w-full h-full",children:[r.jsx("div",{className:`absolute ${p?"border-l-2":"border-l"} border-white opacity-50`,style:{left:"33.333%",top:0,height:"100%"}}),r.jsx("div",{className:`absolute ${p?"border-l-2":"border-l"} border-white opacity-50`,style:{left:"66.666%",top:0,height:"100%"}}),r.jsx("div",{className:`absolute ${p?"border-t-2":"border-t"} border-white opacity-50`,style:{top:"33.333%",left:0,width:"100%"}}),r.jsx("div",{className:`absolute ${p?"border-t-2":"border-t"} border-white opacity-50`,style:{top:"66.666%",left:0,width:"100%"}})]}),r.jsx("div",{className:`absolute -top-1 -left-1 ${p?"w-4 h-4":"w-3 h-3"} bg-white border border-gray-400`,style:{zIndex:15}}),r.jsx("div",{className:`absolute -top-1 -right-1 ${p?"w-4 h-4":"w-3 h-3"} bg-white border border-gray-400`,style:{zIndex:15}}),r.jsx("div",{className:`absolute -bottom-1 -left-1 ${p?"w-4 h-4":"w-3 h-3"} bg-white border border-gray-400`,style:{zIndex:15}}),r.jsx("div",{className:`absolute -bottom-2 -right-2 ${p?"w-6 h-6":"w-5 h-5"} bg-blue-500 border-2 border-white rounded cursor-se-resize hover:bg-blue-600 transition-colors shadow-lg`,style:{zIndex:16},onMouseDown:ee,onTouchStart:Ve,title:"ドラッグしてサイズを変更"}),r.jsx("div",{className:"absolute inset-0 border-2 border-blue-400 rounded-full pointer-events-none opacity-75",style:{zIndex:12}})]})]})})()]})}),r.jsxs("div",{className:"flex justify-end space-x-3 relative z-20",children:[r.jsx("button",{type:"button",onClick:P,className:"px-6 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",disabled:u,children:"キャンセル"}),r.jsx("button",{type:"button",onClick:A,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 font-medium",disabled:u,children:u?"アップロード中...":"適用"})]})]})}),document.body);return r.jsxs("div",{className:`space-y-4 ${s}`,children:[e&&!c&&r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:e,alt:"ユーザーアイコン",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-200"}),r.jsx("button",{type:"button",onClick:se,className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-sm hover:bg-red-600 transition-colors",children:"×"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"アイコンが設定されています"}),r.jsx("button",{type:"button",onClick:()=>{var S;return(S=E.current)==null?void 0:S.click()},className:"text-sm text-blue-500 hover:text-blue-600",children:"変更する"})]})]}),!e&&!c&&r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors",children:[r.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:k,className:"hidden"}),r.jsxs("button",{type:"button",onClick:()=>{var S;return(S=E.current)==null?void 0:S.click()},className:"flex flex-col items-center space-y-2 text-gray-600 hover:text-blue-500",children:[r.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),r.jsx("span",{className:"text-sm",children:"アイコンをアップロード"}),r.jsx("span",{className:"text-xs text-gray-400",children:"JPG, PNG (5MB以下)"})]})]}),r.jsx(Ne,{})]})}function Oa({message:t,type:e="success",duration:s=3e3,onClose:n}){const[o,a]=j.useState(!1);j.useEffect(()=>{a(!0);const c=setTimeout(()=>{a(!1),setTimeout(n,300)},s);return()=>clearTimeout(c)},[s,n]);const i=()=>{switch(e){case"success":return"bg-green-500 text-white";case"error":return"bg-red-500 text-white";case"info":return"bg-blue-500 text-white";default:return"bg-green-500 text-white"}},l=()=>{switch(e){case"success":return"✅";case"error":return"❌";case"info":return"ℹ️";default:return"✅"}};return r.jsx("div",{className:`fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transition-all duration-300 transform ${o?"translate-x-0 opacity-100":"translate-x-full opacity-0"} ${i()}`,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-lg",children:l()}),r.jsx("span",{className:"font-medium",children:t}),r.jsx("button",{onClick:()=>{a(!1),setTimeout(n,300)},className:"ml-3 text-white/80 hover:text-white transition-colors",children:"×"})]})})}function Ua(){const t=be(),[e,s]=j.useState(""),[n,o]=j.useState(null),[a,i]=j.useState(!0),[l,c]=j.useState(!1),[d,u]=j.useState(null),[g,p]=j.useState(!1);j.useEffect(()=>{b()},[]);const b=async()=>{const x=localStorage.getItem("musicard_user");if(!x){t("/login");return}s(x),await f(x)},f=async x=>{try{let C=await Pe.loadUser(x);C||(C={username:x,displayName:x,bio:"",baseColor:Le[0],themeColor:Be[0],socialLinks:{},favoriteGenres:[],songs:[],gridLayout:te[1],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),viewCount:0,isPublic:!0},await Pe.saveUser(C),console.log(`🆕 新規ユーザー「${x}」のプロフィールを作成しました`)),o(C)}catch(C){console.error("ユーザーデータの読み込みエラー:",C)}finally{i(!1)}},h=async()=>{if(n){c(!0);try{await Pe.saveUser({...n,updatedAt:new Date().toISOString()})?(console.log("✅ プロフィールを保存しました"),u({message:"プロフィールを保存しました！",type:"success"})):u({message:"保存に失敗しました",type:"error"})}catch(x){console.error("保存エラー:",x),u({message:"保存中にエラーが発生しました",type:"error"})}finally{c(!1)}}},m=()=>{confirm("ログアウトしますか？")&&(localStorage.removeItem("musicard_user"),localStorage.removeItem("musicard_login_time"),t("/login"))},y=()=>{e&&t(`/users/${e}`,{state:{isPreview:!0}})},v=x=>{if(!n)return;const C={id:x.id||`${x.name}-${x.artist}`.replace(/\s+/g,"-").toLowerCase(),title:x.name,artist:x.artist,jacket:x.image,previewUrl:null,addedAt:new Date().toISOString()};o({...n,songs:[...n.songs,C]}),p(!1)},N=x=>{n&&o({...n,songs:n.songs.filter(C=>C.id!==x)})};return a?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})}):n?r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:[r.jsxs("div",{className:"container mx-auto px-4 py-8",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[n.displayName,"の音楽名刺"]}),r.jsxs("p",{className:"text-gray-600",children:["@",e]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:y,className:"bg-white text-blue-600 px-4 py-2 rounded-lg border border-blue-200 hover:bg-blue-50 transition-colors font-medium",children:"👁️ プレビュー"}),r.jsx("button",{onClick:h,disabled:l,className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-6 py-2 rounded-lg font-medium hover:from-blue-600 hover:to-cyan-600 transition-all disabled:opacity-50",children:l?"保存中...":"💾 保存"}),r.jsx("button",{onClick:m,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors",children:"ログアウト"})]})]}),!1,r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"基本情報"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロフィールアイコン"}),r.jsx(Ms,{currentIcon:n.icon||"",onIconChange:x=>o({...n,icon:x}),username:e})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"表示名"}),r.jsx("input",{type:"text",value:n.displayName,onChange:x=>o({...n,displayName:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"自己紹介"}),r.jsx("textarea",{value:n.bio,onChange:x=>o({...n,bio:x.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"音楽の趣味について..."})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"ベースカラー"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"音楽名刺の基本となる背景色を選択してください。"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:Le.map(x=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"radio",name:"baseColor",checked:n.baseColor.id===x.id,onChange:()=>o({...n,baseColor:x}),className:"sr-only"}),r.jsxs("div",{className:`relative p-4 rounded-xl border-2 transition-all ${n.baseColor.id===x.id?"border-blue-500 ring-2 ring-blue-500/20 shadow-lg scale-105":"border-gray-200 hover:border-gray-300 hover:scale-102"}`,children:[r.jsx("div",{className:`w-full h-8 rounded-lg ${x.background} mb-2 shadow-sm`}),r.jsx("p",{className:"text-center text-sm font-medium text-gray-800",children:x.name}),n.baseColor.id===x.id&&r.jsx("div",{className:"absolute top-2 right-2",children:r.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]})]},x.id))})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"テーマカラー"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"アイコンの枠線やボタンの色に反映されるテーマカラーを選択してください。"}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:Be.map(x=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"radio",name:"themeColor",checked:n.themeColor.id===x.id,onChange:()=>o({...n,themeColor:x}),className:"sr-only"}),r.jsxs("div",{className:`relative p-3 rounded-xl border-2 transition-all ${n.themeColor.id===x.id?"border-gray-400 ring-2 ring-blue-500/20 shadow-lg scale-105":"border-gray-200 hover:border-gray-300 hover:scale-102"}`,children:[r.jsx("div",{className:`w-full h-8 rounded-lg bg-gradient-to-r ${x.gradient} mb-2 shadow-sm`}),r.jsx("p",{className:"text-center text-sm font-medium text-gray-800",children:x.name}),n.themeColor.id===x.id&&r.jsx("div",{className:"absolute top-2 right-2",children:r.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]})]},x.id))})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"グリッドレイアウト"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"音楽名刺のグリッドレイアウトを選択してください"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:te.map(x=>{var C;return r.jsxs("button",{onClick:()=>o({...n,gridLayout:x}),className:`p-4 rounded-lg border-2 transition-all text-left ${((C=n.gridLayout)==null?void 0:C.id)===x.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:[r.jsx("div",{className:"font-medium text-sm mb-1",children:x.name}),r.jsxs("div",{className:"text-xs text-gray-500",children:[x.centerPositions.length===1?"中央1マス":"中央4マス","のアイコン配置"]}),r.jsx("div",{className:"mt-2 grid gap-0.5 w-12 h-12",style:{gridTemplateColumns:`repeat(${x.size}, 1fr)`,gridTemplateRows:`repeat(${x.size}, 1fr)`},children:Array.from({length:x.totalCells}).map((I,T)=>{const E=x.centerPositions.includes(T);return E&&x.centerPositions.length===4&&T!==x.centerPositions[0]?null:r.jsx("div",{className:`rounded-sm ${E?"bg-blue-400":"bg-gray-300"}`,style:E&&x.centerPositions.length===4?{gridColumn:`${x.centerPositions[0]%x.size+1} / span 2`,gridRow:`${Math.floor(x.centerPositions[0]/x.size)+1} / span 2`}:{}},T)})})]},x.id)})})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 flex flex-col h-full max-h-[calc(100vh-12rem)]",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["楽曲リスト (",n.songs.length,")"]}),r.jsxs("button",{onClick:()=>p(!0),className:"bg-blue-500 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors flex items-center gap-1",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"曲を追加"]})]}),n.songs.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500 flex-1 flex items-center justify-center flex-col",children:[r.jsx("div",{className:"text-4xl mb-4",children:"🎵"}),r.jsx("p",{children:"まだ楽曲が追加されていません"}),r.jsx("p",{className:"text-sm",children:"右上の「曲を追加」ボタンから楽曲を追加してみましょう"})]}):r.jsx("div",{className:"flex-1 min-h-0",children:r.jsx("div",{className:"h-full overflow-y-auto pr-2 space-y-3",children:n.songs.map(x=>r.jsxs("div",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[r.jsx("img",{src:x.jacket||"/default-cover.jpg",alt:x.title,className:"w-12 h-12 rounded object-cover"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-medium text-gray-900 truncate",children:x.title}),r.jsx("div",{className:"text-sm text-gray-500 truncate",children:x.artist})]}),r.jsx("button",{onClick:()=>{const C=x.id||`${x.title}-${x.artist}`.replace(/\s+/g,"-").toLowerCase();N(C)},className:"text-red-500 hover:text-red-700 p-1",title:"削除",children:"🗑️"})]},x.id))})})]})]}),g&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"楽曲を追加"}),r.jsx("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx(xr,{onSelect:v,placeholder:"楽曲名やアーティスト名で検索...",username:e})]})}),r.jsxs("div",{className:"mt-8 bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"共有"}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("p",{className:"text-blue-700 mb-3",children:"あなたの音楽名刺URL:"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"text",value:`${window.location.origin}/users/${e}`,readOnly:!0,className:"flex-1 px-3 py-2 bg-white border border-gray-300 rounded text-sm"}),r.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/users/${e}`)},className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors",children:"📋 コピー"})]})]})]})]}),d&&r.jsx(Oa,{message:d.message,type:d.type,onClose:()=>u(null)})]}):r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-red-600",children:"プロフィールの読み込みに失敗しました"}),r.jsx("button",{onClick:()=>t("/login"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:"ログインページに戻る"})]})})}function Da({title:t,artist:e,videoId:s,coverImage:n,onError:o}){const[a,i]=j.useState(!1),[l,c]=j.useState(!1),[d,u]=j.useState(0),[g]=j.useState(30),[p,b]=j.useState(1),[f,h]=j.useState(0),[m,y]=j.useState(!1),v=j.useRef(null),N=j.useRef(null),x=j.useRef(null),C=async()=>{try{y(!0);const k=Math.floor(Math.random()*30)+45;h(k),console.log(`🎵 サビ予測時間: ${k}秒`)}catch(k){console.error("サビ検出エラー:",k),h(0)}finally{y(!1)}},I=()=>{b(0);let k=0;x.current=setInterval(()=>{k+=.05,k>=1&&(k=1,clearInterval(x.current)),b(k)},50)},T=k=>{let D=p;x.current=setInterval(()=>{D-=.05,D<=0&&(D=0,clearInterval(x.current),k==null||k()),b(D)},50)},E=()=>{if(!s){o==null||o("YouTube動画IDが取得できませんでした");return}try{c(!1),i(!0),u(0),I(),N.current=setInterval(()=>{u(k=>{const D=k+1;return D>=g?(L(),g):D})},1e3),console.log(`▶️ YouTube試聴開始: ${t} - ${e}`),console.log(`🎥 Video ID: ${s}, Start: ${f}s`)}catch(k){console.error("YouTube再生エラー:",k),c(!0),i(!1),o==null||o("YouTube動画の再生に失敗しました")}},L=()=>{T(()=>{i(!1),u(0),N.current&&(clearInterval(N.current),N.current=null),x.current&&(clearInterval(x.current),x.current=null)}),console.log(`⏹️ YouTube試聴停止: ${t} - ${e}`)},U=()=>`https://www.youtube.com/embed/${s}?autoplay=1&start=${f}&end=${f+g}&controls=1&modestbranding=1&rel=0&showinfo=0&enablejsapi=1&origin=${window.location.origin}`,q=d/g*100,R=k=>{const D=Math.floor(k/60),M=k%60;return`${D}:${M.toString().padStart(2,"0")}`};return j.useEffect(()=>()=>{N.current&&clearInterval(N.current),x.current&&clearInterval(x.current)},[]),s?r.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden max-w-sm mx-auto",children:[r.jsx("div",{className:"relative aspect-video bg-black",children:a?r.jsxs("div",{className:"relative w-full h-full",children:[r.jsx("iframe",{ref:v,width:"100%",height:"100%",src:U(),title:`${t} by ${e}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"absolute inset-0",style:{opacity:p}}),r.jsx("button",{onClick:L,className:"absolute top-2 left-2 bg-black/70 text-white p-2 rounded-full hover:bg-black/90 transition-colors",children:r.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})})}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 p-2",children:r.jsxs("div",{className:"flex items-center gap-2 text-white text-xs",children:[r.jsx("span",{children:R(d)}),r.jsx("div",{className:"flex-1 bg-gray-600 rounded-full h-1 overflow-hidden",children:r.jsx("div",{className:"h-full bg-red-500 transition-all duration-1000 ease-linear",style:{width:`${q}%`}})}),r.jsx("span",{children:R(g)})]})})]}):r.jsxs("div",{className:"relative w-full h-full",children:[r.jsx("img",{src:n,alt:`${t} by ${e}`,className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:r.jsx("button",{onClick:E,disabled:l,className:`
                  w-16 h-16 rounded-full flex items-center justify-center transition-all duration-200
                  ${l?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700 hover:scale-110 shadow-lg"}
                `,children:l?r.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}):r.jsx("svg",{className:"w-8 h-8 text-white ml-1",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M8 5v14l11-7z"})})})}),r.jsx("div",{className:"absolute top-2 right-2 bg-black/70 rounded px-2 py-1",children:r.jsx("svg",{className:"w-6 h-4 text-red-500",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})})})]})}),r.jsxs("div",{className:"p-4",children:[r.jsx("h3",{className:"font-semibold text-gray-900 truncate mb-1",children:t}),r.jsx("p",{className:"text-sm text-gray-600 truncate mb-3",children:e}),r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsxs("button",{onClick:C,disabled:m,className:"flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-xs disabled:opacity-50",children:[m?r.jsx("div",{className:"w-3 h-3 border border-blue-500 border-t-transparent rounded-full animate-spin"}):r.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"サビ検出"]}),r.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[r.jsx("span",{children:"開始:"}),r.jsx("span",{className:"font-mono",children:R(f)})]})]}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),"30秒プレビュー"]}),a&&r.jsxs("span",{className:"text-red-500 font-medium flex items-center gap-1",children:[r.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),"再生中"]})]})]}),l&&r.jsx("div",{className:"px-4 pb-4",children:r.jsx("div",{className:"text-xs text-red-500 text-center bg-red-50 p-2 rounded",children:"YouTube動画の再生に失敗しました"})})]}):r.jsx("div",{className:"flex items-center justify-center p-4 bg-gray-100 rounded-lg",children:r.jsxs("div",{className:"text-center",children:[r.jsx("svg",{className:"w-8 h-8 text-gray-400 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),r.jsx("p",{className:"text-xs text-gray-500",children:"YouTube動画なし"})]})})}var et={},za=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},Os={},ae={};let br;const Fa=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];ae.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};ae.getSymbolTotalCodewords=function(e){return Fa[e]};ae.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e};ae.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');br=e};ae.isKanjiModeEnabled=function(){return typeof br<"u"};ae.toSJIS=function(e){return br(e)};var It={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+s)}}t.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},t.from=function(n,o){if(t.isValid(n))return n;try{return e(n)}catch{return o}}})(It);function Us(){this.buffer=[],this.length=0}Us.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let s=0;s<e;s++)this.putBit((t>>>e-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var Ha=Us;function tt(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}tt.prototype.set=function(t,e,s,n){const o=t*this.size+e;this.data[o]=s,n&&(this.reservedBit[o]=!0)};tt.prototype.get=function(t,e){return this.data[t*this.size+e]};tt.prototype.xor=function(t,e,s){this.data[t*this.size+e]^=s};tt.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var Va=tt,Ds={};(function(t){const e=ae.getSymbolSize;t.getRowColCoords=function(n){if(n===1)return[];const o=Math.floor(n/7)+2,a=e(n),i=a===145?26:Math.ceil((a-13)/(2*o-2))*2,l=[a-7];for(let c=1;c<o-1;c++)l[c]=l[c-1]-i;return l.push(6),l.reverse()},t.getPositions=function(n){const o=[],a=t.getRowColCoords(n),i=a.length;for(let l=0;l<i;l++)for(let c=0;c<i;c++)l===0&&c===0||l===0&&c===i-1||l===i-1&&c===0||o.push([a[l],a[c]]);return o}})(Ds);var zs={};const Ja=ae.getSymbolSize,qr=7;zs.getPositions=function(e){const s=Ja(e);return[[0,0],[s-qr,0],[0,s-qr]]};var Fs={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},t.from=function(o){return t.isValid(o)?parseInt(o,10):void 0},t.getPenaltyN1=function(o){const a=o.size;let i=0,l=0,c=0,d=null,u=null;for(let g=0;g<a;g++){l=c=0,d=u=null;for(let p=0;p<a;p++){let b=o.get(g,p);b===d?l++:(l>=5&&(i+=e.N1+(l-5)),d=b,l=1),b=o.get(p,g),b===u?c++:(c>=5&&(i+=e.N1+(c-5)),u=b,c=1)}l>=5&&(i+=e.N1+(l-5)),c>=5&&(i+=e.N1+(c-5))}return i},t.getPenaltyN2=function(o){const a=o.size;let i=0;for(let l=0;l<a-1;l++)for(let c=0;c<a-1;c++){const d=o.get(l,c)+o.get(l,c+1)+o.get(l+1,c)+o.get(l+1,c+1);(d===4||d===0)&&i++}return i*e.N2},t.getPenaltyN3=function(o){const a=o.size;let i=0,l=0,c=0;for(let d=0;d<a;d++){l=c=0;for(let u=0;u<a;u++)l=l<<1&2047|o.get(d,u),u>=10&&(l===1488||l===93)&&i++,c=c<<1&2047|o.get(u,d),u>=10&&(c===1488||c===93)&&i++}return i*e.N3},t.getPenaltyN4=function(o){let a=0;const i=o.data.length;for(let c=0;c<i;c++)a+=o.data[c];return Math.abs(Math.ceil(a*100/i/5)-10)*e.N4};function s(n,o,a){switch(n){case t.Patterns.PATTERN000:return(o+a)%2===0;case t.Patterns.PATTERN001:return o%2===0;case t.Patterns.PATTERN010:return a%3===0;case t.Patterns.PATTERN011:return(o+a)%3===0;case t.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(a/3))%2===0;case t.Patterns.PATTERN101:return o*a%2+o*a%3===0;case t.Patterns.PATTERN110:return(o*a%2+o*a%3)%2===0;case t.Patterns.PATTERN111:return(o*a%3+(o+a)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}t.applyMask=function(o,a){const i=a.size;for(let l=0;l<i;l++)for(let c=0;c<i;c++)a.isReserved(c,l)||a.xor(c,l,s(o,c,l))},t.getBestMask=function(o,a){const i=Object.keys(t.Patterns).length;let l=0,c=1/0;for(let d=0;d<i;d++){a(d),t.applyMask(d,o);const u=t.getPenaltyN1(o)+t.getPenaltyN2(o)+t.getPenaltyN3(o)+t.getPenaltyN4(o);t.applyMask(d,o),u<c&&(c=u,l=d)}return l}})(Fs);var Tt={};const we=It,ot=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],at=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Tt.getBlocksCount=function(e,s){switch(s){case we.L:return ot[(e-1)*4+0];case we.M:return ot[(e-1)*4+1];case we.Q:return ot[(e-1)*4+2];case we.H:return ot[(e-1)*4+3];default:return}};Tt.getTotalCodewordsCount=function(e,s){switch(s){case we.L:return at[(e-1)*4+0];case we.M:return at[(e-1)*4+1];case we.Q:return at[(e-1)*4+2];case we.H:return at[(e-1)*4+3];default:return}};var Hs={},At={};const We=new Uint8Array(512),xt=new Uint8Array(256);(function(){let e=1;for(let s=0;s<255;s++)We[s]=e,xt[e]=s,e<<=1,e&256&&(e^=285);for(let s=255;s<512;s++)We[s]=We[s-255]})();At.log=function(e){if(e<1)throw new Error("log("+e+")");return xt[e]};At.exp=function(e){return We[e]};At.mul=function(e,s){return e===0||s===0?0:We[xt[e]+xt[s]]};(function(t){const e=At;t.mul=function(n,o){const a=new Uint8Array(n.length+o.length-1);for(let i=0;i<n.length;i++)for(let l=0;l<o.length;l++)a[i+l]^=e.mul(n[i],o[l]);return a},t.mod=function(n,o){let a=new Uint8Array(n);for(;a.length-o.length>=0;){const i=a[0];for(let c=0;c<o.length;c++)a[c]^=e.mul(o[c],i);let l=0;for(;l<a.length&&a[l]===0;)l++;a=a.slice(l)}return a},t.generateECPolynomial=function(n){let o=new Uint8Array([1]);for(let a=0;a<n;a++)o=t.mul(o,new Uint8Array([1,e.exp(a)]));return o}})(Hs);const Vs=Hs;function yr(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}yr.prototype.initialize=function(e){this.degree=e,this.genPoly=Vs.generateECPolynomial(this.degree)};yr.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(e.length+this.degree);s.set(e);const n=Vs.mod(s,this.genPoly),o=this.degree-n.length;if(o>0){const a=new Uint8Array(this.degree);return a.set(n,o),a}return n};var Wa=yr,Js={},je={},wr={};wr.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var me={};const Ws="[0-9]+",qa="[A-Z $%*+\\-./:]+";let Ke="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Ke=Ke.replace(/u/g,"\\u");const Ka="(?:(?![A-Z0-9 $%*+\\-./:]|"+Ke+`)(?:.|[\r
]))+`;me.KANJI=new RegExp(Ke,"g");me.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");me.BYTE=new RegExp(Ka,"g");me.NUMERIC=new RegExp(Ws,"g");me.ALPHANUMERIC=new RegExp(qa,"g");const Ya=new RegExp("^"+Ke+"$"),Ga=new RegExp("^"+Ws+"$"),Xa=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");me.testKanji=function(e){return Ya.test(e)};me.testNumeric=function(e){return Ga.test(e)};me.testAlphanumeric=function(e){return Xa.test(e)};(function(t){const e=wr,s=me;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(a,i){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!e.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?a.ccBits[0]:i<27?a.ccBits[1]:a.ccBits[2]},t.getBestModeForData=function(a){return s.testNumeric(a)?t.NUMERIC:s.testAlphanumeric(a)?t.ALPHANUMERIC:s.testKanji(a)?t.KANJI:t.BYTE},t.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},t.isValid=function(a){return a&&a.bit&&a.ccBits};function n(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+o)}}t.from=function(a,i){if(t.isValid(a))return a;try{return n(a)}catch{return i}}})(je);(function(t){const e=ae,s=Tt,n=It,o=je,a=wr,i=7973,l=e.getBCHDigit(i);function c(p,b,f){for(let h=1;h<=40;h++)if(b<=t.getCapacity(h,f,p))return h}function d(p,b){return o.getCharCountIndicator(p,b)+4}function u(p,b){let f=0;return p.forEach(function(h){const m=d(h.mode,b);f+=m+h.getBitsLength()}),f}function g(p,b){for(let f=1;f<=40;f++)if(u(p,f)<=t.getCapacity(f,b,o.MIXED))return f}t.from=function(b,f){return a.isValid(b)?parseInt(b,10):f},t.getCapacity=function(b,f,h){if(!a.isValid(b))throw new Error("Invalid QR Code version");typeof h>"u"&&(h=o.BYTE);const m=e.getSymbolTotalCodewords(b),y=s.getTotalCodewordsCount(b,f),v=(m-y)*8;if(h===o.MIXED)return v;const N=v-d(h,b);switch(h){case o.NUMERIC:return Math.floor(N/10*3);case o.ALPHANUMERIC:return Math.floor(N/11*2);case o.KANJI:return Math.floor(N/13);case o.BYTE:default:return Math.floor(N/8)}},t.getBestVersionForData=function(b,f){let h;const m=n.from(f,n.M);if(Array.isArray(b)){if(b.length>1)return g(b,m);if(b.length===0)return 1;h=b[0]}else h=b;return c(h.mode,h.getLength(),m)},t.getEncodedBits=function(b){if(!a.isValid(b)||b<7)throw new Error("Invalid QR Code version");let f=b<<12;for(;e.getBCHDigit(f)-l>=0;)f^=i<<e.getBCHDigit(f)-l;return b<<12|f}})(Js);var qs={};const sr=ae,Ks=1335,Qa=21522,Kr=sr.getBCHDigit(Ks);qs.getEncodedBits=function(e,s){const n=e.bit<<3|s;let o=n<<10;for(;sr.getBCHDigit(o)-Kr>=0;)o^=Ks<<sr.getBCHDigit(o)-Kr;return(n<<10|o)^Qa};var Ys={};const Za=je;function Me(t){this.mode=Za.NUMERIC,this.data=t.toString()}Me.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};Me.prototype.getLength=function(){return this.data.length};Me.prototype.getBitsLength=function(){return Me.getBitsLength(this.data.length)};Me.prototype.write=function(e){let s,n,o;for(s=0;s+3<=this.data.length;s+=3)n=this.data.substr(s,3),o=parseInt(n,10),e.put(o,10);const a=this.data.length-s;a>0&&(n=this.data.substr(s),o=parseInt(n,10),e.put(o,a*3+1))};var ei=Me;const ti=je,Ft=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Oe(t){this.mode=ti.ALPHANUMERIC,this.data=t}Oe.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};Oe.prototype.getLength=function(){return this.data.length};Oe.prototype.getBitsLength=function(){return Oe.getBitsLength(this.data.length)};Oe.prototype.write=function(e){let s;for(s=0;s+2<=this.data.length;s+=2){let n=Ft.indexOf(this.data[s])*45;n+=Ft.indexOf(this.data[s+1]),e.put(n,11)}this.data.length%2&&e.put(Ft.indexOf(this.data[s]),6)};var ri=Oe;const si=je;function Ue(t){this.mode=si.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}Ue.getBitsLength=function(e){return e*8};Ue.prototype.getLength=function(){return this.data.length};Ue.prototype.getBitsLength=function(){return Ue.getBitsLength(this.data.length)};Ue.prototype.write=function(t){for(let e=0,s=this.data.length;e<s;e++)t.put(this.data[e],8)};var ni=Ue;const oi=je,ai=ae;function De(t){this.mode=oi.KANJI,this.data=t}De.getBitsLength=function(e){return e*13};De.prototype.getLength=function(){return this.data.length};De.prototype.getBitsLength=function(){return De.getBitsLength(this.data.length)};De.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let s=ai.toSJIS(this.data[e]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),t.put(s,13)}};var ii=De,Gs={exports:{}};(function(t){var e={single_source_shortest_paths:function(s,n,o){var a={},i={};i[n]=0;var l=e.PriorityQueue.make();l.push(n,0);for(var c,d,u,g,p,b,f,h,m;!l.empty();){c=l.pop(),d=c.value,g=c.cost,p=s[d]||{};for(u in p)p.hasOwnProperty(u)&&(b=p[u],f=g+b,h=i[u],m=typeof i[u]>"u",(m||h>f)&&(i[u]=f,l.push(u,f),a[u]=d))}if(typeof o<"u"&&typeof i[o]>"u"){var y=["Could not find a path from ",n," to ",o,"."].join("");throw new Error(y)}return a},extract_shortest_path_from_predecessor_list:function(s,n){for(var o=[],a=n;a;)o.push(a),s[a],a=s[a];return o.reverse(),o},find_path:function(s,n,o){var a=e.single_source_shortest_paths(s,n,o);return e.extract_shortest_path_from_predecessor_list(a,o)},PriorityQueue:{make:function(s){var n=e.PriorityQueue,o={},a;s=s||{};for(a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);return o.queue=[],o.sorter=s.sorter||n.default_sorter,o},default_sorter:function(s,n){return s.cost-n.cost},push:function(s,n){var o={value:s,cost:n};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(Gs);var li=Gs.exports;(function(t){const e=je,s=ei,n=ri,o=ni,a=ii,i=me,l=ae,c=li;function d(y){return unescape(encodeURIComponent(y)).length}function u(y,v,N){const x=[];let C;for(;(C=y.exec(N))!==null;)x.push({data:C[0],index:C.index,mode:v,length:C[0].length});return x}function g(y){const v=u(i.NUMERIC,e.NUMERIC,y),N=u(i.ALPHANUMERIC,e.ALPHANUMERIC,y);let x,C;return l.isKanjiModeEnabled()?(x=u(i.BYTE,e.BYTE,y),C=u(i.KANJI,e.KANJI,y)):(x=u(i.BYTE_KANJI,e.BYTE,y),C=[]),v.concat(N,x,C).sort(function(T,E){return T.index-E.index}).map(function(T){return{data:T.data,mode:T.mode,length:T.length}})}function p(y,v){switch(v){case e.NUMERIC:return s.getBitsLength(y);case e.ALPHANUMERIC:return n.getBitsLength(y);case e.KANJI:return a.getBitsLength(y);case e.BYTE:return o.getBitsLength(y)}}function b(y){return y.reduce(function(v,N){const x=v.length-1>=0?v[v.length-1]:null;return x&&x.mode===N.mode?(v[v.length-1].data+=N.data,v):(v.push(N),v)},[])}function f(y){const v=[];for(let N=0;N<y.length;N++){const x=y[N];switch(x.mode){case e.NUMERIC:v.push([x,{data:x.data,mode:e.ALPHANUMERIC,length:x.length},{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.ALPHANUMERIC:v.push([x,{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.KANJI:v.push([x,{data:x.data,mode:e.BYTE,length:d(x.data)}]);break;case e.BYTE:v.push([{data:x.data,mode:e.BYTE,length:d(x.data)}])}}return v}function h(y,v){const N={},x={start:{}};let C=["start"];for(let I=0;I<y.length;I++){const T=y[I],E=[];for(let L=0;L<T.length;L++){const U=T[L],q=""+I+L;E.push(q),N[q]={node:U,lastCount:0},x[q]={};for(let R=0;R<C.length;R++){const k=C[R];N[k]&&N[k].node.mode===U.mode?(x[k][q]=p(N[k].lastCount+U.length,U.mode)-p(N[k].lastCount,U.mode),N[k].lastCount+=U.length):(N[k]&&(N[k].lastCount=U.length),x[k][q]=p(U.length,U.mode)+4+e.getCharCountIndicator(U.mode,v))}}C=E}for(let I=0;I<C.length;I++)x[C[I]].end=0;return{map:x,table:N}}function m(y,v){let N;const x=e.getBestModeForData(y);if(N=e.from(v,x),N!==e.BYTE&&N.bit<x.bit)throw new Error('"'+y+'" cannot be encoded with mode '+e.toString(N)+`.
 Suggested mode is: `+e.toString(x));switch(N===e.KANJI&&!l.isKanjiModeEnabled()&&(N=e.BYTE),N){case e.NUMERIC:return new s(y);case e.ALPHANUMERIC:return new n(y);case e.KANJI:return new a(y);case e.BYTE:return new o(y)}}t.fromArray=function(v){return v.reduce(function(N,x){return typeof x=="string"?N.push(m(x,null)):x.data&&N.push(m(x.data,x.mode)),N},[])},t.fromString=function(v,N){const x=g(v,l.isKanjiModeEnabled()),C=f(x),I=h(C,N),T=c.find_path(I.map,"start","end"),E=[];for(let L=1;L<T.length-1;L++)E.push(I.table[T[L]].node);return t.fromArray(b(E))},t.rawSplit=function(v){return t.fromArray(g(v,l.isKanjiModeEnabled()))}})(Ys);const $t=ae,Ht=It,ci=Ha,di=Va,ui=Ds,hi=zs,nr=Fs,or=Tt,mi=Wa,bt=Js,fi=qs,gi=je,Vt=Ys;function pi(t,e){const s=t.size,n=hi.getPositions(e);for(let o=0;o<n.length;o++){const a=n[o][0],i=n[o][1];for(let l=-1;l<=7;l++)if(!(a+l<=-1||s<=a+l))for(let c=-1;c<=7;c++)i+c<=-1||s<=i+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?t.set(a+l,i+c,!0,!0):t.set(a+l,i+c,!1,!0))}}function xi(t){const e=t.size;for(let s=8;s<e-8;s++){const n=s%2===0;t.set(s,6,n,!0),t.set(6,s,n,!0)}}function bi(t,e){const s=ui.getPositions(e);for(let n=0;n<s.length;n++){const o=s[n][0],a=s[n][1];for(let i=-2;i<=2;i++)for(let l=-2;l<=2;l++)i===-2||i===2||l===-2||l===2||i===0&&l===0?t.set(o+i,a+l,!0,!0):t.set(o+i,a+l,!1,!0)}}function yi(t,e){const s=t.size,n=bt.getEncodedBits(e);let o,a,i;for(let l=0;l<18;l++)o=Math.floor(l/3),a=l%3+s-8-3,i=(n>>l&1)===1,t.set(o,a,i,!0),t.set(a,o,i,!0)}function Jt(t,e,s){const n=t.size,o=fi.getEncodedBits(e,s);let a,i;for(a=0;a<15;a++)i=(o>>a&1)===1,a<6?t.set(a,8,i,!0):a<8?t.set(a+1,8,i,!0):t.set(n-15+a,8,i,!0),a<8?t.set(8,n-a-1,i,!0):a<9?t.set(8,15-a-1+1,i,!0):t.set(8,15-a-1,i,!0);t.set(n-8,8,1,!0)}function wi(t,e){const s=t.size;let n=-1,o=s-1,a=7,i=0;for(let l=s-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!t.isReserved(o,l-c)){let d=!1;i<e.length&&(d=(e[i]>>>a&1)===1),t.set(o,l-c,d),a--,a===-1&&(i++,a=7)}if(o+=n,o<0||s<=o){o-=n,n=-n;break}}}function vi(t,e,s){const n=new ci;s.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),gi.getCharCountIndicator(c.mode,t)),c.write(n)});const o=$t.getSymbolTotalCodewords(t),a=or.getTotalCodewordsCount(t,e),i=(o-a)*8;for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const l=(i-n.getLengthInBits())/8;for(let c=0;c<l;c++)n.put(c%2?17:236,8);return ji(n,t,e)}function ji(t,e,s){const n=$t.getSymbolTotalCodewords(e),o=or.getTotalCodewordsCount(e,s),a=n-o,i=or.getBlocksCount(e,s),l=n%i,c=i-l,d=Math.floor(n/i),u=Math.floor(a/i),g=u+1,p=d-u,b=new mi(p);let f=0;const h=new Array(i),m=new Array(i);let y=0;const v=new Uint8Array(t.buffer);for(let T=0;T<i;T++){const E=T<c?u:g;h[T]=v.slice(f,f+E),m[T]=b.encode(h[T]),f+=E,y=Math.max(y,E)}const N=new Uint8Array(n);let x=0,C,I;for(C=0;C<y;C++)for(I=0;I<i;I++)C<h[I].length&&(N[x++]=h[I][C]);for(C=0;C<p;C++)for(I=0;I<i;I++)N[x++]=m[I][C];return N}function Ni(t,e,s,n){let o;if(Array.isArray(t))o=Vt.fromArray(t);else if(typeof t=="string"){let d=e;if(!d){const u=Vt.rawSplit(t);d=bt.getBestVersionForData(u,s)}o=Vt.fromString(t,d||40)}else throw new Error("Invalid data");const a=bt.getBestVersionForData(o,s);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=a;else if(e<a)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+a+`.
`);const i=vi(e,s,o),l=$t.getSymbolSize(e),c=new di(l);return pi(c,e),xi(c),bi(c,e),Jt(c,s,0),e>=7&&yi(c,e),wi(c,i),isNaN(n)&&(n=nr.getBestMask(c,Jt.bind(null,c,s))),nr.applyMask(n,c),Jt(c,s,n),{modules:c,version:e,errorCorrectionLevel:s,maskPattern:n,segments:o}}Os.create=function(e,s){if(typeof e>"u"||e==="")throw new Error("No input text");let n=Ht.M,o,a;return typeof s<"u"&&(n=Ht.from(s.errorCorrectionLevel,Ht.M),o=bt.from(s.version),a=nr.from(s.maskPattern),s.toSJISFunc&&$t.setToSJISFunction(s.toSJISFunc)),Ni(e,o,n,a)};var Xs={},vr={};(function(t){function e(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let n=s.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+s);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(a){return[a,a]}))),n.length===6&&n.push("F","F");const o=parseInt(n.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+n.slice(0,6).join("")}}t.getOptions=function(n){n||(n={}),n.color||(n.color={});const o=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,a=n.width&&n.width>=21?n.width:void 0,i=n.scale||4;return{width:a,scale:a?4:i,margin:o,color:{dark:e(n.color.dark||"#000000ff"),light:e(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},t.getScale=function(n,o){return o.width&&o.width>=n+o.margin*2?o.width/(n+o.margin*2):o.scale},t.getImageWidth=function(n,o){const a=t.getScale(n,o);return Math.floor((n+o.margin*2)*a)},t.qrToImageData=function(n,o,a){const i=o.modules.size,l=o.modules.data,c=t.getScale(i,a),d=Math.floor((i+a.margin*2)*c),u=a.margin*c,g=[a.color.light,a.color.dark];for(let p=0;p<d;p++)for(let b=0;b<d;b++){let f=(p*d+b)*4,h=a.color.light;if(p>=u&&b>=u&&p<d-u&&b<d-u){const m=Math.floor((p-u)/c),y=Math.floor((b-u)/c);h=g[l[m*i+y]?1:0]}n[f++]=h.r,n[f++]=h.g,n[f++]=h.b,n[f]=h.a}}})(vr);(function(t){const e=vr;function s(o,a,i){o.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=i,a.width=i,a.style.height=i+"px",a.style.width=i+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(a,i,l){let c=l,d=i;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),i||(d=n()),c=e.getOptions(c);const u=e.getImageWidth(a.modules.size,c),g=d.getContext("2d"),p=g.createImageData(u,u);return e.qrToImageData(p.data,a,c),s(g,d,u),g.putImageData(p,0,0),d},t.renderToDataURL=function(a,i,l){let c=l;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),c||(c={});const d=t.render(a,i,c),u=c.type||"image/png",g=c.rendererOpts||{};return d.toDataURL(u,g.quality)}})(Xs);var Qs={};const Si=vr;function Yr(t,e){const s=t.a/255,n=e+'="'+t.hex+'"';return s<1?n+" "+e+'-opacity="'+s.toFixed(2).slice(1)+'"':n}function Wt(t,e,s){let n=t+e;return typeof s<"u"&&(n+=" "+s),n}function Ci(t,e,s){let n="",o=0,a=!1,i=0;for(let l=0;l<t.length;l++){const c=Math.floor(l%e),d=Math.floor(l/e);!c&&!a&&(a=!0),t[l]?(i++,l>0&&c>0&&t[l-1]||(n+=a?Wt("M",c+s,.5+d+s):Wt("m",o,0),o=0,a=!1),c+1<e&&t[l+1]||(n+=Wt("h",i),i=0)):o++}return n}Qs.render=function(e,s,n){const o=Si.getOptions(s),a=e.modules.size,i=e.modules.data,l=a+o.margin*2,c=o.color.light.a?"<path "+Yr(o.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",d="<path "+Yr(o.color.dark,"stroke")+' d="'+Ci(i,a,o.margin)+'"/>',u='viewBox="0 0 '+l+" "+l+'"',p='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+u+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof n=="function"&&n(null,p),p};const ki=za,ar=Os,Zs=Xs,Ei=Qs;function jr(t,e,s,n,o){const a=[].slice.call(arguments,1),i=a.length,l=typeof a[i-1]=="function";if(!l&&!ki())throw new Error("Callback required as last argument");if(l){if(i<2)throw new Error("Too few arguments provided");i===2?(o=s,s=e,e=n=void 0):i===3&&(e.getContext&&typeof o>"u"?(o=n,n=void 0):(o=n,n=s,s=e,e=void 0))}else{if(i<1)throw new Error("Too few arguments provided");return i===1?(s=e,e=n=void 0):i===2&&!e.getContext&&(n=s,s=e,e=void 0),new Promise(function(c,d){try{const u=ar.create(s,n);c(t(u,e,n))}catch(u){d(u)}})}try{const c=ar.create(s,n);o(null,t(c,e,n))}catch(c){o(c)}}et.create=ar.create;et.toCanvas=jr.bind(null,Zs.render);et.toDataURL=jr.bind(null,Zs.renderToDataURL);et.toString=jr.bind(null,function(t,e,s){return Ei.render(t,s)});var en={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function s(){for(var a="",i=0;i<arguments.length;i++){var l=arguments[i];l&&(a=o(a,n(l)))}return a}function n(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return s.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var i="";for(var l in a)e.call(a,l)&&a[l]&&(i=o(i,l));return i}function o(a,i){return i?a?a+" "+i:a+i:a}t.exports?(s.default=s,t.exports=s):window.classNames=s})()})(en);var Ri=en.exports;const tn=Zr(Ri);var ir={exports:{}},lr={exports:{}},Ye=1e3,Ge=Ye*60,Xe=Ge*60,Qe=Xe*24,Li=Qe*365.25,Ii=function(t,e){e=e||{};var s=typeof t;if(s==="string"&&t.length>0)return Ti(t);if(s==="number"&&isNaN(t)===!1)return e.long?$i(t):Ai(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Ti(t){if(t=String(t),!(t.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var s=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return s*Li;case"days":case"day":case"d":return s*Qe;case"hours":case"hour":case"hrs":case"hr":case"h":return s*Xe;case"minutes":case"minute":case"mins":case"min":case"m":return s*Ge;case"seconds":case"second":case"secs":case"sec":case"s":return s*Ye;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function Ai(t){return t>=Qe?Math.round(t/Qe)+"d":t>=Xe?Math.round(t/Xe)+"h":t>=Ge?Math.round(t/Ge)+"m":t>=Ye?Math.round(t/Ye)+"s":t+"ms"}function $i(t){return it(t,Qe,"day")||it(t,Xe,"hour")||it(t,Ge,"minute")||it(t,Ye,"second")||t+" ms"}function it(t,e,s){if(!(t<e))return t<e*1.5?Math.floor(t/e)+" "+s:Math.ceil(t/e)+" "+s+"s"}(function(t,e){e=t.exports=o.debug=o.default=o,e.coerce=c,e.disable=i,e.enable=a,e.enabled=l,e.humanize=Ii,e.names=[],e.skips=[],e.formatters={};var s;function n(d){var u=0,g;for(g in d)u=(u<<5)-u+d.charCodeAt(g),u|=0;return e.colors[Math.abs(u)%e.colors.length]}function o(d){function u(){if(u.enabled){var g=u,p=+new Date,b=p-(s||p);g.diff=b,g.prev=s,g.curr=p,s=p;for(var f=new Array(arguments.length),h=0;h<f.length;h++)f[h]=arguments[h];f[0]=e.coerce(f[0]),typeof f[0]!="string"&&f.unshift("%O");var m=0;f[0]=f[0].replace(/%([a-zA-Z%])/g,function(v,N){if(v==="%%")return v;m++;var x=e.formatters[N];if(typeof x=="function"){var C=f[m];v=x.call(g,C),f.splice(m,1),m--}return v}),e.formatArgs.call(g,f);var y=u.log||e.log||console.log.bind(console);y.apply(g,f)}}return u.namespace=d,u.enabled=e.enabled(d),u.useColors=e.useColors(),u.color=n(d),typeof e.init=="function"&&e.init(u),u}function a(d){e.save(d),e.names=[],e.skips=[];for(var u=(typeof d=="string"?d:"").split(/[\s,]+/),g=u.length,p=0;p<g;p++)u[p]&&(d=u[p].replace(/\*/g,".*?"),d[0]==="-"?e.skips.push(new RegExp("^"+d.substr(1)+"$")):e.names.push(new RegExp("^"+d+"$")))}function i(){e.enable("")}function l(d){var u,g;for(u=0,g=e.skips.length;u<g;u++)if(e.skips[u].test(d))return!1;for(u=0,g=e.names.length;u<g;u++)if(e.names[u].test(d))return!0;return!1}function c(d){return d instanceof Error?d.stack||d.message:d}})(lr,lr.exports);var _i=lr.exports;(function(t,e){e=t.exports=_i,e.log=o,e.formatArgs=n,e.save=a,e.load=i,e.useColors=s,e.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:l(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function s(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}e.formatters.j=function(c){try{return JSON.stringify(c)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}};function n(c){var d=this.useColors;if(c[0]=(d?"%c":"")+this.namespace+(d?" %c":" ")+c[0]+(d?"%c ":" ")+"+"+e.humanize(this.diff),!!d){var u="color: "+this.color;c.splice(1,0,u,"color: inherit");var g=0,p=0;c[0].replace(/%[a-zA-Z%]/g,function(b){b!=="%%"&&(g++,b==="%c"&&(p=g))}),c.splice(p,0,u)}}function o(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(c){try{c==null?e.storage.removeItem("debug"):e.storage.debug=c}catch{}}function i(){var c;try{c=e.storage.debug}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}e.enable(i());function l(){try{return window.localStorage}catch{}}})(ir,ir.exports);var Pi=ir.exports,Gr=Pi("jsonp"),Bi=Ui,Mi=0;function Oi(){}function Ui(t,e,s){typeof e=="function"&&(s=e,e={}),e||(e={});var n=e.prefix||"__jp",o=e.name||n+Mi++,a=e.param||"callback",i=e.timeout!=null?e.timeout:6e4,l=encodeURIComponent,c=document.getElementsByTagName("script")[0]||document.head,d,u;i&&(u=setTimeout(function(){g(),s&&s(new Error("Timeout"))},i));function g(){d.parentNode&&d.parentNode.removeChild(d),window[o]=Oi,u&&clearTimeout(u)}function p(){window[o]&&g()}return window[o]=function(b){Gr("jsonp got",b),g(),s&&s(null,b)},t+=(~t.indexOf("?")?"&":"?")+a+"="+l(o),t=t.replace("?&","?"),Gr('jsonp req "%s"',t),d=document.createElement("script"),d.src=t,c.parentNode.insertBefore(d,c),p}const Ie=Zr(Bi);var Di=Object.defineProperty,zi=Object.defineProperties,Fi=Object.getOwnPropertyDescriptors,yt=Object.getOwnPropertySymbols,rn=Object.prototype.hasOwnProperty,sn=Object.prototype.propertyIsEnumerable,Xr=(t,e,s)=>e in t?Di(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,oe=(t,e)=>{for(var s in e||(e={}))rn.call(e,s)&&Xr(t,s,e[s]);if(yt)for(var s of yt(e))sn.call(e,s)&&Xr(t,s,e[s]);return t},_t=(t,e)=>zi(t,Fi(e)),Pt=(t,e)=>{var s={};for(var n in t)rn.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&yt)for(var n of yt(t))e.indexOf(n)<0&&sn.call(t,n)&&(s[n]=t[n]);return s};function Bt(t){return s=>{var n=s,{bgStyle:o={},borderRadius:a=0,iconFillColor:i="white",round:l=!1,size:c=64}=n,d=Pt(n,["bgStyle","borderRadius","iconFillColor","round","size"]);return r.jsxs("svg",_t(oe({viewBox:"0 0 64 64",width:c,height:c},d),{children:[l?r.jsx("circle",{cx:"32",cy:"32",r:"32",fill:t.color,style:o}):r.jsx("rect",{width:"64",height:"64",rx:a,ry:a,fill:t.color,style:o}),r.jsx("path",{d:t.path,fill:i})]}))}}class Hi extends Error{constructor(e){super(e),this.name="AssertionError"}}function J(t,e){if(!t)throw new Hi(e)}function H(t){const e=Object.entries(t).filter(([,s])=>s!=null).map(([s,n])=>`${encodeURIComponent(s)}=${encodeURIComponent(String(n))}`);return e.length>0?`?${e.join("&")}`:""}const Vi=t=>!!t&&(typeof t=="object"||typeof t=="function")&&"then"in t&&typeof t.then=="function",Ji=(t,e)=>({left:window.outerWidth/2+(window.screenX||window.screenLeft||0)-t/2,top:window.outerHeight/2+(window.screenY||window.screenTop||0)-e/2}),Wi=(t,e)=>({top:(window.screen.height-e)/2,left:(window.screen.width-t)/2});function qi(t,e,s){var n=e,{height:o,width:a}=n,i=Pt(n,["height","width"]);const l=oe({height:o,width:a,location:"no",toolbar:"no",status:"no",directories:"no",menubar:"no",scrollbars:"yes",resizable:"no",centerscreen:"yes",chrome:"yes"},i),c=window.open(t,"",Object.keys(l).map(d=>`${d}=${l[d]}`).join(", "));if(s){const d=window.setInterval(()=>{try{(c===null||c.closed)&&(window.clearInterval(d),s(c))}catch(u){console.error(u)}},1e3)}return c}function Ki(t){var e=t,{beforeOnClick:s,children:n,className:o,disabled:a,disabledStyle:i={opacity:.6},forwardedRef:l,htmlTitle:c,networkLink:d,networkName:u,onClick:g,onShareWindowClose:p,openShareDialogOnClick:b=!0,opts:f,resetButtonStyle:h=!0,style:m,title:y,url:v,windowHeight:N=400,windowPosition:x="windowCenter",windowWidth:C=550}=e,I=Pt(e,["beforeOnClick","children","className","disabled","disabledStyle","forwardedRef","htmlTitle","networkLink","networkName","onClick","onShareWindowClose","openShareDialogOnClick","opts","resetButtonStyle","style","title","url","windowHeight","windowPosition","windowWidth"]);const T=async U=>{const q=d(v,f);if(!a){if(U.preventDefault(),s){const R=s();Vi(R)&&await R}if(b){const R=oe({height:N,width:C},x==="windowCenter"?Ji(C,N):Wi(C,N));qi(q,R,p)}g&&g(U,q)}},E=tn("react-share__ShareButton",{"react-share__ShareButton--disabled":!!a,disabled:!!a},o),L=oe(oe(h?{backgroundColor:"transparent",border:"none",padding:0,font:"inherit",color:"inherit",cursor:"pointer"}:{},m),a&&i);return r.jsx("button",_t(oe({},I),{className:E,onClick:T,ref:l,style:L,title:c,children:n}))}function W(t,e,s,n){const o=(a,i)=>{const l=s(a),c=oe({},a);return Object.keys(l).forEach(u=>{delete c[u]}),r.jsx(Ki,_t(oe(oe({},n),c),{forwardedRef:i,networkName:t,networkLink:e,opts:l}))};return o.displayName=`ShareButton-${t}`,j.forwardRef(o)}function Yi(t,{title:e,separator:s}){return J(t,"bluesky.url"),"https://bsky.app/intent/compose"+H({text:e?e+s+t:t})}W("bluesky",Yi,t=>({title:t.title,separator:t.separator||" "}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function Gi(t,{subject:e,body:s,separator:n}){return"mailto:"+H({subject:e,body:s?s+n+t:t})}W("email",Gi,t=>({subject:t.subject,body:t.body,separator:t.separator||" "}),{openShareDialogOnClick:!1,onClick:(t,e)=>{window.location.href=e}});const Xi=Bt({color:"#0965FE",path:"M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z"});function Qi(t,{appId:e,redirectUri:s,to:n}){return"https://www.facebook.com/dialog/send"+H({link:t,redirect_uri:s||t,app_id:e,to:n})}W("facebookmessenger",Qi,t=>({appId:t.appId,redirectUri:t.redirectUri,to:t.to}),{windowWidth:1e3,windowHeight:820});function Zi(t,{hashtag:e}){return J(t,"facebook.url"),"https://www.facebook.com/sharer/sharer.php"+H({u:t,hashtag:e})}const el=W("facebook",Zi,t=>({hashtag:t.hashtag}),{windowWidth:550,windowHeight:400});function tl(){const t=j.useRef(!1);return j.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),j.useCallback(()=>t.current,[])}function rl(t){var e=t,{children:s=p=>p,className:n,getCount:o,url:a}=e,i=Pt(e,["children","className","getCount","url"]);const l=tl(),[c,d]=j.useState(void 0),[u,g]=j.useState(!1);return j.useEffect(()=>{g(!0),o(a,p=>{l()&&(d(p),g(!1))})},[a]),r.jsx("span",_t(oe({className:tn("react-share__ShareCount",n)},i),{children:!u&&c!==void 0&&s(c)}))}function Te(t){const e=s=>r.jsx(rl,oe({getCount:t},s));return e.displayName=`ShareCount(${t.name})`,e}function sl(t,e){const s=`https://graph.facebook.com/?id=${t}&fields=og_object{engagement}`;Ie(s,(n,o)=>{e(!n&&o&&o.og_object&&o.og_object.engagement?o.og_object.engagement.count:void 0)})}Te(sl);function nl(t,{title:e}){return J(t,"hatena.url"),`http://b.hatena.ne.jp/add?mode=confirm&url=${t}&title=${e}`}W("hatena",nl,t=>({title:t.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function ol(t,e){Ie("https://bookmark.hatenaapis.com/count/entry"+H({url:t}),(n,o)=>{e(o??void 0)})}Te(ol);function al(t,{title:e,description:s}){return J(t,"instapaper.url"),"http://www.instapaper.com/hello2"+H({url:t,title:e,description:s})}W("instapaper",al,t=>({title:t.title,description:t.description}),{windowWidth:500,windowHeight:500,windowPosition:"windowCenter"});const il=Bt({color:"#00b800",path:"M52.62 30.138c0 3.693-1.432 7.019-4.42 10.296h.001c-4.326 4.979-14 11.044-16.201 11.972-2.2.927-1.876-.591-1.786-1.112l.294-1.765c.069-.527.142-1.343-.066-1.865-.232-.574-1.146-.872-1.817-1.016-9.909-1.31-17.245-8.238-17.245-16.51 0-9.226 9.251-16.733 20.62-16.733 11.37 0 20.62 7.507 20.62 16.733zM27.81 25.68h-1.446a.402.402 0 0 0-.402.401v8.985c0 .221.18.4.402.4h1.446a.401.401 0 0 0 .402-.4v-8.985a.402.402 0 0 0-.402-.401zm9.956 0H36.32a.402.402 0 0 0-.402.401v5.338L31.8 25.858a.39.39 0 0 0-.031-.04l-.002-.003-.024-.025-.008-.007a.313.313 0 0 0-.032-.026.255.255 0 0 1-.021-.014l-.012-.007-.021-.012-.013-.006-.023-.01-.013-.005-.024-.008-.014-.003-.023-.005-.017-.002-.021-.003-.021-.002h-1.46a.402.402 0 0 0-.402.401v8.985c0 .221.18.4.402.4h1.446a.401.401 0 0 0 .402-.4v-5.337l4.123 5.568c.028.04.063.072.101.099l.004.003a.236.236 0 0 0 .025.015l.012.006.019.01a.154.154 0 0 1 .019.008l.012.004.028.01.005.001a.442.442 0 0 0 .104.013h1.446a.4.4 0 0 0 .401-.4v-8.985a.402.402 0 0 0-.401-.401zm-13.442 7.537h-3.93v-7.136a.401.401 0 0 0-.401-.401h-1.447a.4.4 0 0 0-.401.401v8.984a.392.392 0 0 0 .123.29c.072.068.17.111.278.111h5.778a.4.4 0 0 0 .401-.401v-1.447a.401.401 0 0 0-.401-.401zm21.429-5.287c.222 0 .401-.18.401-.402v-1.446a.401.401 0 0 0-.401-.402h-5.778a.398.398 0 0 0-.279.113l-.005.004-.006.008a.397.397 0 0 0-.111.276v8.984c0 .108.043.206.112.278l.005.006a.401.401 0 0 0 .284.117h5.778a.4.4 0 0 0 .401-.401v-1.447a.401.401 0 0 0-.401-.401h-3.93v-1.519h3.93c.222 0 .401-.18.401-.402V29.85a.401.401 0 0 0-.401-.402h-3.93V27.93h3.93z"});function ll(t,{title:e}){return J(t,"line.url"),"https://social-plugins.line.me/lineit/share"+H({url:t,text:e})}const cl=W("line",ll,t=>({title:t.title}),{windowWidth:500,windowHeight:500});function dl(t,{title:e,summary:s,source:n}){return J(t,"linkedin.url"),"https://linkedin.com/shareArticle"+H({url:t,mini:"true",title:e,summary:s,source:n})}W("linkedin",dl,({title:t,summary:e,source:s})=>({title:t,summary:e,source:s}),{windowWidth:750,windowHeight:600});function ul(t,{title:e,description:s}){return J(t,"livejournal.url"),"https://www.livejournal.com/update.bml"+H({subject:e,event:s})}W("livejournal",ul,t=>({title:t.title,description:t.description}),{windowWidth:660,windowHeight:460});function hl(t,{title:e,description:s,imageUrl:n}){return J(t,"mailru.url"),"https://connect.mail.ru/share"+H({url:t,title:e,description:s,image_url:n})}W("mailru",hl,t=>({title:t.title,description:t.description,imageUrl:t.imageUrl}),{windowWidth:660,windowHeight:460});function ml(t,{title:e,description:s,image:n}){return J(t,"ok.url"),"https://connect.ok.ru/offer"+H({url:t,title:e,description:s,imageUrl:n})}W("ok",ml,t=>({title:t.title,description:t.description,image:t.image}),{windowWidth:588,windowHeight:480,windowPosition:"screenCenter"});function fl(t,e){window.OK||(window.OK={Share:{count:function(a,i){var l,c;(c=(l=window.OK.callbacks)[a])==null||c.call(l,i)}},callbacks:[]});const s="https://connect.ok.ru/dk",n=window.OK.callbacks.length;return window.ODKL={updateCount(o,a){var i,l;const c=o===""?0:parseInt(o.replace("react-share-",""),10);(l=(i=window.OK.callbacks)[c])==null||l.call(i,a===""?void 0:parseInt(a,10))}},window.OK.callbacks.push(e),Ie(s+H({"st.cmd":"extLike",uid:`react-share-${n}`,ref:t}))}Te(fl);function gl(t,{media:e,description:s,pinId:n}){return n?`https://pinterest.com/pin/${n}/repin/x/`:(J(t,"pinterest.url"),J(e,"pinterest.media"),"https://pinterest.com/pin/create/button/"+H({url:t,media:e,description:s}))}W("pinterest",gl,t=>({media:t.media,description:t.description,pinId:t.pinId}),{windowWidth:1e3,windowHeight:730});function pl(t,e){Ie("https://api.pinterest.com/v1/urls/count.json"+H({url:t}),(n,o)=>{e(o?o.count:void 0)})}Te(pl);function xl(t,{title:e}){return J(t,"pocket.url"),"https://getpocket.com/save"+H({url:t,title:e})}W("pocket",xl,t=>({title:t.title}),{windowWidth:500,windowHeight:500});function bl(t,{title:e}){return J(t,"reddit.url"),"https://www.reddit.com/web/submit"+H({url:t,title:e})}W("reddit",bl,t=>({title:t.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function yl(t,{title:e}){return J(t,"gab.url"),"https://gab.com/compose"+H({url:t,text:e})}W("gab",yl,t=>({title:t.title}),{windowWidth:660,windowHeight:640,windowPosition:"windowCenter"});function wl(t,e){const s=`https://www.reddit.com/api/info.json?limit=1&url=${t}`;Ie(s,{param:"jsonp"},(n,o)=>{e(!n&&o&&o.data&&o.data.children.length>0&&o.data.children[0].data.score?o.data.children[0].data.score:void 0)})}Te(wl);function vl(t,{title:e}){return J(t,"telegram.url"),"https://telegram.me/share/url"+H({url:t,text:e})}W("telegram",vl,t=>({title:t.title}),{windowWidth:550,windowHeight:400});function jl(t,{title:e}){return J(t,"threads.url"),"https://threads.net/intent/post"+H({url:t,text:e})}W("threads",jl,t=>({title:t.title}),{windowWidth:550,windowHeight:600});function Nl(t,{title:e,caption:s,tags:n,posttype:o}){return J(t,"tumblr.url"),"https://www.tumblr.com/widgets/share/tool"+H({canonicalUrl:t,title:e,caption:s,tags:n,posttype:o})}W("tumblr",Nl,t=>({title:t.title,tags:(t.tags||[]).join(","),caption:t.caption,posttype:t.posttype||"link"}),{windowWidth:660,windowHeight:460});function Sl(t,e){return Ie("https://api.tumblr.com/v2/share/stats"+H({url:t}),(n,o)=>{e(!n&&o&&o.response?o.response.note_count:void 0)})}Te(Sl);const Cl=Bt({color:"#00aced",path:"M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"});function kl(t,{title:e,via:s,hashtags:n=[],related:o=[]}){return J(t,"twitter.url"),J(Array.isArray(n),"twitter.hashtags is not an array"),J(Array.isArray(o),"twitter.related is not an array"),"https://twitter.com/intent/tweet"+H({url:t,text:e,via:s,hashtags:n.length>0?n.join(","):void 0,related:o.length>0?o.join(","):void 0})}const El=W("twitter",kl,t=>({hashtags:t.hashtags,title:t.title,via:t.via,related:t.related}),{windowWidth:550,windowHeight:400});function Rl(t,{title:e,separator:s}){return J(t,"viber.url"),"viber://forward"+H({text:e?e+s+t:t})}W("viber",Rl,t=>({title:t.title,separator:t.separator||" "}),{windowWidth:660,windowHeight:460});function Ll(t,{title:e,image:s,noParse:n,noVkLinks:o}){return J(t,"vk.url"),"https://vk.com/share.php"+H({url:t,title:e,image:s,noparse:n?1:0,no_vk_links:o?1:0})}W("vk",Ll,t=>({title:t.title,image:t.image,noParse:t.noParse,noVkLinks:t.noVkLinks}),{windowWidth:660,windowHeight:460});function Il(t,e){window.VK||(window.VK={}),window.VK.Share={count:(o,a)=>{var i,l;return(l=(i=window.VK.callbacks)==null?void 0:i[o])==null?void 0:l.call(i,a)}},window.VK.callbacks=[];const s="https://vk.com/share.php",n=window.VK.callbacks.length;return window.VK.callbacks.push(e),Ie(s+H({act:"count",index:n,url:t}))}Te(Il);function Tl(t,{title:e,image:s}){return J(t,"weibo.url"),"http://service.weibo.com/share/share.php"+H({url:t,title:e,pic:s})}W("weibo",Tl,t=>({title:t.title,image:t.image}),{windowWidth:660,windowHeight:550,windowPosition:"screenCenter"});const Al=Bt({color:"#25D366",path:"m42.32286,33.93287c-0.5178,-0.2589 -3.04726,-1.49644 -3.52105,-1.66732c-0.4712,-0.17346 -0.81554,-0.2589 -1.15987,0.2589c-0.34175,0.51004 -1.33075,1.66474 -1.63108,2.00648c-0.30032,0.33658 -0.60064,0.36247 -1.11327,0.12945c-0.5178,-0.2589 -2.17994,-0.80259 -4.14759,-2.56312c-1.53269,-1.37217 -2.56312,-3.05503 -2.86603,-3.57283c-0.30033,-0.5178 -0.03366,-0.80259 0.22524,-1.06149c0.23301,-0.23301 0.5178,-0.59547 0.7767,-0.90616c0.25372,-0.31068 0.33657,-0.5178 0.51262,-0.85437c0.17088,-0.36246 0.08544,-0.64725 -0.04402,-0.90615c-0.12945,-0.2589 -1.15987,-2.79613 -1.58964,-3.80584c-0.41424,-1.00971 -0.84142,-0.88027 -1.15987,-0.88027c-0.29773,-0.02588 -0.64208,-0.02588 -0.98382,-0.02588c-0.34693,0 -0.90616,0.12945 -1.37736,0.62136c-0.4712,0.5178 -1.80194,1.76053 -1.80194,4.27186c0,2.51134 1.84596,4.945 2.10227,5.30747c0.2589,0.33657 3.63497,5.51458 8.80262,7.74113c1.23237,0.5178 2.1903,0.82848 2.94111,1.08738c1.23237,0.38836 2.35599,0.33657 3.24402,0.20712c0.99159,-0.15534 3.04985,-1.24272 3.47963,-2.45956c0.44013,-1.21683 0.44013,-2.22654 0.31068,-2.45955c-0.12945,-0.23301 -0.46601,-0.36247 -0.98382,-0.59548m-9.40068,12.84407l-0.02589,0c-3.05503,0 -6.08417,-0.82849 -8.72495,-2.38189l-0.62136,-0.37023l-6.47252,1.68286l1.73463,-6.29129l-0.41424,-0.64725c-1.70875,-2.71846 -2.6149,-5.85116 -2.6149,-9.07706c0,-9.39809 7.68934,-17.06155 17.15993,-17.06155c4.58253,0 8.88029,1.78642 12.11655,5.02268c3.23625,3.21036 5.02267,7.50812 5.02267,12.06476c-0.0078,9.3981 -7.69712,17.06155 -17.14699,17.06155m14.58906,-31.58846c-3.93529,-3.80584 -9.1133,-5.95471 -14.62789,-5.95471c-11.36055,0 -20.60848,9.2065 -20.61625,20.52564c0,3.61684 0.94757,7.14565 2.75211,10.26282l-2.92557,10.63564l10.93337,-2.85309c3.0136,1.63108 6.4052,2.4958 9.85634,2.49839l0.01037,0c11.36574,0 20.61884,-9.2091 20.62403,-20.53082c0,-5.48093 -2.14111,-10.64081 -6.03239,-14.51915"});function $l(){return/(android|iphone|ipad|mobile)/i.test(navigator.userAgent)}function _l(t,{title:e,separator:s}){return J(t,"whatsapp.url"),"https://"+($l()?"api":"web")+".whatsapp.com/send"+H({text:e?e+s+t:t})}const Pl=W("whatsapp",_l,t=>({title:t.title,separator:t.separator||" "}),{windowWidth:550,windowHeight:400});function Bl(t,{quote:e,hashtag:s}){return J(t,"workplace.url"),"https://work.facebook.com/sharer.php"+H({u:t,quote:e,hashtag:s})}W("workplace",Bl,t=>({quote:t.quote,hashtag:t.hashtag}),{windowWidth:550,windowHeight:400});function Ml({username:t,displayName:e,bio:s,className:n=""}){const[o,a]=j.useState(""),[i,l]=j.useState(!1),[c,d]=j.useState(!1),u=`${window.location.origin}/users/${t}`,g=`${e}の音楽名刺をチェック！ ${s?`"${s}"`:""}`;j.useEffect(()=>{(async()=>{try{const f=await et.toDataURL(u,{width:256,margin:2,color:{dark:"#000000",light:"#ffffff"}});a(f)}catch(f){console.error("QRコード生成エラー:",f)}})()},[u]);const p=async()=>{try{await navigator.clipboard.writeText(u),d(!0),setTimeout(()=>d(!1),2e3)}catch(b){console.error("クリップボードコピーエラー:",b)}};return r.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 ${n}`,children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"プロフィールを共有"]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロフィールURL"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"text",value:u,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-sm"}),r.jsx("button",{onClick:p,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c?"bg-green-100 text-green-800":"bg-blue-500 text-white hover:bg-blue-600"}`,children:c?"✓ コピー済み":"コピー"})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("button",{onClick:()=>l(!i),className:"flex items-center text-blue-600 hover:text-blue-800 text-sm font-medium",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"QRコードを",i?"非表示":"表示"]}),i&&o&&r.jsxs("div",{className:"mt-3 text-center",children:[r.jsx("img",{src:o,alt:"プロフィールQRコード",className:"mx-auto border border-gray-200 rounded-lg"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"スマートフォンでQRコードを読み取ってプロフィールにアクセス"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"SNSで共有"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(El,{url:u,title:g,children:r.jsx(Cl,{size:36,round:!0})}),r.jsx(el,{url:u,title:g,children:r.jsx(Xi,{size:36,round:!0})}),r.jsx(cl,{url:u,title:g,children:r.jsx(il,{size:36,round:!0})}),r.jsx(Pl,{url:u,title:g,children:r.jsx(Al,{size:36,round:!0})})]})]})]})}const Ol=[{title:"Shape of You",artist:"Ed Sheeran",jacket:"https://picsum.photos/300/300?random=1"},{title:"Blinding Lights",artist:"The Weeknd",jacket:"https://picsum.photos/300/300?random=2"},{title:"As It Was",artist:"Harry Styles",jacket:"https://picsum.photos/300/300?random=3"},{title:"Good 4 U",artist:"Olivia Rodrigo",jacket:"https://picsum.photos/300/300?random=4"}],Ul=[{title:"Pretender",artist:"Official髭男dism",jacket:"https://picsum.photos/300/300?random=5"},{title:"紅蓮華",artist:"LiSA",jacket:"https://picsum.photos/300/300?random=6"},{title:"猫",artist:"DISH//",jacket:"https://picsum.photos/300/300?random=7"}],Dl={alice:Ol,bob:Ul};function zl({title:t,artist:e,previewUrl:s,coverImage:n,onPlay:o,onPause:a,onError:i}){const[l,c]=j.useState(!1),[d,u]=j.useState(0),[g,p]=j.useState(30),[b,f]=j.useState(!1),[h,m]=j.useState(!1),y=j.useRef(null),v=j.useRef(null),N=async()=>{if(!s){i==null||i("試聴用音源が利用できません");return}if(y.current)try{f(!0),m(!1),l?(y.current.pause(),c(!1),a==null||a()):(await y.current.play(),c(!0),o==null||o())}catch(E){console.error("再生エラー:",E),m(!0),i==null||i("音楽の再生に失敗しました")}finally{f(!1)}},x=()=>{y.current&&u(y.current.currentTime)},C=E=>{if(!y.current||!v.current)return;const L=v.current.getBoundingClientRect(),U=E.clientX-L.left,q=L.width,R=U/q*g;y.current.currentTime=R,u(R)},I=E=>{const L=Math.floor(E/60),U=Math.floor(E%60);return`${L}:${U.toString().padStart(2,"0")}`},T=g>0?d/g*100:0;return j.useEffect(()=>{const E=y.current;if(!E)return;const L=()=>{p(E.duration)},U=()=>{c(!1),u(0)},q=()=>{m(!0),c(!1),i==null||i("音楽ファイルの読み込みに失敗しました")};return E.addEventListener("loadedmetadata",L),E.addEventListener("timeupdate",x),E.addEventListener("ended",U),E.addEventListener("error",q),()=>{E.removeEventListener("loadedmetadata",L),E.removeEventListener("timeupdate",x),E.removeEventListener("ended",U),E.removeEventListener("error",q)}},[i]),j.useEffect(()=>{c(!1),u(0),m(!1)},[s]),s?r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 max-w-sm mx-auto",children:[r.jsx("audio",{ref:y,src:s,preload:"metadata"}),r.jsx("div",{className:"aspect-square mb-4 rounded-lg overflow-hidden bg-gray-200",children:r.jsx("img",{src:n,alt:`${t} by ${e}`,className:"w-full h-full object-cover"})}),r.jsxs("div",{className:"mb-4",children:[r.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:t}),r.jsx("p",{className:"text-sm text-gray-600 truncate",children:e})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("div",{className:"flex justify-center",children:r.jsx("button",{onClick:N,disabled:b||h,className:`
              w-12 h-12 rounded-full flex items-center justify-center transition-all duration-200
              ${b||h?"bg-gray-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 hover:scale-105 shadow-lg"}
            `,children:b?r.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):h?r.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}):l?r.jsx("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):r.jsx("svg",{className:"w-6 h-6 text-white ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{ref:v,onClick:C,className:"h-2 bg-gray-200 rounded-full cursor-pointer overflow-hidden",children:r.jsx("div",{className:"h-full bg-blue-500 transition-all duration-200 rounded-full",style:{width:`${T}%`}})}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[r.jsx("span",{children:I(d)}),r.jsx("span",{children:I(g)})]})]})]}),h&&r.jsx("div",{className:"mt-2 text-xs text-red-500 text-center",children:"試聴に失敗しました"})]}):(console.warn(`⚠️ 試聴不可: "${t}" by "${e}"`),console.warn("💡 理由: Spotifyプレビューが提供されていません"),console.warn(`🔧 対処法: 
      1. 他の楽曲を試してください
      2. Spotify Premiumを検討してください  
      3. アーティストがプレビューを無効にしている可能性があります`),r.jsx("div",{className:"flex items-center justify-center p-4 bg-gray-100 rounded-lg",children:r.jsxs("div",{className:"text-center",children:[r.jsx("svg",{className:"w-8 h-8 text-gray-400 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 1.414L15.657 9.17l1.414 1.414a1 1 0 11-1.414 1.414L14.243 10.584l-1.414 1.414a1 1 0 11-1.414-1.414L12.829 9.17l-1.414-1.414a1 1 0 111.414-1.414L14.243 7.756l1.414-1.413z",clipRule:"evenodd"})}),r.jsx("p",{className:"text-xs text-gray-500",children:"試聴不可"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"プレビュー未提供"})]})}))}const Fl="/api/youtube/search",cr={searchMusic:async(t,e=5)=>{try{const s=await fetch(`${Fl}?query=${encodeURIComponent(t)}&maxResults=${e}`);if(!s.ok){const o=await s.json().catch(()=>({}));throw new Error(`YouTube検索失敗: ${s.status} ${o.error||""}`)}return(await s.json()).results||[]}catch(s){throw console.error("YouTube検索エラー:",s),s}},searchTrackByArtist:async(t,e,s=3)=>{const n=[`${t} ${e} official`,`${t} ${e} music video`,`${t} ${e} audio`,`${e} ${t}`];for(const o of n)try{const a=await cr.searchMusic(o,s);if(a.length>0)return a.map(l=>({...l,score:cr.calculateRelevanceScore(l,t,e)})).sort((l,c)=>c.score-l.score)}catch(a){console.warn(`クエリ失敗: ${o}`,a);continue}return[]},calculateRelevanceScore:(t,e,s)=>{let n=0;const o=t.title.toLowerCase(),a=t.channelTitle.toLowerCase(),i=e.toLowerCase(),l=s.toLowerCase();return o.includes(i)&&(n+=30),(a.includes(l)||o.includes(l))&&(n+=25),(a.includes("official")||o.includes("official"))&&(n+=20),(o.includes("music video")||o.includes("mv"))&&(n+=15),(o.includes("audio")||o.includes("lyric"))&&(n+=10),(o.includes("live")||o.includes("concert"))&&(n-=10),(o.includes("cover")||o.includes("remix"))&&(n-=5),n}};function Hl(){var fe,rt,st,nt;const{username:t}=es(),e=ln(),s=be(),[n,o]=j.useState(null),[a,i]=j.useState(!0);j.useState(null);const l=((fe=e.state)==null?void 0:fe.isPreview)===!0,[c,d]=j.useState(null),[u,g]=j.useState(!1),[p,b]=j.useState(!1),[f,h]=j.useState(!1),[m,y]=j.useState(!1),[v,N]=j.useState(!0),x=(A,P)=>{const K=P.totalCells,se=P.centerPositions||[],ee=[];for(let S=0;S<K;S++)se.includes(S)||ee.push(S);const ge=[...ee].sort(()=>Math.random()-.5).slice(0,A.length),Ne={};return ge.forEach((S,_)=>{Ne[S]=_}),Ne},[C,I]=j.useState({});j.useEffect(()=>{t&&T(t)},[t]),j.useEffect(()=>{if(n&&n.songs&&n.gridLayout){const A=x(n.songs,n.gridLayout);I(A),v&&setTimeout(()=>{N(!1)},100)}},[n]);const T=async A=>{try{const P=await Pe.loadUser(A);if(P)o(P),console.log(`✅ ユーザー「${A}」のデータを読み込みました`),await Pe.incrementViewCount(A);else{console.log(`⚠️ ユーザー「${A}」のデータが見つかりません`);const K=Dl[A];if(K){const se={username:A,displayName:A,bio:"",baseColor:Le[0],themeColor:Be[0],socialLinks:{},favoriteGenres:[],songs:K.map(ee=>({...ee,id:`${ee.title}-${ee.artist}`.replace(/\s+/g,"-").toLowerCase(),previewUrl:null,addedAt:new Date().toISOString()})),gridLayout:te[1],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),viewCount:0,isPublic:!0};o(se),console.log(`📄 users.jsonからフォールバックデータを使用: ${A}`)}}}catch(P){console.error(`❌ ユーザーデータの読み込みに失敗: ${A}`,P)}finally{i(!1)}},E=async A=>{try{const P=localStorage.getItem("spotify_access_token");if(!P)return console.log("Spotifyトークンがありません。検索をスキップします。"),A;const K=await ve.searchTracksAdvanced(A.title,A.artist,P);if(K.length>0){const se=K[0];return{...A,spotify:{id:se.id,previewUrl:se.previewUrl,spotifyUrl:se.spotifyUrl}}}}catch(P){console.error("Spotify検索エラー:",P)}return A},L=async A=>{try{const P=await cr.searchMusic(`${A.title} ${A.artist}`);if(P.length>0){const K=P[0];return{...A,youtube:{videoId:K.videoId,title:K.title,channelTitle:K.channelTitle,embedUrl:K.embedUrl}}}}catch(P){console.error("YouTube検索エラー:",P)}return A},U=async A=>{let P=A;return A.spotify||(P=await E(P)),A.youtube||(P=await L(P)),P},q=async A=>{if(!p){b(!0);try{const P=await U(A);d(P),g(!0)}catch(P){console.error("楽曲プレビューの取得に失敗しました:",P)}finally{b(!1)}}},R=()=>{g(!1),d(null)};if(a)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})});if(!n||!n.songs||n.songs.length===0)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[r.jsx("div",{className:"text-6xl mb-4",children:"🎵"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"ユーザーが見つかりません"}),r.jsxs("p",{className:"text-gray-600 mb-6",children:["お探しのユーザー「",t,"」は存在しないか、楽曲が登録されていません。"]}),r.jsxs("button",{onClick:()=>s("/"),className:"inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"ホームに戻る"]})]})});const k=n.themeColor||Be[0],D=n.baseColor||Le[0],M=D.id==="light";return r.jsxs("div",{className:`min-h-screen relative overflow-hidden ${D.background}`,children:[!M&&r.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${k.gradient} opacity-30`}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex items-center justify-between p-6",children:[r.jsxs("button",{onClick:()=>s("/"),className:`flex items-center transition-all px-3 py-2 rounded-lg ${M?"text-gray-700 hover:bg-gray-200":"text-white hover:bg-white/10"}`,onMouseEnter:A=>{M||(A.currentTarget.style.color=k.primaryHex)},onMouseLeave:A=>{M||(A.currentTarget.style.color="white")},children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"ホームに戻る"]}),r.jsxs("div",{className:"flex gap-2",children:[l&&r.jsx("button",{onClick:()=>s("/dashboard"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all shadow-lg ${M?"bg-gray-200 text-gray-700 hover:bg-gray-300":`bg-gradient-to-r ${k.gradient} text-white hover:opacity-90`}`,children:"編集画面に戻る"}),(l||e.pathname.includes("/users/"))&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>h(!f),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${f?M?"bg-gray-300 text-gray-700 shadow-lg":`bg-gradient-to-r ${k.gradient} text-white shadow-lg`:M?`${D.surface} ${D.textPrimary} ${D.border} border hover:${D.surfaceHover}`:"bg-white/10 text-white border hover:border-transparent"}`,style:!f&&!M?{borderColor:k.primaryHex+"50"}:{},onMouseEnter:A=>{!f&&!M&&(A.currentTarget.style.background=`linear-gradient(to right, ${k.primaryHex}, ${k.primaryHex})`)},onMouseLeave:A=>{!f&&!M&&(A.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},children:"統計"}),r.jsx("button",{onClick:()=>y(!m),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${m?M?"bg-gray-300 text-gray-700 shadow-lg":`bg-gradient-to-r ${k.gradient} text-white shadow-lg`:M?`${D.surface} ${D.textPrimary} ${D.border} border hover:${D.surfaceHover}`:"bg-white/10 text-white border hover:border-transparent"}`,style:!m&&!M?{borderColor:k.primaryHex+"50"}:{},onMouseEnter:A=>{!m&&!M&&(A.currentTarget.style.background=`linear-gradient(to right, ${k.primaryHex}, ${k.primaryHex})`)},onMouseLeave:A=>{!m&&!M&&(A.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},children:"共有"})]})]})]}),(f||m)&&r.jsx("div",{className:"px-6 mb-8",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f&&r.jsx("div",{className:`backdrop-blur-sm rounded-xl p-6 ${M?"bg-white/80 shadow-lg":"bg-white/10"}`}),m&&r.jsx("div",{className:`backdrop-blur-sm rounded-xl p-6 ${M?"bg-white/80 shadow-lg":"bg-white/10"}`,children:r.jsx(Ml,{username:n.username,displayName:n.displayName,bio:n.bio})})]})}),r.jsxs("div",{className:"flex flex-col items-center justify-center px-6 py-12",children:[r.jsx("div",{className:"w-full max-w-4xl",children:r.jsx("div",{className:"grid gap-2 aspect-square",style:{gridTemplateColumns:`repeat(${((rt=n.gridLayout)==null?void 0:rt.size)||te[1].size}, 1fr)`,gridTemplateRows:`repeat(${((st=n.gridLayout)==null?void 0:st.size)||te[1].size}, 1fr)`},children:Array.from({length:((nt=n.gridLayout)==null?void 0:nt.totalCells)||te[1].totalCells}).map((A,P)=>{var Ne,S,_,O;const K=((Ne=n.gridLayout)==null?void 0:Ne.centerPositions)||te[1].centerPositions,se=K.includes(P),ee=(((S=n.gridLayout)==null?void 0:S.size)||te[1].size)%2===1,Ve=C[P],ge=Ve!==void 0?n.songs[Ve]:null;return se&&K.length===4&&P!==K[0]?null:r.jsx("div",{className:`aspect-square relative overflow-hidden rounded-lg ${v?"animate-fade-in-scale":""}`,style:{...se&&K.length===4?{gridColumn:`${K[0]%(((_=n.gridLayout)==null?void 0:_.size)||te[1].size)+1} / span 2`,gridRow:`${Math.floor(K[0]/(((O=n.gridLayout)==null?void 0:O.size)||te[1].size))+1} / span 2`}:{},animationDelay:`${P*50}ms`},children:se?r.jsx("div",{className:`w-full h-full flex items-center justify-center backdrop-blur-sm ${M?"bg-white/80":"bg-black/10"}`,children:n.icon?r.jsx("img",{src:n.icon,alt:`${n.displayName}のアイコン`,className:`w-full h-full object-cover rounded-lg shadow-xl ${ee?"border-8":"border-4"}`,style:{borderColor:k.primaryHex,boxShadow:ee?`0 15px 35px -5px ${k.primaryHex}40, 0 15px 15px -5px ${k.primaryHex}30, inset 0 0 0 2px ${k.primaryHex}20`:`0 10px 25px -5px ${k.primaryHex}30, 0 10px 10px -5px ${k.primaryHex}20`}}):r.jsx("div",{className:`w-full h-full flex items-center justify-center rounded-lg shadow-xl ${ee?"border-8":"border-4"} ${M?"bg-gradient-to-br from-gray-100 to-gray-200":"bg-gradient-to-br from-white/20 to-white/10"}`,style:{borderColor:k.primaryHex,boxShadow:ee?`0 15px 35px -5px ${k.primaryHex}40, 0 15px 15px -5px ${k.primaryHex}30, inset 0 0 0 2px ${k.primaryHex}20`:`0 10px 25px -5px ${k.primaryHex}30, 0 10px 10px -5px ${k.primaryHex}20`},children:r.jsx("div",{className:`font-bold ${ee?"text-5xl":"text-4xl"} ${M?"text-gray-600":"text-white/60"}`,children:n.displayName.charAt(0).toUpperCase()})})}):ge?r.jsx("div",{onClick:()=>q(ge),className:`w-full h-full cursor-pointer transform hover:scale-105 transition-all duration-300 hover:shadow-2xl group ${p?"opacity-50 cursor-not-allowed":""}`,children:r.jsxs("div",{className:"relative w-full h-full",children:[r.jsx("img",{src:ge.jacket,alt:"",className:"w-full h-full object-cover rounded-lg shadow-lg"}),r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-300 rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"bg-white bg-opacity-90 rounded-full p-2 sm:p-3 transform scale-0 group-hover:scale-100 transition-transform duration-300",children:r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-gray-800",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M8 5v14l11-7z"})})})}),r.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-0 group-hover:bg-opacity-90 transition-all duration-300 rounded-b-lg p-2 opacity-0 group-hover:opacity-100",children:[r.jsx("p",{className:"text-white text-xs font-medium truncate",children:ge.title}),r.jsx("p",{className:"text-white/80 text-xs truncate",children:ge.artist})]})]})}):r.jsx("div",{className:"w-full h-full"})},P)})})}),r.jsxs("div",{className:"text-center mt-12",children:[r.jsx("h1",{className:`text-3xl sm:text-4xl lg:text-5xl font-bold mb-4 ${D.textPrimary}`,children:n.displayName}),n.bio&&r.jsx("p",{className:`text-lg mb-4 ${D.textSecondary}`,children:n.bio}),r.jsxs("div",{className:`flex items-center justify-center gap-6 ${D.textSecondary}`,children:[r.jsxs("span",{children:["🎵 ",n.songs.length,"曲"]}),n.viewCount>0&&r.jsxs("span",{children:["👁️ ",n.viewCount,"回閲覧"]}),n.location&&r.jsxs("span",{children:["📍 ",n.location]})]}),Object.keys(n.socialLinks).length>0&&r.jsxs("div",{className:"flex gap-4 mt-8 justify-center",children:[n.socialLinks.twitter&&r.jsx("a",{href:n.socialLinks.twitter,target:"_blank",rel:"noopener noreferrer",className:`p-3 rounded-full transition-colors ${M?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20"}`,children:r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"})})}),n.socialLinks.instagram&&r.jsx("a",{href:n.socialLinks.instagram,target:"_blank",rel:"noopener noreferrer",className:`p-3 rounded-full transition-colors ${M?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20"}`,children:r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})})}),n.socialLinks.spotify&&r.jsx("a",{href:n.socialLinks.spotify,target:"_blank",rel:"noopener noreferrer",className:`p-3 rounded-full transition-colors ${M?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20"}`,children:r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})})})]})]})]}),u&&c&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"楽曲プレイヤー"}),r.jsx("button",{onClick:R,className:"text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("img",{src:c.jacket,alt:`${c.title} - ${c.artist}`,className:"w-40 h-40 mx-auto rounded-lg shadow-lg mb-4"}),r.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:c.title}),r.jsx("p",{className:"text-gray-600",children:c.artist})]}),c.spotify&&r.jsx("div",{className:"mb-4",children:r.jsx(zl,{previewUrl:c.spotify.previewUrl,title:c.title,artist:c.artist,coverImage:c.jacket||"/default-cover.jpg"})}),c.youtube&&r.jsx("div",{className:"mb-4",children:r.jsx(Da,{videoId:c.youtube.videoId,title:c.youtube.title,artist:c.artist,coverImage:c.jacket||"/default-cover.jpg"})}),!c.spotify&&!c.youtube&&r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{children:"プレビューが見つかりませんでした"})]})]})})]})]})}function Vl(){const t=be(),[e,s]=j.useState({username:"",displayName:"",bio:"",baseColor:Le[0],themeColor:Be[0],socialLinks:{},favoriteGenres:[],songs:[],gridLayout:te[0],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),viewCount:0,isPublic:!0}),[n,o]=j.useState(!1),[a,i]=j.useState({}),l=()=>{e.songs.length<20&&s(h=>({...h,songs:[...h.songs,{title:"",artist:"",jacket:"",genre:"",releaseYear:void 0}]}))},c=h=>{s(m=>({...m,songs:m.songs.filter((y,v)=>v!==h)}))},d=(h,m,y)=>{s(v=>({...v,songs:v.songs.map((N,x)=>x===h?{...N,[m]:y}:N)}))},u=(h,m)=>{d(h,"title",m.name),d(h,"artist",m.artist),d(h,"jacket",m.image||""),d(h,"isGeneratedImage",m.isGeneratedImage||!1)},g=h=>{s(m=>({...m,favoriteGenres:m.favoriteGenres.includes(h)?m.favoriteGenres.filter(y=>y!==h):[...m.favoriteGenres,h]}))},p=(h,m)=>{s(y=>({...y,socialLinks:{...y.socialLinks,[h]:m.trim()||void 0}}))},b=()=>{const h={};return e.username.trim()?/^[a-zA-Z0-9_-]+$/.test(e.username)||(h.username="ユーザー名は英数字、ハイフン、アンダースコアのみ使用可能です"):h.username="ユーザー名は必須です",e.displayName.trim()||(h.displayName="表示名は必須です"),e.songs.length===0&&(h.songs="最低1曲は追加してください"),e.songs.some(y=>!y.title||!y.artist)&&(h.songs="全ての楽曲のタイトルとアーティストを入力してください"),i(h),Object.keys(h).length===0},f=async h=>{if(h.preventDefault(),!!b()){o(!0);try{pr(e)?t(`/users/${e.username}`):i({submit:"データの保存に失敗しました"})}catch(m){console.error("データの保存に失敗しました:",m),i({submit:"データの保存に失敗しました"})}finally{o(!1)}}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:r.jsx("div",{className:"container mx-auto px-4 py-8",children:r.jsxs("div",{className:"max-w-3xl mx-auto",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"音楽名刺を作成"}),r.jsx("p",{className:"text-gray-600",children:"あなたの音楽の好みを世界に発信しましょう"})]}),r.jsxs("form",{onSubmit:f,className:"space-y-8",children:[r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"基本情報"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ユーザー名 *"}),r.jsx("input",{type:"text",value:e.username,onChange:h=>s(m=>({...m,username:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"example_user",required:!0}),a.username&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.username})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"表示名 *"}),r.jsx("input",{type:"text",value:e.displayName,onChange:h=>s(m=>({...m,displayName:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"山田太郎",required:!0}),a.displayName&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.displayName})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"自己紹介"}),r.jsx("textarea",{value:e.bio,onChange:h=>s(m=>({...m,bio:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"音楽が大好きです！様々なジャンルを聴きます。"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"居住地"}),r.jsx("input",{type:"text",value:e.location||"",onChange:h=>s(m=>({...m,location:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"東京都渋谷区"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"職業"}),r.jsx("input",{type:"text",value:e.occupation||"",onChange:h=>s(m=>({...m,occupation:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"エンジニア"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"外観設定"}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロフィール画像"}),r.jsx(Ms,{currentIcon:e.icon,onIconChange:h=>s(m=>({...m,icon:h})),username:e.username})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ベースカラー"}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"音楽名刺の基本となる背景色を選択してください。"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:Le.map(h=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"radio",name:"baseColor",checked:e.baseColor.id===h.id,onChange:()=>s(m=>({...m,baseColor:h})),className:"sr-only"}),r.jsxs("div",{className:`relative p-3 rounded-lg border-2 transition-all ${e.baseColor.id===h.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[r.jsx("div",{className:`w-full h-6 rounded-lg ${h.background} mb-2`}),r.jsx("p",{className:"text-sm font-medium text-gray-800",children:h.name})]})]},h.id))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"テーマカラー"}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"アイコンの枠線やボタンの色に反映されます。"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:Be.map(h=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"radio",name:"themeColor",checked:e.themeColor.id===h.id,onChange:()=>s(m=>({...m,themeColor:h})),className:"sr-only"}),r.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${e.themeColor.id===h.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[r.jsx("div",{className:`w-full h-6 rounded-lg bg-gradient-to-r ${h.gradient} mb-2`}),r.jsx("p",{className:"text-sm font-medium text-gray-800",children:h.name})]})]},h.id))})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"SNSリンク"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Twitter"}),r.jsx("input",{type:"url",value:e.socialLinks.twitter||"",onChange:h=>p("twitter",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://twitter.com/username"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Instagram"}),r.jsx("input",{type:"url",value:e.socialLinks.instagram||"",onChange:h=>p("instagram",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://instagram.com/username"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spotify"}),r.jsx("input",{type:"url",value:e.socialLinks.spotify||"",onChange:h=>p("spotify",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://open.spotify.com/user/username"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),r.jsx("input",{type:"url",value:e.socialLinks.website||"",onChange:h=>p("website",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"好きなジャンル"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"最大5つまで選択できます"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:Hr.map(h=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:e.favoriteGenres.includes(h),onChange:()=>g(h),disabled:!e.favoriteGenres.includes(h)&&e.favoriteGenres.length>=5,className:"sr-only"}),r.jsx("div",{className:`p-3 rounded-lg border-2 transition-all text-center ${e.favoriteGenres.includes(h)?`border-${e.themeColor.primary} bg-${e.themeColor.primary}/10 text-${e.themeColor.primary}`:"border-gray-200 hover:border-gray-300 text-gray-700"} ${!e.favoriteGenres.includes(h)&&e.favoriteGenres.length>=5?"opacity-50 cursor-not-allowed":""}`,children:r.jsx("p",{className:"text-sm font-medium",children:h})})]},h))})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"お気に入りの楽曲"}),r.jsx("button",{type:"button",onClick:l,disabled:e.songs.length>=20,className:`px-4 py-2 rounded-lg font-medium transition-colors ${e.songs.length>=20?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:"楽曲を追加"})]}),a.songs&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600",children:a.songs})}),r.jsx("div",{className:"space-y-4",children:e.songs.map((h,m)=>r.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["楽曲 ",m+1]}),r.jsx("button",{type:"button",onClick:()=>c(m),className:"text-red-500 hover:text-red-700 transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),r.jsx(xr,{onSelect:y=>u(m,y),placeholder:"曲名やアーティスト名を検索...",username:e.username}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ジャンル"}),r.jsxs("select",{value:h.genre||"",onChange:y=>d(m,"genre",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"選択してください"}),Hr.map(y=>r.jsx("option",{value:y,children:y},y))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"リリース年"}),r.jsx("input",{type:"number",value:h.releaseYear||"",onChange:y=>{const v=parseInt(y.target.value);d(m,"releaseYear",isNaN(v)?"":v)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"2023",min:"1900",max:new Date().getFullYear()})]})]}),h.jacket&&r.jsx("div",{className:"mt-3",children:r.jsx("img",{src:h.jacket,alt:`${h.title} - ${h.artist}`,className:"w-16 h-16 object-cover rounded-lg border border-gray-200"})})]},m))}),e.songs.length===0&&r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),r.jsx("p",{children:"楽曲を追加してください"})]})]}),r.jsxs("div",{className:"text-center",children:[a.submit&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600",children:a.submit})}),r.jsx("button",{type:"submit",disabled:n,className:`px-8 py-3 rounded-xl font-semibold transition-all ${n?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-cyan-500 text-white hover:from-blue-600 hover:to-cyan-600 hover:scale-105"} shadow-lg hover:shadow-xl`,children:n?"作成中...":"音楽名刺を作成"})]})]})]})})})}function Jl({className:t=""}){const[e,s]=j.useState({totalUsers:0,totalSongs:0,totalViews:0,storageSizeKB:0}),[n,o]=j.useState([]),[a,i]=j.useState(!1);j.useEffect(()=>{l()},[]);const l=()=>{s($a()),o($s())},c=()=>{Lt()?(alert("✅ バックアップを作成しました"),l()):alert("❌ バックアップの作成に失敗しました")},d=()=>{confirm("バックアップから復元しますか？現在のデータは上書きされます。")&&(La()?(alert("✅ バックアップから復元しました"),l(),window.location.reload()):alert("❌ バックアップからの復元に失敗しました"))},u=()=>{try{const b=Ia(),f=new Blob([b],{type:"application/json"}),h=URL.createObjectURL(f),m=document.createElement("a");m.href=h,m.download=`musicmeisi_backup_${new Date().toISOString().split("T")[0]}.json`,m.click(),URL.revokeObjectURL(h),alert("✅ データをエクスポートしました")}catch(b){console.error("エクスポートエラー:",b),alert("❌ データのエクスポートに失敗しました")}},g=b=>{var m;const f=(m=b.target.files)==null?void 0:m[0];if(!f)return;const h=new FileReader;h.onload=y=>{var v;try{const N=(v=y.target)==null?void 0:v.result;Ta(N)?(alert("✅ データをインポートしました"),l(),window.location.reload()):alert("❌ データのインポートに失敗しました")}catch(N){console.error("インポートエラー:",N),alert("❌ 無効なファイル形式です")}},h.readAsText(f),b.target.value=""},p=b=>b?new Date(b).toLocaleString("ja-JP"):"N/A";return r.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 ${t}`,children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 1.79 4 4 4h8c2.21 0 4-1.79 4-4V7M4 7V4a1 1 0 011-1h5l2 2h6a1 1 0 011 1v1M4 7h16"})}),"データ管理"]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.totalUsers}),r.jsx("div",{className:"text-sm text-blue-800",children:"総ユーザー数"})]}),r.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.totalSongs}),r.jsx("div",{className:"text-sm text-green-800",children:"総楽曲数"})]}),r.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.totalViews}),r.jsx("div",{className:"text-sm text-purple-800",children:"総閲覧数"})]}),r.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:e.storageSizeKB}),r.jsx("div",{className:"text-sm text-orange-800",children:"ストレージ (KB)"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[r.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"})}),"バックアップ"]}),r.jsxs("button",{onClick:d,className:"flex items-center justify-center gap-2 px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"復元"]}),r.jsxs("button",{onClick:u,className:"flex items-center justify-center gap-2 px-3 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"エクスポート"]}),r.jsxs("label",{className:"flex items-center justify-center gap-2 px-3 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm cursor-pointer",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),"インポート",r.jsx("input",{type:"file",accept:".json",onChange:g,className:"sr-only"})]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("button",{onClick:()=>i(!a),className:"flex items-center text-gray-600 hover:text-gray-800 text-sm font-medium",children:[r.jsx("svg",{className:`w-4 h-4 mr-2 transition-transform ${a?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),"ユーザー詳細を",a?"非表示":"表示"]})}),a&&r.jsxs("div",{className:"overflow-x-auto",children:[r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"ユーザー名"}),r.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"表示名"}),r.jsx("th",{className:"text-right py-2 px-3 font-medium text-gray-700",children:"楽曲数"}),r.jsx("th",{className:"text-right py-2 px-3 font-medium text-gray-700",children:"閲覧数"}),r.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"更新日時"})]})}),r.jsx("tbody",{children:n.map(b=>r.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[r.jsx("td",{className:"py-2 px-3 font-mono text-sm",children:b.username}),r.jsx("td",{className:"py-2 px-3",children:b.displayName}),r.jsx("td",{className:"py-2 px-3 text-right",children:b.songCount}),r.jsx("td",{className:"py-2 px-3 text-right",children:b.viewCount}),r.jsx("td",{className:"py-2 px-3 text-xs text-gray-500",children:p(b.updatedAt)})]},b.username))})]}),n.length===0&&r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293L16 14H8l-2.707-1.707A1 1 0 004.586 13H2"})}),r.jsx("p",{children:"登録されているユーザーがいません"})]})]}),r.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"💡 使用方法"}),r.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[r.jsxs("li",{children:["• ",r.jsx("strong",{children:"バックアップ"}),": 現在のデータをブラウザ内に保存"]}),r.jsxs("li",{children:["• ",r.jsx("strong",{children:"復元"}),": バックアップからデータを復元"]}),r.jsxs("li",{children:["• ",r.jsx("strong",{children:"エクスポート"}),": データをJSONファイルとしてダウンロード"]}),r.jsxs("li",{children:["• ",r.jsx("strong",{children:"インポート"}),": JSONファイルからデータを読み込み"]})]})]})]})}function Wl(){const t=be(),[e,s]=j.useState([]),[n,o]=j.useState(!0),[a,i]=j.useState(!1),[l,c]=j.useState(!1);j.useEffect(()=>{d()},[]);const d=()=>{const h=localStorage.getItem("musicard_admin"),m=localStorage.getItem("musicard_admin_login_time");if(!h||!m){console.warn("🛡️ 管理者権限がありません"),t("/admin-login");return}const y=parseInt(m),v=Date.now(),N=24*60*60*1e3;if(v-y>N){console.warn("🛡️ 管理者セッションが期限切れです"),localStorage.removeItem("musicard_admin"),localStorage.removeItem("musicard_admin_login_time"),t("/admin-login");return}if(!({}.VITE_ADMIN_USERS||"admin").split(",").includes(h)){console.warn("🛡️ 管理者権限が無効です"),t("/admin-login");return}c(!0),u()};j.useEffect(()=>{l&&u()},[l]);const u=()=>{try{const h=$s();s(h)}catch(h){console.error("ユーザーデータの読み込みに失敗しました:",h)}finally{o(!1)}},g=h=>{confirm(`${h}の名刺を削除しますか？この操作は取り消せません。`)&&(Ea(h)?(u(),alert(`✅ ${h}の名刺を削除しました`)):alert(`❌ ${h}の削除に失敗しました`))},p=h=>{t(`/edit/${h}`)},b=()=>{confirm("管理者ログアウトしますか？")&&(localStorage.removeItem("musicard_admin"),localStorage.removeItem("musicard_admin_login_time"),t("/"))},f=h=>h?new Date(h).toLocaleString("ja-JP"):"N/A";return l?n?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})}):r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:r.jsxs("div",{className:"container mx-auto px-4 py-8",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"管理者パネル"}),r.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"ADMIN"})]}),r.jsx("p",{className:"text-gray-600",children:"音楽名刺の管理とデータ統計"}),r.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["管理者: ",localStorage.getItem("musicard_admin")]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>i(!a),className:`px-4 py-2 rounded-lg font-medium transition-colors ${a?"bg-blue-600 text-white":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:"データ管理"}),r.jsx("button",{onClick:b,className:"bg-red-500 text-white px-6 py-2 rounded-lg font-medium hover:bg-red-600 transition-colors",children:"ログアウト"}),r.jsx(_e,{to:"/",className:"bg-white text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-50 transition-colors border border-gray-200",children:"ホームに戻る"})]})]}),a&&r.jsx("div",{className:"mb-8",children:r.jsx(Jl,{})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-blue-600",children:e.length}),r.jsx("div",{className:"text-gray-600",children:"総ユーザー数"})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-green-600",children:e.reduce((h,m)=>h+m.songCount,0)}),r.jsx("div",{className:"text-gray-600",children:"総楽曲数"})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-purple-600",children:e.reduce((h,m)=>h+m.viewCount,0)}),r.jsx("div",{className:"text-gray-600",children:"総閲覧数"})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-orange-600",children:e.length>0?Math.round(e.reduce((h,m)=>h+m.songCount,0)/e.length):0}),r.jsx("div",{className:"text-gray-600",children:"平均楽曲数"})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[r.jsx("div",{className:"p-6 border-b border-gray-200",children:r.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"登録ユーザー一覧"})}),e.length===0?r.jsxs("div",{className:"text-center py-16",children:[r.jsx("div",{className:"text-6xl mb-6",children:"🎵"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"名刺がまだありません"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"最初の音楽名刺を作成してみましょう"}),r.jsxs(_e,{to:"/create",className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg font-medium hover:from-blue-600 hover:to-cyan-600 transition-all hover:scale-105 shadow-lg",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"名刺を作成"]})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"ユーザー"}),r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"楽曲数"}),r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"閲覧数"}),r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"更新日"}),r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"操作"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(h=>r.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"py-4 px-6",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center text-white font-semibold",children:h.displayName.charAt(0).toUpperCase()}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:h.displayName}),r.jsxs("div",{className:"text-sm text-gray-500 font-mono",children:["@",h.username]})]})]})}),r.jsx("td",{className:"py-4 px-6 text-sm text-gray-900",children:r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[h.songCount," 曲"]})}),r.jsx("td",{className:"py-4 px-6 text-sm text-gray-900",children:r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[h.viewCount," 回"]})}),r.jsx("td",{className:"py-4 px-6 text-sm text-gray-500",children:f(h.updatedAt)}),r.jsx("td",{className:"py-4 px-6",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx(_e,{to:`/users/${h.username}`,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 transition-colors",children:"表示"}),r.jsx("button",{onClick:()=>p(h.username),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-green-700 bg-green-100 hover:bg-green-200 transition-colors",children:"編集"}),r.jsx("button",{onClick:()=>g(h.username),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 transition-colors",children:"削除"})]})})]},h.username))})]})})]}),r.jsxs("div",{className:"mt-8 bg-blue-50 rounded-xl p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"💡 使用方法"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"名刺の管理"}),r.jsxs("ul",{className:"space-y-1",children:[r.jsx("li",{children:"• 「表示」で名刺ページを表示"}),r.jsx("li",{children:"• 「編集」で名刺内容を編集"}),r.jsx("li",{children:"• 「削除」で名刺を完全削除"})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"データ管理"}),r.jsxs("ul",{className:"space-y-1",children:[r.jsx("li",{children:"• 統計情報の確認"}),r.jsx("li",{children:"• データのバックアップ・復元"}),r.jsx("li",{children:"• エクスポート・インポート"})]})]})]})]})]})}):r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"管理者認証を確認中..."})]})})}const lt=[{id:"blue",name:"ブルー",gradient:"from-blue-500 to-blue-600",primary:"blue-500",secondary:"blue-100"},{id:"purple",name:"パープル",gradient:"from-purple-500 to-purple-600",primary:"purple-500",secondary:"purple-100"},{id:"green",name:"グリーン",gradient:"from-green-500 to-green-600",primary:"green-500",secondary:"green-100"},{id:"pink",name:"ピンク",gradient:"from-pink-500 to-pink-600",primary:"pink-500",secondary:"pink-100"},{id:"orange",name:"オレンジ",gradient:"from-orange-500 to-orange-600",primary:"orange-500",secondary:"orange-100"},{id:"indigo",name:"インディゴ",gradient:"from-indigo-500 to-indigo-600",primary:"indigo-500",secondary:"indigo-100"}];function ql(){const{username:t}=es(),e=be(),[s,n]=j.useState([]),[o,a]=j.useState(""),[i,l]=j.useState(lt[0]),[c,d]=j.useState(!0),u=j.useCallback(m=>{try{const y=localStorage.getItem("musicmeisi_users");if(y){const v=JSON.parse(y);if(v[m]){const N=v[m];if(n(N.songs||N),a(N.icon||""),N.themeColor){const x=lt.find(C=>C.id===N.themeColor.id);l(x||lt[0])}}else alert("ユーザーが見つかりません"),e("/manage")}else alert("ユーザーデータが見つかりません"),e("/manage")}catch{alert("データの読み込みに失敗しました"),e("/manage")}finally{d(!1)}},[e]);j.useEffect(()=>{t&&u(t)},[t,u]);const g=()=>{n([...s,{title:"",artist:"",jacket:""}])},p=m=>{s.length>1&&n(s.filter((y,v)=>v!==m))},b=(m,y,v)=>{const N=[...s];N[m]={...N[m],[y]:v},n(N)},f=(m,y)=>{const v=[...s];v[m]={title:y.name,artist:y.artist,jacket:y.image||"",isGeneratedImage:y.isGeneratedImage},n(v)},h=async m=>{if(m.preventDefault(),!t){alert("ユーザー名が無効です");return}const y=s.filter(v=>v.title.trim()&&v.artist.trim());if(y.length===0){alert("少なくとも1つの楽曲情報を入力してください");return}try{const v=localStorage.getItem("musicmeisi_users"),N=v?JSON.parse(v):{};N[t]={username:t,icon:o,themeColor:i,songs:y,updatedAt:new Date().toISOString()},localStorage.setItem("musicmeisi_users",JSON.stringify(N)),alert("名刺が更新されました！"),e(`/users/${t}`)}catch{alert("エラーが発生しました。もう一度お試しください。")}};return c?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:r.jsx("div",{className:"text-blue-600 text-xl",children:"読み込み中..."})}):r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:[r.jsx("div",{className:"sticky top-0 z-50 backdrop-blur-sm bg-white/80 border-b border-blue-200/50 shadow-sm",children:r.jsx("div",{className:"container mx-auto px-4 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h1",{className:"text-xl font-bold text-blue-900",children:[t,"の名刺を編集"]}),r.jsxs("button",{onClick:()=>e("/manage"),className:"inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 transition-colors duration-300",children:[r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"管理画面に戻る"]})]})})}),r.jsx("div",{className:"container mx-auto px-4 py-8",children:r.jsx("div",{className:"max-w-2xl mx-auto",children:r.jsxs("form",{onSubmit:h,className:"space-y-8",noValidate:!0,children:[r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-blue-200/50 shadow-lg",children:[r.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-6",children:"基本情報"}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-blue-700 text-sm font-medium mb-2",children:"ユーザー名"}),r.jsx("input",{type:"text",value:t,disabled:!0,className:"w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-blue-500 cursor-not-allowed"}),r.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"ユーザー名は変更できません"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-blue-700 text-sm font-medium mb-3",children:"名刺テーマカラー"}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:lt.map(m=>r.jsxs("button",{type:"button",onClick:()=>l(m),className:`p-3 rounded-xl border-2 transition-all duration-300 ${i.id===m.id?"border-blue-500 shadow-lg scale-105":"border-blue-200 hover:border-blue-300"}`,children:[r.jsx("div",{className:`w-full h-8 bg-gradient-to-r ${m.gradient} rounded-lg mb-2`}),r.jsx("span",{className:"text-sm text-blue-700 font-medium",children:m.name})]},m.id))}),r.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"選択したカラーが名刺のアクセントカラーとして使用されます"})]})]}),r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-blue-200/50 shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"好きな音楽"}),r.jsx("button",{type:"button",onClick:g,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-300",children:"曲を追加"})]}),r.jsx("div",{className:"space-y-6",children:s.map((m,y)=>r.jsxs("div",{className:"bg-slate-700/50 rounded-xl p-4 border border-slate-600/50",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-white font-medium",children:["曲 ",y+1]}),s.length>1&&r.jsx("button",{type:"button",onClick:()=>p(y),className:"text-red-400 hover:text-red-300 transition-colors duration-300",children:r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"音楽を検索"}),r.jsx(xr,{onSelect:v=>f(y,v),placeholder:"曲名やアーティスト名で検索...",className:"mb-3"}),r.jsx("p",{className:"text-slate-400 text-xs",children:"検索して自動入力するか、下記のフィールドに直接入力してください"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"曲名 *"}),r.jsx("input",{type:"text",value:m.title,onChange:v=>b(y,"title",v.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"曲名を入力"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"アーティスト *"}),r.jsx("input",{type:"text",value:m.artist,onChange:v=>b(y,"artist",v.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"アーティスト名を入力"})]})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"ジャケット画像URL（任意）"}),r.jsx("input",{type:"text",value:m.jacket,onChange:v=>b(y,"jacket",v.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"https://example.com/image.jpg"}),r.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"未入力の場合はランダム画像が使用されます"})]})]},y))})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 rounded-xl font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300 hover:scale-105",children:"更新する"}),r.jsx("button",{type:"button",onClick:()=>e("/manage"),className:"px-8 py-4 bg-slate-700 text-white rounded-xl font-semibold hover:bg-slate-600 transition-all duration-300",children:"キャンセル"})]})]})})})]})}function Kl(){const[t]=cn(),e=be(),[s,n]=j.useState("loading"),[o,a]=j.useState(""),i=j.useRef(!1);return j.useEffect(()=>{(async()=>{var c,d,u;if(i.current){console.log("🔄 認証処理は既に実行済みです");return}i.current=!0;try{const g=t.get("code"),p=t.get("state"),b=t.get("error");if(console.log("🔍 コールバックパラメータ確認:"),console.log(`   code: ${g?"✅ あり":"❌ なし"}`),console.log(`   state: ${p?"✅ あり":"❌ なし"}`),console.log(`   error: ${b||"なし"}`),b)throw new Error(`Spotify認証エラー: ${b}`);if(!g)throw new Error("認証コードが見つかりません");if(!p)throw new Error("状態パラメータが見つかりません");const f=localStorage.getItem("spotify_current_state"),h=localStorage.getItem(`spotify_auth_${p}`);let m=null;if(h)try{m=JSON.parse(h).codeVerifier}catch(v){console.error("❌ 認証データ解析エラー:",v)}if(console.log("🔍 LocalStorage状態確認:"),console.log(`   受信したcode: ${g.substring(0,10)}...`),console.log(`   受信したstate: "${p}"`),console.log(`   保存されたstate: "${f}"`),console.log(`   code_verifier: ${m?"✅ 存在":"❌ なし"}`),console.log(`   state一致: ${f===p}`),f!==p)throw new Error("State parameter不一致 - セキュリティエラー");console.log("🔄 認証コードをアクセストークンに交換中...");const y=await Es.getAccessToken(g,p);Ts(y),localStorage.removeItem("spotify_current_state"),localStorage.removeItem(`spotify_auth_${p}`),Ls("spotify"),n("success"),a("Spotify認証が完了しました！PKCEフローによる安全な認証です。"),window.history.replaceState({},document.title,"/callback"),setTimeout(()=>{e("/")},3e3)}catch(g){console.error("❌ Spotify認証エラー:",g),n("error"),a(g.message||"Spotify認証に失敗しました"),((c=g.message)!=null&&c.includes("Token exchange failed")||(d=g.message)!=null&&d.includes("Failed to get access token"))&&(console.error("🔍 トークン交換エラーの詳細:"),console.error("   • 認証コードが既に使用済みの可能性"),console.error("   • Client IDが間違っている可能性"),console.error("   • Redirect URIが正確に設定されていない可能性"),console.error("   • 認証コードの有効期限（10分）が切れている可能性"),console.error("   • code_verifierが見つからない可能性")),(u=g.message)!=null&&u.includes("Invalid authorization code")&&(console.warn("⚠️ 認証コードが無効です。新しい認証を開始してください。"),setTimeout(()=>{e("/")},5e3))}})()},[e,t]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:r.jsx("div",{className:"max-w-md mx-auto p-8",children:r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-8 border border-blue-200/50 shadow-lg text-center",children:[s==="loading"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),r.jsx("h1",{className:"text-2xl font-bold text-blue-900 mb-4",children:"🎧 Spotify認証処理中..."}),r.jsxs("p",{className:"text-blue-600",children:["認証コードをアクセストークンに交換しています...",r.jsx("br",{}),r.jsx("span",{className:"text-sm text-blue-500",children:"重複処理を防止中"})]})]}),s==="success"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-12 h-12 mx-auto mb-4 text-green-500",children:r.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),r.jsx("h1",{className:"text-2xl font-bold text-green-700 mb-4",children:"🎉 認証完了！"}),r.jsx("p",{className:"text-blue-600 mb-4",children:o}),r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-4",children:r.jsxs("p",{className:"text-green-700 text-sm",children:["✅ 音楽検索でSpotifyが利用可能になりました",r.jsx("br",{}),"✅ PKCEフローによる安全な認証を実現",r.jsx("br",{}),"✅ Client Secretが不要なセキュアな実装",r.jsx("br",{}),"✅ より高精度な検索結果を提供",r.jsx("br",{}),"✅ 認証コードの重複使用を防止"]})}),r.jsx("p",{className:"text-blue-500 text-sm",children:"3秒後に自動的にホームページに戻ります..."})]}),s==="error"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-12 h-12 mx-auto mb-4 text-red-500",children:r.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),r.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-4",children:"❌ 認証に失敗しました"}),r.jsx("p",{className:"text-red-600 mb-4",children:o}),r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:r.jsxs("p",{className:"text-red-700 text-sm text-left",children:[r.jsx("strong",{children:"🔍 よくある解決方法:"}),r.jsx("br",{}),"• 認証コードの重複使用（ページリロード等）",r.jsx("br",{}),"• Spotify Developer Dashboardでredirect_uriを確認",r.jsx("br",{}),"• Client IDが正しく設定されているか確認",r.jsx("br",{}),"• ブラウザのキャッシュをクリアして再試行",r.jsx("br",{}),"• 認証コードの有効期限（10分）内に処理を完了",r.jsx("br",{}),"• code_verifierが失われた場合は新しい認証を開始"]})}),r.jsx("button",{onClick:()=>e("/"),className:"bg-blue-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-600 transition-colors duration-300",children:"ホームに戻る"})]})]})})})}function Yl(){j.useState(!1);const[t,e]=j.useState(Vr()),[s,n]=j.useState(0);j.useEffect(()=>{o()},[]);const o=async()=>{try{const a=await Pe.loadAllUsers();n(Object.keys(a).length),e(Vr())}catch(a){console.error("ストレージ統計の読み込みエラー:",a)}};return null}function Gl(){return r.jsxs(r.Fragment,{children:[r.jsxs(dn,{children:[r.jsx(xe,{path:"/",element:r.jsx(Na,{})}),r.jsx(xe,{path:"/login",element:r.jsx(Sa,{})}),r.jsx(xe,{path:"/admin-login",element:r.jsx(Ca,{})}),r.jsx(xe,{path:"/dashboard",element:r.jsx(Ua,{})}),r.jsx(xe,{path:"/users/:username",element:r.jsx(Hl,{})}),r.jsx(xe,{path:"/create",element:r.jsx(Vl,{})}),r.jsx(xe,{path:"/admin",element:r.jsx(Wl,{})}),r.jsx(xe,{path:"/edit/:username",element:r.jsx(ql,{})}),r.jsx(xe,{path:"/callback",element:r.jsx(Kl,{})})]}),r.jsx(Yl,{})]})}qt.createRoot(document.getElementById("root")).render(r.jsx(an.StrictMode,{children:r.jsx(un,{children:r.jsx(Gl,{})})}));
