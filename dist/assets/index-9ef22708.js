var Fs=Object.defineProperty;var Hs=(e,t,r)=>t in e?Fs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ue=(e,t,r)=>(Hs(e,typeof t!="symbol"?t+"":t,r),r);import{r as j,a as Sn,g as at,b as Vs}from"./vendor-280e31ee.js";import{u as Ne,L as Oe,a as Cn,b as qs,c as Ws,R as Js,d as je,B as Ks}from"./router-a8409eb2.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();const Ys="modulepreload",Gs=function(e){return"/"+e},Dr={},Xs=function(t,r,n){if(!r||r.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(r.map(a=>{if(a=Gs(a),a in Dr)return;Dr[a]=!0;const i=a.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!n)for(let u=o.length-1;u>=0;u--){const f=o[u];if(f.href===a&&(!i||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":Ys,i||(d.as="script",d.crossOrigin=""),d.href=a,document.head.appendChild(d),i)return new Promise((u,f)=>{d.addEventListener("load",u),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a})};var kn={exports:{}},_t={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qs=j,Zs=Symbol.for("react.element"),eo=Symbol.for("react.fragment"),to=Object.prototype.hasOwnProperty,ro=Qs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,no={key:!0,ref:!0,__self:!0,__source:!0};function En(e,t,r){var n,o={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)to.call(t,n)&&!no.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:Zs,type:e,key:a,ref:i,props:o,_owner:ro.current}}_t.Fragment=eo;_t.jsx=En;_t.jsxs=En;kn.exports=_t;var s=kn.exports,ar={},zr=Sn;ar.createRoot=zr.createRoot,ar.hydrateRoot=zr.hydrateRoot;function _n(e,t){return function(){return e.apply(t,arguments)}}const{toString:so}=Object.prototype,{getPrototypeOf:Cr}=Object,{iterator:Tt,toStringTag:Tn}=Symbol,Rt=(e=>t=>{const r=so.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),me=e=>(e=e.toLowerCase(),t=>Rt(t)===e),Lt=e=>t=>typeof t===e,{isArray:We}=Array,et=Lt("undefined");function oo(e){return e!==null&&!et(e)&&e.constructor!==null&&!et(e.constructor)&&oe(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Rn=me("ArrayBuffer");function ao(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Rn(e.buffer),t}const io=Lt("string"),oe=Lt("function"),Ln=Lt("number"),At=e=>e!==null&&typeof e=="object",lo=e=>e===!0||e===!1,xt=e=>{if(Rt(e)!=="object")return!1;const t=Cr(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Tn in e)&&!(Tt in e)},co=me("Date"),uo=me("File"),ho=me("Blob"),fo=me("FileList"),mo=e=>At(e)&&oe(e.pipe),go=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||oe(e.append)&&((t=Rt(e))==="formdata"||t==="object"&&oe(e.toString)&&e.toString()==="[object FormData]"))},po=me("URLSearchParams"),[xo,bo,yo,wo]=["ReadableStream","Request","Response","Headers"].map(me),vo=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function it(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,o;if(typeof e!="object"&&(e=[e]),We(e))for(n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else{const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let l;for(n=0;n<i;n++)l=a[n],t.call(null,e[l],l,e)}}function An(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,o;for(;n-- >0;)if(o=r[n],t===o.toLowerCase())return o;return null}const Le=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),In=e=>!et(e)&&e!==Le;function ir(){const{caseless:e}=In(this)&&this||{},t={},r=(n,o)=>{const a=e&&An(t,o)||o;xt(t[a])&&xt(n)?t[a]=ir(t[a],n):xt(n)?t[a]=ir({},n):We(n)?t[a]=n.slice():t[a]=n};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&it(arguments[n],r);return t}const jo=(e,t,r,{allOwnKeys:n}={})=>(it(t,(o,a)=>{r&&oe(o)?e[a]=_n(o,r):e[a]=o},{allOwnKeys:n}),e),No=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),So=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Co=(e,t,r,n)=>{let o,a,i;const l={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)i=o[a],(!n||n(i,e,t))&&!l[i]&&(t[i]=e[i],l[i]=!0);e=r!==!1&&Cr(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},ko=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},Eo=e=>{if(!e)return null;if(We(e))return e;let t=e.length;if(!Ln(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},_o=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Cr(Uint8Array)),To=(e,t)=>{const n=(e&&e[Tt]).call(e);let o;for(;(o=n.next())&&!o.done;){const a=o.value;t.call(e,a[0],a[1])}},Ro=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},Lo=me("HTMLFormElement"),Ao=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,o){return n.toUpperCase()+o}),Fr=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),Io=me("RegExp"),Bn=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};it(r,(o,a)=>{let i;(i=t(o,a,e))!==!1&&(n[a]=i||o)}),Object.defineProperties(e,n)},Bo=e=>{Bn(e,(t,r)=>{if(oe(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(oe(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},$o=(e,t)=>{const r={},n=o=>{o.forEach(a=>{r[a]=!0})};return We(e)?n(e):n(String(e).split(t)),r},Po=()=>{},Uo=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Mo(e){return!!(e&&oe(e.append)&&e[Tn]==="FormData"&&e[Tt])}const Oo=e=>{const t=new Array(10),r=(n,o)=>{if(At(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[o]=n;const a=We(n)?[]:{};return it(n,(i,l)=>{const c=r(i,o+1);!et(c)&&(a[l]=c)}),t[o]=void 0,a}}return n};return r(e,0)},Do=me("AsyncFunction"),zo=e=>e&&(At(e)||oe(e))&&oe(e.then)&&oe(e.catch),$n=((e,t)=>e?setImmediate:t?((r,n)=>(Le.addEventListener("message",({source:o,data:a})=>{o===Le&&a===r&&n.length&&n.shift()()},!1),o=>{n.push(o),Le.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",oe(Le.postMessage)),Fo=typeof queueMicrotask<"u"?queueMicrotask.bind(Le):typeof process<"u"&&process.nextTick||$n,Ho=e=>e!=null&&oe(e[Tt]),w={isArray:We,isArrayBuffer:Rn,isBuffer:oo,isFormData:go,isArrayBufferView:ao,isString:io,isNumber:Ln,isBoolean:lo,isObject:At,isPlainObject:xt,isReadableStream:xo,isRequest:bo,isResponse:yo,isHeaders:wo,isUndefined:et,isDate:co,isFile:uo,isBlob:ho,isRegExp:Io,isFunction:oe,isStream:mo,isURLSearchParams:po,isTypedArray:_o,isFileList:fo,forEach:it,merge:ir,extend:jo,trim:vo,stripBOM:No,inherits:So,toFlatObject:Co,kindOf:Rt,kindOfTest:me,endsWith:ko,toArray:Eo,forEachEntry:To,matchAll:Ro,isHTMLForm:Lo,hasOwnProperty:Fr,hasOwnProp:Fr,reduceDescriptors:Bn,freezeMethods:Bo,toObjectSet:$o,toCamelCase:Ao,noop:Po,toFiniteNumber:Uo,findKey:An,global:Le,isContextDefined:In,isSpecCompliantForm:Mo,toJSONObject:Oo,isAsyncFn:Do,isThenable:zo,setImmediate:$n,asap:Fo,isIterable:Ho};function B(e,t,r,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}w.inherits(B,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:w.toJSONObject(this.config),code:this.code,status:this.status}}});const Pn=B.prototype,Un={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Un[e]={value:e}});Object.defineProperties(B,Un);Object.defineProperty(Pn,"isAxiosError",{value:!0});B.from=(e,t,r,n,o,a)=>{const i=Object.create(Pn);return w.toFlatObject(e,i,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),B.call(i,e.message,t,r,n,o),i.cause=e,i.name=e.name,a&&Object.assign(i,a),i};const Vo=null;function lr(e){return w.isPlainObject(e)||w.isArray(e)}function Mn(e){return w.endsWith(e,"[]")?e.slice(0,-2):e}function Hr(e,t,r){return e?e.concat(t).map(function(o,a){return o=Mn(o),!r&&a?"["+o+"]":o}).join(r?".":""):t}function qo(e){return w.isArray(e)&&!e.some(lr)}const Wo=w.toFlatObject(w,{},null,function(t){return/^is[A-Z]/.test(t)});function It(e,t,r){if(!w.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=w.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(h,g){return!w.isUndefined(g[h])});const n=r.metaTokens,o=r.visitor||u,a=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&w.isSpecCompliantForm(t);if(!w.isFunction(o))throw new TypeError("visitor must be a function");function d(m){if(m===null)return"";if(w.isDate(m))return m.toISOString();if(w.isBoolean(m))return m.toString();if(!c&&w.isBlob(m))throw new B("Blob is not supported. Use a Buffer instead.");return w.isArrayBuffer(m)||w.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,h,g){let b=m;if(m&&!g&&typeof m=="object"){if(w.endsWith(h,"{}"))h=n?h:h.slice(0,-2),m=JSON.stringify(m);else if(w.isArray(m)&&qo(m)||(w.isFileList(m)||w.endsWith(h,"[]"))&&(b=w.toArray(m)))return h=Mn(h),b.forEach(function(N,y){!(w.isUndefined(N)||N===null)&&t.append(i===!0?Hr([h],y,a):i===null?h:h+"[]",d(N))}),!1}return lr(m)?!0:(t.append(Hr(g,h,a),d(m)),!1)}const f=[],p=Object.assign(Wo,{defaultVisitor:u,convertValue:d,isVisitable:lr});function x(m,h){if(!w.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+h.join("."));f.push(m),w.forEach(m,function(b,v){(!(w.isUndefined(b)||b===null)&&o.call(t,b,w.isString(v)?v.trim():v,h,p))===!0&&x(b,h?h.concat(v):[v])}),f.pop()}}if(!w.isObject(e))throw new TypeError("data must be an object");return x(e),t}function Vr(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function kr(e,t){this._pairs=[],e&&It(e,this,t)}const On=kr.prototype;On.append=function(t,r){this._pairs.push([t,r])};On.toString=function(t){const r=t?function(n){return t.call(this,n,Vr)}:Vr;return this._pairs.map(function(o){return r(o[0])+"="+r(o[1])},"").join("&")};function Jo(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Dn(e,t,r){if(!t)return e;const n=r&&r.encode||Jo;w.isFunction(r)&&(r={serialize:r});const o=r&&r.serialize;let a;if(o?a=o(t,r):a=w.isURLSearchParams(t)?t.toString():new kr(t,r).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class Ko{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){w.forEach(this.handlers,function(n){n!==null&&t(n)})}}const qr=Ko,zn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Yo=typeof URLSearchParams<"u"?URLSearchParams:kr,Go=typeof FormData<"u"?FormData:null,Xo=typeof Blob<"u"?Blob:null,Qo={isBrowser:!0,classes:{URLSearchParams:Yo,FormData:Go,Blob:Xo},protocols:["http","https","file","blob","url","data"]},Er=typeof window<"u"&&typeof document<"u",cr=typeof navigator=="object"&&navigator||void 0,Zo=Er&&(!cr||["ReactNative","NativeScript","NS"].indexOf(cr.product)<0),ea=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),ta=Er&&window.location.href||"http://localhost",ra=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Er,hasStandardBrowserEnv:Zo,hasStandardBrowserWebWorkerEnv:ea,navigator:cr,origin:ta},Symbol.toStringTag,{value:"Module"})),Z={...ra,...Qo};function na(e,t){return It(e,new Z.classes.URLSearchParams,Object.assign({visitor:function(r,n,o,a){return Z.isNode&&w.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function sa(e){return w.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function oa(e){const t={},r=Object.keys(e);let n;const o=r.length;let a;for(n=0;n<o;n++)a=r[n],t[a]=e[a];return t}function Fn(e){function t(r,n,o,a){let i=r[a++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),c=a>=r.length;return i=!i&&w.isArray(o)?o.length:i,c?(w.hasOwnProp(o,i)?o[i]=[o[i],n]:o[i]=n,!l):((!o[i]||!w.isObject(o[i]))&&(o[i]=[]),t(r,n,o[i],a)&&w.isArray(o[i])&&(o[i]=oa(o[i])),!l)}if(w.isFormData(e)&&w.isFunction(e.entries)){const r={};return w.forEachEntry(e,(n,o)=>{t(sa(n),o,r,0)}),r}return null}function aa(e,t,r){if(w.isString(e))try{return(t||JSON.parse)(e),w.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const _r={transitional:zn,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",o=n.indexOf("application/json")>-1,a=w.isObject(t);if(a&&w.isHTMLForm(t)&&(t=new FormData(t)),w.isFormData(t))return o?JSON.stringify(Fn(t)):t;if(w.isArrayBuffer(t)||w.isBuffer(t)||w.isStream(t)||w.isFile(t)||w.isBlob(t)||w.isReadableStream(t))return t;if(w.isArrayBufferView(t))return t.buffer;if(w.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return na(t,this.formSerializer).toString();if((l=w.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return It(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return a||o?(r.setContentType("application/json",!1),aa(t)):t}],transformResponse:[function(t){const r=this.transitional||_r.transitional,n=r&&r.forcedJSONParsing,o=this.responseType==="json";if(w.isResponse(t)||w.isReadableStream(t))return t;if(t&&w.isString(t)&&(n&&!this.responseType||o)){const i=!(r&&r.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(l){if(i)throw l.name==="SyntaxError"?B.from(l,B.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Z.classes.FormData,Blob:Z.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};w.forEach(["delete","get","head","post","put","patch"],e=>{_r.headers[e]={}});const Tr=_r,ia=w.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),la=e=>{const t={};let r,n,o;return e&&e.split(`
`).forEach(function(i){o=i.indexOf(":"),r=i.substring(0,o).trim().toLowerCase(),n=i.substring(o+1).trim(),!(!r||t[r]&&ia[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Wr=Symbol("internals");function Xe(e){return e&&String(e).trim().toLowerCase()}function bt(e){return e===!1||e==null?e:w.isArray(e)?e.map(bt):String(e)}function ca(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const da=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Jt(e,t,r,n,o){if(w.isFunction(n))return n.call(this,t,r);if(o&&(t=r),!!w.isString(t)){if(w.isString(n))return t.indexOf(n)!==-1;if(w.isRegExp(n))return n.test(t)}}function ua(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function ha(e,t){const r=w.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(o,a,i){return this[n].call(this,t,o,a,i)},configurable:!0})})}class Bt{constructor(t){t&&this.set(t)}set(t,r,n){const o=this;function a(l,c,d){const u=Xe(c);if(!u)throw new Error("header name must be a non-empty string");const f=w.findKey(o,u);(!f||o[f]===void 0||d===!0||d===void 0&&o[f]!==!1)&&(o[f||c]=bt(l))}const i=(l,c)=>w.forEach(l,(d,u)=>a(d,u,c));if(w.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(w.isString(t)&&(t=t.trim())&&!da(t))i(la(t),r);else if(w.isObject(t)&&w.isIterable(t)){let l={},c,d;for(const u of t){if(!w.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?w.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}i(l,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=Xe(t),t){const n=w.findKey(this,t);if(n){const o=this[n];if(!r)return o;if(r===!0)return ca(o);if(w.isFunction(r))return r.call(this,o,n);if(w.isRegExp(r))return r.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Xe(t),t){const n=w.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||Jt(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let o=!1;function a(i){if(i=Xe(i),i){const l=w.findKey(n,i);l&&(!r||Jt(n,n[l],l,r))&&(delete n[l],o=!0)}}return w.isArray(t)?t.forEach(a):a(t),o}clear(t){const r=Object.keys(this);let n=r.length,o=!1;for(;n--;){const a=r[n];(!t||Jt(this,this[a],a,t,!0))&&(delete this[a],o=!0)}return o}normalize(t){const r=this,n={};return w.forEach(this,(o,a)=>{const i=w.findKey(n,a);if(i){r[i]=bt(o),delete r[a];return}const l=t?ua(a):String(a).trim();l!==a&&delete r[a],r[l]=bt(o),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return w.forEach(this,(n,o)=>{n!=null&&n!==!1&&(r[o]=t&&w.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(o=>n.set(o)),n}static accessor(t){const n=(this[Wr]=this[Wr]={accessors:{}}).accessors,o=this.prototype;function a(i){const l=Xe(i);n[l]||(ha(o,i),n[l]=!0)}return w.isArray(t)?t.forEach(a):a(t),this}}Bt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);w.reduceDescriptors(Bt.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});w.freezeMethods(Bt);const fe=Bt;function Kt(e,t){const r=this||Tr,n=t||r,o=fe.from(n.headers);let a=n.data;return w.forEach(e,function(l){a=l.call(r,a,o.normalize(),t?t.status:void 0)}),o.normalize(),a}function Hn(e){return!!(e&&e.__CANCEL__)}function Je(e,t,r){B.call(this,e??"canceled",B.ERR_CANCELED,t,r),this.name="CanceledError"}w.inherits(Je,B,{__CANCEL__:!0});function Vn(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new B("Request failed with status code "+r.status,[B.ERR_BAD_REQUEST,B.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function fa(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function ma(e,t){e=e||10;const r=new Array(e),n=new Array(e);let o=0,a=0,i;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=n[a];i||(i=d),r[o]=c,n[o]=d;let f=a,p=0;for(;f!==o;)p+=r[f++],f=f%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),d-i<t)return;const x=u&&d-u;return x?Math.round(p*1e3/x):void 0}}function ga(e,t){let r=0,n=1e3/t,o,a;const i=(d,u=Date.now())=>{r=u,o=null,a&&(clearTimeout(a),a=null),e.apply(null,d)};return[(...d)=>{const u=Date.now(),f=u-r;f>=n?i(d,u):(o=d,a||(a=setTimeout(()=>{a=null,i(o)},n-f)))},()=>o&&i(o)]}const vt=(e,t,r=3)=>{let n=0;const o=ma(50,250);return ga(a=>{const i=a.loaded,l=a.lengthComputable?a.total:void 0,c=i-n,d=o(c),u=i<=l;n=i;const f={loaded:i,total:l,progress:l?i/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-i)/d:void 0,event:a,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},Jr=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Kr=e=>(...t)=>w.asap(()=>e(...t)),pa=Z.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Z.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Z.origin),Z.navigator&&/(msie|trident)/i.test(Z.navigator.userAgent)):()=>!0,xa=Z.hasStandardBrowserEnv?{write(e,t,r,n,o,a){const i=[e+"="+encodeURIComponent(t)];w.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),w.isString(n)&&i.push("path="+n),w.isString(o)&&i.push("domain="+o),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ba(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function ya(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function qn(e,t,r){let n=!ba(t);return e&&(n||r==!1)?ya(e,t):t}const Yr=e=>e instanceof fe?{...e}:e;function Ie(e,t){t=t||{};const r={};function n(d,u,f,p){return w.isPlainObject(d)&&w.isPlainObject(u)?w.merge.call({caseless:p},d,u):w.isPlainObject(u)?w.merge({},u):w.isArray(u)?u.slice():u}function o(d,u,f,p){if(w.isUndefined(u)){if(!w.isUndefined(d))return n(void 0,d,f,p)}else return n(d,u,f,p)}function a(d,u){if(!w.isUndefined(u))return n(void 0,u)}function i(d,u){if(w.isUndefined(u)){if(!w.isUndefined(d))return n(void 0,d)}else return n(void 0,u)}function l(d,u,f){if(f in t)return n(d,u);if(f in e)return n(void 0,d)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(d,u,f)=>o(Yr(d),Yr(u),f,!0)};return w.forEach(Object.keys(Object.assign({},e,t)),function(u){const f=c[u]||o,p=f(e[u],t[u],u);w.isUndefined(p)&&f!==l||(r[u]=p)}),r}const Wn=e=>{const t=Ie({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:o,xsrfCookieName:a,headers:i,auth:l}=t;t.headers=i=fe.from(i),t.url=Dn(qn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(w.isFormData(r)){if(Z.hasStandardBrowserEnv||Z.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[d,...u]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...u].join("; "))}}if(Z.hasStandardBrowserEnv&&(n&&w.isFunction(n)&&(n=n(t)),n||n!==!1&&pa(t.url))){const d=o&&a&&xa.read(a);d&&i.set(o,d)}return t},wa=typeof XMLHttpRequest<"u",va=wa&&function(e){return new Promise(function(r,n){const o=Wn(e);let a=o.data;const i=fe.from(o.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=o,u,f,p,x,m;function h(){x&&x(),m&&m(),o.cancelToken&&o.cancelToken.unsubscribe(u),o.signal&&o.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(o.method.toUpperCase(),o.url,!0),g.timeout=o.timeout;function b(){if(!g)return;const N=fe.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),C={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:N,config:e,request:g};Vn(function(L){r(L),h()},function(L){n(L),h()},C),g=null}"onloadend"in g?g.onloadend=b:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(b)},g.onabort=function(){g&&(n(new B("Request aborted",B.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new B("Network Error",B.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let y=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const C=o.transitional||zn;o.timeoutErrorMessage&&(y=o.timeoutErrorMessage),n(new B(y,C.clarifyTimeoutError?B.ETIMEDOUT:B.ECONNABORTED,e,g)),g=null},a===void 0&&i.setContentType(null),"setRequestHeader"in g&&w.forEach(i.toJSON(),function(y,C){g.setRequestHeader(C,y)}),w.isUndefined(o.withCredentials)||(g.withCredentials=!!o.withCredentials),l&&l!=="json"&&(g.responseType=o.responseType),d&&([p,m]=vt(d,!0),g.addEventListener("progress",p)),c&&g.upload&&([f,x]=vt(c),g.upload.addEventListener("progress",f),g.upload.addEventListener("loadend",x)),(o.cancelToken||o.signal)&&(u=N=>{g&&(n(!N||N.type?new Je(null,e,g):N),g.abort(),g=null)},o.cancelToken&&o.cancelToken.subscribe(u),o.signal&&(o.signal.aborted?u():o.signal.addEventListener("abort",u)));const v=fa(o.url);if(v&&Z.protocols.indexOf(v)===-1){n(new B("Unsupported protocol "+v+":",B.ERR_BAD_REQUEST,e));return}g.send(a||null)})},ja=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,o;const a=function(d){if(!o){o=!0,l();const u=d instanceof Error?d:this.reason;n.abort(u instanceof B?u:new Je(u instanceof Error?u.message:u))}};let i=t&&setTimeout(()=>{i=null,a(new B(`timeout ${t} of ms exceeded`,B.ETIMEDOUT))},t);const l=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(a):d.removeEventListener("abort",a)}),e=null)};e.forEach(d=>d.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>w.asap(l),c}},Na=ja,Sa=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let n=0,o;for(;n<r;)o=n+t,yield e.slice(n,o),n=o},Ca=async function*(e,t){for await(const r of ka(e))yield*Sa(r,t)},ka=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},Gr=(e,t,r,n)=>{const o=Ca(e,t);let a=0,i,l=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await o.next();if(d){l(),c.close();return}let f=u.byteLength;if(r){let p=a+=f;r(p)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),o.return()}},{highWaterMark:2})},$t=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Jn=$t&&typeof ReadableStream=="function",Ea=$t&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Kn=(e,...t)=>{try{return!!e(...t)}catch{return!1}},_a=Jn&&Kn(()=>{let e=!1;const t=new Request(Z.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Xr=64*1024,dr=Jn&&Kn(()=>w.isReadableStream(new Response("").body)),jt={stream:dr&&(e=>e.body)};$t&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!jt[t]&&(jt[t]=w.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new B(`Response type '${t}' is not supported`,B.ERR_NOT_SUPPORT,n)})})})(new Response);const Ta=async e=>{if(e==null)return 0;if(w.isBlob(e))return e.size;if(w.isSpecCompliantForm(e))return(await new Request(Z.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(w.isArrayBufferView(e)||w.isArrayBuffer(e))return e.byteLength;if(w.isURLSearchParams(e)&&(e=e+""),w.isString(e))return(await Ea(e)).byteLength},Ra=async(e,t)=>{const r=w.toFiniteNumber(e.getContentLength());return r??Ta(t)},La=$t&&(async e=>{let{url:t,method:r,data:n,signal:o,cancelToken:a,timeout:i,onDownloadProgress:l,onUploadProgress:c,responseType:d,headers:u,withCredentials:f="same-origin",fetchOptions:p}=Wn(e);d=d?(d+"").toLowerCase():"text";let x=Na([o,a&&a.toAbortSignal()],i),m;const h=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let g;try{if(c&&_a&&r!=="get"&&r!=="head"&&(g=await Ra(u,n))!==0){let C=new Request(t,{method:"POST",body:n,duplex:"half"}),T;if(w.isFormData(n)&&(T=C.headers.get("content-type"))&&u.setContentType(T),C.body){const[L,_]=Jr(g,vt(Kr(c)));n=Gr(C.body,Xr,L,_)}}w.isString(f)||(f=f?"include":"omit");const b="credentials"in Request.prototype;m=new Request(t,{...p,signal:x,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:b?f:void 0});let v=await fetch(m,p);const N=dr&&(d==="stream"||d==="response");if(dr&&(l||N&&h)){const C={};["status","statusText","headers"].forEach(R=>{C[R]=v[R]});const T=w.toFiniteNumber(v.headers.get("content-length")),[L,_]=l&&Jr(T,vt(Kr(l),!0))||[];v=new Response(Gr(v.body,Xr,L,()=>{_&&_(),h&&h()}),C)}d=d||"text";let y=await jt[w.findKey(jt,d)||"text"](v,e);return!N&&h&&h(),await new Promise((C,T)=>{Vn(C,T,{data:y,headers:fe.from(v.headers),status:v.status,statusText:v.statusText,config:e,request:m})})}catch(b){throw h&&h(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new B("Network Error",B.ERR_NETWORK,e,m),{cause:b.cause||b}):B.from(b,b&&b.code,e,m)}}),ur={http:Vo,xhr:va,fetch:La};w.forEach(ur,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Qr=e=>`- ${e}`,Aa=e=>w.isFunction(e)||e===null||e===!1,Yn={getAdapter:e=>{e=w.isArray(e)?e:[e];const{length:t}=e;let r,n;const o={};for(let a=0;a<t;a++){r=e[a];let i;if(n=r,!Aa(r)&&(n=ur[(i=String(r)).toLowerCase()],n===void 0))throw new B(`Unknown adapter '${i}'`);if(n)break;o[i||"#"+a]=n}if(!n){const a=Object.entries(o).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=t?a.length>1?`since :
`+a.map(Qr).join(`
`):" "+Qr(a[0]):"as no adapter specified";throw new B("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:ur};function Yt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Je(null,e)}function Zr(e){return Yt(e),e.headers=fe.from(e.headers),e.data=Kt.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Yn.getAdapter(e.adapter||Tr.adapter)(e).then(function(n){return Yt(e),n.data=Kt.call(e,e.transformResponse,n),n.headers=fe.from(n.headers),n},function(n){return Hn(n)||(Yt(e),n&&n.response&&(n.response.data=Kt.call(e,e.transformResponse,n.response),n.response.headers=fe.from(n.response.headers))),Promise.reject(n)})}const Gn="1.10.0",Pt={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Pt[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const en={};Pt.transitional=function(t,r,n){function o(a,i){return"[Axios v"+Gn+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,l)=>{if(t===!1)throw new B(o(i," has been removed"+(r?" in "+r:"")),B.ERR_DEPRECATED);return r&&!en[i]&&(en[i]=!0,console.warn(o(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,l):!0}};Pt.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Ia(e,t,r){if(typeof e!="object")throw new B("options must be an object",B.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let o=n.length;for(;o-- >0;){const a=n[o],i=t[a];if(i){const l=e[a],c=l===void 0||i(l,a,e);if(c!==!0)throw new B("option "+a+" must be "+c,B.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new B("Unknown option "+a,B.ERR_BAD_OPTION)}}const yt={assertOptions:Ia,validators:Pt},ge=yt.validators;class Nt{constructor(t){this.defaults=t||{},this.interceptors={request:new qr,response:new qr}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Ie(this.defaults,r);const{transitional:n,paramsSerializer:o,headers:a}=r;n!==void 0&&yt.assertOptions(n,{silentJSONParsing:ge.transitional(ge.boolean),forcedJSONParsing:ge.transitional(ge.boolean),clarifyTimeoutError:ge.transitional(ge.boolean)},!1),o!=null&&(w.isFunction(o)?r.paramsSerializer={serialize:o}:yt.assertOptions(o,{encode:ge.function,serialize:ge.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),yt.assertOptions(r,{baseUrl:ge.spelling("baseURL"),withXsrfToken:ge.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&w.merge(a.common,a[r.method]);a&&w.forEach(["delete","get","head","post","put","patch","common"],m=>{delete a[m]}),r.headers=fe.concat(i,a);const l=[];let c=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(r)===!1||(c=c&&h.synchronous,l.unshift(h.fulfilled,h.rejected))});const d=[];this.interceptors.response.forEach(function(h){d.push(h.fulfilled,h.rejected)});let u,f=0,p;if(!c){const m=[Zr.bind(this),void 0];for(m.unshift.apply(m,l),m.push.apply(m,d),p=m.length,u=Promise.resolve(r);f<p;)u=u.then(m[f++],m[f++]);return u}p=l.length;let x=r;for(f=0;f<p;){const m=l[f++],h=l[f++];try{x=m(x)}catch(g){h.call(this,g);break}}try{u=Zr.call(this,x)}catch(m){return Promise.reject(m)}for(f=0,p=d.length;f<p;)u=u.then(d[f++],d[f++]);return u}getUri(t){t=Ie(this.defaults,t);const r=qn(t.baseURL,t.url,t.allowAbsoluteUrls);return Dn(r,t.params,t.paramsSerializer)}}w.forEach(["delete","get","head","options"],function(t){Nt.prototype[t]=function(r,n){return this.request(Ie(n||{},{method:t,url:r,data:(n||{}).data}))}});w.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,l){return this.request(Ie(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}Nt.prototype[t]=r(),Nt.prototype[t+"Form"]=r(!0)});const wt=Nt;class Rr{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(o=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](o);n._listeners=null}),this.promise.then=o=>{let a;const i=new Promise(l=>{n.subscribe(l),a=l}).then(o);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,l){n.reason||(n.reason=new Je(a,i,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Rr(function(o){t=o}),cancel:t}}}const Ba=Rr;function $a(e){return function(r){return e.apply(null,r)}}function Pa(e){return w.isObject(e)&&e.isAxiosError===!0}const hr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hr).forEach(([e,t])=>{hr[t]=e});const Ua=hr;function Xn(e){const t=new wt(e),r=_n(wt.prototype.request,t);return w.extend(r,wt.prototype,t,{allOwnKeys:!0}),w.extend(r,t,null,{allOwnKeys:!0}),r.create=function(o){return Xn(Ie(e,o))},r}const G=Xn(Tr);G.Axios=wt;G.CanceledError=Je;G.CancelToken=Ba;G.isCancel=Hn;G.VERSION=Gn;G.toFormData=It;G.AxiosError=B;G.Cancel=G.CanceledError;G.all=function(t){return Promise.all(t)};G.spread=$a;G.isAxiosError=Pa;G.mergeConfig=Ie;G.AxiosHeaders=fe;G.formToJSON=e=>Fn(w.isHTMLForm(e)?new FormData(e):e);G.getAdapter=Yn.getAdapter;G.HttpStatusCode=Ua;G.default=G;const Ma=G,tn="4bf253f4685945a5b0c15b8580c167cb",Gt=()=>{if({}.VITE_SPOTIFY_REDIRECT_URI)return{}.VITE_SPOTIFY_REDIRECT_URI;if(typeof window<"u"){const{protocol:e,hostname:t}=window.location;return`${e}//${t}/callback`}if(typeof window<"u"){const{protocol:e,hostname:t,port:r}=window.location;return t==="localhost"||t==="127.0.0.1"?`${e}//${t}:${r||"5173"}/callback`:`${e}//${t}/callback`}throw new Error("本番環境では VITE_SPOTIFY_REDIRECT_URI を設定してください")},Me="https://api.spotify.com/v1",Oa="https://accounts.spotify.com/authorize",Da="https://accounts.spotify.com/api/token",za=["user-read-private","user-read-email"].join(" ");function Fa(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=new Uint8Array(128);return crypto.getRandomValues(r),Array.from(r,o=>e[o%e.length]).join("")}async function Ha(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r);return btoa(String.fromCharCode(...new Uint8Array(n))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const Qn={getCurrentRedirectUri:()=>Gt(),getAuthUrl:async()=>{const e=Fa(),t=await Ha(e),r=Gt(),n=qa(32),o=Date.now(),a={codeVerifier:e,timestamp:o,state:n};localStorage.setItem(`spotify_auth_${n}`,JSON.stringify(a)),localStorage.setItem("spotify_current_state",n);const i=new URLSearchParams({client_id:tn,response_type:"code",redirect_uri:r,scope:za,code_challenge_method:"S256",code_challenge:t,state:n});return`${Oa}?${i.toString()}`},getAccessToken:async(e,t)=>{if(!t){const c=localStorage.getItem("spotify_current_state");c&&(t=c)}let r=null,n=null;if(t){const c=localStorage.getItem(`spotify_auth_${t}`);if(c)try{const d=JSON.parse(c);r=d.codeVerifier,n=d.timestamp,console.log("✅ State対応認証データ取得成功:",{state:t.substring(0,10)+"...",hasCodeVerifier:!!r,作成時刻:n?new Date(n).toLocaleTimeString():"unknown"})}catch(d){console.error("❌ 認証データ解析エラー:",d)}}if(!r){r=localStorage.getItem("spotify_code_verifier");const c=localStorage.getItem("spotify_code_verifier_timestamp");c&&(n=parseInt(c)),r&&console.log("⚠️ フォールバック: 古い方式でcode_verifier取得")}if(!r)throw new Error("Code verifier not found - 認証を最初からやり直してください");if(n){const c=Date.now(),d=Math.floor((c-n)/6e4);console.log("🕐 Code Verifier時間確認:",{作成時刻:new Date(n).toLocaleTimeString(),現在時刻:new Date(c).toLocaleTimeString(),経過時間:`${d}分`,制限時間:"10分"}),d>10&&console.warn("⚠️ Code Verifierが10分以上経過しています")}const o=Gt(),a={grant_type:"authorization_code",code:e,redirect_uri:o,client_id:tn,code_verifier:r};console.log("🔄 トークン交換リクエスト開始..."),console.log(`   Redirect URI: ${o}`),console.log("   Client ID: 設定済み"),console.log(`   認証コード: ${e.substring(0,10)}...`),console.log(`   Code Verifier: ${r?"設定済み":"❌ 未設定"}`),console.log(`   Code Verifier長さ: ${r?r.length:0}`),console.log(`   Code Verifier先頭: ${r?r.substring(0,15)+"...":"なし"}`);const i=await fetch(Da,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a)});if(t&&localStorage.removeItem(`spotify_auth_${t}`),localStorage.removeItem("spotify_current_state"),localStorage.removeItem("spotify_code_verifier"),localStorage.removeItem("spotify_code_verifier_timestamp"),!i.ok){t&&localStorage.removeItem(`spotify_auth_${t}`),localStorage.removeItem("spotify_current_state"),localStorage.removeItem("spotify_code_verifier"),localStorage.removeItem("spotify_code_verifier_timestamp");let c="Unknown error";try{const d=await i.json();c=JSON.stringify(d,null,2),console.error("❌ Token exchange失敗:",d)}catch{console.error("❌ Token exchange失敗: レスポンス解析エラー")}throw new Error(`Failed to get access token: ${i.status} - ${c}`)}const l=await i.json();return console.log("✅ Token exchange成功!"),l.access_token}},ke={buildOptimizedQuery:(e,t="track")=>{let r=e.trim();return/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(r)||t==="track"&&r.includes(" ")&&!r.includes("track:")&&!r.includes("artist:")&&r.split(" ").length>=2,r},searchAlbums:async(e,t,r=10)=>{var c;const n=ke.buildOptimizedQuery(e,"album"),a=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(e)?"&market=JP":"",i=await fetch(`${Me}/search?q=${encodeURIComponent(n)}&type=album&limit=${r}${a}`,{headers:{Authorization:`Bearer ${t}`}});if(!i.ok){const d=await i.json().catch(()=>({}));throw new Error(`Failed to search albums: ${i.status} ${((c=d.error)==null?void 0:c.message)||""}`)}return(await i.json()).albums.items.map(d=>{var u,f;return{id:d.id,name:d.name,artist:((u=d.artists[0])==null?void 0:u.name)||"Unknown Artist",image:((f=d.images[0])==null?void 0:f.url)||null,releaseDate:d.release_date,totalTracks:d.total_tracks,spotifyUrl:d.external_urls.spotify}})},searchTracks:async(e,t,r=10)=>{var c;const n=ke.buildOptimizedQuery(e,"track"),a=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(e)?"&market=JP":"",i=await fetch(`${Me}/search?q=${encodeURIComponent(n)}&type=track&limit=${r}${a}`,{headers:{Authorization:`Bearer ${t}`}});if(!i.ok){const d=await i.json().catch(()=>({}));throw new Error(`Failed to search tracks: ${i.status} ${((c=d.error)==null?void 0:c.message)||""}`)}return(await i.json()).tracks.items.map(d=>{var u,f,p,x;return{id:d.id,name:d.name,artist:((u=d.artists[0])==null?void 0:u.name)||"Unknown Artist",album:((f=d.album)==null?void 0:f.name)||"Unknown Album",image:((x=(p=d.album)==null?void 0:p.images[0])==null?void 0:x.url)||null,duration:d.duration_ms,previewUrl:d.preview_url,spotifyUrl:d.external_urls.spotify}})},searchTracksAdvanced:async(e,t,r,n=5)=>{const a=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(e+t)?"&market=JP":"",i=`track:"${e}" artist:"${t}"`,l=await fetch(`${Me}/search?q=${encodeURIComponent(i)}&type=track&limit=${n}${a}`,{headers:{Authorization:`Bearer ${r}`}});if(!l.ok){const d=`${e} ${t}`;return ke.searchTracks(d,r,n)}return(await l.json()).tracks.items.map(d=>{var u,f,p,x;return{id:d.id,name:d.name,artist:((u=d.artists[0])==null?void 0:u.name)||"Unknown Artist",album:((f=d.album)==null?void 0:f.name)||"Unknown Album",image:((x=(p=d.album)==null?void 0:p.images[0])==null?void 0:x.url)||null,duration:d.duration_ms,previewUrl:d.preview_url,spotifyUrl:d.external_urls.spotify}})},searchArtists:async(e,t,r=10)=>{const n=await fetch(`${Me}/search?q=${encodeURIComponent(e)}&type=artist&limit=${r}`,{headers:{Authorization:`Bearer ${t}`}});if(!n.ok)throw new Error("Failed to search artists");return(await n.json()).artists.items.map(a=>{var i,l;return{id:a.id,name:a.name,image:((i=a.images[0])==null?void 0:i.url)||null,followers:((l=a.followers)==null?void 0:l.total)||0,genres:a.genres||[],spotifyUrl:a.external_urls.spotify}})}},Va={getPreviewUrl:(e,t)=>`${Me}/tracks/${e}`,getUserPlaylists:async e=>{const t=await fetch(`${Me}/me/playlists`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error("Failed to get playlists");return(await t.json()).items.map(n=>{var o;return{id:n.id,name:n.name,description:n.description,image:((o=n.images[0])==null?void 0:o.url)||null,tracksCount:n.tracks.total,spotifyUrl:n.external_urls.spotify}})}};function qa(e){if(typeof crypto<"u"&&crypto.getRandomValues){const n=new Uint32Array(e);crypto.getRandomValues(n);const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return Array.from(n,a=>o[a%o.length]).join("")}const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let r="";for(let n=0;n<e;n++)r+=t.charAt(Math.floor(Math.random()*t.length));return r}const Wa=Object.freeze(Object.defineProperty({__proto__:null,spotifyAuth:Qn,spotifyPreview:Va,spotifySearch:ke},Symbol.toStringTag,{value:"Module"}));let Zn=[];const Ja=()=>{Zn=[]},xe=(e,t,r,n)=>{const o={provider:e,success:t,error:r,fallbackReason:n,timestamp:Date.now()};Zn.push(o),t?console.log(`✅ ${e.toUpperCase()}検索成功`):(console.error(`❌ ${e.toUpperCase()}検索失敗:`,r),n&&console.warn(`🔄 フォールバック理由: ${n}`))};let pe="spotify";const es=e=>{pe=e,console.log(`🔄 音楽検索プロバイダーを ${e.toUpperCase()} に切り替えました`)},Ka="abfe3677d7f2a1b357dc58df96ede541",Ya="https://ws.audioscrobbler.com/2.0/",ts="4bf253f4685945a5b0c15b8580c167cb",rn=e=>!!(e&&e.trim()!==""&&!e.includes("2a96cbd8b46e442fc41c2b86b821562f"));let Ae=null;const Ga=()=>{const e=localStorage.getItem("spotify_access_token");e&&(Ae=e,console.log("Spotify トークンをローカルストレージから復元しました"),es("spotify"))};Ga();const rs=e=>{Ae=e,localStorage.setItem("spotify_access_token",e),console.log("Spotify アクセストークンが設定されました")},Xa=()=>{Ae=null,localStorage.removeItem("spotify_access_token"),localStorage.removeItem("spotify_refresh_token"),localStorage.removeItem("spotify_token_expires"),console.log("Spotify アクセストークンを削除しました")};async function Qa(){const e=localStorage.getItem("spotify_refresh_token");if(!e)throw new Error("リフレッシュトークンがありません");const t=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Basic ${btoa(`${ts}:${{}.VITE_SPOTIFY_CLIENT_SECRET||""}`)}`},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:e})});if(!t.ok){const n=await t.json();throw new Error(`Token refresh failed: ${n.error_description||n.error}`)}const r=await t.json();return rs(r.access_token),localStorage.setItem("spotify_token_expires",(Date.now()+r.expires_in*1e3).toString()),r.refresh_token&&localStorage.setItem("spotify_refresh_token",r.refresh_token),console.log("✅ Spotifyトークンをリフレッシュしました"),r.access_token}async function Za(){if(!Ae)return console.log("❌ アクセストークンが設定されていません"),null;const e=localStorage.getItem("spotify_token_expires");if(!e)return console.log("❌ トークンの有効期限情報がありません"),Ae;const t=Date.now(),r=parseInt(e);if(t>=r-5*60*1e3){console.log("🔄 トークンの有効期限が近いため、リフレッシュします");try{return await Qa()}catch(n){return console.error("❌ トークンリフレッシュに失敗:",n),Xa(),null}}return Ae}const nn=async e=>{var r,n,o,a,i;Ja();const t=await Za();if(!t){const l="Spotify アクセストークンが設定されていないか、リフレッシュに失敗しました";return xe("spotify",!1,l,`${l}。Last.fmにフォールバックします。`),St(e)}try{const l=[],c=e.trim().split(/\s+/),d=c.length>=2,u=await ke.searchTracks(e,t,7),f=await ke.searchAlbums(e,t,3);let p=[];if(d&&c.length<=4)try{const m=c.slice(0,Math.ceil(c.length/2)).join(" "),h=c.slice(Math.ceil(c.length/2)).join(" ");p=await ke.searchTracksAdvanced(m,h,t,3)}catch(m){console.log("Spotify詳細検索失敗（通常の検索結果を使用）:",m)}const x=new Set;return p.forEach(m=>{x.has(m.id)||(l.push({name:m.name,artist:m.artist,image:m.image||void 0,url:m.spotifyUrl,isGeneratedImage:!m.image,provider:"spotify",id:m.id}),x.add(m.id))}),u.forEach(m=>{x.has(m.id)||(l.push({name:m.name,artist:m.artist,image:m.image||void 0,url:m.spotifyUrl,isGeneratedImage:!m.image,provider:"spotify",id:m.id}),x.add(m.id))}),f.forEach(m=>{x.has(m.id)||(l.push({name:m.name,artist:m.artist,image:m.image||void 0,url:m.spotifyUrl,isGeneratedImage:!m.image,provider:"spotify",id:m.id}),x.add(m.id))}),xe("spotify",!0),console.log(`Spotify検索完了: ${l.length}件の結果`),l.slice(0,10)}catch(l){const c=((o=(n=(r=l==null?void 0:l.response)==null?void 0:r.data)==null?void 0:n.error)==null?void 0:o.message)||(l==null?void 0:l.message)||"Spotify API呼び出しに失敗しました",d=(a=l==null?void 0:l.response)==null?void 0:a.status,u=d?`HTTP ${d}: ${c}`:c;return xe("spotify",!1,u,"Spotify検索でエラーが発生したため、Last.fmにフォールバックします"),console.error("Spotify検索エラー詳細:",{status:d,message:c,response:(i=l==null?void 0:l.response)==null?void 0:i.data,error:l}),St(e)}},St=async e=>{var t,r,n,o,a,i;try{const l=e.trim();console.log(`Last.fm検索実行: "${l}"`);const d=((r=(t=(await Ma.get(Ya,{params:{method:"track.search",track:l,api_key:Ka,format:"json",limit:15}})).data.results)==null?void 0:t.trackmatches)==null?void 0:r.track)||[];return xe("lastfm",!0),console.log(`Last.fm検索結果: ${d.length}件`),Array.isArray(d)?d.map(u=>{var x,m,h,g,b,v;const f=((m=(x=u.image)==null?void 0:x[3])==null?void 0:m["#text"])||((g=(h=u.image)==null?void 0:h[2])==null?void 0:g["#text"])||((v=(b=u.image)==null?void 0:b[1])==null?void 0:v["#text"])||"",p=ei(u.name,u.artist);return{name:u.name,artist:u.artist,image:rn(f)?f:p.image,url:u.url,isGeneratedImage:!rn(f),provider:"lastfm"}}):(xe("lastfm",!1,"Last.fm APIの応答形式が予期しない形式です","レスポンスデータの構造が変更された可能性があります"),[])}catch(l){const c=((o=(n=l==null?void 0:l.response)==null?void 0:n.data)==null?void 0:o.message)||(l==null?void 0:l.message)||"Last.fm API呼び出しに失敗しました",d=(a=l==null?void 0:l.response)==null?void 0:a.status,u=d?`HTTP ${d}: ${c}`:c;return xe("lastfm",!1,u,"Last.fm APIでエラーが発生しました"),console.error("Last.fm検索エラー詳細:",{status:d,message:c,response:(i=l==null?void 0:l.response)==null?void 0:i.data,error:l}),[]}},ei=(e,t)=>({image:`https://picsum.photos/300/300?random=${Math.floor(Math.random()*1e3)}`,isGenerated:!0}),ti=[{name:"Bohemian Rhapsody",artist:"Queen",image:"https://picsum.photos/300/300?random=1",isGeneratedImage:!0,provider:"lastfm"},{name:"Hotel California",artist:"Eagles",image:"https://picsum.photos/300/300?random=2",isGeneratedImage:!0,provider:"lastfm"},{name:"Imagine",artist:"John Lennon",image:"https://picsum.photos/300/300?random=3",isGeneratedImage:!0,provider:"lastfm"},{name:"Stairway to Heaven",artist:"Led Zeppelin",image:"https://picsum.photos/300/300?random=4",isGeneratedImage:!0,provider:"lastfm"},{name:"Yesterday",artist:"The Beatles",image:"https://picsum.photos/300/300?random=5",isGeneratedImage:!0,provider:"lastfm"},{name:"Smells Like Teen Spirit",artist:"Nirvana",image:"https://picsum.photos/300/300?random=6",isGeneratedImage:!0,provider:"lastfm"},{name:"Like a Rolling Stone",artist:"Bob Dylan",image:"https://picsum.photos/300/300?random=7",isGeneratedImage:!0,provider:"lastfm"},{name:"I Want to Hold Your Hand",artist:"The Beatles",image:"https://picsum.photos/300/300?random=8",isGeneratedImage:!0,provider:"lastfm"},{name:"Johnny B. Goode",artist:"Chuck Berry",image:"https://picsum.photos/300/300?random=9",isGeneratedImage:!0,provider:"lastfm"},{name:"Good Vibrations",artist:"The Beach Boys",image:"https://picsum.photos/300/300?random=10",isGeneratedImage:!0,provider:"lastfm"}],ri=async e=>{const t=ti.filter(r=>r.name.toLowerCase().includes(e.toLowerCase())||r.artist.toLowerCase().includes(e.toLowerCase()));return await new Promise(r=>setTimeout(r,300)),t},ni=()=>{const e=[];return ts&&Ae&&e.push("spotify"),e.push("lastfm"),e},si=async e=>{const t=ni();if(console.log(`🔍 音楽検索開始: "${e}"`),console.log(`📋 利用可能プロバイダー: ${t.map(r=>r.toUpperCase()).join(", ")}`),console.log(`⚙️ 現在のプロバイダー: ${pe.toUpperCase()}`),t.includes(pe))try{switch(pe){case"spotify":return await nn(e);case"lastfm":return await St(e);default:{const r=`未サポートのプロバイダー: ${pe}`;throw xe(pe,!1,r),new Error(r)}}}catch(r){console.error(`${pe.toUpperCase()}検索エラー:`,r)}else{const r=`${pe.toUpperCase()}は現在利用できません`;xe(pe,!1,r,r)}for(const r of t)if(r!==pe)try{switch(console.log(`🔄 ${r.toUpperCase()}にフォールバックします`),r){case"spotify":return await nn(e);case"lastfm":return await St(e)}}catch(n){const o=(n==null?void 0:n.message)||`${r}フォールバック失敗`;xe(r,!1,o,"フォールバック試行中にエラー"),console.error(`${r.toUpperCase()}フォールバック失敗:`,n)}return console.warn("⚠️ 全てのプロバイダーが利用不可。モックデータを使用します。"),xe("lastfm",!1,"全プロバイダー失敗","モックデータにフォールバック"),await ri(e)};async function oi(){const{spotifyAuth:e}=await Xs(()=>Promise.resolve().then(()=>Wa),void 0);return e.getAuthUrl()}function ai(){const e=Ne();return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:s.jsxs("div",{className:"container mx-auto px-4 py-16",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsxs("h1",{className:"text-7xl font-bold text-gray-900 mb-6",children:["Musi",s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-cyan-500",children:"Card"})]}),s.jsx("p",{className:"text-gray-600 text-xl mb-8 max-w-2xl mx-auto leading-relaxed",children:"好きな音で、あなたを彩ろう"}),s.jsx("div",{className:"flex justify-center gap-4 mb-8",children:s.jsx(Oe,{to:"/login",className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-8 py-4 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 hover:scale-105 text-lg shadow-lg hover:shadow-xl",children:"ログイン / 音楽名刺を作成"})}),s.jsx("div",{className:"flex justify-center",children:s.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg",children:[s.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"サンプル名刺をご覧ください"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx(Oe,{to:"/users/alice",className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-6 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 hover:scale-105 shadow-md hover:shadow-lg",children:"Aliceの名刺"}),s.jsx(Oe,{to:"/users/bob",className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-xl font-semibold hover:bg-gray-200 transition-all duration-300 hover:scale-105 border border-gray-200",children:"Bobの名刺"})]})]})})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-8 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl mx-auto mb-4 flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M18 3a1 1 0 00-1.447-.894L8.763 6H5a3 3 0 000 6h.28l1.771 5.316A1 1 0 008 18h1a1 1 0 001-1v-4.382l6.553 3.894A1 1 0 0018 16V3z",clipRule:"evenodd"})})}),s.jsx("h3",{className:"text-gray-900 font-semibold text-lg mb-2",children:"洗練されたデザイン"}),s.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"Topsters風のモダンで美しいレイアウト"})]}),s.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-xl mx-auto mb-4 flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})}),s.jsx("h3",{className:"text-gray-900 font-semibold text-lg mb-2",children:"簡単シェア"}),s.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"SNSのプロフィールに貼るだけで音楽の趣味を共有"})]}),s.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-400 to-cyan-400 rounded-xl mx-auto mb-4 flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),s.jsx("h3",{className:"text-gray-900 font-semibold text-lg mb-2",children:"どこでも表示"}),s.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"PC・スマートフォンどちらでも美しく表示"})]})]}),s.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-8 border border-blue-200/50 shadow-lg",children:[s.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-4",children:"🎵 音楽検索機能"}),s.jsx("p",{className:"text-blue-700 mb-4",children:"SpotifyとLast.fmの両方に対応した音楽検索で、豊富な楽曲データベースから選択できます。"}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"🎧 Spotify認証"}),s.jsx("p",{className:"text-blue-600 text-sm",children:"Spotifyにログインして、より豊富な音楽データベースにアクセス"})]}),s.jsxs("button",{onClick:async()=>{const t=await oi();window.open(t,"_blank")},className:"bg-green-500 text-white px-4 py-2 rounded-xl font-semibold hover:bg-green-600 transition-colors duration-300 flex items-center gap-2",children:[s.jsx("span",{children:"🎵"}),"Spotify連携"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[s.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"🎯 Spotify検索"}),s.jsx("p",{className:"text-blue-600 text-sm",children:"高精度な検索結果と豊富なメタデータ"})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[s.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"🔄 Last.fmフォールバック"}),s.jsx("p",{className:"text-blue-600 text-sm",children:"Spotifyで見つからない場合の自動フォールバック"})]})]})]}),!1,s.jsx("div",{className:"mt-16 pt-8 border-t border-gray-200/50",children:s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:()=>e("/admin-login"),className:"text-xs text-gray-300 hover:text-gray-500 transition-colors px-2 py-1 rounded opacity-50 hover:opacity-100",title:"管理者ログイン",children:"⚙️"})})})]})})}function ii(){const e=Ne(),[t,r]=j.useState(""),[n,o]=j.useState(""),[a,i]=j.useState(!1),[l,c]=j.useState(!1),d=async u=>{if(u.preventDefault(),!(!t.trim()||!n.trim())){i(!0);try{const f=t.trim().toLowerCase(),p=localStorage.getItem(`musicard_auth_${f}`);if(p){if(JSON.parse(p).password!==n){alert("❌ パスワードが正しくありません");return}console.log(`✅ ユーザー「${t}」でログインしました`)}else if(l){const x={username:f,password:n,createdAt:new Date().toISOString()};localStorage.setItem(`musicard_auth_${f}`,JSON.stringify(x)),console.log(`🆕 新規ユーザー「${t}」を登録しました`)}else{alert("❌ ユーザーが見つかりません。新規登録をしてください。");return}localStorage.setItem("musicard_user",f),localStorage.setItem("musicard_login_time",Date.now().toString()),e("/dashboard")}catch(f){console.error("ログインエラー:",f),alert("ログインに失敗しました")}finally{i(!1)}}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:["Musi",s.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-cyan-500",children:"Card"})]}),s.jsx("p",{className:"text-gray-600",children:"音楽名刺でつながろう"})]}),s.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 mb-6",children:[s.jsx("button",{type:"button",onClick:()=>c(!1),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${l?"text-gray-600 hover:text-gray-800":"bg-white text-blue-600 shadow-sm"}`,children:"ログイン"}),s.jsx("button",{type:"button",onClick:()=>c(!0),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${l?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:"新規登録"})]}),s.jsxs("form",{onSubmit:d,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ユーザー名"}),s.jsx("input",{type:"text",value:t,onChange:u=>r(u.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"英数字でユーザー名を入力",required:!0,disabled:a})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"パスワード"}),s.jsx("input",{type:"password",value:n,onChange:u=>o(u.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"パスワードを入力",required:!0,disabled:a}),l&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"パスワードは安全に保管されます"})]}),s.jsx("button",{type:"submit",disabled:!t.trim()||!n.trim()||a,className:"w-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:a?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),l?"登録中...":"ログイン中..."]}):l?"新規登録":"ログイン"})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[s.jsx("p",{className:"text-sm text-gray-600 text-center mb-4",children:"または、ゲストとして閲覧"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>e("/users/alice"),className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Aliceの名刺"}),s.jsx("button",{onClick:()=>e("/users/bob"),className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Bobの名刺"})]})]}),!1]})})}function li(){const e=Ne(),[t,r]=j.useState(""),[n,o]=j.useState(""),[a,i]=j.useState(!1),l=async c=>{if(c.preventDefault(),!(!t.trim()||!n.trim())){i(!0);try{if(!({}.VITE_ADMIN_USERS||"admin").split(",").includes(t.toLowerCase())){alert("❌ 管理者権限がありません");return}const u=`musicard_admin_${t.toLowerCase()}`,f=localStorage.getItem(u);if(f){if(JSON.parse(f).password!==n){alert("❌ 管理者パスワードが正しくありません");return}}else{const p={username:t.toLowerCase(),password:n,role:"admin",createdAt:new Date().toISOString()};localStorage.setItem(u,JSON.stringify(p)),console.log(`🛡️ 管理者アカウント「${t}」を作成しました`)}localStorage.setItem("musicard_admin",t.toLowerCase()),localStorage.setItem("musicard_admin_login_time",Date.now().toString()),console.log(`🛡️ 管理者「${t}」でログインしました`),e("/admin")}catch(d){console.error("管理者ログインエラー:",d),alert("ログインに失敗しました")}finally{i(!1)}}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-white to-red-100 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border-t-4 border-red-500",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-red-500 rounded-full mx-auto mb-4 flex items-center justify-center",children:s.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"管理者ログイン"}),s.jsx("p",{className:"text-gray-600",children:"MusiCard Admin Panel"})]}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("svg",{className:"w-5 h-5 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})}),s.jsx("p",{className:"text-red-700 text-sm",children:"管理者のみアクセス可能です"})]})}),s.jsxs("form",{onSubmit:l,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"管理者ユーザー名"}),s.jsx("input",{type:"text",value:t,onChange:c=>r(c.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"管理者ユーザー名",required:!0,disabled:a})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"管理者パスワード"}),s.jsx("input",{type:"password",value:n,onChange:c=>o(c.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"管理者パスワード",required:!0,disabled:a})]}),s.jsx("button",{type:"submit",disabled:!t.trim()||!n.trim()||a,className:"w-full bg-gradient-to-r from-red-500 to-red-600 text-white py-3 rounded-lg font-semibold hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:a?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"ログイン中..."]}):"管理者ログイン"})]}),s.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center",children:s.jsx("button",{onClick:()=>e("/"),className:"text-gray-500 hover:text-gray-700 text-sm transition-colors",children:"← トップページに戻る"})}),!1]})})}const Be=[{id:"light",name:"ライト",background:"bg-gradient-to-br from-gray-50 to-gray-100",textPrimary:"text-gray-800",textSecondary:"text-gray-600",surface:"bg-white/80",surfaceHover:"bg-gray-100",border:"border-gray-300"},{id:"dark",name:"ダーク",background:"bg-black",textPrimary:"text-white",textSecondary:"text-white/80",surface:"bg-white/10",surfaceHover:"bg-white/20",border:"border-white/20"}],ze=[{id:"blue",name:"ブルー",gradient:"from-blue-500 to-blue-600",primary:"blue-500",secondary:"blue-100",primaryHex:"#3B82F6",secondaryHex:"#DBEAFE"},{id:"purple",name:"パープル",gradient:"from-purple-500 to-purple-600",primary:"purple-500",secondary:"purple-100",primaryHex:"#8B5CF6",secondaryHex:"#EDE9FE"},{id:"green",name:"グリーン",gradient:"from-green-500 to-green-600",primary:"green-500",secondary:"green-100",primaryHex:"#10B981",secondaryHex:"#DCFCE7"},{id:"pink",name:"ピンク",gradient:"from-pink-500 to-pink-600",primary:"pink-500",secondary:"pink-100",primaryHex:"#EC4899",secondaryHex:"#FCE7F3"},{id:"orange",name:"オレンジ",gradient:"from-orange-500 to-orange-600",primary:"orange-500",secondary:"orange-100",primaryHex:"#F97316",secondaryHex:"#FED7AA"},{id:"red",name:"レッド",gradient:"from-red-500 to-red-600",primary:"red-500",secondary:"red-100",primaryHex:"#EF4444",secondaryHex:"#FEE2E2"},{id:"indigo",name:"インディゴ",gradient:"from-indigo-500 to-indigo-600",primary:"indigo-500",secondary:"indigo-100",primaryHex:"#6366F1",secondaryHex:"#E0E7FF"},{id:"teal",name:"ティール",gradient:"from-teal-500 to-teal-600",primary:"teal-500",secondary:"teal-100",primaryHex:"#14B8A6",secondaryHex:"#CCFBF1"}],ne=[{id:"3x3",name:"3×3 (9セル)",size:3,totalCells:9,centerPositions:[4]},{id:"4x4",name:"4×4 (16セル)",size:4,totalCells:16,centerPositions:[5,6,9,10]},{id:"5x5",name:"5×5 (25セル)",size:5,totalCells:25,centerPositions:[12]},{id:"6x6",name:"6×6 (36セル)",size:6,totalCells:36,centerPositions:[14,15,20,21]}],sn=["J-POP","K-POP","ロック","メタル","パンク","オルタナティブ","インディー","エレクトロニカ","テクノ","ハウス","ダブステップ","ヒップホップ","R&B","ソウル","ファンク","ジャズ","ブルース","フォーク","カントリー","レゲエ","クラシック","アニメ","ゲーム音楽","ボサノヴァ","ラテン","ワールドミュージック","アンビエント","その他"],Ke="musicmeisi_users",ns="musicmeisi_users_backup",Se=()=>{try{const e=localStorage.getItem(Ke);if(!e)return console.log("📂 ユーザーデータが見つかりません。新しいストレージを初期化します"),{};const t=JSON.parse(e);console.log(`📂 ${Object.keys(t).length}人のユーザーデータを読み込みました`);const r={};for(const[n,o]of Object.entries(t))gi(o)?r[n]=o:console.warn(`⚠️ 無効なユーザーデータをスキップ: ${n}`);return r}catch(e){return console.error("❌ ユーザーデータの読み込みに失敗:",e),{}}},ci=e=>{try{const r=Se()[e];if(!r)return null;let n=!1,o={...r};if(r.baseColor||(o.baseColor=Be[0],n=!0,console.log(`🔄 ユーザー「${e}」: baseColorを追加`)),!r.gridLayout)o.gridLayout=ne[1],n=!0,console.log(`🔄 ユーザー「${e}」: gridLayoutを追加`);else if(r.gridLayout&&"centerPosition"in r.gridLayout){const a=r.gridLayout,i=ne.find(l=>l.size===a.size)||ne[1];o.gridLayout=i,n=!0,console.log(`🔄 ユーザー「${e}」: centerPosition → centerPositions に更新`)}return n?(Lr(o),console.log(`✅ ユーザー「${e}」のデータマイグレーションが完了しました`),o):r}catch(t){return console.error(`❌ ユーザー「${e}」の読み込みに失敗:`,t),null}},Lr=e=>{try{const t=Se();return Ut(t),t[e.username]={...e,updatedAt:new Date().toISOString()},localStorage.setItem(Ke,JSON.stringify(t)),console.log(`💾 ユーザー「${e.username}」のデータを保存しました`),console.log(`📊 現在の総ユーザー数: ${Object.keys(t).length}人`),!0}catch(t){return console.error(`❌ ユーザー「${e.username}」の保存に失敗:`,t),!1}},di=e=>{try{const t=Se();return t[e]?(Ut(t),delete t[e],localStorage.setItem(Ke,JSON.stringify(t)),console.log(`🗑️ ユーザー「${e}」のデータを削除しました`),console.log(`📊 現在の総ユーザー数: ${Object.keys(t).length}人`),!0):(console.warn(`⚠️ ユーザー「${e}」は存在しません`),!1)}catch(t){return console.error(`❌ ユーザー「${e}」の削除に失敗:`,t),!1}},ss=()=>{try{const e=Se();return Object.entries(e).map(([t,r])=>{var n;return{username:t,displayName:r.displayName||t,songCount:((n=r.songs)==null?void 0:n.length)||0,viewCount:r.viewCount||0,updatedAt:r.updatedAt||r.createdAt||""}}).sort((t,r)=>new Date(r.updatedAt).getTime()-new Date(t.updatedAt).getTime())}catch(e){return console.error("❌ ユーザーリストの取得に失敗:",e),[]}},ui=e=>{try{const t=Se();return t[e]?(t[e].viewCount=(t[e].viewCount||0)+1,t[e].updatedAt=new Date().toISOString(),localStorage.setItem(Ke,JSON.stringify(t)),!0):(console.warn(`⚠️ ユーザー「${e}」は存在しません`),!1)}catch(t){return console.error("❌ 訪問者数の更新に失敗:",t),!1}},Ut=e=>{try{const t=e||Se(),r={data:t,timestamp:new Date().toISOString(),userCount:Object.keys(t).length};return localStorage.setItem(ns,JSON.stringify(r)),console.log(`💾 バックアップを作成しました (${r.userCount}人のユーザー)`),!0}catch(t){return console.error("❌ バックアップの作成に失敗:",t),!1}},hi=()=>{try{const e=localStorage.getItem(ns);if(!e)return console.warn("⚠️ バックアップデータが見つかりません"),!1;const t=JSON.parse(e);return localStorage.setItem(Ke,JSON.stringify(t.data)),console.log(`🔄 バックアップから復元しました (${t.userCount}人のユーザー)`),console.log(`📅 バックアップ作成日時: ${new Date(t.timestamp).toLocaleString()}`),!0}catch(e){return console.error("❌ バックアップからの復元に失敗:",e),!1}},fi=()=>{try{const e=Se(),t={version:"1.0",exportDate:new Date().toISOString(),userCount:Object.keys(e).length,users:e};return JSON.stringify(t,null,2)}catch(e){return console.error("❌ データのエクスポートに失敗:",e),""}},mi=e=>{try{const t=JSON.parse(e);if(!t.users||typeof t.users!="object")throw new Error("無効なデータ形式です");return Ut(),localStorage.setItem(Ke,JSON.stringify(t.users)),console.log(`📥 データをインポートしました (${Object.keys(t.users).length}人のユーザー)`),!0}catch(t){return console.error("❌ データのインポートに失敗:",t),!1}},gi=e=>!e||typeof e!="object"?!1:["username","displayName","songs","createdAt"].every(r=>r in e),pi=()=>{try{const e=Se(),t=Object.keys(e).length;let r=0,n=0;Object.values(e).forEach(a=>{var i;r+=((i=a.songs)==null?void 0:i.length)||0,n+=a.viewCount||0});const o=new Blob([JSON.stringify(e)]).size;return{totalUsers:t,totalSongs:r,totalViews:n,storageSizeBytes:o,storageSizeKB:Math.round(o/1024*100)/100}}catch(e){return console.error("❌ 統計情報の取得に失敗:",e),{totalUsers:0,totalSongs:0,totalViews:0,storageSizeBytes:0,storageSizeKB:0}}},os={}.VITE_STORAGE_PROVIDER||"localStorage";class as{async loadAllUsers(){return Promise.resolve(Se())}async loadUser(t){return Promise.resolve(ci(t))}async saveUser(t){return Promise.resolve(Lr(t))}async incrementViewCount(t){return Promise.resolve(ui(t))}}class xi{constructor(){Ue(this,"fallback",new as)}async loadAllUsers(){try{return console.log("🔄 Vercel Blob実装は準備中です。ローカルストレージにフォールバック中..."),await this.fallback.loadAllUsers()}catch(t){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",t),await this.fallback.loadAllUsers()}}async loadUser(t){try{return await this.fallback.loadUser(t)}catch(r){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",r),await this.fallback.loadUser(t)}}async saveUser(t){try{return await this.fallback.saveUser(t)}catch(r){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",r),await this.fallback.saveUser(t)}}async incrementViewCount(t){try{return await this.fallback.incrementViewCount(t)}catch(r){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",r),await this.fallback.incrementViewCount(t)}}async uploadImage(t,r){try{return console.log(`🖼️ 画像アップロード準備中: ${r}`),new Promise(n=>{const o=new FileReader;o.onloadend=()=>n(o.result),o.readAsDataURL(t)})}catch(n){throw console.error("画像アップロードエラー:",n),n}}}function bi(){switch(os){case"vercelBlob":return console.log("🚀 Vercel Blobストレージを使用中（フォールバック付き）"),new xi;case"localStorage":default:return console.log("💾 ローカルストレージを使用中"),new as}}const De=bi();function on(){return{current:os,available:["localStorage","vercelBlob"],override:localStorage.getItem("OVERRIDE_STORAGE_PROVIDER"),environment:{}.VITE_STORAGE_PROVIDER}}function yi(){if(typeof navigator<"u"&&navigator.product==="ReactNative")return!0;if(typeof process<"u"){const e=process.type;return e==="renderer"||e==="worker"?!1:!!(process.versions&&process.versions.node)}return!1}const wi={toWeb(){throw new Error("Vercel Blob: Sorry, we cannot get a Readable stream in this environment. If you see this message please open an issue here: https://github.com/vercel/storage/ with details on your environment.")}};/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var vi=function(t){return t!=null&&t.constructor!=null&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)};const ji=at(vi);var is={};function he(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var Ni=he;he.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};he.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};he.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0};he.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};he.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)};he.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)};he.prototype.start=he.prototype.try;he.prototype.errors=function(){return this._errors};he.prototype.attempts=function(){return this._attempts};he.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,r=0,n=0;n<this._errors.length;n++){var o=this._errors[n],a=o.message,i=(e[a]||0)+1;e[a]=i,i>=r&&(t=o,r=i)}return t};(function(e){var t=Ni;e.operation=function(r){var n=e.timeouts(r);return new t(n,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})},e.timeouts=function(r){if(r instanceof Array)return[].concat(r);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var o in r)n[o]=r[o];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],i=0;i<n.retries;i++)a.push(this.createTimeout(i,n));return r&&r.forever&&!a.length&&a.push(this.createTimeout(i,n)),a.sort(function(l,c){return l-c}),a},e.createTimeout=function(r,n){var o=n.randomize?Math.random()+1:1,a=Math.round(o*Math.max(n.minTimeout,1)*Math.pow(n.factor,r));return a=Math.min(a,n.maxTimeout),a},e.wrap=function(r,n,o){if(n instanceof Array&&(o=n,n=null),!o){o=[];for(var a in r)typeof r[a]=="function"&&o.push(a)}for(var i=0;i<o.length;i++){var l=o[i],c=r[l];r[l]=(function(u){var f=e.operation(n),p=Array.prototype.slice.call(arguments,1),x=p.pop();p.push(function(m){f.retry(m)||(m&&(arguments[0]=f.mainError()),x.apply(this,arguments))}),f.attempt(function(){u.apply(r,p)})}).bind(r,c),r[l].options=n}}})(is);var Si=is,Ci=Si;function ki(e,t){function r(n,o){var a=t||{},i;"randomize"in a||(a.randomize=!0),i=Ci.operation(a);function l(u){o(u||new Error("Aborted"))}function c(u,f){if(u.bail){l(u);return}i.retry(u)?a.onRetry&&a.onRetry(u,f):o(i.mainError())}function d(u){var f;try{f=e(l,u)}catch(p){c(p,u);return}Promise.resolve(f).then(n).catch(function(x){c(x,u)})}i.attempt(d)}return new Promise(r)}var Ei=ki;const _i=at(Ei),ls=globalThis.fetch.bind(globalThis);function Ti(e,t){if(typeof e!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof e}\`.`);let r,n=0;return function(...a){clearTimeout(r);const i=Date.now(),l=i-n,c=t-l;c<=0?(n=i,e.apply(this,a)):r=setTimeout(()=>{n=Date.now(),e.apply(this,a)},c)}}var Ri=Ti;const cs=at(Ri);var Li=new Promise(e=>{try{const t=new Uint8Array([104,101,108,108,111]);new Blob([t]).text().then(n=>{e(n==="hello")}).catch(()=>{e(!1)})}catch{e(!1)}});async function ds(e){if(e instanceof ReadableStream)return e;if(e instanceof Blob)return e.stream();if(us(e))return wi.toWeb(e);let t;return e instanceof ArrayBuffer?t=new Uint8Array(e):Ii(e)?t=e:t=Ai(e),await Li?new Blob([t]).stream():new ReadableStream({start(r){r.enqueue(t),r.close()}})}function us(e){return typeof e=="object"&&typeof e.pipe=="function"&&e.readable&&typeof e._read=="function"&&typeof e._readableState=="object"}function Ai(e){return new TextEncoder().encode(e)}function Ii(e){return ji(e)}var Bi=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i,$i={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)};function ue(e){if(typeof e=="number"&&!isNaN(e))return e;if(typeof e!="string")return null;const t=Bi.exec(e);let r,n="b";if(!t)r=parseInt(e,10);else{const[,o,,,a]=t;if(!o)return null;r=parseFloat(o),a&&(n=a.toLowerCase())}return isNaN(r)?null:Math.floor($i[n]*r)}var Pi="https://vercel.com/api/blob";function Ui(e){if(e!=null&&e.token)return e.token;if({}.BLOB_READ_WRITE_TOKEN)return{}.BLOB_READ_WRITE_TOKEN;throw new Y("No token found. Either configure the `BLOB_READ_WRITE_TOKEN` environment variable, or pass a `token` option to your calls.")}var Y=class extends Error{constructor(e){super(`Vercel Blob: ${e}`)}};function Mi(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}var Oi=["//"],hs=(()=>{if(yi())return!0;if(fr().startsWith("http://localhost"))return!1;let t=!1;const r=new Request(fr(),{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!r})();function fr(e=""){let t=null;try{t={}.VERCEL_BLOB_API_URL||{}.NEXT_PUBLIC_VERCEL_BLOB_API_URL}catch{}return`${t||Pi}${e}`}var an=typeof TextEncoder=="function"?new TextEncoder:null;function fs(e){return e?typeof e=="string"?an?an.encode(e).byteLength:new Blob([e]).size:"byteLength"in e&&typeof e.byteLength=="number"?e.byteLength:"size"in e&&typeof e.size=="number"?e.size:0:0}var Di=(e,t)=>{let r=new Uint8Array(0);return new TransformStream({transform(n,o){queueMicrotask(()=>{const a=new Uint8Array(r.length+n.byteLength);for(a.set(r),a.set(new Uint8Array(n),r.length),r=a;r.length>=e;){const i=r.slice(0,e);o.enqueue(i),t==null||t(i.byteLength),r=r.slice(e)}})},flush(n){queueMicrotask(()=>{r.length>0&&(n.enqueue(r),t==null||t(r.byteLength))})}})};function ms(e){return globalThis.ReadableStream&&e instanceof ReadableStream}function zi(e){return!!(ms(e)||us(e))}var Fi=Object.prototype.toString,Hi=e=>Fi.call(e)==="[object Error]",Vi=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function qi(e){return e&&Hi(e)&&e.name==="TypeError"&&typeof e.message=="string"?e.message==="Load failed"?e.stack===void 0:Vi.has(e.message):!1}var gs=!1,ln,cn;try{((ln={}.DEBUG)!=null&&ln.includes("blob")||(cn={}.NEXT_PUBLIC_DEBUG)!=null&&cn.includes("blob"))&&(gs=!0)}catch{}function se(e,...t){gs&&console.debug(`vercel-blob: ${e}`,...t)}var ps=typeof ls=="function",Wi=ps&&hs,Ji=64*1024,dn=async({input:e,init:t,onUploadProgress:r})=>{se("using fetch");let n;if(t.body)if(r){const a=await ds(t.body);let i=0;const l=Di(Ji,c=>{i+=c,r(i)});n=a.pipeThrough(l)}else n=t.body;const o=hs&&n&&zi(n)?"half":void 0;return ls(e,{...t,...t.body?{body:n}:{},duplex:o})},un=typeof XMLHttpRequest<"u",hn=async({input:e,init:t,onUploadProgress:r})=>{se("using xhr");let n=null;return t.body&&(ms(t.body)?n=await new Response(t.body).blob():n=t.body),new Promise((o,a)=>{const i=new XMLHttpRequest;if(i.open(t.method||"GET",e.toString(),!0),r&&i.upload.addEventListener("progress",l=>{l.lengthComputable&&r(l.loaded)}),i.onload=()=>{var l;if((l=t.signal)!=null&&l.aborted){a(new DOMException("The user aborted the request.","AbortError"));return}const c=new Headers;i.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(f=>{const p=f.split(": "),x=p.shift(),m=p.join(": ");x&&c.set(x.toLowerCase(),m)});const u=new Response(i.response,{status:i.status,statusText:i.statusText,headers:c});o(u)},i.onerror=()=>{a(new TypeError("Network request failed"))},i.ontimeout=()=>{a(new TypeError("Network request timed out"))},i.onabort=()=>{a(new DOMException("The user aborted a request.","AbortError"))},t.headers&&new Headers(t.headers).forEach((c,d)=>{i.setRequestHeader(d,c)}),t.signal&&(t.signal.addEventListener("abort",()=>{i.abort()}),t.signal.aborted)){i.abort();return}i.send(n)})},Ki=async({input:e,init:t,onUploadProgress:r})=>{if(r){if(Wi)return dn({input:e,init:t,onUploadProgress:r});if(un)return hn({input:e,init:t,onUploadProgress:r})}if(ps)return dn({input:e,init:t});if(un)return hn({input:e,init:t});throw new Error("No request implementation available")},fn,Yi=(fn=globalThis.DOMException)!=null?fn:(()=>{try{atob("~")}catch(e){return Object.getPrototypeOf(e).constructor}})(),mn=950,Gi=class extends Y{constructor(){super("Access denied, please provide a valid token for this resource.")}},Xi=class extends Y{constructor(e){super(`Content type mismatch, ${e}.`)}},Qi=class extends Y{constructor(e){super(`Pathname mismatch, ${e}. Check the pathname used in upload() or put() matches the one from the client token.`)}},Zi=class extends Y{constructor(){super("Client token has expired.")}},el=class extends Y{constructor(e){super(`File is too large, ${e}.`)}},tl=class extends Y{constructor(){super("This store does not exist.")}},rl=class extends Y{constructor(){super("This store has been suspended.")}},xs=class extends Y{constructor(){super("Unknown error, please visit https://vercel.com/help.")}},nl=class extends Y{constructor(){super("The requested blob does not exist")}},Mt=class extends Y{constructor(){super("The blob service is currently not available. Please try again.")}},sl=class extends Y{constructor(e){super(`Too many requests please lower the number of concurrent requests ${e?` - try again in ${e} seconds`:""}.`),this.retryAfter=e??0}},ol=class extends Y{constructor(){super("The request was aborted.")}},al=11;function il(){let e=null;try{e={}.VERCEL_BLOB_API_VERSION_OVERRIDE||{}.NEXT_PUBLIC_VERCEL_BLOB_API_VERSION_OVERRIDE}catch{}return`${e??al}`}function ll(){try{const e={}.VERCEL_BLOB_RETRIES||"10";return parseInt(e,10)}catch{return 10}}function cl(e){const t=e.headers.get("retry-after");return new sl(t?parseInt(t,10):void 0)}async function dl(e){var t,r,n;let o,a;try{const l=await e.json();o=(r=(t=l.error)==null?void 0:t.code)!=null?r:"unknown_error",a=(n=l.error)==null?void 0:n.message}catch{o="unknown_error"}a!=null&&a.includes("contentType")&&a.includes("is not allowed")&&(o="content_type_not_allowed"),a!=null&&a.includes('"pathname"')&&a.includes("does not match the token payload")&&(o="client_token_pathname_mismatch"),a==="Token expired"&&(o="client_token_expired"),a!=null&&a.includes("the file length cannot be greater than")&&(o="file_too_large");let i;switch(o){case"store_suspended":i=new rl;break;case"forbidden":i=new Gi;break;case"content_type_not_allowed":i=new Xi(a);break;case"client_token_pathname_mismatch":i=new Qi(a);break;case"client_token_expired":i=new Zi;break;case"file_too_large":i=new el(a);break;case"not_found":i=new nl;break;case"store_not_found":i=new tl;break;case"bad_request":i=new Y(a??"Bad request");break;case"service_unavailable":i=new Mt;break;case"rate_limited":i=cl(e);break;case"unknown_error":case"not_allowed":default:i=new xs;break}return{code:o,error:i}}async function Ye(e,t,r){const n=il(),o=Ui(r),a=ul(),[,,,i=""]=o.split("_"),l=`${i}:${Date.now()}:${Math.random().toString(16).slice(2)}`;let c=0,d=0,u=0;const f=(r==null?void 0:r.onUploadProgress)||hl();t.body&&f&&(d=fs(t.body)),r!=null&&r.onUploadProgress&&r.onUploadProgress({loaded:0,total:d,percentage:0});const p=await _i(async x=>{let m;try{m=await Ki({input:fr(e),init:{...t,headers:{"x-api-blob-request-id":l,"x-api-blob-request-attempt":String(c),"x-api-version":n,...f?{"x-content-length":String(d)}:{},authorization:`Bearer ${o}`,...a,...t.headers}},onUploadProgress:r!=null&&r.onUploadProgress?b=>{var v;const N=d!==0?d:b;u=b;const y=d>0?Number((b/N*100).toFixed(2)):0;y===100&&d>0||(v=r.onUploadProgress)==null||v.call(r,{loaded:b,total:N,percentage:y})}:void 0})}catch(b){if(b instanceof Yi&&b.name==="AbortError"){x(new ol);return}if(qi(b))throw b;if(b instanceof TypeError){x(b);return}throw b}if(m.ok)return m;const{code:h,error:g}=await dl(m);if(h==="unknown_error"||h==="service_unavailable"||h==="internal_server_error")throw g;x(g)},{retries:ll(),onRetry:x=>{x instanceof Error&&se(`retrying API request to ${e}`,x.message),c=c+1}});if(!p)throw new xs;return r!=null&&r.onUploadProgress&&r.onUploadProgress({loaded:u,total:u,percentage:100}),await p.json()}function ul(){const e={};try{"VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API"in process.env&&{}.VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API!==void 0?e["x-proxy-through-alternative-api"]={}.VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API:"NEXT_PUBLIC_VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API"in process.env&&{}.NEXT_PUBLIC_VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API!==void 0&&(e["x-proxy-through-alternative-api"]={}.NEXT_PUBLIC_VERCEL_BLOB_PROXY_THROUGH_ALTERNATIVE_API)}catch{}return e}function hl(){try{return{}.VERCEL_BLOB_USE_X_CONTENT_LENGTH==="1"}catch{return!1}}var ht={cacheControlMaxAge:"x-cache-control-max-age",addRandomSuffix:"x-add-random-suffix",allowOverwrite:"x-allow-overwrite",contentType:"x-content-type"};function fl(e,t){const r={};return e.includes("contentType")&&t.contentType&&(r[ht.contentType]=t.contentType),e.includes("addRandomSuffix")&&t.addRandomSuffix!==void 0&&(r[ht.addRandomSuffix]=t.addRandomSuffix?"1":"0"),e.includes("allowOverwrite")&&t.allowOverwrite!==void 0&&(r[ht.allowOverwrite]=t.allowOverwrite?"1":"0"),e.includes("cacheControlMaxAge")&&t.cacheControlMaxAge!==void 0&&(r[ht.cacheControlMaxAge]=t.cacheControlMaxAge.toString()),r}async function ml({pathname:e,options:t,extraChecks:r,getToken:n}){if(!e)throw new Y("pathname is required");if(e.length>mn)throw new Y(`pathname is too long, maximum length is ${mn}`);for(const o of Oi)if(e.includes(o))throw new Y(`pathname cannot contain "${o}", please encode it if needed`);if(!t)throw new Y("missing options, see usage");if(t.access!=="public")throw new Y('access must be "public"');return r&&r(t),n&&(t.token=await n(e,t)),t}async function gl({uploadId:e,key:t,pathname:r,parts:n,headers:o,options:a}){const i=new URLSearchParams({pathname:r});try{const l=await Ye(`/mpu?${i.toString()}`,{method:"POST",headers:{...o,"content-type":"application/json","x-mpu-action":"complete","x-mpu-upload-id":e,"x-mpu-key":encodeURIComponent(t)},body:JSON.stringify(n),signal:a.abortSignal},a);return se("mpu: complete",l),l}catch(l){throw l instanceof TypeError&&(l.message==="Failed to fetch"||l.message==="fetch failed")?new Mt:l}}async function pl(e,t,r){se("mpu: create","pathname:",e);const n=new URLSearchParams({pathname:e});try{const o=await Ye(`/mpu?${n.toString()}`,{method:"POST",headers:{...t,"x-mpu-action":"create"},signal:r.abortSignal},r);return se("mpu: create",o),o}catch(o){throw o instanceof TypeError&&(o.message==="Failed to fetch"||o.message==="fetch failed")?new Mt:o}}async function xl({uploadId:e,key:t,pathname:r,headers:n,options:o,internalAbortController:a=new AbortController,part:i}){var l,c,d;const u=new URLSearchParams({pathname:r}),f=Ye(`/mpu?${u.toString()}`,{signal:a.signal,method:"POST",headers:{...n,"x-mpu-action":"upload","x-mpu-key":encodeURIComponent(t),"x-mpu-upload-id":e,"x-mpu-part-number":i.partNumber.toString()},body:i.blob},o);function p(){a.abort()}(l=o.abortSignal)!=null&&l.aborted?p():(c=o.abortSignal)==null||c.addEventListener("abort",p);const x=await f;return(d=o.abortSignal)==null||d.removeEventListener("abort",p),x}var bs=typeof window<"u"?6:8,mr=8*1024*1024,Qe=bs*mr*2;function bl({uploadId:e,key:t,pathname:r,stream:n,headers:o,options:a,totalToLoad:i}){se("mpu: upload init","key:",t);const l=new AbortController;return new Promise((c,d)=>{const u=[],f=[],p=n.getReader();let x=0,m=!1,h=1,g=!1,b=0,v=!1,N=0,y=[],C=0,T;const L={};a.onUploadProgress&&(T=cs(()=>{var k;const S=Object.values(L).reduce((te,ye)=>te+ye,0),P=i||S,I=i>0?Number(((S/i||S)*100).toFixed(2)):0;(k=a.onUploadProgress)==null||k.call(a,{loaded:S,total:P,percentage:I})},150)),_().catch(V);async function _(){for(se("mpu: upload read start","activeUploads:",x,"currentBytesInMemory:",`${ue(b)}/${ue(Qe)}`,"bytesSent:",ue(N)),m=!0;b<Qe&&!g;)try{const{value:k,done:S}=await p.read();if(S){v=!0,se("mpu: upload read consumed the whole stream"),y.length>0&&(u.push({partNumber:h++,blob:new Blob(y,{type:"application/octet-stream"})}),M()),m=!1;return}b+=k.byteLength;let P=0;for(;P<k.byteLength;){const I=mr-C,te=Math.min(P+I,k.byteLength),ye=k.slice(P,te);y.push(ye),C+=ye.byteLength,P=te,C===mr&&(u.push({partNumber:h++,blob:new Blob(y,{type:"application/octet-stream"})}),y=[],C=0,M())}}catch(k){V(k)}se("mpu: upload read end","activeUploads:",x,"currentBytesInMemory:",`${ue(b)}/${ue(Qe)}`,"bytesSent:",ue(N)),m=!1}async function R(k){x++,se("mpu: upload send part start","partNumber:",k.partNumber,"size:",k.blob.size,"activeUploads:",x,"currentBytesInMemory:",`${ue(b)}/${ue(Qe)}`,"bytesSent:",ue(N));try{const S=a.onUploadProgress?I=>{L[k.partNumber]=I.loaded,T&&T()}:void 0,P=await xl({uploadId:e,key:t,pathname:r,headers:o,options:{...a,onUploadProgress:S},internalAbortController:l,part:k});if(se("mpu: upload send part end","partNumber:",k.partNumber,"activeUploads",x,"currentBytesInMemory:",`${ue(b)}/${ue(Qe)}`,"bytesSent:",ue(N)),g)return;if(f.push({partNumber:k.partNumber,etag:P.etag}),b-=k.blob.size,x--,N+=k.blob.size,u.length>0&&M(),v){x===0&&(p.releaseLock(),c(f));return}m||_().catch(V)}catch(S){V(S)}}function M(){if(!g)for(se("send parts","activeUploads",x,"partsToUpload",u.length);x<bs&&u.length>0;){const k=u.shift();k&&R(k)}}function V(k){g||(g=!0,l.abort(),p.releaseLock(),k instanceof TypeError&&(k.message==="Failed to fetch"||k.message==="fetch failed")?d(new Mt):d(k))}})}async function yl(e,t,r,n){se("mpu: init","pathname:",e,"headers:",r);const o={...n,onUploadProgress:void 0},a=await pl(e,r,o),i=fs(t),l=await ds(t),c=await bl({uploadId:a.uploadId,key:a.key,pathname:e,stream:l,headers:r,options:n,totalToLoad:i});return await gl({uploadId:a.uploadId,key:a.key,pathname:e,parts:c,headers:r,options:o})}function wl({allowedOptions:e,getToken:t,extraChecks:r}){return async function(o,a,i){if(!a)throw new Y("body is required");if(Mi(a))throw new Y("Body must be a string, buffer or stream. You sent a plain JavaScript object, double check what you're trying to upload.");const l=await ml({pathname:o,options:i,extraChecks:r,getToken:t}),c=fl(e,l);if(l.multipart===!0)return yl(o,a,c,l);const d=l.onUploadProgress?cs(l.onUploadProgress,100):void 0,u=new URLSearchParams({pathname:o}),f=await Ye(`/?${u.toString()}`,{method:"PUT",body:a,headers:c,signal:l.abortSignal},{...l,onUploadProgress:d});return{url:f.url,downloadUrl:f.downloadUrl,pathname:f.pathname,contentType:f.contentType,contentDisposition:f.contentDisposition}}}/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */async function gn(e,t){await Ye("/delete",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({urls:Array.isArray(e)?e:[e]}),signal:t==null?void 0:t.abortSignal},t)}async function Xt(e){var t;const r=new URLSearchParams;e!=null&&e.limit&&r.set("limit",e.limit.toString()),e!=null&&e.prefix&&r.set("prefix",e.prefix),e!=null&&e.cursor&&r.set("cursor",e.cursor),e!=null&&e.mode&&r.set("mode",e.mode);const n=await Ye(`?${r.toString()}`,{method:"GET",signal:e==null?void 0:e.abortSignal},e);return(e==null?void 0:e.mode)==="folded"?{folders:(t=n.folders)!=null?t:[],cursor:n.cursor,hasMore:n.hasMore,blobs:n.blobs.map(pn)}:{cursor:n.cursor,hasMore:n.hasMore,blobs:n.blobs.map(pn)}}function pn(e){return{url:e.url,downloadUrl:e.downloadUrl,pathname:e.pathname,size:e.size,uploadedAt:new Date(e.uploadedAt)}}var Qt=wl({allowedOptions:["cacheControlMaxAge","addRandomSuffix","allowOverwrite","contentType"]});let vl=null;try{vl=require("sharp")}catch{console.warn("⚠️ sharpパッケージが利用できません。画像処理機能が制限されます。")}function xn(e,t=5){return e.length/1048576<=t}function bn(e){return["image/jpeg","image/jpg","image/png","image/webp"].includes(e.toLowerCase())}function Zt(e,t,r){const n=Date.now(),o=Math.random().toString(36).substring(2,8),a=e.split(".").pop()||"jpg";return`${t}/${r}/${n}-${o}.${a}`}const ys={}.BLOB_READ_WRITE_TOKEN||{}.VITE_BLOB_READ_WRITE_TOKEN;ys||console.warn("⚠️ BLOB_READ_WRITE_TOKENが設定されていません。画像ストレージ機能が無効になります。");const er=!0,Te=class Te{constructor(){Ue(this,"uploadCache",new Map)}static getInstance(){return Te.instance||(Te.instance=new Te),Te.instance}isBlobStorageAvailable(){return!!ys}async uploadUserIcon(t,r){try{if(!this.isBlobStorageAvailable())return console.warn("⚠️ Blob Storageが利用できません。ローカル保存を使用します。"),this.fallbackUpload(t,r,"icon");if(!bn(t.type))throw new Error("サポートされていない画像形式です");if(!xn(await t.arrayBuffer().then(l=>Buffer.from(l))))throw new Error("ファイルサイズが大きすぎます（最大5MB）");const n=Buffer.from(await t.arrayBuffer());let o;er&&(o={buffer:n,format:t.type.split("/")[1]||"jpeg",size:n.length,width:0,height:0});const a=Zt(t.name,r,"icon"),{url:i}=await Qt(a,o.buffer,{access:"public",addRandomSuffix:!1,contentType:`image/${o.format}`});return this.uploadCache.set(a,i),console.log(`📤 ユーザーアイコンをアップロード: ${r} (${o.size} bytes)`),{url:i,size:o.size,width:o.width,height:o.height,format:o.format}}catch(n){return console.error("ユーザーアイコンアップロードエラー:",n),this.fallbackUpload(t,r,"icon")}}async uploadAlbumCover(t,r,n){try{if(!this.isBlobStorageAvailable())return console.warn("⚠️ Blob Storageが利用できません。ローカル保存を使用します。"),this.fallbackUpload(t,r,"album");if(!bn(t.type))throw new Error("サポートされていない画像形式です");if(!xn(await t.arrayBuffer().then(c=>Buffer.from(c))))throw new Error("ファイルサイズが大きすぎます（最大5MB）");const o=Buffer.from(await t.arrayBuffer());let a;er&&(a={buffer:o,format:t.type.split("/")[1]||"jpeg",size:o.length,width:0,height:0});const i=Zt(t.name,r,"album"),{url:l}=await Qt(i,a.buffer,{access:"public",addRandomSuffix:!1,contentType:`image/${a.format}`});return this.uploadCache.set(i,l),console.log(`📤 アルバムジャケットをアップロード: ${r}/${n} (${a.size} bytes)`),{url:l,size:a.size,width:a.width,height:a.height,format:a.format}}catch(o){return console.error("アルバムジャケットアップロードエラー:",o),this.fallbackUpload(t,r,"album")}}async uploadFromUrl(t,r,n){try{if(!this.isBlobStorageAvailable())return console.warn("⚠️ Blob Storageが利用できません。元のURLを返します。"),this.fallbackUrlUpload(t,r,n);const o=await fetch(t);if(!o.ok)throw new Error("画像の取得に失敗しました");const a=Buffer.from(await o.arrayBuffer());let i;er&&(i={buffer:a,format:"jpeg",size:a.length,width:0,height:0});const l=Zt(`external-${Date.now()}`,r,n),{url:c}=await Qt(l,i.buffer,{access:"public",addRandomSuffix:!1,contentType:`image/${i.format}`});return console.log(`📤 外部画像をアップロード: ${r}/${n} (${i.size} bytes)`),{url:c,size:i.size,width:i.width,height:i.height,format:i.format}}catch(o){return console.error("外部画像アップロードエラー:",o),this.fallbackUrlUpload(t,r,n)}}async fallbackUpload(t,r,n){return new Promise(o=>{const a=new FileReader;a.onload=i=>{var c;const l=(c=i.target)==null?void 0:c.result;o({url:l,size:t.size,width:0,height:0,format:t.type.split("/")[1]||"jpeg"})},a.readAsDataURL(t)})}async fallbackUrlUpload(t,r,n){return{url:t,size:0,width:0,height:0,format:"jpeg"}}async deleteImage(t){try{return this.isBlobStorageAvailable()?(await gn(t),console.log(`🗑️ 画像を削除: ${t}`),!0):(console.warn("⚠️ Blob Storageが利用できません。削除をスキップします。"),!0)}catch(r){return console.error("画像削除エラー:",r),!1}}async getUserImages(t){try{if(!this.isBlobStorageAvailable())return console.warn("⚠️ Blob Storageが利用できません。画像一覧を取得できません。"),[];const{blobs:r}=await Xt({prefix:`${t}/`,limit:100});return r.map(n=>n.url)}catch(r){return console.error("ユーザー画像一覧取得エラー:",r),[]}}async getStorageStats(){try{if(!this.isBlobStorageAvailable())return console.warn("⚠️ Blob Storageが利用できません。統計情報を取得できません。"),{totalFiles:0,totalSize:0,userIcons:0,albumCovers:0};const{blobs:t}=await Xt({limit:1e3});let r=0,n=0,o=0;return t.forEach(a=>{r+=a.size||0,a.pathname.includes("/icon/")?n++:a.pathname.includes("/album/")&&o++}),{totalFiles:t.length,totalSize:r,userIcons:n,albumCovers:o}}catch(t){return console.error("ストレージ統計取得エラー:",t),{totalFiles:0,totalSize:0,userIcons:0,albumCovers:0}}}async cleanupOldImages(){try{if(!this.isBlobStorageAvailable())return console.warn("⚠️ Blob Storageが利用できません。クリーンアップをスキップします。"),0;const t=new Date;t.setDate(t.getDate()-30);const{blobs:r}=await Xt({limit:1e3});let n=0;for(const o of r)if(o.uploadedAt&&new Date(o.uploadedAt)<t)try{await gn(o.url),n++}catch(a){console.error(`古い画像削除エラー: ${o.url}`,a)}return console.log(`🧹 古い画像を${n}件削除しました`),n}catch(t){return console.error("古い画像クリーンアップエラー:",t),0}}};Ue(Te,"instance");let gr=Te;const pr=gr.getInstance(),Re=class Re{constructor(){Ue(this,"cache",new Map)}static getInstance(){return Re.instance||(Re.instance=new Re),Re.instance}generateCacheKey(t,r,n){const o=btoa(t).replace(/[^a-zA-Z0-9]/g,"");return`${r}/${n}/${o}`}async getCachedImage(t,r,n){const o=this.generateCacheKey(t,r,n),a=this.cache.get(o);if(a){const i=new Date(a.cachedAt);if((new Date().getTime()-i.getTime())/(1e3*60*60*24)<30)return console.log(`📋 キャッシュされた画像を使用: ${t}`),a.url}return null}async cacheExternalImage(t,r,n,o){try{const a=await this.getCachedImage(t,r,n);if(a)return a;const i=await pr.uploadFromUrl(t,r,n),l=this.generateCacheKey(t,r,n),c={url:i.url,cachedAt:new Date().toISOString(),size:i.size,source:o};return this.cache.set(l,c),this.saveCacheToStorage(),console.log(`💾 外部画像をキャッシュ: ${t} → ${i.url}`),i.url}catch(a){throw console.error("外部画像キャッシュエラー:",a),a}}async getSpotifyImage(t,r,n,o){try{const a=await this.getCachedImage(t,r,n);return a||await this.cacheExternalImage(t,r,n,"spotify")}catch(a){if(console.warn("Spotify画像キャッシュエラー:",a),o&&o!==t)try{return await this.getSpotifyImage(o,r,n)}catch(i){console.error("フォールバック画像も失敗:",i)}return this.getDefaultImage(n)}}async getLastfmImage(t,r,n,o){try{const a=await this.getCachedImage(t,r,n);return a||await this.cacheExternalImage(t,r,n,"lastfm")}catch(a){if(console.warn("Last.fm画像キャッシュエラー:",a),o&&o!==t)try{return await this.getLastfmImage(o,r,n)}catch(i){console.error("フォールバック画像も失敗:",i)}return this.getDefaultImage(n)}}getDefaultImage(t){return t==="icon"?"/default-user-icon.png":"/default-album-cover.png"}saveCacheToStorage(){try{const t=Array.from(this.cache.entries());localStorage.setItem("external_image_cache",JSON.stringify(t))}catch(t){console.error("キャッシュ保存エラー:",t)}}loadCacheFromStorage(){try{const t=localStorage.getItem("external_image_cache");if(t){const r=JSON.parse(t);this.cache=new Map(r),console.log(`📋 キャッシュを復元: ${this.cache.size}件`)}}catch(t){console.error("キャッシュ復元エラー:",t)}}cleanupOldCache(){const t=new Date;let r=0;for(const[n,o]of this.cache.entries()){const a=new Date(o.cachedAt);(t.getTime()-a.getTime())/(1e3*60*60*24)>60&&(this.cache.delete(n),r++)}return r>0&&(this.saveCacheToStorage(),console.log(`🧹 古いキャッシュを${r}件削除しました`)),r}getCacheStats(){let t=0,r=0,n=0,o=0;for(const a of this.cache.values())switch(o+=a.size,a.source){case"spotify":t++;break;case"lastfm":r++;break;case"manual":n++;break}return{totalCached:this.cache.size,spotifyImages:t,lastfmImages:r,manualImages:n,totalSize:o}}};Ue(Re,"instance");let xr=Re;const ws=xr.getInstance();typeof window<"u"&&ws.loadCacheFromStorage();function Ar({onSelect:e,placeholder:t="曲名やアーティスト名を検索...",className:r="",username:n=""}){const[o,a]=j.useState(""),[i,l]=j.useState([]),[c,d]=j.useState(!1),[u,f]=j.useState(!1),[p,x]=j.useState(0),[m,h]=j.useState(null),[g,b]=j.useState(!1),[v,N]=j.useState(0),y=j.useRef(null),C=j.useRef(null),T=j.useRef(),L=j.useCallback(async k=>{if(k.trim().length<2){l([]),f(!1);return}d(!0),h(null),b(!1);try{const S=await si(k);if(n&&S.length>0){const P=await Promise.all(S.map(async I=>{if(I.image&&I.image.startsWith("http"))try{const te=await ws.cacheExternalImage(I.image,n,"album","manual");return{...I,image:te}}catch(te){return console.warn("画像キャッシュエラー:",te),I}return I}));l(P)}else l(S);f(!0),x(0)}catch(S){console.error("音楽検索エラー:",S),h(S instanceof Error?S.message:"検索中にエラーが発生しました"),l([]),f(!1)}finally{d(!1)}},[n]),_=j.useCallback(()=>{const k=Date.now();if(k-v<1e3){console.log("検索間隔が短すぎます");return}N(k),L(o.trim())},[o,v,L]);j.useEffect(()=>(T.current&&clearTimeout(T.current),o.trim().length>=2?T.current=setTimeout(()=>{L(o)},500):(l([]),f(!1)),()=>{T.current&&clearTimeout(T.current)}),[o,L]);const R=j.useCallback(k=>{if(!(!u||i.length===0))switch(k.key){case"ArrowDown":k.preventDefault(),x(S=>(S+1)%i.length);break;case"ArrowUp":k.preventDefault(),x(S=>(S-1+i.length)%i.length);break;case"Enter":k.preventDefault(),i[p]&&M(i[p]);break;case"Escape":f(!1);break}},[u,i,p]),M=j.useCallback(k=>{e(k),a(""),l([]),f(!1),x(0),h(null)},[e]);j.useEffect(()=>{const k=S=>{C.current&&!C.current.contains(S.target)&&f(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]);const V=()=>{b(!g)};return s.jsxs("div",{className:`relative ${r}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{ref:y,type:"text",value:o,onChange:k=>a(k.target.value),onKeyDown:R,onFocus:()=>o.trim().length>=2&&i.length>0&&f(!0),className:"w-full px-4 py-3 pr-24 bg-white border border-blue-200 rounded-lg text-blue-900 placeholder-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:t}),s.jsxs("div",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[s.jsx("button",{type:"button",onClick:_,disabled:c||o.trim().length<1,className:"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-md transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"手動検索を実行",children:c?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}):s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),m&&s.jsx("button",{type:"button",onClick:V,className:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors duration-200",title:"エラー詳細を表示",children:s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})]})]}),m&&s.jsxs("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[s.jsx("p",{className:"text-sm text-red-600",children:m}),g&&s.jsxs("div",{className:"mt-2 p-2 bg-red-100 rounded text-xs text-red-700",children:[s.jsx("p",{children:"詳細情報:"}),s.jsx("p",{children:"• インターネット接続を確認してください"}),s.jsx("p",{children:"• 検索キーワードを変更してみてください"}),s.jsx("p",{children:"• しばらく時間をおいてから再試行してください"})]})]}),u&&i.length>0&&s.jsx("div",{ref:C,className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-64 overflow-y-auto",children:i.map((k,S)=>s.jsxs("div",{onClick:()=>M(k),className:`flex items-center p-3 cursor-pointer transition-colors duration-200 ${S===p?"bg-blue-500 text-white":"hover:bg-blue-50 text-blue-900"}`,children:[s.jsxs("div",{className:"flex-shrink-0 w-12 h-12 mr-3 relative",children:[s.jsx("img",{src:k.image||`https://picsum.photos/48/48?random=${S}`,alt:`${k.name} by ${k.artist}`,className:"w-full h-full object-cover rounded-lg",onError:P=>{const I=P.target;I.src=`https://picsum.photos/48/48?random=${S}`}}),k.isGeneratedImage&&s.jsx("div",{className:"absolute -top-1 -right-1 bg-orange-500 text-white text-xs px-1 py-0.5 rounded-full",children:"AI"}),k.provider&&s.jsx("div",{className:`absolute -bottom-1 -left-1 text-white text-xs px-1 py-0.5 rounded-full ${k.provider==="spotify"?"bg-green-500":"bg-red-500"}`,children:k.provider==="spotify"?"S":"L"}),n&&k.image&&k.image.includes("blob.vercel-storage.com")&&s.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-500 text-white text-xs px-1 py-0.5 rounded-full",children:"C"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium truncate",children:k.name}),s.jsx("div",{className:"text-sm opacity-75 truncate",children:k.artist})]}),S===p&&s.jsx("div",{className:"flex-shrink-0 ml-2",children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},`${k.name}-${k.artist}-${S}`))})]})}function vs({onIconChange:e,currentIcon:t,className:r="",username:n=""}){const[o,a]=j.useState(null),[i,l]=j.useState({x:20,y:20,size:60}),[c,d]=j.useState(!1),[u,f]=j.useState(!1),[p,x]=j.useState(!1),[m,h]=j.useState(!1),[g,b]=j.useState(!1),[v,N]=j.useState({x:0,y:0}),[y,C]=j.useState({size:0,mouseX:0,mouseY:0}),[T,L]=j.useState(null),_=j.useRef(null),R=j.useRef(null),M=j.useRef(null),V=j.useRef(null);j.useEffect(()=>{const E=()=>{x(window.innerWidth<=768)};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const k=()=>{if(!R.current)return{width:0,height:0};const E=R.current.getBoundingClientRect();return{width:E.width,height:E.height}};j.useEffect(()=>{const E=$=>{$.key==="Escape"&&c&&U()};return c&&(document.addEventListener("keydown",E),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",E),document.body.style.overflow="unset"}},[c]);const S=E=>{var F;const $=(F=E.target.files)==null?void 0:F[0];if(!$)return;const D=5,z=D*1024*1024;if($.size>z){alert(`ファイルサイズは${D}MB以下にしてください。現在のサイズ: ${($.size/1024/1024).toFixed(1)}MB`),_.current&&(_.current.value="");return}if(!$.type.startsWith("image/")){alert("画像ファイルを選択してください"),_.current&&(_.current.value="");return}const O=new FileReader;O.onload=q=>{var ee;const Q=(ee=q.target)==null?void 0:ee.result;a(Q),d(!0),l({x:25,y:25,size:50}),L(null)},O.readAsDataURL($)},P=E=>{if(!M.current||!R.current)return;M.current.getBoundingClientRect();const $=R.current.getBoundingClientRect(),D=(E.clientX-$.left)/$.width*100,z=(E.clientY-$.top)/$.height*100;D>=i.x&&D<=i.x+i.size&&z>=i.y&&z<=i.y+i.size&&(h(!0),N({x:D-i.x,y:z-i.y}))},I=E=>{if(!(!m&&!g)&&R.current){if(g){const $=E.clientY-y.mouseY,D=k(),z=Math.min(D.width,D.height),O=$/z*100;let F=y.size+O;F=Math.max(10,Math.min(100,F));const q=F/100*z,Q=(D.width-q)/D.width*100,ee=(D.height-q)/D.height*100;l(X=>({size:F,x:Math.min(X.x,Q),y:Math.min(X.y,ee)}))}else if(m){const $=R.current.getBoundingClientRect(),D=(E.clientX-$.left)/$.width*100,z=(E.clientY-$.top)/$.height*100,O=k(),F=Math.min(O.width,O.height),q=i.size/100*F,Q=(O.width-q)/O.width*100,ee=(O.height-q)/O.height*100,X=Math.max(0,Math.min(Q,D-v.x)),de=Math.max(0,Math.min(ee,z-v.y));l(ie=>({...ie,x:X,y:de}))}}},te=()=>{h(!1),b(!1)},ye=E=>{if(!M.current||!R.current)return;const $=E.touches[0],D=R.current.getBoundingClientRect(),z=($.clientX-D.left)/D.width*100,O=($.clientY-D.top)/D.height*100;z>=i.x&&z<=i.x+i.size&&O>=i.y&&O<=i.y+i.size&&(h(!0),N({x:z-i.x,y:O-i.y}))},dt=E=>{if(!m&&!g||!R.current)return;E.preventDefault();const $=E.touches[0];if(g){const D=$.clientY-y.mouseY,z=k(),O=Math.min(z.width,z.height),F=D/O*100;let q=y.size+F;q=Math.max(10,Math.min(100,q));const Q=q/100*O,ee=(z.width-Q)/z.width*100,X=(z.height-Q)/z.height*100;l(de=>({size:q,x:Math.min(de.x,ee),y:Math.min(de.y,X)}))}else if(m){const D=R.current.getBoundingClientRect(),z=($.clientX-D.left)/D.width*100,O=($.clientY-D.top)/D.height*100,F=k(),q=Math.min(F.width,F.height),Q=i.size/100*q,ee=(F.width-Q)/F.width*100,X=(F.height-Q)/F.height*100,de=Math.max(0,Math.min(ee,z-v.x)),ie=Math.max(0,Math.min(X,O-v.y));l(ve=>({...ve,x:de,y:ie}))}},ut=()=>{h(!1),b(!1)},A=async()=>{if(R.current){f(!0),L(null);try{const E=document.createElement("canvas"),$=E.getContext("2d");if(!$)return;const D=R.current.naturalWidth/R.current.width,z=R.current.naturalHeight/R.current.height,O=Math.min(R.current.width,R.current.height),F=i.size/100*O,q=i.x/100*R.current.width,Q=i.y/100*R.current.height,ee=256,X=Math.min(F*Math.min(D,z),ee);E.width=X,E.height=X,$.imageSmoothingEnabled=!0,$.imageSmoothingQuality="high",$.drawImage(R.current,q*D,Q*z,F*D,F*z,0,0,X,X);const de=await new Promise(ie=>{E.toBlob(ve=>{ve&&ie(ve)},"image/jpeg",.85)});if(n){const ie=new File([de],"icon.jpg",{type:"image/jpeg"}),ve=await pr.uploadUserIcon(ie,n);e(ve.url),console.log("✅ アイコンをストレージにアップロードしました:",ve.url)}else{const ie=E.toDataURL("image/jpeg",.85);e(ie),console.log("⚠️ ユーザー名が設定されていないため、ローカル保存を使用")}a(null),d(!1)}catch(E){console.error("トリミングエラー:",E),L("画像のアップロードに失敗しました。もう一度お試しください。")}finally{f(!1)}}},U=()=>{a(null),d(!1),_.current&&(_.current.value="")},K=E=>{E.target===E.currentTarget&&U()},ae=async()=>{if(t&&n)try{await pr.deleteImage(t),console.log("🗑️ アイコンをストレージから削除しました")}catch(E){console.warn("アイコン削除エラー（無視）:",E)}e(""),_.current&&(_.current.value="")},re=E=>{E.preventDefault(),E.stopPropagation(),b(!0),C({size:i.size,mouseX:E.clientX,mouseY:E.clientY})},Ge=E=>{E.preventDefault(),E.stopPropagation();const $=E.touches[0];b(!0),C({size:i.size,mouseX:$.clientX,mouseY:$.clientY})},we=E=>{E.key==="Enter"&&(E.preventDefault(),E.stopPropagation(),A())},_e=()=>!c||!o?null:Sn.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[99999] p-4",onClick:K,style:{position:"fixed",top:0,left:0,right:0,bottom:0},children:s.jsxs("div",{className:`bg-white rounded-xl shadow-2xl p-4 select-none ${p?"w-full h-full max-w-none max-h-none rounded-none":"max-w-2xl w-full max-h-[90vh] overflow-y-auto"}`,onClick:E=>E.stopPropagation(),onKeyDown:we,tabIndex:0,style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"アイコンをトリミング"}),s.jsx("button",{type:"button",onClick:U,className:"text-gray-400 hover:text-gray-600 transition-colors p-2",disabled:u,children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),T&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-red-600",children:T})}),!1,s.jsx("div",{className:"mb-6",children:s.jsxs("div",{ref:M,className:`relative inline-block ${g?"cursor-se-resize":m?"cursor-grabbing":"cursor-move"} select-none`,style:{maxWidth:"100%",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},onMouseDown:P,onMouseMove:I,onMouseUp:te,onMouseLeave:te,onTouchStart:ye,onTouchMove:dt,onTouchEnd:ut,children:[s.jsx("img",{ref:R,src:o,alt:"トリミング対象",className:"max-w-full max-h-full object-contain rounded-lg select-none",style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",WebkitTouchCallout:"none",WebkitUserDrag:"none"},draggable:!1}),(()=>{var Mr,Or;const E=k(),$=Math.min(E.width,E.height);if(E.width===0||E.height===0)return null;const D=(Mr=R.current)==null?void 0:Mr.getBoundingClientRect(),z=(Or=M.current)==null?void 0:Or.getBoundingClientRect();console.log("=== デバッグ情報 ==="),console.log("画像サイズ:",E),console.log("画像要素の位置:",D),console.log("コンテナの位置:",z);const O=i.size/100*$,F=i.x/100*E.width,q=i.y/100*E.height,Q=(F+O/2)/E.width*100,ee=(q+O/2)/E.height*100,X=O/2,de=X/E.width*100,ie=X/E.height*100,ve=Math.max(de,ie);console.log("トリミング枠:",{cropLeft:F,cropTop:q,squareSize:O,radiusPx:X}),console.log("マスク中心座標:",{centerX:Q,centerY:ee}),console.log("半径計算:",{radiusPercentX:de,radiusPercentY:ie,radiusPercent:ve,画像サイズ:E});const Wt=`radial-gradient(ellipse ${de}% ${ie}% at ${Q}% ${ee}%, transparent 97%, black 100%)`;return console.log("マスクスタイル:",Wt),s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`absolute inset-0 bg-black bg-opacity-50 pointer-events-none ${m||g?"":"transition-all duration-150"}`,style:{zIndex:5,WebkitMask:Wt,mask:Wt,backgroundColor:"rgba(0, 0, 0, 0.7)"}}),s.jsxs("div",{className:"absolute inset-0 pointer-events-none",style:{zIndex:4},children:[s.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{top:0,left:0,right:0,height:`${q}px`}}),s.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{bottom:0,left:0,right:0,height:`${E.height-q-O}px`}}),s.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{top:`${q}px`,left:0,width:`${F}px`,height:`${O}px`}}),s.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{top:`${q}px`,right:0,width:`${E.width-F-O}px`,height:`${O}px`}})]}),s.jsx("div",{className:`absolute border-2 border-dashed border-white pointer-events-none ${m||g?"":"transition-all duration-150"}`,style:{left:`${F}px`,top:`${q}px`,width:`${O}px`,height:`${O}px`,zIndex:8,opacity:.8}}),s.jsxs("div",{ref:V,className:`absolute border-2 border-white ${m||g?"border-blue-400":""} transition-colors duration-150`,style:{left:`${F}px`,top:`${q}px`,width:`${O}px`,height:`${O}px`,cursor:g?"se-resize":m?"grabbing":"move",transition:m||g?"none":"all 0.15s ease",zIndex:10,pointerEvents:"auto",backgroundColor:"transparent"},title:`正方形サイズ: ${Math.round(O)}px × ${Math.round(O)}px`,children:[s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("div",{className:`absolute ${p?"border-l-2":"border-l"} border-white opacity-50`,style:{left:"33.333%",top:0,height:"100%"}}),s.jsx("div",{className:`absolute ${p?"border-l-2":"border-l"} border-white opacity-50`,style:{left:"66.666%",top:0,height:"100%"}}),s.jsx("div",{className:`absolute ${p?"border-t-2":"border-t"} border-white opacity-50`,style:{top:"33.333%",left:0,width:"100%"}}),s.jsx("div",{className:`absolute ${p?"border-t-2":"border-t"} border-white opacity-50`,style:{top:"66.666%",left:0,width:"100%"}})]}),s.jsx("div",{className:`absolute -top-1 -left-1 ${p?"w-4 h-4":"w-3 h-3"} bg-white border border-gray-400`,style:{zIndex:15}}),s.jsx("div",{className:`absolute -top-1 -right-1 ${p?"w-4 h-4":"w-3 h-3"} bg-white border border-gray-400`,style:{zIndex:15}}),s.jsx("div",{className:`absolute -bottom-1 -left-1 ${p?"w-4 h-4":"w-3 h-3"} bg-white border border-gray-400`,style:{zIndex:15}}),s.jsx("div",{className:`absolute -bottom-2 -right-2 ${p?"w-6 h-6":"w-5 h-5"} bg-blue-500 border-2 border-white rounded cursor-se-resize hover:bg-blue-600 transition-colors shadow-lg`,style:{zIndex:16},onMouseDown:re,onTouchStart:Ge,title:"ドラッグしてサイズを変更"}),s.jsx("div",{className:"absolute inset-0 border-2 border-blue-400 rounded-full pointer-events-none opacity-75",style:{zIndex:12}})]})]})})()]})}),s.jsxs("div",{className:"flex justify-end space-x-3 relative z-20",children:[s.jsx("button",{type:"button",onClick:U,className:"px-6 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",disabled:u,children:"キャンセル"}),s.jsx("button",{type:"button",onClick:A,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 font-medium",disabled:u,children:u?"アップロード中...":"適用"})]})]})}),document.body);return s.jsxs("div",{className:`space-y-4 ${r}`,children:[t&&!c&&s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:t,alt:"ユーザーアイコン",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-200"}),s.jsx("button",{type:"button",onClick:ae,className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-sm hover:bg-red-600 transition-colors",children:"×"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"アイコンが設定されています"}),s.jsx("button",{type:"button",onClick:()=>{var E;return(E=_.current)==null?void 0:E.click()},className:"text-sm text-blue-500 hover:text-blue-600",children:"変更する"})]})]}),!t&&!c&&s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors",children:[s.jsx("input",{ref:_,type:"file",accept:"image/*",onChange:S,className:"hidden"}),s.jsxs("button",{type:"button",onClick:()=>{var E;return(E=_.current)==null?void 0:E.click()},className:"flex flex-col items-center space-y-2 text-gray-600 hover:text-blue-500",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),s.jsx("span",{className:"text-sm",children:"アイコンをアップロード"}),s.jsx("span",{className:"text-xs text-gray-400",children:"JPG, PNG (5MB以下)"})]})]}),s.jsx(_e,{})]})}function jl({message:e,type:t="success",duration:r=3e3,onClose:n}){const[o,a]=j.useState(!1);j.useEffect(()=>{a(!0);const c=setTimeout(()=>{a(!1),setTimeout(n,300)},r);return()=>clearTimeout(c)},[r,n]);const i=()=>{switch(t){case"success":return"bg-green-500 text-white";case"error":return"bg-red-500 text-white";case"info":return"bg-blue-500 text-white";default:return"bg-green-500 text-white"}},l=()=>{switch(t){case"success":return"✅";case"error":return"❌";case"info":return"ℹ️";default:return"✅"}};return s.jsx("div",{className:`fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transition-all duration-300 transform ${o?"translate-x-0 opacity-100":"translate-x-full opacity-0"} ${i()}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-lg",children:l()}),s.jsx("span",{className:"font-medium",children:e}),s.jsx("button",{onClick:()=>{a(!1),setTimeout(n,300)},className:"ml-3 text-white/80 hover:text-white transition-colors",children:"×"})]})})}function Nl(){const e=Ne(),[t,r]=j.useState(""),[n,o]=j.useState(null),[a,i]=j.useState(!0),[l,c]=j.useState(!1),[d,u]=j.useState(null),[f,p]=j.useState(!1);j.useEffect(()=>{x()},[]);const x=async()=>{const y=localStorage.getItem("musicard_user");if(!y){e("/login");return}r(y),await m(y)},m=async y=>{try{let C=await De.loadUser(y);C||(C={username:y,displayName:y,bio:"",baseColor:Be[0],themeColor:ze[0],socialLinks:{},favoriteGenres:[],songs:[],gridLayout:ne[1],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),viewCount:0,isPublic:!0},await De.saveUser(C),console.log(`🆕 新規ユーザー「${y}」のプロフィールを作成しました`)),o(C)}catch(C){console.error("ユーザーデータの読み込みエラー:",C)}finally{i(!1)}},h=async()=>{if(n){c(!0);try{await De.saveUser({...n,updatedAt:new Date().toISOString()})?(console.log("✅ プロフィールを保存しました"),u({message:"プロフィールを保存しました！",type:"success"})):u({message:"保存に失敗しました",type:"error"})}catch(y){console.error("保存エラー:",y),u({message:"保存中にエラーが発生しました",type:"error"})}finally{c(!1)}}},g=()=>{confirm("ログアウトしますか？")&&(localStorage.removeItem("musicard_user"),localStorage.removeItem("musicard_login_time"),e("/login"))},b=()=>{t&&e(`/users/${t}`,{state:{isPreview:!0}})},v=y=>{if(!n)return;const C={id:y.id||`${y.name}-${y.artist}`.replace(/\s+/g,"-").toLowerCase(),title:y.name,artist:y.artist,jacket:y.image,previewUrl:null,addedAt:new Date().toISOString()};o({...n,songs:[...n.songs,C]}),p(!1)},N=y=>{n&&o({...n,songs:n.songs.filter(C=>C.id!==y)})};return a?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})}):n?s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:[s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[n.displayName,"の音楽名刺"]}),s.jsxs("p",{className:"text-gray-600",children:["@",t]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:b,className:"bg-white text-blue-600 px-4 py-2 rounded-lg border border-blue-200 hover:bg-blue-50 transition-colors font-medium",children:"👁️ プレビュー"}),s.jsx("button",{onClick:h,disabled:l,className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-6 py-2 rounded-lg font-medium hover:from-blue-600 hover:to-cyan-600 transition-all disabled:opacity-50",children:l?"保存中...":"💾 保存"}),s.jsx("button",{onClick:g,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors",children:"ログアウト"})]})]}),!1,s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"基本情報"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロフィールアイコン"}),s.jsx(vs,{currentIcon:n.icon||"",onIconChange:y=>o({...n,icon:y}),username:t})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"表示名"}),s.jsx("input",{type:"text",value:n.displayName,onChange:y=>o({...n,displayName:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"自己紹介"}),s.jsx("textarea",{value:n.bio,onChange:y=>o({...n,bio:y.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"音楽の趣味について..."})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"ベースカラー"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"音楽名刺の基本となる背景色を選択してください。"}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:Be.map(y=>s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"radio",name:"baseColor",checked:n.baseColor.id===y.id,onChange:()=>o({...n,baseColor:y}),className:"sr-only"}),s.jsxs("div",{className:`relative p-4 rounded-xl border-2 transition-all ${n.baseColor.id===y.id?"border-blue-500 ring-2 ring-blue-500/20 shadow-lg scale-105":"border-gray-200 hover:border-gray-300 hover:scale-102"}`,children:[s.jsx("div",{className:`w-full h-8 rounded-lg ${y.background} mb-2 shadow-sm`}),s.jsx("p",{className:"text-center text-sm font-medium text-gray-800",children:y.name}),n.baseColor.id===y.id&&s.jsx("div",{className:"absolute top-2 right-2",children:s.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]})]},y.id))})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"テーマカラー"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"アイコンの枠線やボタンの色に反映されるテーマカラーを選択してください。"}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:ze.map(y=>s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"radio",name:"themeColor",checked:n.themeColor.id===y.id,onChange:()=>o({...n,themeColor:y}),className:"sr-only"}),s.jsxs("div",{className:`relative p-3 rounded-xl border-2 transition-all ${n.themeColor.id===y.id?"border-gray-400 ring-2 ring-blue-500/20 shadow-lg scale-105":"border-gray-200 hover:border-gray-300 hover:scale-102"}`,children:[s.jsx("div",{className:`w-full h-8 rounded-lg bg-gradient-to-r ${y.gradient} mb-2 shadow-sm`}),s.jsx("p",{className:"text-center text-sm font-medium text-gray-800",children:y.name}),n.themeColor.id===y.id&&s.jsx("div",{className:"absolute top-2 right-2",children:s.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]})]},y.id))})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"グリッドレイアウト"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"音楽名刺のグリッドレイアウトを選択してください"}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:ne.map(y=>{var C;return s.jsxs("button",{onClick:()=>o({...n,gridLayout:y}),className:`p-4 rounded-lg border-2 transition-all text-left ${((C=n.gridLayout)==null?void 0:C.id)===y.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:[s.jsx("div",{className:"font-medium text-sm mb-1",children:y.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:[y.centerPositions.length===1?"中央1マス":"中央4マス","のアイコン配置"]}),s.jsx("div",{className:"mt-2 grid gap-0.5 w-12 h-12",style:{gridTemplateColumns:`repeat(${y.size}, 1fr)`,gridTemplateRows:`repeat(${y.size}, 1fr)`},children:Array.from({length:y.totalCells}).map((T,L)=>{const _=y.centerPositions.includes(L);return _&&y.centerPositions.length===4&&L!==y.centerPositions[0]?null:s.jsx("div",{className:`rounded-sm ${_?"bg-blue-400":"bg-gray-300"}`,style:_&&y.centerPositions.length===4?{gridColumn:`${y.centerPositions[0]%y.size+1} / span 2`,gridRow:`${Math.floor(y.centerPositions[0]/y.size)+1} / span 2`}:{}},L)})})]},y.id)})})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 flex flex-col h-full max-h-[calc(100vh-12rem)]",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["楽曲リスト (",n.songs.length,")"]}),s.jsxs("button",{onClick:()=>p(!0),className:"bg-blue-500 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors flex items-center gap-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"曲を追加"]})]}),n.songs.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500 flex-1 flex items-center justify-center flex-col",children:[s.jsx("div",{className:"text-4xl mb-4",children:"🎵"}),s.jsx("p",{children:"まだ楽曲が追加されていません"}),s.jsx("p",{className:"text-sm",children:"右上の「曲を追加」ボタンから楽曲を追加してみましょう"})]}):s.jsx("div",{className:"flex-1 min-h-0",children:s.jsx("div",{className:"h-full overflow-y-auto pr-2 space-y-3",children:n.songs.map(y=>s.jsxs("div",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[s.jsx("img",{src:y.jacket||"/default-cover.jpg",alt:y.title,className:"w-12 h-12 rounded object-cover"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-gray-900 truncate",children:y.title}),s.jsx("div",{className:"text-sm text-gray-500 truncate",children:y.artist})]}),s.jsx("button",{onClick:()=>{const C=y.id||`${y.title}-${y.artist}`.replace(/\s+/g,"-").toLowerCase();N(C)},className:"text-red-500 hover:text-red-700 p-1",title:"削除",children:"🗑️"})]},y.id))})})]})]}),f&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"楽曲を追加"}),s.jsx("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx(Ar,{onSelect:v,placeholder:"楽曲名やアーティスト名で検索...",username:t})]})}),s.jsxs("div",{className:"mt-8 bg-white rounded-xl shadow-lg p-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"共有"}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-blue-700 mb-3",children:"あなたの音楽名刺URL:"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:`${window.location.origin}/users/${t}`,readOnly:!0,className:"flex-1 px-3 py-2 bg-white border border-gray-300 rounded text-sm"}),s.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/users/${t}`)},className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors",children:"📋 コピー"})]})]})]})]}),d&&s.jsx(jl,{message:d.message,type:d.type,onClose:()=>u(null)})]}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-600",children:"プロフィールの読み込みに失敗しました"}),s.jsx("button",{onClick:()=>e("/login"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:"ログインページに戻る"})]})})}function Sl({title:e,artist:t,videoId:r,coverImage:n,onError:o}){const[a,i]=j.useState(!1),[l,c]=j.useState(!1),[d,u]=j.useState(0),[f]=j.useState(30),[p,x]=j.useState(1),[m,h]=j.useState(0),[g,b]=j.useState(!1),v=j.useRef(null),N=j.useRef(null),y=j.useRef(null),C=async()=>{try{b(!0);const S=Math.floor(Math.random()*30)+45;h(S),console.log(`🎵 サビ予測時間: ${S}秒`)}catch(S){console.error("サビ検出エラー:",S),h(0)}finally{b(!1)}},T=()=>{x(0);let S=0;y.current=setInterval(()=>{S+=.05,S>=1&&(S=1,clearInterval(y.current)),x(S)},50)},L=S=>{let P=p;y.current=setInterval(()=>{P-=.05,P<=0&&(P=0,clearInterval(y.current),S==null||S()),x(P)},50)},_=()=>{if(!r){o==null||o("YouTube動画IDが取得できませんでした");return}try{c(!1),i(!0),u(0),T(),N.current=setInterval(()=>{u(S=>{const P=S+1;return P>=f?(R(),f):P})},1e3),console.log(`▶️ YouTube試聴開始: ${e} - ${t}`),console.log(`🎥 Video ID: ${r}, Start: ${m}s`)}catch(S){console.error("YouTube再生エラー:",S),c(!0),i(!1),o==null||o("YouTube動画の再生に失敗しました")}},R=()=>{L(()=>{i(!1),u(0),N.current&&(clearInterval(N.current),N.current=null),y.current&&(clearInterval(y.current),y.current=null)}),console.log(`⏹️ YouTube試聴停止: ${e} - ${t}`)},M=()=>`https://www.youtube.com/embed/${r}?autoplay=1&start=${m}&end=${m+f}&controls=1&modestbranding=1&rel=0&showinfo=0&enablejsapi=1&origin=${window.location.origin}`,V=d/f*100,k=S=>{const P=Math.floor(S/60),I=S%60;return`${P}:${I.toString().padStart(2,"0")}`};return j.useEffect(()=>()=>{N.current&&clearInterval(N.current),y.current&&clearInterval(y.current)},[]),r?s.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden max-w-sm mx-auto",children:[s.jsx("div",{className:"relative aspect-video bg-black",children:a?s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("iframe",{ref:v,width:"100%",height:"100%",src:M(),title:`${e} by ${t}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"absolute inset-0",style:{opacity:p}}),s.jsx("button",{onClick:R,className:"absolute top-2 left-2 bg-black/70 text-white p-2 rounded-full hover:bg-black/90 transition-colors",children:s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})})}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 p-2",children:s.jsxs("div",{className:"flex items-center gap-2 text-white text-xs",children:[s.jsx("span",{children:k(d)}),s.jsx("div",{className:"flex-1 bg-gray-600 rounded-full h-1 overflow-hidden",children:s.jsx("div",{className:"h-full bg-red-500 transition-all duration-1000 ease-linear",style:{width:`${V}%`}})}),s.jsx("span",{children:k(f)})]})})]}):s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("img",{src:n,alt:`${e} by ${t}`,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:s.jsx("button",{onClick:_,disabled:l,className:`
                  w-16 h-16 rounded-full flex items-center justify-center transition-all duration-200
                  ${l?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700 hover:scale-110 shadow-lg"}
                `,children:l?s.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}):s.jsx("svg",{className:"w-8 h-8 text-white ml-1",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M8 5v14l11-7z"})})})}),s.jsx("div",{className:"absolute top-2 right-2 bg-black/70 rounded px-2 py-1",children:s.jsx("svg",{className:"w-6 h-4 text-red-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})})})]})}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 truncate mb-1",children:e}),s.jsx("p",{className:"text-sm text-gray-600 truncate mb-3",children:t}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsxs("button",{onClick:C,disabled:g,className:"flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-xs disabled:opacity-50",children:[g?s.jsx("div",{className:"w-3 h-3 border border-blue-500 border-t-transparent rounded-full animate-spin"}):s.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"サビ検出"]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[s.jsx("span",{children:"開始:"}),s.jsx("span",{className:"font-mono",children:k(m)})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),"30秒プレビュー"]}),a&&s.jsxs("span",{className:"text-red-500 font-medium flex items-center gap-1",children:[s.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),"再生中"]})]})]}),l&&s.jsx("div",{className:"px-4 pb-4",children:s.jsx("div",{className:"text-xs text-red-500 text-center bg-red-50 p-2 rounded",children:"YouTube動画の再生に失敗しました"})})]}):s.jsx("div",{className:"flex items-center justify-center p-4 bg-gray-100 rounded-lg",children:s.jsxs("div",{className:"text-center",children:[s.jsx("svg",{className:"w-8 h-8 text-gray-400 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),s.jsx("p",{className:"text-xs text-gray-500",children:"YouTube動画なし"})]})})}var lt={},Cl=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},js={},ce={};let Ir;const kl=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];ce.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};ce.getSymbolTotalCodewords=function(t){return kl[t]};ce.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};ce.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');Ir=t};ce.isKanjiModeEnabled=function(){return typeof Ir<"u"};ce.toSJIS=function(t){return Ir(t)};var Ot={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},e.from=function(n,o){if(e.isValid(n))return n;try{return t(n)}catch{return o}}})(Ot);function Ns(){this.buffer=[],this.length=0}Ns.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var El=Ns;function ct(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}ct.prototype.set=function(e,t,r,n){const o=e*this.size+t;this.data[o]=r,n&&(this.reservedBit[o]=!0)};ct.prototype.get=function(e,t){return this.data[e*this.size+t]};ct.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r};ct.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var _l=ct,Ss={};(function(e){const t=ce.getSymbolSize;e.getRowColCoords=function(n){if(n===1)return[];const o=Math.floor(n/7)+2,a=t(n),i=a===145?26:Math.ceil((a-13)/(2*o-2))*2,l=[a-7];for(let c=1;c<o-1;c++)l[c]=l[c-1]-i;return l.push(6),l.reverse()},e.getPositions=function(n){const o=[],a=e.getRowColCoords(n),i=a.length;for(let l=0;l<i;l++)for(let c=0;c<i;c++)l===0&&c===0||l===0&&c===i-1||l===i-1&&c===0||o.push([a[l],a[c]]);return o}})(Ss);var Cs={};const Tl=ce.getSymbolSize,yn=7;Cs.getPositions=function(t){const r=Tl(t);return[[0,0],[r-yn,0],[0,r-yn]]};var ks={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const a=o.size;let i=0,l=0,c=0,d=null,u=null;for(let f=0;f<a;f++){l=c=0,d=u=null;for(let p=0;p<a;p++){let x=o.get(f,p);x===d?l++:(l>=5&&(i+=t.N1+(l-5)),d=x,l=1),x=o.get(p,f),x===u?c++:(c>=5&&(i+=t.N1+(c-5)),u=x,c=1)}l>=5&&(i+=t.N1+(l-5)),c>=5&&(i+=t.N1+(c-5))}return i},e.getPenaltyN2=function(o){const a=o.size;let i=0;for(let l=0;l<a-1;l++)for(let c=0;c<a-1;c++){const d=o.get(l,c)+o.get(l,c+1)+o.get(l+1,c)+o.get(l+1,c+1);(d===4||d===0)&&i++}return i*t.N2},e.getPenaltyN3=function(o){const a=o.size;let i=0,l=0,c=0;for(let d=0;d<a;d++){l=c=0;for(let u=0;u<a;u++)l=l<<1&2047|o.get(d,u),u>=10&&(l===1488||l===93)&&i++,c=c<<1&2047|o.get(u,d),u>=10&&(c===1488||c===93)&&i++}return i*t.N3},e.getPenaltyN4=function(o){let a=0;const i=o.data.length;for(let c=0;c<i;c++)a+=o.data[c];return Math.abs(Math.ceil(a*100/i/5)-10)*t.N4};function r(n,o,a){switch(n){case e.Patterns.PATTERN000:return(o+a)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return a%3===0;case e.Patterns.PATTERN011:return(o+a)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(a/3))%2===0;case e.Patterns.PATTERN101:return o*a%2+o*a%3===0;case e.Patterns.PATTERN110:return(o*a%2+o*a%3)%2===0;case e.Patterns.PATTERN111:return(o*a%3+(o+a)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}e.applyMask=function(o,a){const i=a.size;for(let l=0;l<i;l++)for(let c=0;c<i;c++)a.isReserved(c,l)||a.xor(c,l,r(o,c,l))},e.getBestMask=function(o,a){const i=Object.keys(e.Patterns).length;let l=0,c=1/0;for(let d=0;d<i;d++){a(d),e.applyMask(d,o);const u=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(d,o),u<c&&(c=u,l=d)}return l}})(ks);var Dt={};const Ce=Ot,ft=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],mt=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Dt.getBlocksCount=function(t,r){switch(r){case Ce.L:return ft[(t-1)*4+0];case Ce.M:return ft[(t-1)*4+1];case Ce.Q:return ft[(t-1)*4+2];case Ce.H:return ft[(t-1)*4+3];default:return}};Dt.getTotalCodewordsCount=function(t,r){switch(r){case Ce.L:return mt[(t-1)*4+0];case Ce.M:return mt[(t-1)*4+1];case Ce.Q:return mt[(t-1)*4+2];case Ce.H:return mt[(t-1)*4+3];default:return}};var Es={},zt={};const Ze=new Uint8Array(512),Ct=new Uint8Array(256);(function(){let t=1;for(let r=0;r<255;r++)Ze[r]=t,Ct[t]=r,t<<=1,t&256&&(t^=285);for(let r=255;r<512;r++)Ze[r]=Ze[r-255]})();zt.log=function(t){if(t<1)throw new Error("log("+t+")");return Ct[t]};zt.exp=function(t){return Ze[t]};zt.mul=function(t,r){return t===0||r===0?0:Ze[Ct[t]+Ct[r]]};(function(e){const t=zt;e.mul=function(n,o){const a=new Uint8Array(n.length+o.length-1);for(let i=0;i<n.length;i++)for(let l=0;l<o.length;l++)a[i+l]^=t.mul(n[i],o[l]);return a},e.mod=function(n,o){let a=new Uint8Array(n);for(;a.length-o.length>=0;){const i=a[0];for(let c=0;c<o.length;c++)a[c]^=t.mul(o[c],i);let l=0;for(;l<a.length&&a[l]===0;)l++;a=a.slice(l)}return a},e.generateECPolynomial=function(n){let o=new Uint8Array([1]);for(let a=0;a<n;a++)o=e.mul(o,new Uint8Array([1,t.exp(a)]));return o}})(Es);const _s=Es;function Br(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}Br.prototype.initialize=function(t){this.degree=t,this.genPoly=_s.generateECPolynomial(this.degree)};Br.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(t.length+this.degree);r.set(t);const n=_s.mod(r,this.genPoly),o=this.degree-n.length;if(o>0){const a=new Uint8Array(this.degree);return a.set(n,o),a}return n};var Rl=Br,Ts={},Ee={},$r={};$r.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var be={};const Rs="[0-9]+",Ll="[A-Z $%*+\\-./:]+";let tt="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";tt=tt.replace(/u/g,"\\u");const Al="(?:(?![A-Z0-9 $%*+\\-./:]|"+tt+`)(?:.|[\r
]))+`;be.KANJI=new RegExp(tt,"g");be.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");be.BYTE=new RegExp(Al,"g");be.NUMERIC=new RegExp(Rs,"g");be.ALPHANUMERIC=new RegExp(Ll,"g");const Il=new RegExp("^"+tt+"$"),Bl=new RegExp("^"+Rs+"$"),$l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");be.testKanji=function(t){return Il.test(t)};be.testNumeric=function(t){return Bl.test(t)};be.testAlphanumeric=function(t){return $l.test(t)};(function(e){const t=$r,r=be;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(a,i){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!t.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?a.ccBits[0]:i<27?a.ccBits[1]:a.ccBits[2]},e.getBestModeForData=function(a){return r.testNumeric(a)?e.NUMERIC:r.testAlphanumeric(a)?e.ALPHANUMERIC:r.testKanji(a)?e.KANJI:e.BYTE},e.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},e.isValid=function(a){return a&&a.bit&&a.ccBits};function n(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(a,i){if(e.isValid(a))return a;try{return n(a)}catch{return i}}})(Ee);(function(e){const t=ce,r=Dt,n=Ot,o=Ee,a=$r,i=7973,l=t.getBCHDigit(i);function c(p,x,m){for(let h=1;h<=40;h++)if(x<=e.getCapacity(h,m,p))return h}function d(p,x){return o.getCharCountIndicator(p,x)+4}function u(p,x){let m=0;return p.forEach(function(h){const g=d(h.mode,x);m+=g+h.getBitsLength()}),m}function f(p,x){for(let m=1;m<=40;m++)if(u(p,m)<=e.getCapacity(m,x,o.MIXED))return m}e.from=function(x,m){return a.isValid(x)?parseInt(x,10):m},e.getCapacity=function(x,m,h){if(!a.isValid(x))throw new Error("Invalid QR Code version");typeof h>"u"&&(h=o.BYTE);const g=t.getSymbolTotalCodewords(x),b=r.getTotalCodewordsCount(x,m),v=(g-b)*8;if(h===o.MIXED)return v;const N=v-d(h,x);switch(h){case o.NUMERIC:return Math.floor(N/10*3);case o.ALPHANUMERIC:return Math.floor(N/11*2);case o.KANJI:return Math.floor(N/13);case o.BYTE:default:return Math.floor(N/8)}},e.getBestVersionForData=function(x,m){let h;const g=n.from(m,n.M);if(Array.isArray(x)){if(x.length>1)return f(x,g);if(x.length===0)return 1;h=x[0]}else h=x;return c(h.mode,h.getLength(),g)},e.getEncodedBits=function(x){if(!a.isValid(x)||x<7)throw new Error("Invalid QR Code version");let m=x<<12;for(;t.getBCHDigit(m)-l>=0;)m^=i<<t.getBCHDigit(m)-l;return x<<12|m}})(Ts);var Ls={};const br=ce,As=1335,Pl=21522,wn=br.getBCHDigit(As);Ls.getEncodedBits=function(t,r){const n=t.bit<<3|r;let o=n<<10;for(;br.getBCHDigit(o)-wn>=0;)o^=As<<br.getBCHDigit(o)-wn;return(n<<10|o)^Pl};var Is={};const Ul=Ee;function Fe(e){this.mode=Ul.NUMERIC,this.data=e.toString()}Fe.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};Fe.prototype.getLength=function(){return this.data.length};Fe.prototype.getBitsLength=function(){return Fe.getBitsLength(this.data.length)};Fe.prototype.write=function(t){let r,n,o;for(r=0;r+3<=this.data.length;r+=3)n=this.data.substr(r,3),o=parseInt(n,10),t.put(o,10);const a=this.data.length-r;a>0&&(n=this.data.substr(r),o=parseInt(n,10),t.put(o,a*3+1))};var Ml=Fe;const Ol=Ee,tr=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function He(e){this.mode=Ol.ALPHANUMERIC,this.data=e}He.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};He.prototype.getLength=function(){return this.data.length};He.prototype.getBitsLength=function(){return He.getBitsLength(this.data.length)};He.prototype.write=function(t){let r;for(r=0;r+2<=this.data.length;r+=2){let n=tr.indexOf(this.data[r])*45;n+=tr.indexOf(this.data[r+1]),t.put(n,11)}this.data.length%2&&t.put(tr.indexOf(this.data[r]),6)};var Dl=He;const zl=Ee;function Ve(e){this.mode=zl.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}Ve.getBitsLength=function(t){return t*8};Ve.prototype.getLength=function(){return this.data.length};Ve.prototype.getBitsLength=function(){return Ve.getBitsLength(this.data.length)};Ve.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var Fl=Ve;const Hl=Ee,Vl=ce;function qe(e){this.mode=Hl.KANJI,this.data=e}qe.getBitsLength=function(t){return t*13};qe.prototype.getLength=function(){return this.data.length};qe.prototype.getBitsLength=function(){return qe.getBitsLength(this.data.length)};qe.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=Vl.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),e.put(r,13)}};var ql=qe,Bs={exports:{}};(function(e){var t={single_source_shortest_paths:function(r,n,o){var a={},i={};i[n]=0;var l=t.PriorityQueue.make();l.push(n,0);for(var c,d,u,f,p,x,m,h,g;!l.empty();){c=l.pop(),d=c.value,f=c.cost,p=r[d]||{};for(u in p)p.hasOwnProperty(u)&&(x=p[u],m=f+x,h=i[u],g=typeof i[u]>"u",(g||h>m)&&(i[u]=m,l.push(u,m),a[u]=d))}if(typeof o<"u"&&typeof i[o]>"u"){var b=["Could not find a path from ",n," to ",o,"."].join("");throw new Error(b)}return a},extract_shortest_path_from_predecessor_list:function(r,n){for(var o=[],a=n;a;)o.push(a),r[a],a=r[a];return o.reverse(),o},find_path:function(r,n,o){var a=t.single_source_shortest_paths(r,n,o);return t.extract_shortest_path_from_predecessor_list(a,o)},PriorityQueue:{make:function(r){var n=t.PriorityQueue,o={},a;r=r||{};for(a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);return o.queue=[],o.sorter=r.sorter||n.default_sorter,o},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var o={value:r,cost:n};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(Bs);var Wl=Bs.exports;(function(e){const t=Ee,r=Ml,n=Dl,o=Fl,a=ql,i=be,l=ce,c=Wl;function d(b){return unescape(encodeURIComponent(b)).length}function u(b,v,N){const y=[];let C;for(;(C=b.exec(N))!==null;)y.push({data:C[0],index:C.index,mode:v,length:C[0].length});return y}function f(b){const v=u(i.NUMERIC,t.NUMERIC,b),N=u(i.ALPHANUMERIC,t.ALPHANUMERIC,b);let y,C;return l.isKanjiModeEnabled()?(y=u(i.BYTE,t.BYTE,b),C=u(i.KANJI,t.KANJI,b)):(y=u(i.BYTE_KANJI,t.BYTE,b),C=[]),v.concat(N,y,C).sort(function(L,_){return L.index-_.index}).map(function(L){return{data:L.data,mode:L.mode,length:L.length}})}function p(b,v){switch(v){case t.NUMERIC:return r.getBitsLength(b);case t.ALPHANUMERIC:return n.getBitsLength(b);case t.KANJI:return a.getBitsLength(b);case t.BYTE:return o.getBitsLength(b)}}function x(b){return b.reduce(function(v,N){const y=v.length-1>=0?v[v.length-1]:null;return y&&y.mode===N.mode?(v[v.length-1].data+=N.data,v):(v.push(N),v)},[])}function m(b){const v=[];for(let N=0;N<b.length;N++){const y=b[N];switch(y.mode){case t.NUMERIC:v.push([y,{data:y.data,mode:t.ALPHANUMERIC,length:y.length},{data:y.data,mode:t.BYTE,length:y.length}]);break;case t.ALPHANUMERIC:v.push([y,{data:y.data,mode:t.BYTE,length:y.length}]);break;case t.KANJI:v.push([y,{data:y.data,mode:t.BYTE,length:d(y.data)}]);break;case t.BYTE:v.push([{data:y.data,mode:t.BYTE,length:d(y.data)}])}}return v}function h(b,v){const N={},y={start:{}};let C=["start"];for(let T=0;T<b.length;T++){const L=b[T],_=[];for(let R=0;R<L.length;R++){const M=L[R],V=""+T+R;_.push(V),N[V]={node:M,lastCount:0},y[V]={};for(let k=0;k<C.length;k++){const S=C[k];N[S]&&N[S].node.mode===M.mode?(y[S][V]=p(N[S].lastCount+M.length,M.mode)-p(N[S].lastCount,M.mode),N[S].lastCount+=M.length):(N[S]&&(N[S].lastCount=M.length),y[S][V]=p(M.length,M.mode)+4+t.getCharCountIndicator(M.mode,v))}}C=_}for(let T=0;T<C.length;T++)y[C[T]].end=0;return{map:y,table:N}}function g(b,v){let N;const y=t.getBestModeForData(b);if(N=t.from(v,y),N!==t.BYTE&&N.bit<y.bit)throw new Error('"'+b+'" cannot be encoded with mode '+t.toString(N)+`.
 Suggested mode is: `+t.toString(y));switch(N===t.KANJI&&!l.isKanjiModeEnabled()&&(N=t.BYTE),N){case t.NUMERIC:return new r(b);case t.ALPHANUMERIC:return new n(b);case t.KANJI:return new a(b);case t.BYTE:return new o(b)}}e.fromArray=function(v){return v.reduce(function(N,y){return typeof y=="string"?N.push(g(y,null)):y.data&&N.push(g(y.data,y.mode)),N},[])},e.fromString=function(v,N){const y=f(v,l.isKanjiModeEnabled()),C=m(y),T=h(C,N),L=c.find_path(T.map,"start","end"),_=[];for(let R=1;R<L.length-1;R++)_.push(T.table[L[R]].node);return e.fromArray(x(_))},e.rawSplit=function(v){return e.fromArray(f(v,l.isKanjiModeEnabled()))}})(Is);const Ft=ce,rr=Ot,Jl=El,Kl=_l,Yl=Ss,Gl=Cs,yr=ks,wr=Dt,Xl=Rl,kt=Ts,Ql=Ls,Zl=Ee,nr=Is;function ec(e,t){const r=e.size,n=Gl.getPositions(t);for(let o=0;o<n.length;o++){const a=n[o][0],i=n[o][1];for(let l=-1;l<=7;l++)if(!(a+l<=-1||r<=a+l))for(let c=-1;c<=7;c++)i+c<=-1||r<=i+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?e.set(a+l,i+c,!0,!0):e.set(a+l,i+c,!1,!0))}}function tc(e){const t=e.size;for(let r=8;r<t-8;r++){const n=r%2===0;e.set(r,6,n,!0),e.set(6,r,n,!0)}}function rc(e,t){const r=Yl.getPositions(t);for(let n=0;n<r.length;n++){const o=r[n][0],a=r[n][1];for(let i=-2;i<=2;i++)for(let l=-2;l<=2;l++)i===-2||i===2||l===-2||l===2||i===0&&l===0?e.set(o+i,a+l,!0,!0):e.set(o+i,a+l,!1,!0)}}function nc(e,t){const r=e.size,n=kt.getEncodedBits(t);let o,a,i;for(let l=0;l<18;l++)o=Math.floor(l/3),a=l%3+r-8-3,i=(n>>l&1)===1,e.set(o,a,i,!0),e.set(a,o,i,!0)}function sr(e,t,r){const n=e.size,o=Ql.getEncodedBits(t,r);let a,i;for(a=0;a<15;a++)i=(o>>a&1)===1,a<6?e.set(a,8,i,!0):a<8?e.set(a+1,8,i,!0):e.set(n-15+a,8,i,!0),a<8?e.set(8,n-a-1,i,!0):a<9?e.set(8,15-a-1+1,i,!0):e.set(8,15-a-1,i,!0);e.set(n-8,8,1,!0)}function sc(e,t){const r=e.size;let n=-1,o=r-1,a=7,i=0;for(let l=r-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!e.isReserved(o,l-c)){let d=!1;i<t.length&&(d=(t[i]>>>a&1)===1),e.set(o,l-c,d),a--,a===-1&&(i++,a=7)}if(o+=n,o<0||r<=o){o-=n,n=-n;break}}}function oc(e,t,r){const n=new Jl;r.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),Zl.getCharCountIndicator(c.mode,e)),c.write(n)});const o=Ft.getSymbolTotalCodewords(e),a=wr.getTotalCodewordsCount(e,t),i=(o-a)*8;for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const l=(i-n.getLengthInBits())/8;for(let c=0;c<l;c++)n.put(c%2?17:236,8);return ac(n,e,t)}function ac(e,t,r){const n=Ft.getSymbolTotalCodewords(t),o=wr.getTotalCodewordsCount(t,r),a=n-o,i=wr.getBlocksCount(t,r),l=n%i,c=i-l,d=Math.floor(n/i),u=Math.floor(a/i),f=u+1,p=d-u,x=new Xl(p);let m=0;const h=new Array(i),g=new Array(i);let b=0;const v=new Uint8Array(e.buffer);for(let L=0;L<i;L++){const _=L<c?u:f;h[L]=v.slice(m,m+_),g[L]=x.encode(h[L]),m+=_,b=Math.max(b,_)}const N=new Uint8Array(n);let y=0,C,T;for(C=0;C<b;C++)for(T=0;T<i;T++)C<h[T].length&&(N[y++]=h[T][C]);for(C=0;C<p;C++)for(T=0;T<i;T++)N[y++]=g[T][C];return N}function ic(e,t,r,n){let o;if(Array.isArray(e))o=nr.fromArray(e);else if(typeof e=="string"){let d=t;if(!d){const u=nr.rawSplit(e);d=kt.getBestVersionForData(u,r)}o=nr.fromString(e,d||40)}else throw new Error("Invalid data");const a=kt.getBestVersionForData(o,r);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=a;else if(t<a)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+a+`.
`);const i=oc(t,r,o),l=Ft.getSymbolSize(t),c=new Kl(l);return ec(c,t),tc(c),rc(c,t),sr(c,r,0),t>=7&&nc(c,t),sc(c,i),isNaN(n)&&(n=yr.getBestMask(c,sr.bind(null,c,r))),yr.applyMask(n,c),sr(c,r,n),{modules:c,version:t,errorCorrectionLevel:r,maskPattern:n,segments:o}}js.create=function(t,r){if(typeof t>"u"||t==="")throw new Error("No input text");let n=rr.M,o,a;return typeof r<"u"&&(n=rr.from(r.errorCorrectionLevel,rr.M),o=kt.from(r.version),a=yr.from(r.maskPattern),r.toSJISFunc&&Ft.setToSJISFunction(r.toSJISFunc)),ic(t,o,n,a)};var $s={},Pr={};(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(a){return[a,a]}))),n.length===6&&n.push("F","F");const o=parseInt(n.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+n.slice(0,6).join("")}}e.getOptions=function(n){n||(n={}),n.color||(n.color={});const o=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,a=n.width&&n.width>=21?n.width:void 0,i=n.scale||4;return{width:a,scale:a?4:i,margin:o,color:{dark:t(n.color.dark||"#000000ff"),light:t(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},e.getScale=function(n,o){return o.width&&o.width>=n+o.margin*2?o.width/(n+o.margin*2):o.scale},e.getImageWidth=function(n,o){const a=e.getScale(n,o);return Math.floor((n+o.margin*2)*a)},e.qrToImageData=function(n,o,a){const i=o.modules.size,l=o.modules.data,c=e.getScale(i,a),d=Math.floor((i+a.margin*2)*c),u=a.margin*c,f=[a.color.light,a.color.dark];for(let p=0;p<d;p++)for(let x=0;x<d;x++){let m=(p*d+x)*4,h=a.color.light;if(p>=u&&x>=u&&p<d-u&&x<d-u){const g=Math.floor((p-u)/c),b=Math.floor((x-u)/c);h=f[l[g*i+b]?1:0]}n[m++]=h.r,n[m++]=h.g,n[m++]=h.b,n[m]=h.a}}})(Pr);(function(e){const t=Pr;function r(o,a,i){o.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=i,a.width=i,a.style.height=i+"px",a.style.width=i+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(a,i,l){let c=l,d=i;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),i||(d=n()),c=t.getOptions(c);const u=t.getImageWidth(a.modules.size,c),f=d.getContext("2d"),p=f.createImageData(u,u);return t.qrToImageData(p.data,a,c),r(f,d,u),f.putImageData(p,0,0),d},e.renderToDataURL=function(a,i,l){let c=l;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),c||(c={});const d=e.render(a,i,c),u=c.type||"image/png",f=c.rendererOpts||{};return d.toDataURL(u,f.quality)}})($s);var Ps={};const lc=Pr;function vn(e,t){const r=e.a/255,n=t+'="'+e.hex+'"';return r<1?n+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function or(e,t,r){let n=e+t;return typeof r<"u"&&(n+=" "+r),n}function cc(e,t,r){let n="",o=0,a=!1,i=0;for(let l=0;l<e.length;l++){const c=Math.floor(l%t),d=Math.floor(l/t);!c&&!a&&(a=!0),e[l]?(i++,l>0&&c>0&&e[l-1]||(n+=a?or("M",c+r,.5+d+r):or("m",o,0),o=0,a=!1),c+1<t&&e[l+1]||(n+=or("h",i),i=0)):o++}return n}Ps.render=function(t,r,n){const o=lc.getOptions(r),a=t.modules.size,i=t.modules.data,l=a+o.margin*2,c=o.color.light.a?"<path "+vn(o.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",d="<path "+vn(o.color.dark,"stroke")+' d="'+cc(i,a,o.margin)+'"/>',u='viewBox="0 0 '+l+" "+l+'"',p='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+u+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof n=="function"&&n(null,p),p};const dc=Cl,vr=js,Us=$s,uc=Ps;function Ur(e,t,r,n,o){const a=[].slice.call(arguments,1),i=a.length,l=typeof a[i-1]=="function";if(!l&&!dc())throw new Error("Callback required as last argument");if(l){if(i<2)throw new Error("Too few arguments provided");i===2?(o=r,r=t,t=n=void 0):i===3&&(t.getContext&&typeof o>"u"?(o=n,n=void 0):(o=n,n=r,r=t,t=void 0))}else{if(i<1)throw new Error("Too few arguments provided");return i===1?(r=t,t=n=void 0):i===2&&!t.getContext&&(n=r,r=t,t=void 0),new Promise(function(c,d){try{const u=vr.create(r,n);c(e(u,t,n))}catch(u){d(u)}})}try{const c=vr.create(r,n);o(null,e(c,t,n))}catch(c){o(c)}}lt.create=vr.create;lt.toCanvas=Ur.bind(null,Us.render);lt.toDataURL=Ur.bind(null,Us.renderToDataURL);lt.toString=Ur.bind(null,function(e,t,r){return uc.render(e,r)});var Ms={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function r(){for(var a="",i=0;i<arguments.length;i++){var l=arguments[i];l&&(a=o(a,n(l)))}return a}function n(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return r.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var i="";for(var l in a)t.call(a,l)&&a[l]&&(i=o(i,l));return i}function o(a,i){return i?a?a+" "+i:a+i:a}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(Ms);var hc=Ms.exports;const Os=at(hc);var jr={exports:{}},Nr={exports:{}},rt=1e3,nt=rt*60,st=nt*60,ot=st*24,fc=ot*365.25,mc=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return gc(e);if(r==="number"&&isNaN(e)===!1)return t.long?xc(e):pc(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function gc(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*fc;case"days":case"day":case"d":return r*ot;case"hours":case"hour":case"hrs":case"hr":case"h":return r*st;case"minutes":case"minute":case"mins":case"min":case"m":return r*nt;case"seconds":case"second":case"secs":case"sec":case"s":return r*rt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function pc(e){return e>=ot?Math.round(e/ot)+"d":e>=st?Math.round(e/st)+"h":e>=nt?Math.round(e/nt)+"m":e>=rt?Math.round(e/rt)+"s":e+"ms"}function xc(e){return gt(e,ot,"day")||gt(e,st,"hour")||gt(e,nt,"minute")||gt(e,rt,"second")||e+" ms"}function gt(e,t,r){if(!(e<t))return e<t*1.5?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}(function(e,t){t=e.exports=o.debug=o.default=o,t.coerce=c,t.disable=i,t.enable=a,t.enabled=l,t.humanize=mc,t.names=[],t.skips=[],t.formatters={};var r;function n(d){var u=0,f;for(f in d)u=(u<<5)-u+d.charCodeAt(f),u|=0;return t.colors[Math.abs(u)%t.colors.length]}function o(d){function u(){if(u.enabled){var f=u,p=+new Date,x=p-(r||p);f.diff=x,f.prev=r,f.curr=p,r=p;for(var m=new Array(arguments.length),h=0;h<m.length;h++)m[h]=arguments[h];m[0]=t.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");var g=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,function(v,N){if(v==="%%")return v;g++;var y=t.formatters[N];if(typeof y=="function"){var C=m[g];v=y.call(f,C),m.splice(g,1),g--}return v}),t.formatArgs.call(f,m);var b=u.log||t.log||console.log.bind(console);b.apply(f,m)}}return u.namespace=d,u.enabled=t.enabled(d),u.useColors=t.useColors(),u.color=n(d),typeof t.init=="function"&&t.init(u),u}function a(d){t.save(d),t.names=[],t.skips=[];for(var u=(typeof d=="string"?d:"").split(/[\s,]+/),f=u.length,p=0;p<f;p++)u[p]&&(d=u[p].replace(/\*/g,".*?"),d[0]==="-"?t.skips.push(new RegExp("^"+d.substr(1)+"$")):t.names.push(new RegExp("^"+d+"$")))}function i(){t.enable("")}function l(d){var u,f;for(u=0,f=t.skips.length;u<f;u++)if(t.skips[u].test(d))return!1;for(u=0,f=t.names.length;u<f;u++)if(t.names[u].test(d))return!0;return!1}function c(d){return d instanceof Error?d.stack||d.message:d}})(Nr,Nr.exports);var bc=Nr.exports;(function(e,t){t=e.exports=bc,t.log=o,t.formatArgs=n,t.save=a,t.load=i,t.useColors=r,t.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:l(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function r(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}t.formatters.j=function(c){try{return JSON.stringify(c)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}};function n(c){var d=this.useColors;if(c[0]=(d?"%c":"")+this.namespace+(d?" %c":" ")+c[0]+(d?"%c ":" ")+"+"+t.humanize(this.diff),!!d){var u="color: "+this.color;c.splice(1,0,u,"color: inherit");var f=0,p=0;c[0].replace(/%[a-zA-Z%]/g,function(x){x!=="%%"&&(f++,x==="%c"&&(p=f))}),c.splice(p,0,u)}}function o(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(c){try{c==null?t.storage.removeItem("debug"):t.storage.debug=c}catch{}}function i(){var c;try{c=t.storage.debug}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}t.enable(i());function l(){try{return window.localStorage}catch{}}})(jr,jr.exports);var yc=jr.exports,jn=yc("jsonp"),wc=Nc,vc=0;function jc(){}function Nc(e,t,r){typeof t=="function"&&(r=t,t={}),t||(t={});var n=t.prefix||"__jp",o=t.name||n+vc++,a=t.param||"callback",i=t.timeout!=null?t.timeout:6e4,l=encodeURIComponent,c=document.getElementsByTagName("script")[0]||document.head,d,u;i&&(u=setTimeout(function(){f(),r&&r(new Error("Timeout"))},i));function f(){d.parentNode&&d.parentNode.removeChild(d),window[o]=jc,u&&clearTimeout(u)}function p(){window[o]&&f()}return window[o]=function(x){jn("jsonp got",x),f(),r&&r(null,x)},e+=(~e.indexOf("?")?"&":"?")+a+"="+l(o),e=e.replace("?&","?"),jn('jsonp req "%s"',e),d=document.createElement("script"),d.src=e,c.parentNode.insertBefore(d,c),p}const $e=at(wc);var Sc=Object.defineProperty,Cc=Object.defineProperties,kc=Object.getOwnPropertyDescriptors,Et=Object.getOwnPropertySymbols,Ds=Object.prototype.hasOwnProperty,zs=Object.prototype.propertyIsEnumerable,Nn=(e,t,r)=>t in e?Sc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,le=(e,t)=>{for(var r in t||(t={}))Ds.call(t,r)&&Nn(e,r,t[r]);if(Et)for(var r of Et(t))zs.call(t,r)&&Nn(e,r,t[r]);return e},Ht=(e,t)=>Cc(e,kc(t)),Vt=(e,t)=>{var r={};for(var n in e)Ds.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Et)for(var n of Et(e))t.indexOf(n)<0&&zs.call(e,n)&&(r[n]=e[n]);return r};function qt(e){return r=>{var n=r,{bgStyle:o={},borderRadius:a=0,iconFillColor:i="white",round:l=!1,size:c=64}=n,d=Vt(n,["bgStyle","borderRadius","iconFillColor","round","size"]);return s.jsxs("svg",Ht(le({viewBox:"0 0 64 64",width:c,height:c},d),{children:[l?s.jsx("circle",{cx:"32",cy:"32",r:"32",fill:e.color,style:o}):s.jsx("rect",{width:"64",height:"64",rx:a,ry:a,fill:e.color,style:o}),s.jsx("path",{d:e.path,fill:i})]}))}}class Ec extends Error{constructor(t){super(t),this.name="AssertionError"}}function W(e,t){if(!e)throw new Ec(t)}function H(e){const t=Object.entries(e).filter(([,r])=>r!=null).map(([r,n])=>`${encodeURIComponent(r)}=${encodeURIComponent(String(n))}`);return t.length>0?`?${t.join("&")}`:""}const _c=e=>!!e&&(typeof e=="object"||typeof e=="function")&&"then"in e&&typeof e.then=="function",Tc=(e,t)=>({left:window.outerWidth/2+(window.screenX||window.screenLeft||0)-e/2,top:window.outerHeight/2+(window.screenY||window.screenTop||0)-t/2}),Rc=(e,t)=>({top:(window.screen.height-t)/2,left:(window.screen.width-e)/2});function Lc(e,t,r){var n=t,{height:o,width:a}=n,i=Vt(n,["height","width"]);const l=le({height:o,width:a,location:"no",toolbar:"no",status:"no",directories:"no",menubar:"no",scrollbars:"yes",resizable:"no",centerscreen:"yes",chrome:"yes"},i),c=window.open(e,"",Object.keys(l).map(d=>`${d}=${l[d]}`).join(", "));if(r){const d=window.setInterval(()=>{try{(c===null||c.closed)&&(window.clearInterval(d),r(c))}catch(u){console.error(u)}},1e3)}return c}function Ac(e){var t=e,{beforeOnClick:r,children:n,className:o,disabled:a,disabledStyle:i={opacity:.6},forwardedRef:l,htmlTitle:c,networkLink:d,networkName:u,onClick:f,onShareWindowClose:p,openShareDialogOnClick:x=!0,opts:m,resetButtonStyle:h=!0,style:g,title:b,url:v,windowHeight:N=400,windowPosition:y="windowCenter",windowWidth:C=550}=t,T=Vt(t,["beforeOnClick","children","className","disabled","disabledStyle","forwardedRef","htmlTitle","networkLink","networkName","onClick","onShareWindowClose","openShareDialogOnClick","opts","resetButtonStyle","style","title","url","windowHeight","windowPosition","windowWidth"]);const L=async M=>{const V=d(v,m);if(!a){if(M.preventDefault(),r){const k=r();_c(k)&&await k}if(x){const k=le({height:N,width:C},y==="windowCenter"?Tc(C,N):Rc(C,N));Lc(V,k,p)}f&&f(M,V)}},_=Os("react-share__ShareButton",{"react-share__ShareButton--disabled":!!a,disabled:!!a},o),R=le(le(h?{backgroundColor:"transparent",border:"none",padding:0,font:"inherit",color:"inherit",cursor:"pointer"}:{},g),a&&i);return s.jsx("button",Ht(le({},T),{className:_,onClick:L,ref:l,style:R,title:c,children:n}))}function J(e,t,r,n){const o=(a,i)=>{const l=r(a),c=le({},a);return Object.keys(l).forEach(u=>{delete c[u]}),s.jsx(Ac,Ht(le(le({},n),c),{forwardedRef:i,networkName:e,networkLink:t,opts:l}))};return o.displayName=`ShareButton-${e}`,j.forwardRef(o)}function Ic(e,{title:t,separator:r}){return W(e,"bluesky.url"),"https://bsky.app/intent/compose"+H({text:t?t+r+e:e})}J("bluesky",Ic,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function Bc(e,{subject:t,body:r,separator:n}){return"mailto:"+H({subject:t,body:r?r+n+e:e})}J("email",Bc,e=>({subject:e.subject,body:e.body,separator:e.separator||" "}),{openShareDialogOnClick:!1,onClick:(e,t)=>{window.location.href=t}});const $c=qt({color:"#0965FE",path:"M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z"});function Pc(e,{appId:t,redirectUri:r,to:n}){return"https://www.facebook.com/dialog/send"+H({link:e,redirect_uri:r||e,app_id:t,to:n})}J("facebookmessenger",Pc,e=>({appId:e.appId,redirectUri:e.redirectUri,to:e.to}),{windowWidth:1e3,windowHeight:820});function Uc(e,{hashtag:t}){return W(e,"facebook.url"),"https://www.facebook.com/sharer/sharer.php"+H({u:e,hashtag:t})}const Mc=J("facebook",Uc,e=>({hashtag:e.hashtag}),{windowWidth:550,windowHeight:400});function Oc(){const e=j.useRef(!1);return j.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),j.useCallback(()=>e.current,[])}function Dc(e){var t=e,{children:r=p=>p,className:n,getCount:o,url:a}=t,i=Vt(t,["children","className","getCount","url"]);const l=Oc(),[c,d]=j.useState(void 0),[u,f]=j.useState(!1);return j.useEffect(()=>{f(!0),o(a,p=>{l()&&(d(p),f(!1))})},[a]),s.jsx("span",Ht(le({className:Os("react-share__ShareCount",n)},i),{children:!u&&c!==void 0&&r(c)}))}function Pe(e){const t=r=>s.jsx(Dc,le({getCount:e},r));return t.displayName=`ShareCount(${e.name})`,t}function zc(e,t){const r=`https://graph.facebook.com/?id=${e}&fields=og_object{engagement}`;$e(r,(n,o)=>{t(!n&&o&&o.og_object&&o.og_object.engagement?o.og_object.engagement.count:void 0)})}Pe(zc);function Fc(e,{title:t}){return W(e,"hatena.url"),`http://b.hatena.ne.jp/add?mode=confirm&url=${e}&title=${t}`}J("hatena",Fc,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function Hc(e,t){$e("https://bookmark.hatenaapis.com/count/entry"+H({url:e}),(n,o)=>{t(o??void 0)})}Pe(Hc);function Vc(e,{title:t,description:r}){return W(e,"instapaper.url"),"http://www.instapaper.com/hello2"+H({url:e,title:t,description:r})}J("instapaper",Vc,e=>({title:e.title,description:e.description}),{windowWidth:500,windowHeight:500,windowPosition:"windowCenter"});const qc=qt({color:"#00b800",path:"M52.62 30.138c0 3.693-1.432 7.019-4.42 10.296h.001c-4.326 4.979-14 11.044-16.201 11.972-2.2.927-1.876-.591-1.786-1.112l.294-1.765c.069-.527.142-1.343-.066-1.865-.232-.574-1.146-.872-1.817-1.016-9.909-1.31-17.245-8.238-17.245-16.51 0-9.226 9.251-16.733 20.62-16.733 11.37 0 20.62 7.507 20.62 16.733zM27.81 25.68h-1.446a.402.402 0 0 0-.402.401v8.985c0 .221.18.4.402.4h1.446a.401.401 0 0 0 .402-.4v-8.985a.402.402 0 0 0-.402-.401zm9.956 0H36.32a.402.402 0 0 0-.402.401v5.338L31.8 25.858a.39.39 0 0 0-.031-.04l-.002-.003-.024-.025-.008-.007a.313.313 0 0 0-.032-.026.255.255 0 0 1-.021-.014l-.012-.007-.021-.012-.013-.006-.023-.01-.013-.005-.024-.008-.014-.003-.023-.005-.017-.002-.021-.003-.021-.002h-1.46a.402.402 0 0 0-.402.401v8.985c0 .221.18.4.402.4h1.446a.401.401 0 0 0 .402-.4v-5.337l4.123 5.568c.028.04.063.072.101.099l.004.003a.236.236 0 0 0 .025.015l.012.006.019.01a.154.154 0 0 1 .019.008l.012.004.028.01.005.001a.442.442 0 0 0 .104.013h1.446a.4.4 0 0 0 .401-.4v-8.985a.402.402 0 0 0-.401-.401zm-13.442 7.537h-3.93v-7.136a.401.401 0 0 0-.401-.401h-1.447a.4.4 0 0 0-.401.401v8.984a.392.392 0 0 0 .123.29c.072.068.17.111.278.111h5.778a.4.4 0 0 0 .401-.401v-1.447a.401.401 0 0 0-.401-.401zm21.429-5.287c.222 0 .401-.18.401-.402v-1.446a.401.401 0 0 0-.401-.402h-5.778a.398.398 0 0 0-.279.113l-.005.004-.006.008a.397.397 0 0 0-.111.276v8.984c0 .108.043.206.112.278l.005.006a.401.401 0 0 0 .284.117h5.778a.4.4 0 0 0 .401-.401v-1.447a.401.401 0 0 0-.401-.401h-3.93v-1.519h3.93c.222 0 .401-.18.401-.402V29.85a.401.401 0 0 0-.401-.402h-3.93V27.93h3.93z"});function Wc(e,{title:t}){return W(e,"line.url"),"https://social-plugins.line.me/lineit/share"+H({url:e,text:t})}const Jc=J("line",Wc,e=>({title:e.title}),{windowWidth:500,windowHeight:500});function Kc(e,{title:t,summary:r,source:n}){return W(e,"linkedin.url"),"https://linkedin.com/shareArticle"+H({url:e,mini:"true",title:t,summary:r,source:n})}J("linkedin",Kc,({title:e,summary:t,source:r})=>({title:e,summary:t,source:r}),{windowWidth:750,windowHeight:600});function Yc(e,{title:t,description:r}){return W(e,"livejournal.url"),"https://www.livejournal.com/update.bml"+H({subject:t,event:r})}J("livejournal",Yc,e=>({title:e.title,description:e.description}),{windowWidth:660,windowHeight:460});function Gc(e,{title:t,description:r,imageUrl:n}){return W(e,"mailru.url"),"https://connect.mail.ru/share"+H({url:e,title:t,description:r,image_url:n})}J("mailru",Gc,e=>({title:e.title,description:e.description,imageUrl:e.imageUrl}),{windowWidth:660,windowHeight:460});function Xc(e,{title:t,description:r,image:n}){return W(e,"ok.url"),"https://connect.ok.ru/offer"+H({url:e,title:t,description:r,imageUrl:n})}J("ok",Xc,e=>({title:e.title,description:e.description,image:e.image}),{windowWidth:588,windowHeight:480,windowPosition:"screenCenter"});function Qc(e,t){window.OK||(window.OK={Share:{count:function(a,i){var l,c;(c=(l=window.OK.callbacks)[a])==null||c.call(l,i)}},callbacks:[]});const r="https://connect.ok.ru/dk",n=window.OK.callbacks.length;return window.ODKL={updateCount(o,a){var i,l;const c=o===""?0:parseInt(o.replace("react-share-",""),10);(l=(i=window.OK.callbacks)[c])==null||l.call(i,a===""?void 0:parseInt(a,10))}},window.OK.callbacks.push(t),$e(r+H({"st.cmd":"extLike",uid:`react-share-${n}`,ref:e}))}Pe(Qc);function Zc(e,{media:t,description:r,pinId:n}){return n?`https://pinterest.com/pin/${n}/repin/x/`:(W(e,"pinterest.url"),W(t,"pinterest.media"),"https://pinterest.com/pin/create/button/"+H({url:e,media:t,description:r}))}J("pinterest",Zc,e=>({media:e.media,description:e.description,pinId:e.pinId}),{windowWidth:1e3,windowHeight:730});function ed(e,t){$e("https://api.pinterest.com/v1/urls/count.json"+H({url:e}),(n,o)=>{t(o?o.count:void 0)})}Pe(ed);function td(e,{title:t}){return W(e,"pocket.url"),"https://getpocket.com/save"+H({url:e,title:t})}J("pocket",td,e=>({title:e.title}),{windowWidth:500,windowHeight:500});function rd(e,{title:t}){return W(e,"reddit.url"),"https://www.reddit.com/web/submit"+H({url:e,title:t})}J("reddit",rd,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function nd(e,{title:t}){return W(e,"gab.url"),"https://gab.com/compose"+H({url:e,text:t})}J("gab",nd,e=>({title:e.title}),{windowWidth:660,windowHeight:640,windowPosition:"windowCenter"});function sd(e,t){const r=`https://www.reddit.com/api/info.json?limit=1&url=${e}`;$e(r,{param:"jsonp"},(n,o)=>{t(!n&&o&&o.data&&o.data.children.length>0&&o.data.children[0].data.score?o.data.children[0].data.score:void 0)})}Pe(sd);function od(e,{title:t}){return W(e,"telegram.url"),"https://telegram.me/share/url"+H({url:e,text:t})}J("telegram",od,e=>({title:e.title}),{windowWidth:550,windowHeight:400});function ad(e,{title:t}){return W(e,"threads.url"),"https://threads.net/intent/post"+H({url:e,text:t})}J("threads",ad,e=>({title:e.title}),{windowWidth:550,windowHeight:600});function id(e,{title:t,caption:r,tags:n,posttype:o}){return W(e,"tumblr.url"),"https://www.tumblr.com/widgets/share/tool"+H({canonicalUrl:e,title:t,caption:r,tags:n,posttype:o})}J("tumblr",id,e=>({title:e.title,tags:(e.tags||[]).join(","),caption:e.caption,posttype:e.posttype||"link"}),{windowWidth:660,windowHeight:460});function ld(e,t){return $e("https://api.tumblr.com/v2/share/stats"+H({url:e}),(n,o)=>{t(!n&&o&&o.response?o.response.note_count:void 0)})}Pe(ld);const cd=qt({color:"#00aced",path:"M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"});function dd(e,{title:t,via:r,hashtags:n=[],related:o=[]}){return W(e,"twitter.url"),W(Array.isArray(n),"twitter.hashtags is not an array"),W(Array.isArray(o),"twitter.related is not an array"),"https://twitter.com/intent/tweet"+H({url:e,text:t,via:r,hashtags:n.length>0?n.join(","):void 0,related:o.length>0?o.join(","):void 0})}const ud=J("twitter",dd,e=>({hashtags:e.hashtags,title:e.title,via:e.via,related:e.related}),{windowWidth:550,windowHeight:400});function hd(e,{title:t,separator:r}){return W(e,"viber.url"),"viber://forward"+H({text:t?t+r+e:e})}J("viber",hd,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:660,windowHeight:460});function fd(e,{title:t,image:r,noParse:n,noVkLinks:o}){return W(e,"vk.url"),"https://vk.com/share.php"+H({url:e,title:t,image:r,noparse:n?1:0,no_vk_links:o?1:0})}J("vk",fd,e=>({title:e.title,image:e.image,noParse:e.noParse,noVkLinks:e.noVkLinks}),{windowWidth:660,windowHeight:460});function md(e,t){window.VK||(window.VK={}),window.VK.Share={count:(o,a)=>{var i,l;return(l=(i=window.VK.callbacks)==null?void 0:i[o])==null?void 0:l.call(i,a)}},window.VK.callbacks=[];const r="https://vk.com/share.php",n=window.VK.callbacks.length;return window.VK.callbacks.push(t),$e(r+H({act:"count",index:n,url:e}))}Pe(md);function gd(e,{title:t,image:r}){return W(e,"weibo.url"),"http://service.weibo.com/share/share.php"+H({url:e,title:t,pic:r})}J("weibo",gd,e=>({title:e.title,image:e.image}),{windowWidth:660,windowHeight:550,windowPosition:"screenCenter"});const pd=qt({color:"#25D366",path:"m42.32286,33.93287c-0.5178,-0.2589 -3.04726,-1.49644 -3.52105,-1.66732c-0.4712,-0.17346 -0.81554,-0.2589 -1.15987,0.2589c-0.34175,0.51004 -1.33075,1.66474 -1.63108,2.00648c-0.30032,0.33658 -0.60064,0.36247 -1.11327,0.12945c-0.5178,-0.2589 -2.17994,-0.80259 -4.14759,-2.56312c-1.53269,-1.37217 -2.56312,-3.05503 -2.86603,-3.57283c-0.30033,-0.5178 -0.03366,-0.80259 0.22524,-1.06149c0.23301,-0.23301 0.5178,-0.59547 0.7767,-0.90616c0.25372,-0.31068 0.33657,-0.5178 0.51262,-0.85437c0.17088,-0.36246 0.08544,-0.64725 -0.04402,-0.90615c-0.12945,-0.2589 -1.15987,-2.79613 -1.58964,-3.80584c-0.41424,-1.00971 -0.84142,-0.88027 -1.15987,-0.88027c-0.29773,-0.02588 -0.64208,-0.02588 -0.98382,-0.02588c-0.34693,0 -0.90616,0.12945 -1.37736,0.62136c-0.4712,0.5178 -1.80194,1.76053 -1.80194,4.27186c0,2.51134 1.84596,4.945 2.10227,5.30747c0.2589,0.33657 3.63497,5.51458 8.80262,7.74113c1.23237,0.5178 2.1903,0.82848 2.94111,1.08738c1.23237,0.38836 2.35599,0.33657 3.24402,0.20712c0.99159,-0.15534 3.04985,-1.24272 3.47963,-2.45956c0.44013,-1.21683 0.44013,-2.22654 0.31068,-2.45955c-0.12945,-0.23301 -0.46601,-0.36247 -0.98382,-0.59548m-9.40068,12.84407l-0.02589,0c-3.05503,0 -6.08417,-0.82849 -8.72495,-2.38189l-0.62136,-0.37023l-6.47252,1.68286l1.73463,-6.29129l-0.41424,-0.64725c-1.70875,-2.71846 -2.6149,-5.85116 -2.6149,-9.07706c0,-9.39809 7.68934,-17.06155 17.15993,-17.06155c4.58253,0 8.88029,1.78642 12.11655,5.02268c3.23625,3.21036 5.02267,7.50812 5.02267,12.06476c-0.0078,9.3981 -7.69712,17.06155 -17.14699,17.06155m14.58906,-31.58846c-3.93529,-3.80584 -9.1133,-5.95471 -14.62789,-5.95471c-11.36055,0 -20.60848,9.2065 -20.61625,20.52564c0,3.61684 0.94757,7.14565 2.75211,10.26282l-2.92557,10.63564l10.93337,-2.85309c3.0136,1.63108 6.4052,2.4958 9.85634,2.49839l0.01037,0c11.36574,0 20.61884,-9.2091 20.62403,-20.53082c0,-5.48093 -2.14111,-10.64081 -6.03239,-14.51915"});function xd(){return/(android|iphone|ipad|mobile)/i.test(navigator.userAgent)}function bd(e,{title:t,separator:r}){return W(e,"whatsapp.url"),"https://"+(xd()?"api":"web")+".whatsapp.com/send"+H({text:t?t+r+e:e})}const yd=J("whatsapp",bd,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:550,windowHeight:400});function wd(e,{quote:t,hashtag:r}){return W(e,"workplace.url"),"https://work.facebook.com/sharer.php"+H({u:e,quote:t,hashtag:r})}J("workplace",wd,e=>({quote:e.quote,hashtag:e.hashtag}),{windowWidth:550,windowHeight:400});function vd({username:e,displayName:t,bio:r,className:n=""}){const[o,a]=j.useState(""),[i,l]=j.useState(!1),[c,d]=j.useState(!1),u=`${window.location.origin}/users/${e}`,f=`${t}の音楽名刺をチェック！ ${r?`"${r}"`:""}`;j.useEffect(()=>{(async()=>{try{const m=await lt.toDataURL(u,{width:256,margin:2,color:{dark:"#000000",light:"#ffffff"}});a(m)}catch(m){console.error("QRコード生成エラー:",m)}})()},[u]);const p=async()=>{try{await navigator.clipboard.writeText(u),d(!0),setTimeout(()=>d(!1),2e3)}catch(x){console.error("クリップボードコピーエラー:",x)}};return s.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 ${n}`,children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"プロフィールを共有"]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロフィールURL"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:u,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-sm"}),s.jsx("button",{onClick:p,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c?"bg-green-100 text-green-800":"bg-blue-500 text-white hover:bg-blue-600"}`,children:c?"✓ コピー済み":"コピー"})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>l(!i),className:"flex items-center text-blue-600 hover:text-blue-800 text-sm font-medium",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"QRコードを",i?"非表示":"表示"]}),i&&o&&s.jsxs("div",{className:"mt-3 text-center",children:[s.jsx("img",{src:o,alt:"プロフィールQRコード",className:"mx-auto border border-gray-200 rounded-lg"}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"スマートフォンでQRコードを読み取ってプロフィールにアクセス"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"SNSで共有"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ud,{url:u,title:f,children:s.jsx(cd,{size:36,round:!0})}),s.jsx(Mc,{url:u,title:f,children:s.jsx($c,{size:36,round:!0})}),s.jsx(Jc,{url:u,title:f,children:s.jsx(qc,{size:36,round:!0})}),s.jsx(yd,{url:u,title:f,children:s.jsx(pd,{size:36,round:!0})})]})]})]})}const jd=[{title:"Shape of You",artist:"Ed Sheeran",jacket:"https://picsum.photos/300/300?random=1"},{title:"Blinding Lights",artist:"The Weeknd",jacket:"https://picsum.photos/300/300?random=2"},{title:"As It Was",artist:"Harry Styles",jacket:"https://picsum.photos/300/300?random=3"},{title:"Good 4 U",artist:"Olivia Rodrigo",jacket:"https://picsum.photos/300/300?random=4"}],Nd=[{title:"Pretender",artist:"Official髭男dism",jacket:"https://picsum.photos/300/300?random=5"},{title:"紅蓮華",artist:"LiSA",jacket:"https://picsum.photos/300/300?random=6"},{title:"猫",artist:"DISH//",jacket:"https://picsum.photos/300/300?random=7"}],Sd={alice:jd,bob:Nd};function Cd({title:e,artist:t,previewUrl:r,coverImage:n,onPlay:o,onPause:a,onError:i}){const[l,c]=j.useState(!1),[d,u]=j.useState(0),[f,p]=j.useState(30),[x,m]=j.useState(!1),[h,g]=j.useState(!1),b=j.useRef(null),v=j.useRef(null),N=async()=>{if(!r){i==null||i("試聴用音源が利用できません");return}if(b.current)try{m(!0),g(!1),l?(b.current.pause(),c(!1),a==null||a()):(await b.current.play(),c(!0),o==null||o())}catch(_){console.error("再生エラー:",_),g(!0),i==null||i("音楽の再生に失敗しました")}finally{m(!1)}},y=()=>{b.current&&u(b.current.currentTime)},C=_=>{if(!b.current||!v.current)return;const R=v.current.getBoundingClientRect(),M=_.clientX-R.left,V=R.width,k=M/V*f;b.current.currentTime=k,u(k)},T=_=>{const R=Math.floor(_/60),M=Math.floor(_%60);return`${R}:${M.toString().padStart(2,"0")}`},L=f>0?d/f*100:0;return j.useEffect(()=>{const _=b.current;if(!_)return;const R=()=>{p(_.duration)},M=()=>{c(!1),u(0)},V=()=>{g(!0),c(!1),i==null||i("音楽ファイルの読み込みに失敗しました")};return _.addEventListener("loadedmetadata",R),_.addEventListener("timeupdate",y),_.addEventListener("ended",M),_.addEventListener("error",V),()=>{_.removeEventListener("loadedmetadata",R),_.removeEventListener("timeupdate",y),_.removeEventListener("ended",M),_.removeEventListener("error",V)}},[i]),j.useEffect(()=>{c(!1),u(0),g(!1)},[r]),r?s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 max-w-sm mx-auto",children:[s.jsx("audio",{ref:b,src:r,preload:"metadata"}),s.jsx("div",{className:"aspect-square mb-4 rounded-lg overflow-hidden bg-gray-200",children:s.jsx("img",{src:n,alt:`${e} by ${t}`,className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:e}),s.jsx("p",{className:"text-sm text-gray-600 truncate",children:t})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{onClick:N,disabled:x||h,className:`
              w-12 h-12 rounded-full flex items-center justify-center transition-all duration-200
              ${x||h?"bg-gray-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 hover:scale-105 shadow-lg"}
            `,children:x?s.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):h?s.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}):l?s.jsx("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):s.jsx("svg",{className:"w-6 h-6 text-white ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{ref:v,onClick:C,className:"h-2 bg-gray-200 rounded-full cursor-pointer overflow-hidden",children:s.jsx("div",{className:"h-full bg-blue-500 transition-all duration-200 rounded-full",style:{width:`${L}%`}})}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[s.jsx("span",{children:T(d)}),s.jsx("span",{children:T(f)})]})]})]}),h&&s.jsx("div",{className:"mt-2 text-xs text-red-500 text-center",children:"試聴に失敗しました"})]}):(console.warn(`⚠️ 試聴不可: "${e}" by "${t}"`),console.warn("💡 理由: Spotifyプレビューが提供されていません"),console.warn(`🔧 対処法: 
      1. 他の楽曲を試してください
      2. Spotify Premiumを検討してください  
      3. アーティストがプレビューを無効にしている可能性があります`),s.jsx("div",{className:"flex items-center justify-center p-4 bg-gray-100 rounded-lg",children:s.jsxs("div",{className:"text-center",children:[s.jsx("svg",{className:"w-8 h-8 text-gray-400 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 1.414L15.657 9.17l1.414 1.414a1 1 0 11-1.414 1.414L14.243 10.584l-1.414 1.414a1 1 0 11-1.414-1.414L12.829 9.17l-1.414-1.414a1 1 0 111.414-1.414L14.243 7.756l1.414-1.413z",clipRule:"evenodd"})}),s.jsx("p",{className:"text-xs text-gray-500",children:"試聴不可"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"プレビュー未提供"})]})}))}const kd="/api/youtube/search",Sr={searchMusic:async(e,t=5)=>{try{const r=await fetch(`${kd}?query=${encodeURIComponent(e)}&maxResults=${t}`);if(!r.ok){const o=await r.json().catch(()=>({}));throw new Error(`YouTube検索失敗: ${r.status} ${o.error||""}`)}return(await r.json()).results||[]}catch(r){throw console.error("YouTube検索エラー:",r),r}},searchTrackByArtist:async(e,t,r=3)=>{const n=[`${e} ${t} official`,`${e} ${t} music video`,`${e} ${t} audio`,`${t} ${e}`];for(const o of n)try{const a=await Sr.searchMusic(o,r);if(a.length>0)return a.map(l=>({...l,score:Sr.calculateRelevanceScore(l,e,t)})).sort((l,c)=>c.score-l.score)}catch(a){console.warn(`クエリ失敗: ${o}`,a);continue}return[]},calculateRelevanceScore:(e,t,r)=>{let n=0;const o=e.title.toLowerCase(),a=e.channelTitle.toLowerCase(),i=t.toLowerCase(),l=r.toLowerCase();return o.includes(i)&&(n+=30),(a.includes(l)||o.includes(l))&&(n+=25),(a.includes("official")||o.includes("official"))&&(n+=20),(o.includes("music video")||o.includes("mv"))&&(n+=15),(o.includes("audio")||o.includes("lyric"))&&(n+=10),(o.includes("live")||o.includes("concert"))&&(n-=10),(o.includes("cover")||o.includes("remix"))&&(n-=5),n}};function Ed(){var te,ye,dt,ut;const{username:e}=Cn(),t=qs(),r=Ne(),[n,o]=j.useState(null),[a,i]=j.useState(!0);j.useState(null);const l=((te=t.state)==null?void 0:te.isPreview)===!0,[c,d]=j.useState(null),[u,f]=j.useState(!1),[p,x]=j.useState(!1),[m,h]=j.useState(!1),[g,b]=j.useState(!1),[v,N]=j.useState(!0),y=(A,U)=>{const K=U.totalCells,ae=U.centerPositions||[],re=[];for(let E=0;E<K;E++)ae.includes(E)||re.push(E);const we=[...re].sort(()=>Math.random()-.5).slice(0,A.length),_e={};return we.forEach((E,$)=>{_e[E]=$}),_e},[C,T]=j.useState({});j.useEffect(()=>{e&&L(e)},[e]),j.useEffect(()=>{if(n&&n.songs&&n.gridLayout){const A=y(n.songs,n.gridLayout);T(A),v&&setTimeout(()=>{N(!1)},100)}},[n]);const L=async A=>{try{const U=await De.loadUser(A);if(U)o(U),console.log(`✅ ユーザー「${A}」のデータを読み込みました`),await De.incrementViewCount(A);else{console.log(`⚠️ ユーザー「${A}」のデータが見つかりません`);const K=Sd[A];if(K){const ae={username:A,displayName:A,bio:"",baseColor:Be[0],themeColor:ze[0],socialLinks:{},favoriteGenres:[],songs:K.map(re=>({...re,id:`${re.title}-${re.artist}`.replace(/\s+/g,"-").toLowerCase(),previewUrl:null,addedAt:new Date().toISOString()})),gridLayout:ne[1],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),viewCount:0,isPublic:!0};o(ae),console.log(`📄 users.jsonからフォールバックデータを使用: ${A}`)}}}catch(U){console.error(`❌ ユーザーデータの読み込みに失敗: ${A}`,U)}finally{i(!1)}},_=async A=>{try{const U=localStorage.getItem("spotify_access_token");if(!U)return console.log("Spotifyトークンがありません。検索をスキップします。"),A;const K=await ke.searchTracksAdvanced(A.title,A.artist,U);if(K.length>0){const ae=K[0];return{...A,spotify:{id:ae.id,previewUrl:ae.previewUrl,spotifyUrl:ae.spotifyUrl}}}}catch(U){console.error("Spotify検索エラー:",U)}return A},R=async A=>{try{const U=await Sr.searchMusic(`${A.title} ${A.artist}`);if(U.length>0){const K=U[0];return{...A,youtube:{videoId:K.videoId,title:K.title,channelTitle:K.channelTitle,embedUrl:K.embedUrl}}}}catch(U){console.error("YouTube検索エラー:",U)}return A},M=async A=>{let U=A;return A.spotify||(U=await _(U)),A.youtube||(U=await R(U)),U},V=async A=>{if(!p){x(!0);try{const U=await M(A);d(U),f(!0)}catch(U){console.error("楽曲プレビューの取得に失敗しました:",U)}finally{x(!1)}}},k=()=>{f(!1),d(null)};if(a)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})});if(!n||!n.songs||n.songs.length===0)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[s.jsx("div",{className:"text-6xl mb-4",children:"🎵"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"ユーザーが見つかりません"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["お探しのユーザー「",e,"」は存在しないか、楽曲が登録されていません。"]}),s.jsxs("button",{onClick:()=>r("/"),className:"inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"ホームに戻る"]})]})});const S=n.themeColor||ze[0],P=n.baseColor||Be[0],I=P.id==="light";return s.jsxs("div",{className:`min-h-screen relative overflow-hidden ${P.background}`,children:[!I&&s.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${S.gradient} opacity-30`}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex items-center justify-between p-6",children:[s.jsxs("button",{onClick:()=>r("/"),className:`flex items-center transition-all px-3 py-2 rounded-lg ${I?"text-gray-700 hover:bg-gray-200":"text-white hover:bg-white/10"}`,onMouseEnter:A=>{I||(A.currentTarget.style.color=S.primaryHex)},onMouseLeave:A=>{I||(A.currentTarget.style.color="white")},children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"ホームに戻る"]}),s.jsxs("div",{className:"flex gap-2",children:[l&&s.jsx("button",{onClick:()=>r("/dashboard"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all shadow-lg ${I?"bg-gray-200 text-gray-700 hover:bg-gray-300":`bg-gradient-to-r ${S.gradient} text-white hover:opacity-90`}`,children:"編集画面に戻る"}),(l||t.pathname.includes("/users/"))&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>h(!m),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${m?I?"bg-gray-300 text-gray-700 shadow-lg":`bg-gradient-to-r ${S.gradient} text-white shadow-lg`:I?`${P.surface} ${P.textPrimary} ${P.border} border hover:${P.surfaceHover}`:"bg-white/10 text-white border hover:border-transparent"}`,style:!m&&!I?{borderColor:S.primaryHex+"50"}:{},onMouseEnter:A=>{!m&&!I&&(A.currentTarget.style.background=`linear-gradient(to right, ${S.primaryHex}, ${S.primaryHex})`)},onMouseLeave:A=>{!m&&!I&&(A.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},children:"統計"}),s.jsx("button",{onClick:()=>b(!g),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${g?I?"bg-gray-300 text-gray-700 shadow-lg":`bg-gradient-to-r ${S.gradient} text-white shadow-lg`:I?`${P.surface} ${P.textPrimary} ${P.border} border hover:${P.surfaceHover}`:"bg-white/10 text-white border hover:border-transparent"}`,style:!g&&!I?{borderColor:S.primaryHex+"50"}:{},onMouseEnter:A=>{!g&&!I&&(A.currentTarget.style.background=`linear-gradient(to right, ${S.primaryHex}, ${S.primaryHex})`)},onMouseLeave:A=>{!g&&!I&&(A.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},children:"共有"})]})]})]}),(m||g)&&s.jsx("div",{className:"px-6 mb-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m&&s.jsx("div",{className:`backdrop-blur-sm rounded-xl p-6 ${I?"bg-white/80 shadow-lg":"bg-white/10"}`}),g&&s.jsx("div",{className:`backdrop-blur-sm rounded-xl p-6 ${I?"bg-white/80 shadow-lg":"bg-white/10"}`,children:s.jsx(vd,{username:n.username,displayName:n.displayName,bio:n.bio})})]})}),s.jsxs("div",{className:"flex flex-col items-center justify-center px-6 py-12",children:[s.jsx("div",{className:"w-full max-w-4xl",children:s.jsx("div",{className:"grid gap-2 aspect-square",style:{gridTemplateColumns:`repeat(${((ye=n.gridLayout)==null?void 0:ye.size)||ne[1].size}, 1fr)`,gridTemplateRows:`repeat(${((dt=n.gridLayout)==null?void 0:dt.size)||ne[1].size}, 1fr)`},children:Array.from({length:((ut=n.gridLayout)==null?void 0:ut.totalCells)||ne[1].totalCells}).map((A,U)=>{var _e,E,$,D;const K=((_e=n.gridLayout)==null?void 0:_e.centerPositions)||ne[1].centerPositions,ae=K.includes(U),re=(((E=n.gridLayout)==null?void 0:E.size)||ne[1].size)%2===1,Ge=C[U],we=Ge!==void 0?n.songs[Ge]:null;return ae&&K.length===4&&U!==K[0]?null:s.jsx("div",{className:`aspect-square relative overflow-hidden rounded-lg ${v?"animate-fade-in-scale":""}`,style:{...ae&&K.length===4?{gridColumn:`${K[0]%((($=n.gridLayout)==null?void 0:$.size)||ne[1].size)+1} / span 2`,gridRow:`${Math.floor(K[0]/(((D=n.gridLayout)==null?void 0:D.size)||ne[1].size))+1} / span 2`}:{},animationDelay:`${U*50}ms`},children:ae?s.jsx("div",{className:`w-full h-full flex items-center justify-center backdrop-blur-sm ${I?"bg-white/80":"bg-black/10"}`,children:n.icon?s.jsx("img",{src:n.icon,alt:`${n.displayName}のアイコン`,className:`w-full h-full object-cover rounded-lg shadow-xl ${re?"border-8":"border-4"}`,style:{borderColor:S.primaryHex,boxShadow:re?`0 15px 35px -5px ${S.primaryHex}40, 0 15px 15px -5px ${S.primaryHex}30, inset 0 0 0 2px ${S.primaryHex}20`:`0 10px 25px -5px ${S.primaryHex}30, 0 10px 10px -5px ${S.primaryHex}20`}}):s.jsx("div",{className:`w-full h-full flex items-center justify-center rounded-lg shadow-xl ${re?"border-8":"border-4"} ${I?"bg-gradient-to-br from-gray-100 to-gray-200":"bg-gradient-to-br from-white/20 to-white/10"}`,style:{borderColor:S.primaryHex,boxShadow:re?`0 15px 35px -5px ${S.primaryHex}40, 0 15px 15px -5px ${S.primaryHex}30, inset 0 0 0 2px ${S.primaryHex}20`:`0 10px 25px -5px ${S.primaryHex}30, 0 10px 10px -5px ${S.primaryHex}20`},children:s.jsx("div",{className:`font-bold ${re?"text-5xl":"text-4xl"} ${I?"text-gray-600":"text-white/60"}`,children:n.displayName.charAt(0).toUpperCase()})})}):we?s.jsx("div",{onClick:()=>V(we),className:`w-full h-full cursor-pointer transform hover:scale-105 transition-all duration-300 hover:shadow-2xl group ${p?"opacity-50 cursor-not-allowed":""}`,children:s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("img",{src:we.jacket,alt:"",className:"w-full h-full object-cover rounded-lg shadow-lg"}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-300 rounded-lg flex items-center justify-center",children:s.jsx("div",{className:"bg-white bg-opacity-90 rounded-full p-2 sm:p-3 transform scale-0 group-hover:scale-100 transition-transform duration-300",children:s.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-gray-800",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M8 5v14l11-7z"})})})}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-0 group-hover:bg-opacity-90 transition-all duration-300 rounded-b-lg p-2 opacity-0 group-hover:opacity-100",children:[s.jsx("p",{className:"text-white text-xs font-medium truncate",children:we.title}),s.jsx("p",{className:"text-white/80 text-xs truncate",children:we.artist})]})]})}):s.jsx("div",{className:"w-full h-full"})},U)})})}),s.jsxs("div",{className:"text-center mt-12",children:[s.jsx("h1",{className:`text-3xl sm:text-4xl lg:text-5xl font-bold mb-4 ${P.textPrimary}`,children:n.displayName}),n.bio&&s.jsx("p",{className:`text-lg mb-4 ${P.textSecondary}`,children:n.bio}),s.jsxs("div",{className:`flex items-center justify-center gap-6 ${P.textSecondary}`,children:[s.jsxs("span",{children:["🎵 ",n.songs.length,"曲"]}),n.viewCount>0&&s.jsxs("span",{children:["👁️ ",n.viewCount,"回閲覧"]}),n.location&&s.jsxs("span",{children:["📍 ",n.location]})]}),Object.keys(n.socialLinks).length>0&&s.jsxs("div",{className:"flex gap-4 mt-8 justify-center",children:[n.socialLinks.twitter&&s.jsx("a",{href:n.socialLinks.twitter,target:"_blank",rel:"noopener noreferrer",className:`p-3 rounded-full transition-colors ${I?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20"}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"})})}),n.socialLinks.instagram&&s.jsx("a",{href:n.socialLinks.instagram,target:"_blank",rel:"noopener noreferrer",className:`p-3 rounded-full transition-colors ${I?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20"}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})})}),n.socialLinks.spotify&&s.jsx("a",{href:n.socialLinks.spotify,target:"_blank",rel:"noopener noreferrer",className:`p-3 rounded-full transition-colors ${I?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20"}`,children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})})})]})]})]}),u&&c&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"楽曲プレイヤー"}),s.jsx("button",{onClick:k,className:"text-gray-500 hover:text-gray-700 transition-colors",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("img",{src:c.jacket,alt:`${c.title} - ${c.artist}`,className:"w-40 h-40 mx-auto rounded-lg shadow-lg mb-4"}),s.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:c.title}),s.jsx("p",{className:"text-gray-600",children:c.artist})]}),c.spotify&&s.jsx("div",{className:"mb-4",children:s.jsx(Cd,{previewUrl:c.spotify.previewUrl,title:c.title,artist:c.artist,coverImage:c.jacket||"/default-cover.jpg"})}),c.youtube&&s.jsx("div",{className:"mb-4",children:s.jsx(Sl,{videoId:c.youtube.videoId,title:c.youtube.title,artist:c.artist,coverImage:c.jacket||"/default-cover.jpg"})}),!c.spotify&&!c.youtube&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.jsx("p",{children:"プレビューが見つかりませんでした"})]})]})})]})]})}function _d(){const e=Ne(),[t,r]=j.useState({username:"",displayName:"",bio:"",baseColor:Be[0],themeColor:ze[0],socialLinks:{},favoriteGenres:[],songs:[],gridLayout:ne[0],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),viewCount:0,isPublic:!0}),[n,o]=j.useState(!1),[a,i]=j.useState({}),l=()=>{t.songs.length<20&&r(h=>({...h,songs:[...h.songs,{title:"",artist:"",jacket:"",genre:"",releaseYear:void 0}]}))},c=h=>{r(g=>({...g,songs:g.songs.filter((b,v)=>v!==h)}))},d=(h,g,b)=>{r(v=>({...v,songs:v.songs.map((N,y)=>y===h?{...N,[g]:b}:N)}))},u=(h,g)=>{d(h,"title",g.name),d(h,"artist",g.artist),d(h,"jacket",g.image||""),d(h,"isGeneratedImage",g.isGeneratedImage||!1)},f=h=>{r(g=>({...g,favoriteGenres:g.favoriteGenres.includes(h)?g.favoriteGenres.filter(b=>b!==h):[...g.favoriteGenres,h]}))},p=(h,g)=>{r(b=>({...b,socialLinks:{...b.socialLinks,[h]:g.trim()||void 0}}))},x=()=>{const h={};return t.username.trim()?/^[a-zA-Z0-9_-]+$/.test(t.username)||(h.username="ユーザー名は英数字、ハイフン、アンダースコアのみ使用可能です"):h.username="ユーザー名は必須です",t.displayName.trim()||(h.displayName="表示名は必須です"),t.songs.length===0&&(h.songs="最低1曲は追加してください"),t.songs.some(b=>!b.title||!b.artist)&&(h.songs="全ての楽曲のタイトルとアーティストを入力してください"),i(h),Object.keys(h).length===0},m=async h=>{if(h.preventDefault(),!!x()){o(!0);try{Lr(t)?e(`/users/${t.username}`):i({submit:"データの保存に失敗しました"})}catch(g){console.error("データの保存に失敗しました:",g),i({submit:"データの保存に失敗しました"})}finally{o(!1)}}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"音楽名刺を作成"}),s.jsx("p",{className:"text-gray-600",children:"あなたの音楽の好みを世界に発信しましょう"})]}),s.jsxs("form",{onSubmit:m,className:"space-y-8",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"基本情報"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ユーザー名 *"}),s.jsx("input",{type:"text",value:t.username,onChange:h=>r(g=>({...g,username:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"example_user",required:!0}),a.username&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.username})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"表示名 *"}),s.jsx("input",{type:"text",value:t.displayName,onChange:h=>r(g=>({...g,displayName:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"山田太郎",required:!0}),a.displayName&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.displayName})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"自己紹介"}),s.jsx("textarea",{value:t.bio,onChange:h=>r(g=>({...g,bio:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"音楽が大好きです！様々なジャンルを聴きます。"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"居住地"}),s.jsx("input",{type:"text",value:t.location||"",onChange:h=>r(g=>({...g,location:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"東京都渋谷区"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"職業"}),s.jsx("input",{type:"text",value:t.occupation||"",onChange:h=>r(g=>({...g,occupation:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"エンジニア"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"外観設定"}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロフィール画像"}),s.jsx(vs,{currentIcon:t.icon,onIconChange:h=>r(g=>({...g,icon:h})),username:t.username})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ベースカラー"}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"音楽名刺の基本となる背景色を選択してください。"}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:Be.map(h=>s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"radio",name:"baseColor",checked:t.baseColor.id===h.id,onChange:()=>r(g=>({...g,baseColor:h})),className:"sr-only"}),s.jsxs("div",{className:`relative p-3 rounded-lg border-2 transition-all ${t.baseColor.id===h.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("div",{className:`w-full h-6 rounded-lg ${h.background} mb-2`}),s.jsx("p",{className:"text-sm font-medium text-gray-800",children:h.name})]})]},h.id))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"テーマカラー"}),s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"アイコンの枠線やボタンの色に反映されます。"}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:ze.map(h=>s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"radio",name:"themeColor",checked:t.themeColor.id===h.id,onChange:()=>r(g=>({...g,themeColor:h})),className:"sr-only"}),s.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${t.themeColor.id===h.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("div",{className:`w-full h-6 rounded-lg bg-gradient-to-r ${h.gradient} mb-2`}),s.jsx("p",{className:"text-sm font-medium text-gray-800",children:h.name})]})]},h.id))})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"SNSリンク"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Twitter"}),s.jsx("input",{type:"url",value:t.socialLinks.twitter||"",onChange:h=>p("twitter",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://twitter.com/username"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Instagram"}),s.jsx("input",{type:"url",value:t.socialLinks.instagram||"",onChange:h=>p("instagram",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://instagram.com/username"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spotify"}),s.jsx("input",{type:"url",value:t.socialLinks.spotify||"",onChange:h=>p("spotify",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://open.spotify.com/user/username"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),s.jsx("input",{type:"url",value:t.socialLinks.website||"",onChange:h=>p("website",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"好きなジャンル"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"最大5つまで選択できます"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:sn.map(h=>s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:t.favoriteGenres.includes(h),onChange:()=>f(h),disabled:!t.favoriteGenres.includes(h)&&t.favoriteGenres.length>=5,className:"sr-only"}),s.jsx("div",{className:`p-3 rounded-lg border-2 transition-all text-center ${t.favoriteGenres.includes(h)?`border-${t.themeColor.primary} bg-${t.themeColor.primary}/10 text-${t.themeColor.primary}`:"border-gray-200 hover:border-gray-300 text-gray-700"} ${!t.favoriteGenres.includes(h)&&t.favoriteGenres.length>=5?"opacity-50 cursor-not-allowed":""}`,children:s.jsx("p",{className:"text-sm font-medium",children:h})})]},h))})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"お気に入りの楽曲"}),s.jsx("button",{type:"button",onClick:l,disabled:t.songs.length>=20,className:`px-4 py-2 rounded-lg font-medium transition-colors ${t.songs.length>=20?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:"楽曲を追加"})]}),a.songs&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-red-600",children:a.songs})}),s.jsx("div",{className:"space-y-4",children:t.songs.map((h,g)=>s.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["楽曲 ",g+1]}),s.jsx("button",{type:"button",onClick:()=>c(g),className:"text-red-500 hover:text-red-700 transition-colors",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),s.jsx(Ar,{onSelect:b=>u(g,b),placeholder:"曲名やアーティスト名を検索...",username:t.username}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ジャンル"}),s.jsxs("select",{value:h.genre||"",onChange:b=>d(g,"genre",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"選択してください"}),sn.map(b=>s.jsx("option",{value:b,children:b},b))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"リリース年"}),s.jsx("input",{type:"number",value:h.releaseYear||"",onChange:b=>{const v=parseInt(b.target.value);d(g,"releaseYear",isNaN(v)?"":v)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"2023",min:"1900",max:new Date().getFullYear()})]})]}),h.jacket&&s.jsx("div",{className:"mt-3",children:s.jsx("img",{src:h.jacket,alt:`${h.title} - ${h.artist}`,className:"w-16 h-16 object-cover rounded-lg border border-gray-200"})})]},g))}),t.songs.length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),s.jsx("p",{children:"楽曲を追加してください"})]})]}),s.jsxs("div",{className:"text-center",children:[a.submit&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-red-600",children:a.submit})}),s.jsx("button",{type:"submit",disabled:n,className:`px-8 py-3 rounded-xl font-semibold transition-all ${n?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-cyan-500 text-white hover:from-blue-600 hover:to-cyan-600 hover:scale-105"} shadow-lg hover:shadow-xl`,children:n?"作成中...":"音楽名刺を作成"})]})]})]})})})}function Td({className:e=""}){const[t,r]=j.useState({totalUsers:0,totalSongs:0,totalViews:0,storageSizeKB:0}),[n,o]=j.useState([]),[a,i]=j.useState(!1);j.useEffect(()=>{l()},[]);const l=()=>{r(pi()),o(ss())},c=()=>{Ut()?(alert("✅ バックアップを作成しました"),l()):alert("❌ バックアップの作成に失敗しました")},d=()=>{confirm("バックアップから復元しますか？現在のデータは上書きされます。")&&(hi()?(alert("✅ バックアップから復元しました"),l(),window.location.reload()):alert("❌ バックアップからの復元に失敗しました"))},u=()=>{try{const x=fi(),m=new Blob([x],{type:"application/json"}),h=URL.createObjectURL(m),g=document.createElement("a");g.href=h,g.download=`musicmeisi_backup_${new Date().toISOString().split("T")[0]}.json`,g.click(),URL.revokeObjectURL(h),alert("✅ データをエクスポートしました")}catch(x){console.error("エクスポートエラー:",x),alert("❌ データのエクスポートに失敗しました")}},f=x=>{var g;const m=(g=x.target.files)==null?void 0:g[0];if(!m)return;const h=new FileReader;h.onload=b=>{var v;try{const N=(v=b.target)==null?void 0:v.result;mi(N)?(alert("✅ データをインポートしました"),l(),window.location.reload()):alert("❌ データのインポートに失敗しました")}catch(N){console.error("インポートエラー:",N),alert("❌ 無効なファイル形式です")}},h.readAsText(m),x.target.value=""},p=x=>x?new Date(x).toLocaleString("ja-JP"):"N/A";return s.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 ${e}`,children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 1.79 4 4 4h8c2.21 0 4-1.79 4-4V7M4 7V4a1 1 0 011-1h5l2 2h6a1 1 0 011 1v1M4 7h16"})}),"データ管理"]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.totalUsers}),s.jsx("div",{className:"text-sm text-blue-800",children:"総ユーザー数"})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.totalSongs}),s.jsx("div",{className:"text-sm text-green-800",children:"総楽曲数"})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.totalViews}),s.jsx("div",{className:"text-sm text-purple-800",children:"総閲覧数"})]}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.storageSizeKB}),s.jsx("div",{className:"text-sm text-orange-800",children:"ストレージ (KB)"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[s.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"})}),"バックアップ"]}),s.jsxs("button",{onClick:d,className:"flex items-center justify-center gap-2 px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"復元"]}),s.jsxs("button",{onClick:u,className:"flex items-center justify-center gap-2 px-3 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"エクスポート"]}),s.jsxs("label",{className:"flex items-center justify-center gap-2 px-3 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm cursor-pointer",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),"インポート",s.jsx("input",{type:"file",accept:".json",onChange:f,className:"sr-only"})]})]}),s.jsx("div",{className:"mb-4",children:s.jsxs("button",{onClick:()=>i(!a),className:"flex items-center text-gray-600 hover:text-gray-800 text-sm font-medium",children:[s.jsx("svg",{className:`w-4 h-4 mr-2 transition-transform ${a?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),"ユーザー詳細を",a?"非表示":"表示"]})}),a&&s.jsxs("div",{className:"overflow-x-auto",children:[s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"ユーザー名"}),s.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"表示名"}),s.jsx("th",{className:"text-right py-2 px-3 font-medium text-gray-700",children:"楽曲数"}),s.jsx("th",{className:"text-right py-2 px-3 font-medium text-gray-700",children:"閲覧数"}),s.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"更新日時"})]})}),s.jsx("tbody",{children:n.map(x=>s.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[s.jsx("td",{className:"py-2 px-3 font-mono text-sm",children:x.username}),s.jsx("td",{className:"py-2 px-3",children:x.displayName}),s.jsx("td",{className:"py-2 px-3 text-right",children:x.songCount}),s.jsx("td",{className:"py-2 px-3 text-right",children:x.viewCount}),s.jsx("td",{className:"py-2 px-3 text-xs text-gray-500",children:p(x.updatedAt)})]},x.username))})]}),n.length===0&&s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293L16 14H8l-2.707-1.707A1 1 0 004.586 13H2"})}),s.jsx("p",{children:"登録されているユーザーがいません"})]})]}),s.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"💡 使用方法"}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsxs("li",{children:["• ",s.jsx("strong",{children:"バックアップ"}),": 現在のデータをブラウザ内に保存"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"復元"}),": バックアップからデータを復元"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"エクスポート"}),": データをJSONファイルとしてダウンロード"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"インポート"}),": JSONファイルからデータを読み込み"]})]})]})]})}function Rd(){const e=Ne(),[t,r]=j.useState([]),[n,o]=j.useState(!0),[a,i]=j.useState(!1),[l,c]=j.useState(!1);j.useEffect(()=>{d()},[]);const d=()=>{const h=localStorage.getItem("musicard_admin"),g=localStorage.getItem("musicard_admin_login_time");if(!h||!g){console.warn("🛡️ 管理者権限がありません"),e("/admin-login");return}const b=parseInt(g),v=Date.now(),N=24*60*60*1e3;if(v-b>N){console.warn("🛡️ 管理者セッションが期限切れです"),localStorage.removeItem("musicard_admin"),localStorage.removeItem("musicard_admin_login_time"),e("/admin-login");return}if(!({}.VITE_ADMIN_USERS||"admin").split(",").includes(h)){console.warn("🛡️ 管理者権限が無効です"),e("/admin-login");return}c(!0),u()};j.useEffect(()=>{l&&u()},[l]);const u=()=>{try{const h=ss();r(h)}catch(h){console.error("ユーザーデータの読み込みに失敗しました:",h)}finally{o(!1)}},f=h=>{confirm(`${h}の名刺を削除しますか？この操作は取り消せません。`)&&(di(h)?(u(),alert(`✅ ${h}の名刺を削除しました`)):alert(`❌ ${h}の削除に失敗しました`))},p=h=>{e(`/edit/${h}`)},x=()=>{confirm("管理者ログアウトしますか？")&&(localStorage.removeItem("musicard_admin"),localStorage.removeItem("musicard_admin_login_time"),e("/"))},m=h=>h?new Date(h).toLocaleString("ja-JP"):"N/A";return l?n?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"管理者パネル"}),s.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"ADMIN"})]}),s.jsx("p",{className:"text-gray-600",children:"音楽名刺の管理とデータ統計"}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["管理者: ",localStorage.getItem("musicard_admin")]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>i(!a),className:`px-4 py-2 rounded-lg font-medium transition-colors ${a?"bg-blue-600 text-white":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:"データ管理"}),s.jsx("button",{onClick:x,className:"bg-red-500 text-white px-6 py-2 rounded-lg font-medium hover:bg-red-600 transition-colors",children:"ログアウト"}),s.jsx(Oe,{to:"/",className:"bg-white text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-50 transition-colors border border-gray-200",children:"ホームに戻る"})]})]}),a&&s.jsx("div",{className:"mb-8",children:s.jsx(Td,{})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-blue-600",children:t.length}),s.jsx("div",{className:"text-gray-600",children:"総ユーザー数"})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600",children:t.reduce((h,g)=>h+g.songCount,0)}),s.jsx("div",{className:"text-gray-600",children:"総楽曲数"})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-purple-600",children:t.reduce((h,g)=>h+g.viewCount,0)}),s.jsx("div",{className:"text-gray-600",children:"総閲覧数"})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-orange-600",children:t.length>0?Math.round(t.reduce((h,g)=>h+g.songCount,0)/t.length):0}),s.jsx("div",{className:"text-gray-600",children:"平均楽曲数"})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"登録ユーザー一覧"})}),t.length===0?s.jsxs("div",{className:"text-center py-16",children:[s.jsx("div",{className:"text-6xl mb-6",children:"🎵"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"名刺がまだありません"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"最初の音楽名刺を作成してみましょう"}),s.jsxs(Oe,{to:"/create",className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg font-medium hover:from-blue-600 hover:to-cyan-600 transition-all hover:scale-105 shadow-lg",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"名刺を作成"]})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"ユーザー"}),s.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"楽曲数"}),s.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"閲覧数"}),s.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"更新日"}),s.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"操作"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(h=>s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsx("td",{className:"py-4 px-6",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center text-white font-semibold",children:h.displayName.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:h.displayName}),s.jsxs("div",{className:"text-sm text-gray-500 font-mono",children:["@",h.username]})]})]})}),s.jsx("td",{className:"py-4 px-6 text-sm text-gray-900",children:s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[h.songCount," 曲"]})}),s.jsx("td",{className:"py-4 px-6 text-sm text-gray-900",children:s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[h.viewCount," 回"]})}),s.jsx("td",{className:"py-4 px-6 text-sm text-gray-500",children:m(h.updatedAt)}),s.jsx("td",{className:"py-4 px-6",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(Oe,{to:`/users/${h.username}`,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 transition-colors",children:"表示"}),s.jsx("button",{onClick:()=>p(h.username),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-green-700 bg-green-100 hover:bg-green-200 transition-colors",children:"編集"}),s.jsx("button",{onClick:()=>f(h.username),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 transition-colors",children:"削除"})]})})]},h.username))})]})})]}),s.jsxs("div",{className:"mt-8 bg-blue-50 rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"💡 使用方法"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"名刺の管理"}),s.jsxs("ul",{className:"space-y-1",children:[s.jsx("li",{children:"• 「表示」で名刺ページを表示"}),s.jsx("li",{children:"• 「編集」で名刺内容を編集"}),s.jsx("li",{children:"• 「削除」で名刺を完全削除"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"データ管理"}),s.jsxs("ul",{className:"space-y-1",children:[s.jsx("li",{children:"• 統計情報の確認"}),s.jsx("li",{children:"• データのバックアップ・復元"}),s.jsx("li",{children:"• エクスポート・インポート"})]})]})]})]})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"管理者認証を確認中..."})]})})}const pt=[{id:"blue",name:"ブルー",gradient:"from-blue-500 to-blue-600",primary:"blue-500",secondary:"blue-100"},{id:"purple",name:"パープル",gradient:"from-purple-500 to-purple-600",primary:"purple-500",secondary:"purple-100"},{id:"green",name:"グリーン",gradient:"from-green-500 to-green-600",primary:"green-500",secondary:"green-100"},{id:"pink",name:"ピンク",gradient:"from-pink-500 to-pink-600",primary:"pink-500",secondary:"pink-100"},{id:"orange",name:"オレンジ",gradient:"from-orange-500 to-orange-600",primary:"orange-500",secondary:"orange-100"},{id:"indigo",name:"インディゴ",gradient:"from-indigo-500 to-indigo-600",primary:"indigo-500",secondary:"indigo-100"}];function Ld(){const{username:e}=Cn(),t=Ne(),[r,n]=j.useState([]),[o,a]=j.useState(""),[i,l]=j.useState(pt[0]),[c,d]=j.useState(!0),u=j.useCallback(g=>{try{const b=localStorage.getItem("musicmeisi_users");if(b){const v=JSON.parse(b);if(v[g]){const N=v[g];if(n(N.songs||N),a(N.icon||""),N.themeColor){const y=pt.find(C=>C.id===N.themeColor.id);l(y||pt[0])}}else alert("ユーザーが見つかりません"),t("/manage")}else alert("ユーザーデータが見つかりません"),t("/manage")}catch{alert("データの読み込みに失敗しました"),t("/manage")}finally{d(!1)}},[t]);j.useEffect(()=>{e&&u(e)},[e,u]);const f=()=>{n([...r,{title:"",artist:"",jacket:""}])},p=g=>{r.length>1&&n(r.filter((b,v)=>v!==g))},x=(g,b,v)=>{const N=[...r];N[g]={...N[g],[b]:v},n(N)},m=(g,b)=>{const v=[...r];v[g]={title:b.name,artist:b.artist,jacket:b.image||"",isGeneratedImage:b.isGeneratedImage},n(v)},h=async g=>{if(g.preventDefault(),!e){alert("ユーザー名が無効です");return}const b=r.filter(v=>v.title.trim()&&v.artist.trim());if(b.length===0){alert("少なくとも1つの楽曲情報を入力してください");return}try{const v=localStorage.getItem("musicmeisi_users"),N=v?JSON.parse(v):{};N[e]={username:e,icon:o,themeColor:i,songs:b,updatedAt:new Date().toISOString()},localStorage.setItem("musicmeisi_users",JSON.stringify(N)),alert("名刺が更新されました！"),t(`/users/${e}`)}catch{alert("エラーが発生しました。もう一度お試しください。")}};return c?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:s.jsx("div",{className:"text-blue-600 text-xl",children:"読み込み中..."})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:[s.jsx("div",{className:"sticky top-0 z-50 backdrop-blur-sm bg-white/80 border-b border-blue-200/50 shadow-sm",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h1",{className:"text-xl font-bold text-blue-900",children:[e,"の名刺を編集"]}),s.jsxs("button",{onClick:()=>t("/manage"),className:"inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 transition-colors duration-300",children:[s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"管理画面に戻る"]})]})})}),s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsxs("form",{onSubmit:h,className:"space-y-8",noValidate:!0,children:[s.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-blue-200/50 shadow-lg",children:[s.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-6",children:"基本情報"}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-blue-700 text-sm font-medium mb-2",children:"ユーザー名"}),s.jsx("input",{type:"text",value:e,disabled:!0,className:"w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-blue-500 cursor-not-allowed"}),s.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"ユーザー名は変更できません"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-blue-700 text-sm font-medium mb-3",children:"名刺テーマカラー"}),s.jsx("div",{className:"grid grid-cols-3 gap-3",children:pt.map(g=>s.jsxs("button",{type:"button",onClick:()=>l(g),className:`p-3 rounded-xl border-2 transition-all duration-300 ${i.id===g.id?"border-blue-500 shadow-lg scale-105":"border-blue-200 hover:border-blue-300"}`,children:[s.jsx("div",{className:`w-full h-8 bg-gradient-to-r ${g.gradient} rounded-lg mb-2`}),s.jsx("span",{className:"text-sm text-blue-700 font-medium",children:g.name})]},g.id))}),s.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"選択したカラーが名刺のアクセントカラーとして使用されます"})]})]}),s.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-blue-200/50 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"好きな音楽"}),s.jsx("button",{type:"button",onClick:f,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-300",children:"曲を追加"})]}),s.jsx("div",{className:"space-y-6",children:r.map((g,b)=>s.jsxs("div",{className:"bg-slate-700/50 rounded-xl p-4 border border-slate-600/50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-white font-medium",children:["曲 ",b+1]}),r.length>1&&s.jsx("button",{type:"button",onClick:()=>p(b),className:"text-red-400 hover:text-red-300 transition-colors duration-300",children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"音楽を検索"}),s.jsx(Ar,{onSelect:v=>m(b,v),placeholder:"曲名やアーティスト名で検索...",className:"mb-3"}),s.jsx("p",{className:"text-slate-400 text-xs",children:"検索して自動入力するか、下記のフィールドに直接入力してください"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"曲名 *"}),s.jsx("input",{type:"text",value:g.title,onChange:v=>x(b,"title",v.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"曲名を入力"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"アーティスト *"}),s.jsx("input",{type:"text",value:g.artist,onChange:v=>x(b,"artist",v.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"アーティスト名を入力"})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"ジャケット画像URL（任意）"}),s.jsx("input",{type:"text",value:g.jacket,onChange:v=>x(b,"jacket",v.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"https://example.com/image.jpg"}),s.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"未入力の場合はランダム画像が使用されます"})]})]},b))})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 rounded-xl font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300 hover:scale-105",children:"更新する"}),s.jsx("button",{type:"button",onClick:()=>t("/manage"),className:"px-8 py-4 bg-slate-700 text-white rounded-xl font-semibold hover:bg-slate-600 transition-all duration-300",children:"キャンセル"})]})]})})})]})}function Ad(){const[e]=Ws(),t=Ne(),[r,n]=j.useState("loading"),[o,a]=j.useState(""),i=j.useRef(!1);return j.useEffect(()=>{(async()=>{var c,d,u;if(i.current){console.log("🔄 認証処理は既に実行済みです");return}i.current=!0;try{const f=e.get("code"),p=e.get("state"),x=e.get("error");if(console.log("🔍 コールバックパラメータ確認:"),console.log(`   code: ${f?"✅ あり":"❌ なし"}`),console.log(`   state: ${p?"✅ あり":"❌ なし"}`),console.log(`   error: ${x||"なし"}`),x)throw new Error(`Spotify認証エラー: ${x}`);if(!f)throw new Error("認証コードが見つかりません");if(!p)throw new Error("状態パラメータが見つかりません");const m=localStorage.getItem("spotify_current_state"),h=localStorage.getItem(`spotify_auth_${p}`);let g=null;if(h)try{g=JSON.parse(h).codeVerifier}catch(v){console.error("❌ 認証データ解析エラー:",v)}if(console.log("🔍 LocalStorage状態確認:"),console.log(`   受信したcode: ${f.substring(0,10)}...`),console.log(`   受信したstate: "${p}"`),console.log(`   保存されたstate: "${m}"`),console.log(`   code_verifier: ${g?"✅ 存在":"❌ なし"}`),console.log(`   state一致: ${m===p}`),m!==p)throw new Error("State parameter不一致 - セキュリティエラー");console.log("🔄 認証コードをアクセストークンに交換中...");const b=await Qn.getAccessToken(f,p);rs(b),localStorage.removeItem("spotify_current_state"),localStorage.removeItem(`spotify_auth_${p}`),es("spotify"),n("success"),a("Spotify認証が完了しました！PKCEフローによる安全な認証です。"),window.history.replaceState({},document.title,"/callback"),setTimeout(()=>{t("/")},3e3)}catch(f){console.error("❌ Spotify認証エラー:",f),n("error"),a(f.message||"Spotify認証に失敗しました"),((c=f.message)!=null&&c.includes("Token exchange failed")||(d=f.message)!=null&&d.includes("Failed to get access token"))&&(console.error("🔍 トークン交換エラーの詳細:"),console.error("   • 認証コードが既に使用済みの可能性"),console.error("   • Client IDが間違っている可能性"),console.error("   • Redirect URIが正確に設定されていない可能性"),console.error("   • 認証コードの有効期限（10分）が切れている可能性"),console.error("   • code_verifierが見つからない可能性")),(u=f.message)!=null&&u.includes("Invalid authorization code")&&(console.warn("⚠️ 認証コードが無効です。新しい認証を開始してください。"),setTimeout(()=>{t("/")},5e3))}})()},[t,e]),s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:s.jsx("div",{className:"max-w-md mx-auto p-8",children:s.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-8 border border-blue-200/50 shadow-lg text-center",children:[r==="loading"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),s.jsx("h1",{className:"text-2xl font-bold text-blue-900 mb-4",children:"🎧 Spotify認証処理中..."}),s.jsxs("p",{className:"text-blue-600",children:["認証コードをアクセストークンに交換しています...",s.jsx("br",{}),s.jsx("span",{className:"text-sm text-blue-500",children:"重複処理を防止中"})]})]}),r==="success"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-12 h-12 mx-auto mb-4 text-green-500",children:s.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),s.jsx("h1",{className:"text-2xl font-bold text-green-700 mb-4",children:"🎉 認証完了！"}),s.jsx("p",{className:"text-blue-600 mb-4",children:o}),s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-4",children:s.jsxs("p",{className:"text-green-700 text-sm",children:["✅ 音楽検索でSpotifyが利用可能になりました",s.jsx("br",{}),"✅ PKCEフローによる安全な認証を実現",s.jsx("br",{}),"✅ Client Secretが不要なセキュアな実装",s.jsx("br",{}),"✅ より高精度な検索結果を提供",s.jsx("br",{}),"✅ 認証コードの重複使用を防止"]})}),s.jsx("p",{className:"text-blue-500 text-sm",children:"3秒後に自動的にホームページに戻ります..."})]}),r==="error"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-12 h-12 mx-auto mb-4 text-red-500",children:s.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),s.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-4",children:"❌ 認証に失敗しました"}),s.jsx("p",{className:"text-red-600 mb-4",children:o}),s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:s.jsxs("p",{className:"text-red-700 text-sm text-left",children:[s.jsx("strong",{children:"🔍 よくある解決方法:"}),s.jsx("br",{}),"• 認証コードの重複使用（ページリロード等）",s.jsx("br",{}),"• Spotify Developer Dashboardでredirect_uriを確認",s.jsx("br",{}),"• Client IDが正しく設定されているか確認",s.jsx("br",{}),"• ブラウザのキャッシュをクリアして再試行",s.jsx("br",{}),"• 認証コードの有効期限（10分）内に処理を完了",s.jsx("br",{}),"• code_verifierが失われた場合は新しい認証を開始"]})}),s.jsx("button",{onClick:()=>t("/"),className:"bg-blue-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-600 transition-colors duration-300",children:"ホームに戻る"})]})]})})})}function Id(){j.useState(!1);const[e,t]=j.useState(on()),[r,n]=j.useState(0);j.useEffect(()=>{o()},[]);const o=async()=>{try{const a=await De.loadAllUsers();n(Object.keys(a).length),t(on())}catch(a){console.error("ストレージ統計の読み込みエラー:",a)}};return null}function Bd(){return s.jsxs(s.Fragment,{children:[s.jsxs(Js,{children:[s.jsx(je,{path:"/",element:s.jsx(ai,{})}),s.jsx(je,{path:"/login",element:s.jsx(ii,{})}),s.jsx(je,{path:"/admin-login",element:s.jsx(li,{})}),s.jsx(je,{path:"/dashboard",element:s.jsx(Nl,{})}),s.jsx(je,{path:"/users/:username",element:s.jsx(Ed,{})}),s.jsx(je,{path:"/create",element:s.jsx(_d,{})}),s.jsx(je,{path:"/admin",element:s.jsx(Rd,{})}),s.jsx(je,{path:"/edit/:username",element:s.jsx(Ld,{})}),s.jsx(je,{path:"/callback",element:s.jsx(Ad,{})})]}),s.jsx(Id,{})]})}ar.createRoot(document.getElementById("root")).render(s.jsx(Vs.StrictMode,{children:s.jsx(Ks,{children:s.jsx(Bd,{})})}));
