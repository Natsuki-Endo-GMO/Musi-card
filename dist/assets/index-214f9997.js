var ln=Object.defineProperty;var cn=(e,t,s)=>t in e?ln(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var $e=(e,t,s)=>(cn(e,typeof t!="symbol"?t+"":t,s),s);import{r as j,a as rs,g as ss,b as dn}from"./vendor-280e31ee.js";import{u as ye,L as Ee,a as ns,b as un,c as hn,R as mn,d as ue,B as fn}from"./router-a8409eb2.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();const gn="modulepreload",xn=function(e){return"/"+e},Ir={},pn=function(t,s,n){if(!s||s.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(s.map(a=>{if(a=xn(a),a in Ir)return;Ir[a]=!0;const i=a.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!n)for(let u=o.length-1;u>=0;u--){const f=o[u];if(f.href===a&&(!i||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":gn,i||(d.as="script",d.crossOrigin=""),d.href=a,document.head.appendChild(d),i)return new Promise((u,f)=>{d.addEventListener("load",u),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a})};var os={exports:{}},St={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bn=j,yn=Symbol.for("react.element"),wn=Symbol.for("react.fragment"),jn=Object.prototype.hasOwnProperty,vn=bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Nn={key:!0,ref:!0,__self:!0,__source:!0};function as(e,t,s){var n,o={},a=null,i=null;s!==void 0&&(a=""+s),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)jn.call(t,n)&&!Nn.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)o[n]===void 0&&(o[n]=t[n]);return{$$typeof:yn,type:e,key:a,ref:i,props:o,_owner:vn.current}}St.Fragment=wn;St.jsx=as;St.jsxs=as;os.exports=St;var r=os.exports,Xt={},Ar=rs;Xt.createRoot=Ar.createRoot,Xt.hydrateRoot=Ar.hydrateRoot;function is(e,t){return function(){return e.apply(t,arguments)}}const{toString:Sn}=Object.prototype,{getPrototypeOf:fr}=Object,{iterator:Ct,toStringTag:ls}=Symbol,kt=(e=>t=>{const s=Sn.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),de=e=>(e=e.toLowerCase(),t=>kt(t)===e),Et=e=>t=>typeof t===e,{isArray:ze}=Array,Ye=Et("undefined");function Cn(e){return e!==null&&!Ye(e)&&e.constructor!==null&&!Ye(e.constructor)&&re(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const cs=de("ArrayBuffer");function kn(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&cs(e.buffer),t}const En=Et("string"),re=Et("function"),ds=Et("number"),Lt=e=>e!==null&&typeof e=="object",Ln=e=>e===!0||e===!1,ht=e=>{if(kt(e)!=="object")return!1;const t=fr(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(ls in e)&&!(Ct in e)},Rn=de("Date"),In=de("File"),An=de("Blob"),Tn=de("FileList"),$n=e=>Lt(e)&&re(e.pipe),_n=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||re(e.append)&&((t=kt(e))==="formdata"||t==="object"&&re(e.toString)&&e.toString()==="[object FormData]"))},Pn=de("URLSearchParams"),[Bn,Mn,On,Dn]=["ReadableStream","Request","Response","Headers"].map(de),Un=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function rt(e,t,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let n,o;if(typeof e!="object"&&(e=[e]),ze(e))for(n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else{const a=s?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let l;for(n=0;n<i;n++)l=a[n],t.call(null,e[l],l,e)}}function us(e,t){t=t.toLowerCase();const s=Object.keys(e);let n=s.length,o;for(;n-- >0;)if(o=s[n],t===o.toLowerCase())return o;return null}const ke=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),hs=e=>!Ye(e)&&e!==ke;function Qt(){const{caseless:e}=hs(this)&&this||{},t={},s=(n,o)=>{const a=e&&us(t,o)||o;ht(t[a])&&ht(n)?t[a]=Qt(t[a],n):ht(n)?t[a]=Qt({},n):ze(n)?t[a]=n.slice():t[a]=n};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&rt(arguments[n],s);return t}const zn=(e,t,s,{allOwnKeys:n}={})=>(rt(t,(o,a)=>{s&&re(o)?e[a]=is(o,s):e[a]=o},{allOwnKeys:n}),e),Fn=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Hn=(e,t,s,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},Vn=(e,t,s,n)=>{let o,a,i;const l={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)i=o[a],(!n||n(i,e,t))&&!l[i]&&(t[i]=e[i],l[i]=!0);e=s!==!1&&fr(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},Wn=(e,t,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=t.length;const n=e.indexOf(t,s);return n!==-1&&n===s},Jn=e=>{if(!e)return null;if(ze(e))return e;let t=e.length;if(!ds(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},Kn=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&fr(Uint8Array)),qn=(e,t)=>{const n=(e&&e[Ct]).call(e);let o;for(;(o=n.next())&&!o.done;){const a=o.value;t.call(e,a[0],a[1])}},Yn=(e,t)=>{let s;const n=[];for(;(s=e.exec(t))!==null;)n.push(s);return n},Gn=de("HTMLFormElement"),Xn=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,o){return n.toUpperCase()+o}),Tr=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),Qn=de("RegExp"),ms=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),n={};rt(s,(o,a)=>{let i;(i=t(o,a,e))!==!1&&(n[a]=i||o)}),Object.defineProperties(e,n)},Zn=e=>{ms(e,(t,s)=>{if(re(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=e[s];if(re(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},eo=(e,t)=>{const s={},n=o=>{o.forEach(a=>{s[a]=!0})};return ze(e)?n(e):n(String(e).split(t)),s},to=()=>{},ro=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function so(e){return!!(e&&re(e.append)&&e[ls]==="FormData"&&e[Ct])}const no=e=>{const t=new Array(10),s=(n,o)=>{if(Lt(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[o]=n;const a=ze(n)?[]:{};return rt(n,(i,l)=>{const c=s(i,o+1);!Ye(c)&&(a[l]=c)}),t[o]=void 0,a}}return n};return s(e,0)},oo=de("AsyncFunction"),ao=e=>e&&(Lt(e)||re(e))&&re(e.then)&&re(e.catch),fs=((e,t)=>e?setImmediate:t?((s,n)=>(ke.addEventListener("message",({source:o,data:a})=>{o===ke&&a===s&&n.length&&n.shift()()},!1),o=>{n.push(o),ke.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",re(ke.postMessage)),io=typeof queueMicrotask<"u"?queueMicrotask.bind(ke):typeof process<"u"&&process.nextTick||fs,lo=e=>e!=null&&re(e[Ct]),v={isArray:ze,isArrayBuffer:cs,isBuffer:Cn,isFormData:_n,isArrayBufferView:kn,isString:En,isNumber:ds,isBoolean:Ln,isObject:Lt,isPlainObject:ht,isReadableStream:Bn,isRequest:Mn,isResponse:On,isHeaders:Dn,isUndefined:Ye,isDate:Rn,isFile:In,isBlob:An,isRegExp:Qn,isFunction:re,isStream:$n,isURLSearchParams:Pn,isTypedArray:Kn,isFileList:Tn,forEach:rt,merge:Qt,extend:zn,trim:Un,stripBOM:Fn,inherits:Hn,toFlatObject:Vn,kindOf:kt,kindOfTest:de,endsWith:Wn,toArray:Jn,forEachEntry:qn,matchAll:Yn,isHTMLForm:Gn,hasOwnProperty:Tr,hasOwnProp:Tr,reduceDescriptors:ms,freezeMethods:Zn,toObjectSet:eo,toCamelCase:Xn,noop:to,toFiniteNumber:ro,findKey:us,global:ke,isContextDefined:hs,isSpecCompliantForm:so,toJSONObject:no,isAsyncFn:oo,isThenable:ao,setImmediate:fs,asap:io,isIterable:lo};function _(e,t,s,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}v.inherits(_,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:v.toJSONObject(this.config),code:this.code,status:this.status}}});const gs=_.prototype,xs={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{xs[e]={value:e}});Object.defineProperties(_,xs);Object.defineProperty(gs,"isAxiosError",{value:!0});_.from=(e,t,s,n,o,a)=>{const i=Object.create(gs);return v.toFlatObject(e,i,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),_.call(i,e.message,t,s,n,o),i.cause=e,i.name=e.name,a&&Object.assign(i,a),i};const co=null;function Zt(e){return v.isPlainObject(e)||v.isArray(e)}function ps(e){return v.endsWith(e,"[]")?e.slice(0,-2):e}function $r(e,t,s){return e?e.concat(t).map(function(o,a){return o=ps(o),!s&&a?"["+o+"]":o}).join(s?".":""):t}function uo(e){return v.isArray(e)&&!e.some(Zt)}const ho=v.toFlatObject(v,{},null,function(t){return/^is[A-Z]/.test(t)});function Rt(e,t,s){if(!v.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,s=v.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!v.isUndefined(g[m])});const n=s.metaTokens,o=s.visitor||u,a=s.dots,i=s.indexes,c=(s.Blob||typeof Blob<"u"&&Blob)&&v.isSpecCompliantForm(t);if(!v.isFunction(o))throw new TypeError("visitor must be a function");function d(h){if(h===null)return"";if(v.isDate(h))return h.toISOString();if(v.isBoolean(h))return h.toString();if(!c&&v.isBlob(h))throw new _("Blob is not supported. Use a Buffer instead.");return v.isArrayBuffer(h)||v.isTypedArray(h)?c&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function u(h,m,g){let y=h;if(h&&!g&&typeof h=="object"){if(v.endsWith(m,"{}"))m=n?m:m.slice(0,-2),h=JSON.stringify(h);else if(v.isArray(h)&&uo(h)||(v.isFileList(h)||v.endsWith(m,"[]"))&&(y=v.toArray(h)))return m=ps(m),y.forEach(function(w,b){!(v.isUndefined(w)||w===null)&&t.append(i===!0?$r([m],b,a):i===null?m:m+"[]",d(w))}),!1}return Zt(h)?!0:(t.append($r(g,m,a),d(h)),!1)}const f=[],x=Object.assign(ho,{defaultVisitor:u,convertValue:d,isVisitable:Zt});function p(h,m){if(!v.isUndefined(h)){if(f.indexOf(h)!==-1)throw Error("Circular reference detected in "+m.join("."));f.push(h),v.forEach(h,function(y,N){(!(v.isUndefined(y)||y===null)&&o.call(t,y,v.isString(N)?N.trim():N,m,x))===!0&&p(y,m?m.concat(N):[N])}),f.pop()}}if(!v.isObject(e))throw new TypeError("data must be an object");return p(e),t}function _r(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function gr(e,t){this._pairs=[],e&&Rt(e,this,t)}const bs=gr.prototype;bs.append=function(t,s){this._pairs.push([t,s])};bs.toString=function(t){const s=t?function(n){return t.call(this,n,_r)}:_r;return this._pairs.map(function(o){return s(o[0])+"="+s(o[1])},"").join("&")};function mo(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ys(e,t,s){if(!t)return e;const n=s&&s.encode||mo;v.isFunction(s)&&(s={serialize:s});const o=s&&s.serialize;let a;if(o?a=o(t,s):a=v.isURLSearchParams(t)?t.toString():new gr(t,s).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class fo{constructor(){this.handlers=[]}use(t,s,n){return this.handlers.push({fulfilled:t,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){v.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Pr=fo,ws={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},go=typeof URLSearchParams<"u"?URLSearchParams:gr,xo=typeof FormData<"u"?FormData:null,po=typeof Blob<"u"?Blob:null,bo={isBrowser:!0,classes:{URLSearchParams:go,FormData:xo,Blob:po},protocols:["http","https","file","blob","url","data"]},xr=typeof window<"u"&&typeof document<"u",er=typeof navigator=="object"&&navigator||void 0,yo=xr&&(!er||["ReactNative","NativeScript","NS"].indexOf(er.product)<0),wo=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),jo=xr&&window.location.href||"http://localhost",vo=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:xr,hasStandardBrowserEnv:yo,hasStandardBrowserWebWorkerEnv:wo,navigator:er,origin:jo},Symbol.toStringTag,{value:"Module"})),Q={...vo,...bo};function No(e,t){return Rt(e,new Q.classes.URLSearchParams,Object.assign({visitor:function(s,n,o,a){return Q.isNode&&v.isBuffer(s)?(this.append(n,s.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function So(e){return v.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Co(e){const t={},s=Object.keys(e);let n;const o=s.length;let a;for(n=0;n<o;n++)a=s[n],t[a]=e[a];return t}function js(e){function t(s,n,o,a){let i=s[a++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),c=a>=s.length;return i=!i&&v.isArray(o)?o.length:i,c?(v.hasOwnProp(o,i)?o[i]=[o[i],n]:o[i]=n,!l):((!o[i]||!v.isObject(o[i]))&&(o[i]=[]),t(s,n,o[i],a)&&v.isArray(o[i])&&(o[i]=Co(o[i])),!l)}if(v.isFormData(e)&&v.isFunction(e.entries)){const s={};return v.forEachEntry(e,(n,o)=>{t(So(n),o,s,0)}),s}return null}function ko(e,t,s){if(v.isString(e))try{return(t||JSON.parse)(e),v.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(e)}const pr={transitional:ws,adapter:["xhr","http","fetch"],transformRequest:[function(t,s){const n=s.getContentType()||"",o=n.indexOf("application/json")>-1,a=v.isObject(t);if(a&&v.isHTMLForm(t)&&(t=new FormData(t)),v.isFormData(t))return o?JSON.stringify(js(t)):t;if(v.isArrayBuffer(t)||v.isBuffer(t)||v.isStream(t)||v.isFile(t)||v.isBlob(t)||v.isReadableStream(t))return t;if(v.isArrayBufferView(t))return t.buffer;if(v.isURLSearchParams(t))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return No(t,this.formSerializer).toString();if((l=v.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Rt(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return a||o?(s.setContentType("application/json",!1),ko(t)):t}],transformResponse:[function(t){const s=this.transitional||pr.transitional,n=s&&s.forcedJSONParsing,o=this.responseType==="json";if(v.isResponse(t)||v.isReadableStream(t))return t;if(t&&v.isString(t)&&(n&&!this.responseType||o)){const i=!(s&&s.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(l){if(i)throw l.name==="SyntaxError"?_.from(l,_.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Q.classes.FormData,Blob:Q.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};v.forEach(["delete","get","head","post","put","patch"],e=>{pr.headers[e]={}});const br=pr,Eo=v.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Lo=e=>{const t={};let s,n,o;return e&&e.split(`
`).forEach(function(i){o=i.indexOf(":"),s=i.substring(0,o).trim().toLowerCase(),n=i.substring(o+1).trim(),!(!s||t[s]&&Eo[s])&&(s==="set-cookie"?t[s]?t[s].push(n):t[s]=[n]:t[s]=t[s]?t[s]+", "+n:n)}),t},Br=Symbol("internals");function Je(e){return e&&String(e).trim().toLowerCase()}function mt(e){return e===!1||e==null?e:v.isArray(e)?e.map(mt):String(e)}function Ro(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(e);)t[n[1]]=n[2];return t}const Io=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ft(e,t,s,n,o){if(v.isFunction(n))return n.call(this,t,s);if(o&&(t=s),!!v.isString(t)){if(v.isString(n))return t.indexOf(n)!==-1;if(v.isRegExp(n))return n.test(t)}}function Ao(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,s,n)=>s.toUpperCase()+n)}function To(e,t){const s=v.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+s,{value:function(o,a,i){return this[n].call(this,t,o,a,i)},configurable:!0})})}class It{constructor(t){t&&this.set(t)}set(t,s,n){const o=this;function a(l,c,d){const u=Je(c);if(!u)throw new Error("header name must be a non-empty string");const f=v.findKey(o,u);(!f||o[f]===void 0||d===!0||d===void 0&&o[f]!==!1)&&(o[f||c]=mt(l))}const i=(l,c)=>v.forEach(l,(d,u)=>a(d,u,c));if(v.isPlainObject(t)||t instanceof this.constructor)i(t,s);else if(v.isString(t)&&(t=t.trim())&&!Io(t))i(Lo(t),s);else if(v.isObject(t)&&v.isIterable(t)){let l={},c,d;for(const u of t){if(!v.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?v.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}i(l,s)}else t!=null&&a(s,t,n);return this}get(t,s){if(t=Je(t),t){const n=v.findKey(this,t);if(n){const o=this[n];if(!s)return o;if(s===!0)return Ro(o);if(v.isFunction(s))return s.call(this,o,n);if(v.isRegExp(s))return s.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,s){if(t=Je(t),t){const n=v.findKey(this,t);return!!(n&&this[n]!==void 0&&(!s||Ft(this,this[n],n,s)))}return!1}delete(t,s){const n=this;let o=!1;function a(i){if(i=Je(i),i){const l=v.findKey(n,i);l&&(!s||Ft(n,n[l],l,s))&&(delete n[l],o=!0)}}return v.isArray(t)?t.forEach(a):a(t),o}clear(t){const s=Object.keys(this);let n=s.length,o=!1;for(;n--;){const a=s[n];(!t||Ft(this,this[a],a,t,!0))&&(delete this[a],o=!0)}return o}normalize(t){const s=this,n={};return v.forEach(this,(o,a)=>{const i=v.findKey(n,a);if(i){s[i]=mt(o),delete s[a];return}const l=t?Ao(a):String(a).trim();l!==a&&delete s[a],s[l]=mt(o),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const s=Object.create(null);return v.forEach(this,(n,o)=>{n!=null&&n!==!1&&(s[o]=t&&v.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,s])=>t+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...s){const n=new this(t);return s.forEach(o=>n.set(o)),n}static accessor(t){const n=(this[Br]=this[Br]={accessors:{}}).accessors,o=this.prototype;function a(i){const l=Je(i);n[l]||(To(o,i),n[l]=!0)}return v.isArray(t)?t.forEach(a):a(t),this}}It.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);v.reduceDescriptors(It.prototype,({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[s]=n}}});v.freezeMethods(It);const ce=It;function Ht(e,t){const s=this||br,n=t||s,o=ce.from(n.headers);let a=n.data;return v.forEach(e,function(l){a=l.call(s,a,o.normalize(),t?t.status:void 0)}),o.normalize(),a}function vs(e){return!!(e&&e.__CANCEL__)}function Fe(e,t,s){_.call(this,e??"canceled",_.ERR_CANCELED,t,s),this.name="CanceledError"}v.inherits(Fe,_,{__CANCEL__:!0});function Ns(e,t,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?e(s):t(new _("Request failed with status code "+s.status,[_.ERR_BAD_REQUEST,_.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function $o(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function _o(e,t){e=e||10;const s=new Array(e),n=new Array(e);let o=0,a=0,i;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=n[a];i||(i=d),s[o]=c,n[o]=d;let f=a,x=0;for(;f!==o;)x+=s[f++],f=f%e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),d-i<t)return;const p=u&&d-u;return p?Math.round(x*1e3/p):void 0}}function Po(e,t){let s=0,n=1e3/t,o,a;const i=(d,u=Date.now())=>{s=u,o=null,a&&(clearTimeout(a),a=null),e.apply(null,d)};return[(...d)=>{const u=Date.now(),f=u-s;f>=n?i(d,u):(o=d,a||(a=setTimeout(()=>{a=null,i(o)},n-f)))},()=>o&&i(o)]}const pt=(e,t,s=3)=>{let n=0;const o=_o(50,250);return Po(a=>{const i=a.loaded,l=a.lengthComputable?a.total:void 0,c=i-n,d=o(c),u=i<=l;n=i;const f={loaded:i,total:l,progress:l?i/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-i)/d:void 0,event:a,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},s)},Mr=(e,t)=>{const s=e!=null;return[n=>t[0]({lengthComputable:s,total:e,loaded:n}),t[1]]},Or=e=>(...t)=>v.asap(()=>e(...t)),Bo=Q.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,Q.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(Q.origin),Q.navigator&&/(msie|trident)/i.test(Q.navigator.userAgent)):()=>!0,Mo=Q.hasStandardBrowserEnv?{write(e,t,s,n,o,a){const i=[e+"="+encodeURIComponent(t)];v.isNumber(s)&&i.push("expires="+new Date(s).toGMTString()),v.isString(n)&&i.push("path="+n),v.isString(o)&&i.push("domain="+o),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Oo(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Do(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Ss(e,t,s){let n=!Oo(t);return e&&(n||s==!1)?Do(e,t):t}const Dr=e=>e instanceof ce?{...e}:e;function Re(e,t){t=t||{};const s={};function n(d,u,f,x){return v.isPlainObject(d)&&v.isPlainObject(u)?v.merge.call({caseless:x},d,u):v.isPlainObject(u)?v.merge({},u):v.isArray(u)?u.slice():u}function o(d,u,f,x){if(v.isUndefined(u)){if(!v.isUndefined(d))return n(void 0,d,f,x)}else return n(d,u,f,x)}function a(d,u){if(!v.isUndefined(u))return n(void 0,u)}function i(d,u){if(v.isUndefined(u)){if(!v.isUndefined(d))return n(void 0,d)}else return n(void 0,u)}function l(d,u,f){if(f in t)return n(d,u);if(f in e)return n(void 0,d)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(d,u,f)=>o(Dr(d),Dr(u),f,!0)};return v.forEach(Object.keys(Object.assign({},e,t)),function(u){const f=c[u]||o,x=f(e[u],t[u],u);v.isUndefined(x)&&f!==l||(s[u]=x)}),s}const Cs=e=>{const t=Re({},e);let{data:s,withXSRFToken:n,xsrfHeaderName:o,xsrfCookieName:a,headers:i,auth:l}=t;t.headers=i=ce.from(i),t.url=ys(Ss(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(v.isFormData(s)){if(Q.hasStandardBrowserEnv||Q.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[d,...u]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...u].join("; "))}}if(Q.hasStandardBrowserEnv&&(n&&v.isFunction(n)&&(n=n(t)),n||n!==!1&&Bo(t.url))){const d=o&&a&&Mo.read(a);d&&i.set(o,d)}return t},Uo=typeof XMLHttpRequest<"u",zo=Uo&&function(e){return new Promise(function(s,n){const o=Cs(e);let a=o.data;const i=ce.from(o.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=o,u,f,x,p,h;function m(){p&&p(),h&&h(),o.cancelToken&&o.cancelToken.unsubscribe(u),o.signal&&o.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(o.method.toUpperCase(),o.url,!0),g.timeout=o.timeout;function y(){if(!g)return;const w=ce.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),C={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:w,config:e,request:g};Ns(function(A){s(A),m()},function(A){n(A),m()},C),g=null}"onloadend"in g?g.onloadend=y:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(y)},g.onabort=function(){g&&(n(new _("Request aborted",_.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new _("Network Error",_.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let b=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const C=o.transitional||ws;o.timeoutErrorMessage&&(b=o.timeoutErrorMessage),n(new _(b,C.clarifyTimeoutError?_.ETIMEDOUT:_.ECONNABORTED,e,g)),g=null},a===void 0&&i.setContentType(null),"setRequestHeader"in g&&v.forEach(i.toJSON(),function(b,C){g.setRequestHeader(C,b)}),v.isUndefined(o.withCredentials)||(g.withCredentials=!!o.withCredentials),l&&l!=="json"&&(g.responseType=o.responseType),d&&([x,h]=pt(d,!0),g.addEventListener("progress",x)),c&&g.upload&&([f,p]=pt(c),g.upload.addEventListener("progress",f),g.upload.addEventListener("loadend",p)),(o.cancelToken||o.signal)&&(u=w=>{g&&(n(!w||w.type?new Fe(null,e,g):w),g.abort(),g=null)},o.cancelToken&&o.cancelToken.subscribe(u),o.signal&&(o.signal.aborted?u():o.signal.addEventListener("abort",u)));const N=$o(o.url);if(N&&Q.protocols.indexOf(N)===-1){n(new _("Unsupported protocol "+N+":",_.ERR_BAD_REQUEST,e));return}g.send(a||null)})},Fo=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let n=new AbortController,o;const a=function(d){if(!o){o=!0,l();const u=d instanceof Error?d:this.reason;n.abort(u instanceof _?u:new Fe(u instanceof Error?u.message:u))}};let i=t&&setTimeout(()=>{i=null,a(new _(`timeout ${t} of ms exceeded`,_.ETIMEDOUT))},t);const l=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(a):d.removeEventListener("abort",a)}),e=null)};e.forEach(d=>d.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>v.asap(l),c}},Ho=Fo,Vo=function*(e,t){let s=e.byteLength;if(!t||s<t){yield e;return}let n=0,o;for(;n<s;)o=n+t,yield e.slice(n,o),n=o},Wo=async function*(e,t){for await(const s of Jo(e))yield*Vo(s,t)},Jo=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:s,value:n}=await t.read();if(s)break;yield n}}finally{await t.cancel()}},Ur=(e,t,s,n)=>{const o=Wo(e,t);let a=0,i,l=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await o.next();if(d){l(),c.close();return}let f=u.byteLength;if(s){let x=a+=f;s(x)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),o.return()}},{highWaterMark:2})},At=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",ks=At&&typeof ReadableStream=="function",Ko=At&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Es=(e,...t)=>{try{return!!e(...t)}catch{return!1}},qo=ks&&Es(()=>{let e=!1;const t=new Request(Q.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),zr=64*1024,tr=ks&&Es(()=>v.isReadableStream(new Response("").body)),bt={stream:tr&&(e=>e.body)};At&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!bt[t]&&(bt[t]=v.isFunction(e[t])?s=>s[t]():(s,n)=>{throw new _(`Response type '${t}' is not supported`,_.ERR_NOT_SUPPORT,n)})})})(new Response);const Yo=async e=>{if(e==null)return 0;if(v.isBlob(e))return e.size;if(v.isSpecCompliantForm(e))return(await new Request(Q.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(v.isArrayBufferView(e)||v.isArrayBuffer(e))return e.byteLength;if(v.isURLSearchParams(e)&&(e=e+""),v.isString(e))return(await Ko(e)).byteLength},Go=async(e,t)=>{const s=v.toFiniteNumber(e.getContentLength());return s??Yo(t)},Xo=At&&(async e=>{let{url:t,method:s,data:n,signal:o,cancelToken:a,timeout:i,onDownloadProgress:l,onUploadProgress:c,responseType:d,headers:u,withCredentials:f="same-origin",fetchOptions:x}=Cs(e);d=d?(d+"").toLowerCase():"text";let p=Ho([o,a&&a.toAbortSignal()],i),h;const m=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let g;try{if(c&&qo&&s!=="get"&&s!=="head"&&(g=await Go(u,n))!==0){let C=new Request(t,{method:"POST",body:n,duplex:"half"}),I;if(v.isFormData(n)&&(I=C.headers.get("content-type"))&&u.setContentType(I),C.body){const[A,E]=Mr(g,pt(Or(c)));n=Ur(C.body,zr,A,E)}}v.isString(f)||(f=f?"include":"omit");const y="credentials"in Request.prototype;h=new Request(t,{...x,signal:p,method:s.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:y?f:void 0});let N=await fetch(h,x);const w=tr&&(d==="stream"||d==="response");if(tr&&(l||w&&m)){const C={};["status","statusText","headers"].forEach(R=>{C[R]=N[R]});const I=v.toFiniteNumber(N.headers.get("content-length")),[A,E]=l&&Mr(I,pt(Or(l),!0))||[];N=new Response(Ur(N.body,zr,A,()=>{E&&E(),m&&m()}),C)}d=d||"text";let b=await bt[v.findKey(bt,d)||"text"](N,e);return!w&&m&&m(),await new Promise((C,I)=>{Ns(C,I,{data:b,headers:ce.from(N.headers),status:N.status,statusText:N.statusText,config:e,request:h})})}catch(y){throw m&&m(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new _("Network Error",_.ERR_NETWORK,e,h),{cause:y.cause||y}):_.from(y,y&&y.code,e,h)}}),rr={http:co,xhr:zo,fetch:Xo};v.forEach(rr,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Fr=e=>`- ${e}`,Qo=e=>v.isFunction(e)||e===null||e===!1,Ls={getAdapter:e=>{e=v.isArray(e)?e:[e];const{length:t}=e;let s,n;const o={};for(let a=0;a<t;a++){s=e[a];let i;if(n=s,!Qo(s)&&(n=rr[(i=String(s)).toLowerCase()],n===void 0))throw new _(`Unknown adapter '${i}'`);if(n)break;o[i||"#"+a]=n}if(!n){const a=Object.entries(o).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=t?a.length>1?`since :
`+a.map(Fr).join(`
`):" "+Fr(a[0]):"as no adapter specified";throw new _("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:rr};function Vt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Fe(null,e)}function Hr(e){return Vt(e),e.headers=ce.from(e.headers),e.data=Ht.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ls.getAdapter(e.adapter||br.adapter)(e).then(function(n){return Vt(e),n.data=Ht.call(e,e.transformResponse,n),n.headers=ce.from(n.headers),n},function(n){return vs(n)||(Vt(e),n&&n.response&&(n.response.data=Ht.call(e,e.transformResponse,n.response),n.response.headers=ce.from(n.response.headers))),Promise.reject(n)})}const Rs="1.10.0",Tt={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Tt[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Vr={};Tt.transitional=function(t,s,n){function o(a,i){return"[Axios v"+Rs+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,l)=>{if(t===!1)throw new _(o(i," has been removed"+(s?" in "+s:"")),_.ERR_DEPRECATED);return s&&!Vr[i]&&(Vr[i]=!0,console.warn(o(i," has been deprecated since v"+s+" and will be removed in the near future"))),t?t(a,i,l):!0}};Tt.spelling=function(t){return(s,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Zo(e,t,s){if(typeof e!="object")throw new _("options must be an object",_.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let o=n.length;for(;o-- >0;){const a=n[o],i=t[a];if(i){const l=e[a],c=l===void 0||i(l,a,e);if(c!==!0)throw new _("option "+a+" must be "+c,_.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new _("Unknown option "+a,_.ERR_BAD_OPTION)}}const ft={assertOptions:Zo,validators:Tt},he=ft.validators;class yt{constructor(t){this.defaults=t||{},this.interceptors={request:new Pr,response:new Pr}}async request(t,s){try{return await this._request(t,s)}catch(n){if(n instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,s){typeof t=="string"?(s=s||{},s.url=t):s=t||{},s=Re(this.defaults,s);const{transitional:n,paramsSerializer:o,headers:a}=s;n!==void 0&&ft.assertOptions(n,{silentJSONParsing:he.transitional(he.boolean),forcedJSONParsing:he.transitional(he.boolean),clarifyTimeoutError:he.transitional(he.boolean)},!1),o!=null&&(v.isFunction(o)?s.paramsSerializer={serialize:o}:ft.assertOptions(o,{encode:he.function,serialize:he.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),ft.assertOptions(s,{baseUrl:he.spelling("baseURL"),withXsrfToken:he.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let i=a&&v.merge(a.common,a[s.method]);a&&v.forEach(["delete","get","head","post","put","patch","common"],h=>{delete a[h]}),s.headers=ce.concat(i,a);const l=[];let c=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(s)===!1||(c=c&&m.synchronous,l.unshift(m.fulfilled,m.rejected))});const d=[];this.interceptors.response.forEach(function(m){d.push(m.fulfilled,m.rejected)});let u,f=0,x;if(!c){const h=[Hr.bind(this),void 0];for(h.unshift.apply(h,l),h.push.apply(h,d),x=h.length,u=Promise.resolve(s);f<x;)u=u.then(h[f++],h[f++]);return u}x=l.length;let p=s;for(f=0;f<x;){const h=l[f++],m=l[f++];try{p=h(p)}catch(g){m.call(this,g);break}}try{u=Hr.call(this,p)}catch(h){return Promise.reject(h)}for(f=0,x=d.length;f<x;)u=u.then(d[f++],d[f++]);return u}getUri(t){t=Re(this.defaults,t);const s=Ss(t.baseURL,t.url,t.allowAbsoluteUrls);return ys(s,t.params,t.paramsSerializer)}}v.forEach(["delete","get","head","options"],function(t){yt.prototype[t]=function(s,n){return this.request(Re(n||{},{method:t,url:s,data:(n||{}).data}))}});v.forEach(["post","put","patch"],function(t){function s(n){return function(a,i,l){return this.request(Re(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}yt.prototype[t]=s(),yt.prototype[t+"Form"]=s(!0)});const gt=yt;class yr{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(a){s=a});const n=this;this.promise.then(o=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](o);n._listeners=null}),this.promise.then=o=>{let a;const i=new Promise(l=>{n.subscribe(l),a=l}).then(o);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,l){n.reason||(n.reason=new Fe(a,i,l),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const s=this._listeners.indexOf(t);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const t=new AbortController,s=n=>{t.abort(n)};return this.subscribe(s),t.signal.unsubscribe=()=>this.unsubscribe(s),t.signal}static source(){let t;return{token:new yr(function(o){t=o}),cancel:t}}}const ea=yr;function ta(e){return function(s){return e.apply(null,s)}}function ra(e){return v.isObject(e)&&e.isAxiosError===!0}const sr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(sr).forEach(([e,t])=>{sr[t]=e});const sa=sr;function Is(e){const t=new gt(e),s=is(gt.prototype.request,t);return v.extend(s,gt.prototype,t,{allOwnKeys:!0}),v.extend(s,t,null,{allOwnKeys:!0}),s.create=function(o){return Is(Re(e,o))},s}const Y=Is(br);Y.Axios=gt;Y.CanceledError=Fe;Y.CancelToken=ea;Y.isCancel=vs;Y.VERSION=Rs;Y.toFormData=Rt;Y.AxiosError=_;Y.Cancel=Y.CanceledError;Y.all=function(t){return Promise.all(t)};Y.spread=ta;Y.isAxiosError=ra;Y.mergeConfig=Re;Y.AxiosHeaders=ce;Y.formToJSON=e=>js(v.isHTMLForm(e)?new FormData(e):e);Y.getAdapter=Ls.getAdapter;Y.HttpStatusCode=sa;Y.default=Y;const na=Y;let xt="",nr="";async function oa(){try{const t=await(await fetch("/api/config?type=spotify")).json();xt=t.clientId,nr=t.redirectUri}catch(e){console.error("Spotify設定の取得に失敗:",e)}}oa();const Wt=()=>{if(nr)return nr;if(typeof window<"u"){const{protocol:e,hostname:t}=window.location;return`${e}//${t}/callback`}if(typeof window<"u"){const{protocol:e,hostname:t,port:s}=window.location;return t==="localhost"||t==="127.0.0.1"?`${e}//${t}:${s||"5173"}/callback`:`${e}//${t}/callback`}throw new Error("本番環境では SPOTIFY_REDIRECT_URI を設定してください")},_e="https://api.spotify.com/v1",aa="https://accounts.spotify.com/authorize",ia="https://accounts.spotify.com/api/token",la=["user-read-private","user-read-email"].join(" ");function ca(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=new Uint8Array(128);return crypto.getRandomValues(s),Array.from(s,o=>e[o%e.length]).join("")}async function da(e){const s=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",s);return btoa(String.fromCharCode(...new Uint8Array(n))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const As={getCurrentRedirectUri:()=>Wt(),getAuthUrl:async()=>{const e=ca(),t=await da(e),s=Wt(),n=ha(32),o=Date.now(),a={codeVerifier:e,timestamp:o,state:n};localStorage.setItem(`spotify_auth_${n}`,JSON.stringify(a)),localStorage.setItem("spotify_current_state",n);const i=new URLSearchParams({client_id:xt,response_type:"code",redirect_uri:s,scope:la,code_challenge_method:"S256",code_challenge:t,state:n});return`${aa}?${i.toString()}`},getAccessToken:async(e,t)=>{if(!t){const c=localStorage.getItem("spotify_current_state");c&&(t=c)}let s=null,n=null;if(t){const c=localStorage.getItem(`spotify_auth_${t}`);if(c)try{const d=JSON.parse(c);s=d.codeVerifier,n=d.timestamp,console.log("✅ State対応認証データ取得成功:",{state:t.substring(0,10)+"...",hasCodeVerifier:!!s,作成時刻:n?new Date(n).toLocaleTimeString():"unknown"})}catch(d){console.error("❌ 認証データ解析エラー:",d)}}if(!s){s=localStorage.getItem("spotify_code_verifier");const c=localStorage.getItem("spotify_code_verifier_timestamp");c&&(n=parseInt(c)),s&&console.log("⚠️ フォールバック: 古い方式でcode_verifier取得")}if(!s)throw new Error("Code verifier not found - 認証を最初からやり直してください");if(n){const c=Date.now(),d=Math.floor((c-n)/6e4);console.log("🕐 Code Verifier時間確認:",{作成時刻:new Date(n).toLocaleTimeString(),現在時刻:new Date(c).toLocaleTimeString(),経過時間:`${d}分`,制限時間:"10分"}),d>10&&console.warn("⚠️ Code Verifierが10分以上経過しています")}const o=Wt(),a={grant_type:"authorization_code",code:e,redirect_uri:o,client_id:xt,code_verifier:s};console.log("🔄 トークン交換リクエスト開始..."),console.log(`   Redirect URI: ${o}`),console.log(`   Client ID: ${xt?"設定済み":"❌ 未設定"}`),console.log(`   認証コード: ${e.substring(0,10)}...`),console.log(`   Code Verifier: ${s?"設定済み":"❌ 未設定"}`),console.log(`   Code Verifier長さ: ${s?s.length:0}`),console.log(`   Code Verifier先頭: ${s?s.substring(0,15)+"...":"なし"}`);const i=await fetch(ia,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a)});if(t&&localStorage.removeItem(`spotify_auth_${t}`),localStorage.removeItem("spotify_current_state"),localStorage.removeItem("spotify_code_verifier"),localStorage.removeItem("spotify_code_verifier_timestamp"),!i.ok){t&&localStorage.removeItem(`spotify_auth_${t}`),localStorage.removeItem("spotify_current_state"),localStorage.removeItem("spotify_code_verifier"),localStorage.removeItem("spotify_code_verifier_timestamp");let c="Unknown error";try{const d=await i.json();c=JSON.stringify(d,null,2),console.error("❌ Token exchange失敗:",d)}catch{console.error("❌ Token exchange失敗: レスポンス解析エラー")}throw new Error(`Failed to get access token: ${i.status} - ${c}`)}const l=await i.json();return console.log("✅ Token exchange成功!"),l.access_token}},je={buildOptimizedQuery:(e,t="track")=>{let s=e.trim();return/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(s)||t==="track"&&s.includes(" ")&&!s.includes("track:")&&!s.includes("artist:")&&s.split(" ").length>=2,s},searchAlbums:async(e,t,s=10)=>{var c;const n=je.buildOptimizedQuery(e,"album"),a=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(e)?"&market=JP":"",i=await fetch(`${_e}/search?q=${encodeURIComponent(n)}&type=album&limit=${s}${a}`,{headers:{Authorization:`Bearer ${t}`}});if(!i.ok){const d=await i.json().catch(()=>({}));throw new Error(`Failed to search albums: ${i.status} ${((c=d.error)==null?void 0:c.message)||""}`)}return(await i.json()).albums.items.map(d=>{var u,f;return{id:d.id,name:d.name,artist:((u=d.artists[0])==null?void 0:u.name)||"Unknown Artist",image:((f=d.images[0])==null?void 0:f.url)||null,releaseDate:d.release_date,totalTracks:d.total_tracks,spotifyUrl:d.external_urls.spotify}})},searchTracks:async(e,t,s=10)=>{var c;const n=je.buildOptimizedQuery(e,"track"),a=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(e)?"&market=JP":"",i=await fetch(`${_e}/search?q=${encodeURIComponent(n)}&type=track&limit=${s}${a}`,{headers:{Authorization:`Bearer ${t}`}});if(!i.ok){const d=await i.json().catch(()=>({}));throw new Error(`Failed to search tracks: ${i.status} ${((c=d.error)==null?void 0:c.message)||""}`)}return(await i.json()).tracks.items.map(d=>{var u,f,x,p;return{id:d.id,name:d.name,artist:((u=d.artists[0])==null?void 0:u.name)||"Unknown Artist",album:((f=d.album)==null?void 0:f.name)||"Unknown Album",image:((p=(x=d.album)==null?void 0:x.images[0])==null?void 0:p.url)||null,duration:d.duration_ms,previewUrl:d.preview_url,spotifyUrl:d.external_urls.spotify}})},searchTracksAdvanced:async(e,t,s,n=5)=>{const a=/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(e+t)?"&market=JP":"",i=`track:"${e}" artist:"${t}"`,l=await fetch(`${_e}/search?q=${encodeURIComponent(i)}&type=track&limit=${n}${a}`,{headers:{Authorization:`Bearer ${s}`}});if(!l.ok){const d=`${e} ${t}`;return je.searchTracks(d,s,n)}return(await l.json()).tracks.items.map(d=>{var u,f,x,p;return{id:d.id,name:d.name,artist:((u=d.artists[0])==null?void 0:u.name)||"Unknown Artist",album:((f=d.album)==null?void 0:f.name)||"Unknown Album",image:((p=(x=d.album)==null?void 0:x.images[0])==null?void 0:p.url)||null,duration:d.duration_ms,previewUrl:d.preview_url,spotifyUrl:d.external_urls.spotify}})},searchArtists:async(e,t,s=10)=>{const n=await fetch(`${_e}/search?q=${encodeURIComponent(e)}&type=artist&limit=${s}`,{headers:{Authorization:`Bearer ${t}`}});if(!n.ok)throw new Error("Failed to search artists");return(await n.json()).artists.items.map(a=>{var i,l;return{id:a.id,name:a.name,image:((i=a.images[0])==null?void 0:i.url)||null,followers:((l=a.followers)==null?void 0:l.total)||0,genres:a.genres||[],spotifyUrl:a.external_urls.spotify}})}},ua={getPreviewUrl:(e,t)=>`${_e}/tracks/${e}`,getUserPlaylists:async e=>{const t=await fetch(`${_e}/me/playlists`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error("Failed to get playlists");return(await t.json()).items.map(n=>{var o;return{id:n.id,name:n.name,description:n.description,image:((o=n.images[0])==null?void 0:o.url)||null,tracksCount:n.tracks.total,spotifyUrl:n.external_urls.spotify}})}};function ha(e){if(typeof crypto<"u"&&crypto.getRandomValues){const n=new Uint32Array(e);crypto.getRandomValues(n);const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return Array.from(n,a=>o[a%o.length]).join("")}const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let s="";for(let n=0;n<e;n++)s+=t.charAt(Math.floor(Math.random()*t.length));return s}const ma=Object.freeze(Object.defineProperty({__proto__:null,spotifyAuth:As,spotifyPreview:ua,spotifySearch:je},Symbol.toStringTag,{value:"Module"}));let Ts=[];const fa=()=>{Ts=[]},fe=(e,t,s,n)=>{const o={provider:e,success:t,error:s,fallbackReason:n,timestamp:Date.now()};Ts.push(o),t?console.log(`✅ ${e.toUpperCase()}検索成功`):(console.error(`❌ ${e.toUpperCase()}検索失敗:`,s),n&&console.warn(`🔄 フォールバック理由: ${n}`))};let me="spotify";const $s=e=>{me=e,console.log(`🔄 音楽検索プロバイダーを ${e.toUpperCase()} に切り替えました`)},ga="abfe3677d7f2a1b357dc58df96ede541",xa="https://ws.audioscrobbler.com/2.0/",_s="4bf253f4685945a5b0c15b8580c167cb",Wr=e=>!!(e&&e.trim()!==""&&!e.includes("2a96cbd8b46e442fc41c2b86b821562f"));let Le=null;const pa=()=>{const e=localStorage.getItem("spotify_access_token");e&&(Le=e,console.log("Spotify トークンをローカルストレージから復元しました"),$s("spotify"))};pa();const Ps=e=>{Le=e,localStorage.setItem("spotify_access_token",e),console.log("Spotify アクセストークンが設定されました")},ba=()=>{Le=null,localStorage.removeItem("spotify_access_token"),localStorage.removeItem("spotify_refresh_token"),localStorage.removeItem("spotify_token_expires"),console.log("Spotify アクセストークンを削除しました")};async function ya(){const e=localStorage.getItem("spotify_refresh_token");if(!e)throw new Error("リフレッシュトークンがありません");const t=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Basic ${btoa(`${_s}:${{}.VITE_SPOTIFY_CLIENT_SECRET||""}`)}`},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:e})});if(!t.ok){const n=await t.json();throw new Error(`Token refresh failed: ${n.error_description||n.error}`)}const s=await t.json();return Ps(s.access_token),localStorage.setItem("spotify_token_expires",(Date.now()+s.expires_in*1e3).toString()),s.refresh_token&&localStorage.setItem("spotify_refresh_token",s.refresh_token),console.log("✅ Spotifyトークンをリフレッシュしました"),s.access_token}async function wa(){if(!Le)return console.log("❌ アクセストークンが設定されていません"),null;const e=localStorage.getItem("spotify_token_expires");if(!e)return console.log("❌ トークンの有効期限情報がありません"),Le;const t=Date.now(),s=parseInt(e);if(t>=s-5*60*1e3){console.log("🔄 トークンの有効期限が近いため、リフレッシュします");try{return await ya()}catch(n){return console.error("❌ トークンリフレッシュに失敗:",n),ba(),null}}return Le}const Jr=async e=>{var s,n,o,a,i;fa();const t=await wa();if(!t){const l="Spotify アクセストークンが設定されていないか、リフレッシュに失敗しました";return fe("spotify",!1,l,`${l}。Last.fmにフォールバックします。`),wt(e)}try{const l=[],c=e.trim().split(/\s+/),d=c.length>=2,u=await je.searchTracks(e,t,7),f=await je.searchAlbums(e,t,3);let x=[];if(d&&c.length<=4)try{const h=c.slice(0,Math.ceil(c.length/2)).join(" "),m=c.slice(Math.ceil(c.length/2)).join(" ");x=await je.searchTracksAdvanced(h,m,t,3)}catch(h){console.log("Spotify詳細検索失敗（通常の検索結果を使用）:",h)}const p=new Set;return x.forEach(h=>{p.has(h.id)||(l.push({name:h.name,artist:h.artist,image:h.image||void 0,url:h.spotifyUrl,isGeneratedImage:!h.image,provider:"spotify",id:h.id}),p.add(h.id))}),u.forEach(h=>{p.has(h.id)||(l.push({name:h.name,artist:h.artist,image:h.image||void 0,url:h.spotifyUrl,isGeneratedImage:!h.image,provider:"spotify",id:h.id}),p.add(h.id))}),f.forEach(h=>{p.has(h.id)||(l.push({name:h.name,artist:h.artist,image:h.image||void 0,url:h.spotifyUrl,isGeneratedImage:!h.image,provider:"spotify",id:h.id}),p.add(h.id))}),fe("spotify",!0),console.log(`Spotify検索完了: ${l.length}件の結果`),l.slice(0,10)}catch(l){const c=((o=(n=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:n.error)==null?void 0:o.message)||(l==null?void 0:l.message)||"Spotify API呼び出しに失敗しました",d=(a=l==null?void 0:l.response)==null?void 0:a.status,u=d?`HTTP ${d}: ${c}`:c;return fe("spotify",!1,u,"Spotify検索でエラーが発生したため、Last.fmにフォールバックします"),console.error("Spotify検索エラー詳細:",{status:d,message:c,response:(i=l==null?void 0:l.response)==null?void 0:i.data,error:l}),wt(e)}},wt=async e=>{var t,s,n,o,a,i;try{const l=e.trim();console.log(`Last.fm検索実行: "${l}"`);const d=((s=(t=(await na.get(xa,{params:{method:"track.search",track:l,api_key:ga,format:"json",limit:15}})).data.results)==null?void 0:t.trackmatches)==null?void 0:s.track)||[];return fe("lastfm",!0),console.log(`Last.fm検索結果: ${d.length}件`),Array.isArray(d)?d.map(u=>{var p,h,m,g,y,N;const f=((h=(p=u.image)==null?void 0:p[3])==null?void 0:h["#text"])||((g=(m=u.image)==null?void 0:m[2])==null?void 0:g["#text"])||((N=(y=u.image)==null?void 0:y[1])==null?void 0:N["#text"])||"",x=ja(u.name,u.artist);return{name:u.name,artist:u.artist,image:Wr(f)?f:x.image,url:u.url,isGeneratedImage:!Wr(f),provider:"lastfm"}}):(fe("lastfm",!1,"Last.fm APIの応答形式が予期しない形式です","レスポンスデータの構造が変更された可能性があります"),[])}catch(l){const c=((o=(n=l==null?void 0:l.response)==null?void 0:n.data)==null?void 0:o.message)||(l==null?void 0:l.message)||"Last.fm API呼び出しに失敗しました",d=(a=l==null?void 0:l.response)==null?void 0:a.status,u=d?`HTTP ${d}: ${c}`:c;return fe("lastfm",!1,u,"Last.fm APIでエラーが発生しました"),console.error("Last.fm検索エラー詳細:",{status:d,message:c,response:(i=l==null?void 0:l.response)==null?void 0:i.data,error:l}),[]}},ja=(e,t)=>({image:`https://picsum.photos/300/300?random=${Math.floor(Math.random()*1e3)}`,isGenerated:!0}),va=[{name:"Bohemian Rhapsody",artist:"Queen",image:"https://picsum.photos/300/300?random=1",isGeneratedImage:!0,provider:"lastfm"},{name:"Hotel California",artist:"Eagles",image:"https://picsum.photos/300/300?random=2",isGeneratedImage:!0,provider:"lastfm"},{name:"Imagine",artist:"John Lennon",image:"https://picsum.photos/300/300?random=3",isGeneratedImage:!0,provider:"lastfm"},{name:"Stairway to Heaven",artist:"Led Zeppelin",image:"https://picsum.photos/300/300?random=4",isGeneratedImage:!0,provider:"lastfm"},{name:"Yesterday",artist:"The Beatles",image:"https://picsum.photos/300/300?random=5",isGeneratedImage:!0,provider:"lastfm"},{name:"Smells Like Teen Spirit",artist:"Nirvana",image:"https://picsum.photos/300/300?random=6",isGeneratedImage:!0,provider:"lastfm"},{name:"Like a Rolling Stone",artist:"Bob Dylan",image:"https://picsum.photos/300/300?random=7",isGeneratedImage:!0,provider:"lastfm"},{name:"I Want to Hold Your Hand",artist:"The Beatles",image:"https://picsum.photos/300/300?random=8",isGeneratedImage:!0,provider:"lastfm"},{name:"Johnny B. Goode",artist:"Chuck Berry",image:"https://picsum.photos/300/300?random=9",isGeneratedImage:!0,provider:"lastfm"},{name:"Good Vibrations",artist:"The Beach Boys",image:"https://picsum.photos/300/300?random=10",isGeneratedImage:!0,provider:"lastfm"}],Na=async e=>{const t=va.filter(s=>s.name.toLowerCase().includes(e.toLowerCase())||s.artist.toLowerCase().includes(e.toLowerCase()));return await new Promise(s=>setTimeout(s,300)),t},Sa=()=>{const e=[];return _s&&Le&&e.push("spotify"),e.push("lastfm"),e},Ca=async e=>{const t=Sa();if(console.log(`🔍 音楽検索開始: "${e}"`),console.log(`📋 利用可能プロバイダー: ${t.map(s=>s.toUpperCase()).join(", ")}`),console.log(`⚙️ 現在のプロバイダー: ${me.toUpperCase()}`),t.includes(me))try{switch(me){case"spotify":return await Jr(e);case"lastfm":return await wt(e);default:{const s=`未サポートのプロバイダー: ${me}`;throw fe(me,!1,s),new Error(s)}}}catch(s){console.error(`${me.toUpperCase()}検索エラー:`,s)}else{const s=`${me.toUpperCase()}は現在利用できません`;fe(me,!1,s,s)}for(const s of t)if(s!==me)try{switch(console.log(`🔄 ${s.toUpperCase()}にフォールバックします`),s){case"spotify":return await Jr(e);case"lastfm":return await wt(e)}}catch(n){const o=(n==null?void 0:n.message)||`${s}フォールバック失敗`;fe(s,!1,o,"フォールバック試行中にエラー"),console.error(`${s.toUpperCase()}フォールバック失敗:`,n)}return console.warn("⚠️ 全てのプロバイダーが利用不可。モックデータを使用します。"),fe("lastfm",!1,"全プロバイダー失敗","モックデータにフォールバック"),await Na(e)};async function ka(){const{spotifyAuth:e}=await pn(()=>Promise.resolve().then(()=>ma),void 0);return e.getAuthUrl()}function Ea(){const e=ye();return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:r.jsxs("div",{className:"container mx-auto px-4 py-16",children:[r.jsxs("div",{className:"text-center mb-16",children:[r.jsxs("h1",{className:"text-7xl font-bold text-gray-900 mb-6",children:["Musi",r.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-cyan-500",children:"Card"})]}),r.jsx("p",{className:"text-gray-600 text-xl mb-8 max-w-2xl mx-auto leading-relaxed",children:"好きな音で、あなたを彩ろう"}),r.jsx("div",{className:"flex justify-center gap-4 mb-8",children:r.jsx(Ee,{to:"/login",className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-8 py-4 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 hover:scale-105 text-lg shadow-lg hover:shadow-xl",children:"ログイン / 音楽名刺を作成"})}),r.jsx("div",{className:"flex justify-center",children:r.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg",children:[r.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"サンプル名刺をご覧ください"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx(Ee,{to:"/users/alice",className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-6 py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 hover:scale-105 shadow-md hover:shadow-lg",children:"Aliceの名刺"}),r.jsx(Ee,{to:"/users/bob",className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-xl font-semibold hover:bg-gray-200 transition-all duration-300 hover:scale-105 border border-gray-200",children:"Bobの名刺"})]})]})})]}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-8 max-w-4xl mx-auto",children:[r.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl mx-auto mb-4 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 3a1 1 0 00-1.447-.894L8.763 6H5a3 3 0 000 6h.28l1.771 5.316A1 1 0 008 18h1a1 1 0 001-1v-4.382l6.553 3.894A1 1 0 0018 16V3z",clipRule:"evenodd"})})}),r.jsx("h3",{className:"text-gray-900 font-semibold text-lg mb-2",children:"洗練されたデザイン"}),r.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"Topsters風のモダンで美しいレイアウト"})]}),r.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-xl mx-auto mb-4 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})}),r.jsx("h3",{className:"text-gray-900 font-semibold text-lg mb-2",children:"簡単シェア"}),r.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"SNSのプロフィールに貼るだけで音楽の趣味を共有"})]}),r.jsxs("div",{className:"text-center bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-400 to-cyan-400 rounded-xl mx-auto mb-4 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("h3",{className:"text-gray-900 font-semibold text-lg mb-2",children:"どこでも表示"}),r.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"PC・スマートフォンどちらでも美しく表示"})]})]}),r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-8 border border-blue-200/50 shadow-lg",children:[r.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-4",children:"🎵 音楽検索機能"}),r.jsx("p",{className:"text-blue-700 mb-4",children:"SpotifyとLast.fmの両方に対応した音楽検索で、豊富な楽曲データベースから選択できます。"}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"🎧 Spotify認証"}),r.jsx("p",{className:"text-blue-600 text-sm",children:"Spotifyにログインして、より豊富な音楽データベースにアクセス"})]}),r.jsxs("button",{onClick:async()=>{const t=await ka();window.open(t,"_blank")},className:"bg-green-500 text-white px-4 py-2 rounded-xl font-semibold hover:bg-green-600 transition-colors duration-300 flex items-center gap-2",children:[r.jsx("span",{children:"🎵"}),"Spotify連携"]})]})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[r.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"🎯 Spotify検索"}),r.jsx("p",{className:"text-blue-600 text-sm",children:"高精度な検索結果と豊富なメタデータ"})]}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[r.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"🔄 Last.fmフォールバック"}),r.jsx("p",{className:"text-blue-600 text-sm",children:"Spotifyで見つからない場合の自動フォールバック"})]})]})]}),!1,{}.VITE_ENABLE_ADMIN_PANEL==="true"&&r.jsx("div",{className:"mt-16 pt-8 border-t border-gray-200/50",children:r.jsx("div",{className:"text-center",children:r.jsx("button",{onClick:()=>e("/admin-login"),className:"text-xs text-gray-300 hover:text-gray-500 transition-colors px-2 py-1 rounded opacity-50 hover:opacity-100",title:"管理者ログイン",children:"⚙️"})})})]})})}function wr(){const[e,t]=j.useState(null),[s,n]=j.useState(!0),[o,a]=j.useState(null);return j.useEffect(()=>{(async()=>{try{const l=await fetch("/api/admin/config");if(l.ok){const c=await l.json();t(c)}else a("管理者設定の取得に失敗しました")}catch(l){a(l instanceof Error?l.message:"Unknown error")}finally{n(!1)}})()},[]),{config:e,loading:s,error:o}}function La(){const e=ye();wr();const[t,s]=j.useState(""),[n,o]=j.useState(""),[a,i]=j.useState(!1),[l,c]=j.useState(!1),d=async u=>{if(u.preventDefault(),!(!t.trim()||!n.trim())){i(!0);try{const f=t.trim().toLowerCase(),x=localStorage.getItem(`musicard_auth_${f}`);if(x){if(JSON.parse(x).password!==n){alert("❌ パスワードが正しくありません");return}console.log(`✅ ユーザー「${t}」でログインしました`)}else if(l){const p={username:f,password:n,createdAt:new Date().toISOString()};localStorage.setItem(`musicard_auth_${f}`,JSON.stringify(p)),console.log(`🆕 新規ユーザー「${t}」を登録しました`)}else{alert("❌ ユーザーが見つかりません。新規登録をしてください。");return}localStorage.setItem("musicard_user",f),localStorage.setItem("musicard_login_time",Date.now().toString()),e("/dashboard")}catch(f){console.error("ログインエラー:",f),alert("ログインに失敗しました")}finally{i(!1)}}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsxs("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:["Musi",r.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-cyan-500",children:"Card"})]}),r.jsx("p",{className:"text-gray-600",children:"音楽名刺でつながろう"})]}),r.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 mb-6",children:[r.jsx("button",{type:"button",onClick:()=>c(!1),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${l?"text-gray-600 hover:text-gray-800":"bg-white text-blue-600 shadow-sm"}`,children:"ログイン"}),r.jsx("button",{type:"button",onClick:()=>c(!0),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${l?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:"新規登録"})]}),r.jsxs("form",{onSubmit:d,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ユーザー名"}),r.jsx("input",{type:"text",value:t,onChange:u=>s(u.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"英数字でユーザー名を入力",required:!0,disabled:a})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"パスワード"}),r.jsx("input",{type:"password",value:n,onChange:u=>o(u.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"パスワードを入力",required:!0,disabled:a}),l&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"パスワードは安全に保管されます"})]}),r.jsx("button",{type:"submit",disabled:!t.trim()||!n.trim()||a,className:"w-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-cyan-600 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:a?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),l?"登録中...":"ログイン中..."]}):l?"新規登録":"ログイン"})]}),r.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[r.jsx("p",{className:"text-sm text-gray-600 text-center mb-4",children:"または、ゲストとして閲覧"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>e("/users/alice"),className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Aliceの名刺"}),r.jsx("button",{onClick:()=>e("/users/bob"),className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Bobの名刺"})]})]}),!1]})})}function He(){const[e,t]=j.useState(null),[s,n]=j.useState(!0),[o,a]=j.useState(null);return j.useEffect(()=>{(async()=>{try{const l=await fetch("/api/config");if(l.ok){const c=await l.json();t(c)}else a("設定の取得に失敗しました")}catch(l){a(l instanceof Error?l.message:"Unknown error")}finally{n(!1)}})()},[]),{config:e,loading:s,error:o}}function Ra(){const{config:e,loading:t}=He(),{config:s,loading:n}=wr();if(t||n)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"読み込み中..."})]})});if(!(e!=null&&e.enableAdminPanel))return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"アクセスできません"}),r.jsx("p",{className:"text-gray-600",children:"管理者機能は現在利用できません。"})]})});const o=ye(),[a,i]=j.useState(""),[l,c]=j.useState(""),[d,u]=j.useState(!1),f=async x=>{if(x.preventDefault(),!(!a.trim()||!l.trim())){u(!0);try{if(!((s==null?void 0:s.adminUsers)||["admin"]).includes(a.toLowerCase())){alert("❌ 管理者権限がありません");return}const h=`musicard_admin_${a.toLowerCase()}`,m=localStorage.getItem(h);if(m){if(JSON.parse(m).password!==l){alert("❌ 管理者パスワードが正しくありません");return}}else{const g={username:a.toLowerCase(),password:l,role:"admin",createdAt:new Date().toISOString()};localStorage.setItem(h,JSON.stringify(g)),console.log(`🛡️ 管理者アカウント「${a}」を作成しました`)}localStorage.setItem("musicard_admin",a.toLowerCase()),localStorage.setItem("musicard_admin_login_time",Date.now().toString()),console.log(`🛡️ 管理者「${a}」でログインしました`),o("/admin")}catch(p){console.error("管理者ログインエラー:",p),alert("ログインに失敗しました")}finally{u(!1)}}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-white to-red-100 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border-t-4 border-red-500",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("div",{className:"w-16 h-16 bg-red-500 rounded-full mx-auto mb-4 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"管理者ログイン"}),r.jsx("p",{className:"text-gray-600",children:"MusiCard Admin Panel"})]}),r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})}),r.jsx("p",{className:"text-red-700 text-sm",children:"管理者のみアクセス可能です"})]})}),r.jsxs("form",{onSubmit:f,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"管理者ユーザー名"}),r.jsx("input",{type:"text",value:a,onChange:x=>i(x.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"管理者ユーザー名",required:!0,disabled:d})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"管理者パスワード"}),r.jsx("input",{type:"password",value:l,onChange:x=>c(x.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"管理者パスワード",required:!0,disabled:d})]}),r.jsx("button",{type:"submit",disabled:!a.trim()||!l.trim()||d,className:"w-full bg-gradient-to-r from-red-500 to-red-600 text-white py-3 rounded-lg font-semibold hover:from-red-600 hover:to-red-700 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:d?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"ログイン中..."]}):"管理者ログイン"})]}),r.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center",children:r.jsx("button",{onClick:()=>o("/"),className:"text-gray-500 hover:text-gray-700 text-sm transition-colors",children:"← トップページに戻る"})}),!1]})})}const Ie=[{id:"light",name:"ライト",background:"bg-gradient-to-br from-gray-50 to-gray-100",textPrimary:"text-gray-800",textSecondary:"text-gray-600",surface:"bg-white/80",surfaceHover:"bg-gray-100",border:"border-gray-300"},{id:"dark",name:"ダーク",background:"bg-black",textPrimary:"text-white",textSecondary:"text-white/80",surface:"bg-white/10",surfaceHover:"bg-white/20",border:"border-white/20"}],Be=[{id:"blue",name:"ブルー",gradient:"from-blue-500 to-blue-600",primary:"blue-500",secondary:"blue-100",primaryHex:"#3B82F6",secondaryHex:"#DBEAFE"},{id:"purple",name:"パープル",gradient:"from-purple-500 to-purple-600",primary:"purple-500",secondary:"purple-100",primaryHex:"#8B5CF6",secondaryHex:"#EDE9FE"},{id:"green",name:"グリーン",gradient:"from-green-500 to-green-600",primary:"green-500",secondary:"green-100",primaryHex:"#10B981",secondaryHex:"#DCFCE7"},{id:"pink",name:"ピンク",gradient:"from-pink-500 to-pink-600",primary:"pink-500",secondary:"pink-100",primaryHex:"#EC4899",secondaryHex:"#FCE7F3"},{id:"orange",name:"オレンジ",gradient:"from-orange-500 to-orange-600",primary:"orange-500",secondary:"orange-100",primaryHex:"#F97316",secondaryHex:"#FED7AA"},{id:"red",name:"レッド",gradient:"from-red-500 to-red-600",primary:"red-500",secondary:"red-100",primaryHex:"#EF4444",secondaryHex:"#FEE2E2"},{id:"indigo",name:"インディゴ",gradient:"from-indigo-500 to-indigo-600",primary:"indigo-500",secondary:"indigo-100",primaryHex:"#6366F1",secondaryHex:"#E0E7FF"},{id:"teal",name:"ティール",gradient:"from-teal-500 to-teal-600",primary:"teal-500",secondary:"teal-100",primaryHex:"#14B8A6",secondaryHex:"#CCFBF1"}],te=[{id:"3x3",name:"3×3 (9セル)",size:3,totalCells:9,centerPositions:[4]},{id:"4x4",name:"4×4 (16セル)",size:4,totalCells:16,centerPositions:[5,6,9,10]},{id:"5x5",name:"5×5 (25セル)",size:5,totalCells:25,centerPositions:[12]},{id:"6x6",name:"6×6 (36セル)",size:6,totalCells:36,centerPositions:[14,15,20,21]}],Kr=["J-POP","K-POP","ロック","メタル","パンク","オルタナティブ","インディー","エレクトロニカ","テクノ","ハウス","ダブステップ","ヒップホップ","R&B","ソウル","ファンク","ジャズ","ブルース","フォーク","カントリー","レゲエ","クラシック","アニメ","ゲーム音楽","ボサノヴァ","ラテン","ワールドミュージック","アンビエント","その他"],Ve="musicmeisi_users",Bs="musicmeisi_users_backup",le=()=>{try{const e=localStorage.getItem(Ve);if(!e)return console.log("📂 ユーザーデータが見つかりません。新しいストレージを初期化します"),{};const t=JSON.parse(e);console.log(`📂 ${Object.keys(t).length}人のユーザーデータを読み込みました`);const s={};for(const[n,o]of Object.entries(t))Ba(o)?s[n]=o:console.warn(`⚠️ 無効なユーザーデータをスキップ: ${n}`);return s}catch(e){return console.error("❌ ユーザーデータの読み込みに失敗:",e),{}}},Ia=e=>{try{const s=le()[e];if(!s)return null;let n=!1,o={...s};if(s.baseColor||(o.baseColor=Ie[0],n=!0,console.log(`🔄 ユーザー「${e}」: baseColorを追加`)),!s.gridLayout)o.gridLayout=te[1],n=!0,console.log(`🔄 ユーザー「${e}」: gridLayoutを追加`);else if(s.gridLayout&&"centerPosition"in s.gridLayout){const a=s.gridLayout,i=te.find(l=>l.size===a.size)||te[1];o.gridLayout=i,n=!0,console.log(`🔄 ユーザー「${e}」: centerPosition → centerPositions に更新`)}return n?(jr(o),console.log(`✅ ユーザー「${e}」のデータマイグレーションが完了しました`),o):s}catch(t){return console.error(`❌ ユーザー「${e}」の読み込みに失敗:`,t),null}},jr=e=>{try{const t=le();return $t(t),t[e.username]={...e,updatedAt:new Date().toISOString()},localStorage.setItem(Ve,JSON.stringify(t)),console.log(`💾 ユーザー「${e.username}」のデータを保存しました`),console.log(`📊 現在の総ユーザー数: ${Object.keys(t).length}人`),!0}catch(t){return console.error(`❌ ユーザー「${e.username}」の保存に失敗:`,t),!1}},Aa=e=>{try{const t=le();return t[e]?($t(t),delete t[e],localStorage.setItem(Ve,JSON.stringify(t)),console.log(`🗑️ ユーザー「${e}」のデータを削除しました`),console.log(`📊 現在の総ユーザー数: ${Object.keys(t).length}人`),!0):(console.warn(`⚠️ ユーザー「${e}」は存在しません`),!1)}catch(t){return console.error(`❌ ユーザー「${e}」の削除に失敗:`,t),!1}},Ms=()=>{try{const e=le();return Object.entries(e).map(([t,s])=>{var n;return{username:t,displayName:s.displayName||t,songCount:((n=s.songs)==null?void 0:n.length)||0,viewCount:s.viewCount||0,updatedAt:s.updatedAt||s.createdAt||""}}).sort((t,s)=>new Date(s.updatedAt).getTime()-new Date(t.updatedAt).getTime())}catch(e){return console.error("❌ ユーザーリストの取得に失敗:",e),[]}},Ta=e=>{try{const t=le();return t[e]?(t[e].viewCount=(t[e].viewCount||0)+1,t[e].updatedAt=new Date().toISOString(),localStorage.setItem(Ve,JSON.stringify(t)),!0):(console.warn(`⚠️ ユーザー「${e}」は存在しません`),!1)}catch(t){return console.error("❌ 訪問者数の更新に失敗:",t),!1}},$t=e=>{try{const t=e||le(),s={data:t,timestamp:new Date().toISOString(),userCount:Object.keys(t).length};return localStorage.setItem(Bs,JSON.stringify(s)),console.log(`💾 バックアップを作成しました (${s.userCount}人のユーザー)`),!0}catch(t){return console.error("❌ バックアップの作成に失敗:",t),!1}},$a=()=>{try{const e=localStorage.getItem(Bs);if(!e)return console.warn("⚠️ バックアップデータが見つかりません"),!1;const t=JSON.parse(e);return localStorage.setItem(Ve,JSON.stringify(t.data)),console.log(`🔄 バックアップから復元しました (${t.userCount}人のユーザー)`),console.log(`📅 バックアップ作成日時: ${new Date(t.timestamp).toLocaleString()}`),!0}catch(e){return console.error("❌ バックアップからの復元に失敗:",e),!1}},_a=()=>{try{const e=le(),t={version:"1.0",exportDate:new Date().toISOString(),userCount:Object.keys(e).length,users:e};return JSON.stringify(t,null,2)}catch(e){return console.error("❌ データのエクスポートに失敗:",e),""}},Pa=e=>{try{const t=JSON.parse(e);if(!t.users||typeof t.users!="object")throw new Error("無効なデータ形式です");return $t(),localStorage.setItem(Ve,JSON.stringify(t.users)),console.log(`📥 データをインポートしました (${Object.keys(t.users).length}人のユーザー)`),!0}catch(t){return console.error("❌ データのインポートに失敗:",t),!1}},Ba=e=>!e||typeof e!="object"?!1:["username","displayName","songs","createdAt"].every(s=>s in e),Ma=()=>{try{const e=le(),t=Object.keys(e).length;let s=0,n=0;Object.values(e).forEach(a=>{var i;s+=((i=a.songs)==null?void 0:i.length)||0,n+=a.viewCount||0});const o=new Blob([JSON.stringify(e)]).size;return{totalUsers:t,totalSongs:s,totalViews:n,storageSizeBytes:o,storageSizeKB:Math.round(o/1024*100)/100}}catch(e){return console.error("❌ 統計情報の取得に失敗:",e),{totalUsers:0,totalSongs:0,totalViews:0,storageSizeBytes:0,storageSizeKB:0}}},Os={}.VITE_STORAGE_PROVIDER||"localStorage";class Ds{async loadAllUsers(){return Promise.resolve(le())}async loadUser(t){return Promise.resolve(Ia(t))}async saveUser(t){return Promise.resolve(jr(t))}async incrementViewCount(t){return Promise.resolve(Ta(t))}}class Oa{constructor(){$e(this,"fallback",new Ds)}async loadAllUsers(){try{return console.log("🔄 Vercel Blob実装は準備中です。ローカルストレージにフォールバック中..."),await this.fallback.loadAllUsers()}catch(t){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",t),await this.fallback.loadAllUsers()}}async loadUser(t){try{return await this.fallback.loadUser(t)}catch(s){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",s),await this.fallback.loadUser(t)}}async saveUser(t){try{return await this.fallback.saveUser(t)}catch(s){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",s),await this.fallback.saveUser(t)}}async incrementViewCount(t){try{return await this.fallback.incrementViewCount(t)}catch(s){return console.error("Vercel Blobエラー、ローカルストレージにフォールバック:",s),await this.fallback.incrementViewCount(t)}}async uploadImage(t,s){try{return console.log(`🖼️ 画像アップロード準備中: ${s}`),new Promise(n=>{const o=new FileReader;o.onloadend=()=>n(o.result),o.readAsDataURL(t)})}catch(n){throw console.error("画像アップロードエラー:",n),n}}}function Da(){switch(Os){case"vercelBlob":return console.log("🚀 Vercel Blobストレージを使用中（フォールバック付き）"),new Oa;case"localStorage":default:return console.log("💾 ローカルストレージを使用中"),new Ds}}const Pe=Da();function Ua(e){console.log(`🔄 ストレージプロバイダーを${e}に切り替えます`),console.log("ページをリロードして変更を適用してください"),localStorage.setItem("OVERRIDE_STORAGE_PROVIDER",e)}function qr(){return{current:Os,available:["localStorage","vercelBlob"],override:localStorage.getItem("OVERRIDE_STORAGE_PROVIDER"),environment:{}.VITE_STORAGE_PROVIDER}}let za=null;try{za=require("sharp")}catch{console.warn("⚠️ sharpパッケージが利用できません。画像処理機能が制限されます。")}function Yr(e,t=5){let s;return e instanceof ArrayBuffer||e instanceof Uint8Array?s=e.byteLength:s=e.length||0,s/(1024*1024)<=t}function Gr(e){return["image/jpeg","image/jpg","image/png","image/webp"].includes(e.toLowerCase())}const Fa="/api/upload/image",Se=class Se{constructor(){$e(this,"uploadCache",new Map)}static getInstance(){return Se.instance||(Se.instance=new Se),Se.instance}async uploadViaAPI(t,s,n){try{const o=new Uint8Array(t);let a="";for(let d=0;d<o.byteLength;d++)a+=String.fromCharCode(o[d]);const i=btoa(a),l=await fetch(Fa,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:i,username:s,type:n})});if(!l.ok)throw new Error(`アップロードに失敗しました: ${l.status}`);const c=await l.json();return console.log(`[API画像アップロード成功] ユーザー: ${s}, タイプ: ${n}, URL: ${c.url}`),{url:c.url,size:t.byteLength,width:0,height:0,format:"jpeg"}}catch(o){throw console.error("API画像アップロードエラー:",o),o}}async uploadUserIcon(t,s){try{if(!Gr(t.type))throw new Error("サポートされていない画像形式です");const n=await t.arrayBuffer();if(!Yr(new Uint8Array(n)))throw new Error("ファイルサイズが大きすぎます（最大5MB）");return await this.uploadViaAPI(n,s,"icon")}catch(n){return console.error("ユーザーアイコンアップロードエラー:",n),this.fallbackUpload(t,s,"icon")}}async uploadAlbumCover(t,s,n){try{if(!Gr(t.type))throw new Error("サポートされていない画像形式です");const o=await t.arrayBuffer();if(!Yr(o))throw new Error("ファイルサイズが大きすぎます（最大5MB）");return await this.uploadViaAPI(o,s,"album")}catch(o){return console.error("アルバムジャケットアップロードエラー:",o),this.fallbackUpload(t,s,"album")}}async uploadFromUrl(t,s,n){try{const o=await fetch(t);if(!o.ok)throw new Error("画像の取得に失敗しました");const a=await o.arrayBuffer();return await this.uploadViaAPI(a,s,n)}catch(o){return console.error("外部画像アップロードエラー:",o),this.fallbackUrlUpload(t,s,n)}}async fallbackUpload(t,s,n){return console.warn("⚠️ API Routeが利用できません。ローカル保存を使用します。"),new Promise(o=>{const a=new FileReader;a.onload=i=>{var c;const l=(c=i.target)==null?void 0:c.result;o({url:l,size:t.size,width:0,height:0,format:t.type.split("/")[1]||"jpeg"})},a.readAsDataURL(t)})}async fallbackUrlUpload(t,s,n){return console.warn("⚠️ API Routeが利用できません。元のURLを使用します。"),{url:t,size:0,width:0,height:0,format:"jpeg"}}async deleteImage(t){try{const s=await fetch("/api/delete/image",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t})});if(s.ok)return console.log(`🗑️ 画像を削除: ${t}`),!0;throw new Error(`削除に失敗: ${s.status}`)}catch(s){return console.error("画像削除エラー:",s),!1}}async getStats(){try{const t=await fetch("/api/stats/images");if(t.ok){const s=await t.json();return console.log(`[統計取得成功] ファイル数: ${s.totalFiles}, サイズ: ${s.totalSize}`),s}else throw new Error(`統計取得に失敗: ${t.status}`)}catch(t){return console.error("統計取得エラー:",t),{totalFiles:0,totalSize:0,userIcons:0,albumCovers:0}}}async cleanupOldImages(){try{const t=await fetch("/api/cleanup/images",{method:"POST"});if(t.ok){const s=await t.json();return console.log(`🧹 ${s.deletedCount}件の古い画像を削除しました`),s.deletedCount}return 0}catch(t){return console.error("クリーンアップエラー:",t),0}}};$e(Se,"instance");let or=Se;const Ge=or.getInstance(),Ce=class Ce{constructor(){$e(this,"cache",new Map)}static getInstance(){return Ce.instance||(Ce.instance=new Ce),Ce.instance}generateCacheKey(t,s,n){const o=btoa(t).replace(/[^a-zA-Z0-9]/g,"");return`${s}/${n}/${o}`}async getCachedImage(t,s,n){const o=this.generateCacheKey(t,s,n),a=this.cache.get(o);if(a){const i=new Date(a.cachedAt);if((new Date().getTime()-i.getTime())/(1e3*60*60*24)<30)return console.log(`📋 キャッシュされた画像を使用: ${t}`),a.url}return null}async cacheExternalImage(t,s,n,o){try{const a=await this.getCachedImage(t,s,n);if(a)return a;const i=await Ge.uploadFromUrl(t,s,n),l=this.generateCacheKey(t,s,n),c={url:i.url,cachedAt:new Date().toISOString(),size:i.size,source:o};return this.cache.set(l,c),this.saveCacheToStorage(),console.log(`💾 外部画像をキャッシュ: ${t} → ${i.url}`),i.url}catch(a){throw console.error("外部画像キャッシュエラー:",a),a}}async getSpotifyImage(t,s,n,o){try{const a=await this.getCachedImage(t,s,n);return a||await this.cacheExternalImage(t,s,n,"spotify")}catch(a){if(console.warn("Spotify画像キャッシュエラー:",a),o&&o!==t)try{return await this.getSpotifyImage(o,s,n)}catch(i){console.error("フォールバック画像も失敗:",i)}return this.getDefaultImage(n)}}async getLastfmImage(t,s,n,o){try{const a=await this.getCachedImage(t,s,n);return a||await this.cacheExternalImage(t,s,n,"lastfm")}catch(a){if(console.warn("Last.fm画像キャッシュエラー:",a),o&&o!==t)try{return await this.getLastfmImage(o,s,n)}catch(i){console.error("フォールバック画像も失敗:",i)}return this.getDefaultImage(n)}}getDefaultImage(t){return t==="icon"?"/default-user-icon.png":"/default-album-cover.png"}saveCacheToStorage(){try{const t=Array.from(this.cache.entries());localStorage.setItem("external_image_cache",JSON.stringify(t))}catch(t){console.error("キャッシュ保存エラー:",t)}}loadCacheFromStorage(){try{const t=localStorage.getItem("external_image_cache");if(t){const s=JSON.parse(t);this.cache=new Map(s),console.log(`📋 キャッシュを復元: ${this.cache.size}件`)}}catch(t){console.error("キャッシュ復元エラー:",t)}}cleanupOldCache(){const t=new Date;let s=0;for(const[n,o]of this.cache.entries()){const a=new Date(o.cachedAt);(t.getTime()-a.getTime())/(1e3*60*60*24)>60&&(this.cache.delete(n),s++)}return s>0&&(this.saveCacheToStorage(),console.log(`🧹 古いキャッシュを${s}件削除しました`)),s}getCacheStats(){let t=0,s=0,n=0,o=0;for(const a of this.cache.values())switch(o+=a.size,a.source){case"spotify":t++;break;case"lastfm":s++;break;case"manual":n++;break}return{totalCached:this.cache.size,spotifyImages:t,lastfmImages:s,manualImages:n,totalSize:o}}};$e(Ce,"instance");let ar=Ce;const Ke=ar.getInstance();typeof window<"u"&&Ke.loadCacheFromStorage();function vr({onSelect:e,placeholder:t="曲名やアーティスト名を検索...",className:s="",username:n=""}){const[o,a]=j.useState(""),[i,l]=j.useState([]),[c,d]=j.useState(!1),[u,f]=j.useState(!1),[x,p]=j.useState(0),[h,m]=j.useState(null),[g,y]=j.useState(!1),[N,w]=j.useState(0),b=j.useRef(null),C=j.useRef(null),I=j.useRef(),A=j.useCallback(async L=>{if(L.trim().length<2){l([]),f(!1);return}d(!0),m(null),y(!1);try{const k=await Ca(L);if(n&&k.length>0){const z=await Promise.all(k.map(async O=>{if(O.image&&O.image.startsWith("http"))try{const xe=await Ke.cacheExternalImage(O.image,n,"album","manual");return{...O,image:xe}}catch(xe){return console.warn("画像キャッシュエラー:",xe),O}return O}));l(z)}else l(k);f(!0),p(0)}catch(k){console.error("音楽検索エラー:",k),m(k instanceof Error?k.message:"検索中にエラーが発生しました"),l([]),f(!1)}finally{d(!1)}},[n]),E=j.useCallback(()=>{const L=Date.now();if(L-N<1e3){console.log("検索間隔が短すぎます");return}w(L),A(o.trim())},[o,N,A]);j.useEffect(()=>(I.current&&clearTimeout(I.current),o.trim().length>=2?I.current=setTimeout(()=>{A(o)},500):(l([]),f(!1)),()=>{I.current&&clearTimeout(I.current)}),[o,A]);const R=j.useCallback(L=>{if(!(!u||i.length===0))switch(L.key){case"ArrowDown":L.preventDefault(),p(k=>(k+1)%i.length);break;case"ArrowUp":L.preventDefault(),p(k=>(k-1+i.length)%i.length);break;case"Enter":L.preventDefault(),i[x]&&D(i[x]);break;case"Escape":f(!1);break}},[u,i,x]),D=j.useCallback(L=>{e(L),a(""),l([]),f(!1),p(0),m(null)},[e]);j.useEffect(()=>{const L=k=>{C.current&&!C.current.contains(k.target)&&f(!1)};return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[]);const K=()=>{y(!g)};return r.jsxs("div",{className:`relative ${s}`,children:[r.jsxs("div",{className:"relative",children:[r.jsx("input",{ref:b,type:"text",value:o,onChange:L=>a(L.target.value),onKeyDown:R,onFocus:()=>o.trim().length>=2&&i.length>0&&f(!0),className:"w-full px-4 py-3 pr-24 bg-white border border-blue-200 rounded-lg text-blue-900 placeholder-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:t}),r.jsxs("div",{className:"absolute right-1 top-1/2 transform -translate-y-1/2 flex items-center gap-1",children:[r.jsx("button",{type:"button",onClick:E,disabled:c||o.trim().length<1,className:"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-md transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"手動検索を実行",children:c?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}):r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),h&&r.jsx("button",{type:"button",onClick:K,className:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors duration-200",title:"エラー詳細を表示",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})]})]}),h&&r.jsxs("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[r.jsx("p",{className:"text-sm text-red-600",children:h}),g&&r.jsxs("div",{className:"mt-2 p-2 bg-red-100 rounded text-xs text-red-700",children:[r.jsx("p",{children:"詳細情報:"}),r.jsx("p",{children:"• インターネット接続を確認してください"}),r.jsx("p",{children:"• 検索キーワードを変更してみてください"}),r.jsx("p",{children:"• しばらく時間をおいてから再試行してください"})]})]}),u&&i.length>0&&r.jsx("div",{ref:C,className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-64 overflow-y-auto",children:i.map((L,k)=>r.jsxs("div",{onClick:()=>D(L),className:`flex items-center p-3 cursor-pointer transition-colors duration-200 ${k===x?"bg-blue-500 text-white":"hover:bg-blue-50 text-blue-900"}`,children:[r.jsxs("div",{className:"flex-shrink-0 w-12 h-12 mr-3 relative",children:[r.jsx("img",{src:L.image||`https://picsum.photos/48/48?random=${k}`,alt:`${L.name} by ${L.artist}`,className:"w-full h-full object-cover rounded-lg",onError:z=>{const O=z.target;O.src=`https://picsum.photos/48/48?random=${k}`}}),L.isGeneratedImage&&r.jsx("div",{className:"absolute -top-1 -right-1 bg-orange-500 text-white text-xs px-1 py-0.5 rounded-full",children:"AI"}),L.provider&&r.jsx("div",{className:`absolute -bottom-1 -left-1 text-white text-xs px-1 py-0.5 rounded-full ${L.provider==="spotify"?"bg-green-500":"bg-red-500"}`,children:L.provider==="spotify"?"S":"L"}),n&&L.image&&L.image.includes("blob.vercel-storage.com")&&r.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-500 text-white text-xs px-1 py-0.5 rounded-full",children:"C"})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-medium truncate",children:L.name}),r.jsx("div",{className:"text-sm opacity-75 truncate",children:L.artist})]}),k===x&&r.jsx("div",{className:"flex-shrink-0 ml-2",children:r.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},`${L.name}-${L.artist}-${k}`))})]})}function Us({onIconChange:e,currentIcon:t,className:s="",username:n=""}){const[o,a]=j.useState(null),[i,l]=j.useState({x:20,y:20,size:60}),[c,d]=j.useState(!1),[u,f]=j.useState(!1),[x,p]=j.useState(!1),[h,m]=j.useState(!1),[g,y]=j.useState(!1),[N,w]=j.useState({x:0,y:0}),[b,C]=j.useState({size:0,mouseX:0,mouseY:0}),[I,A]=j.useState(null),E=j.useRef(null),R=j.useRef(null),D=j.useRef(null),K=j.useRef(null);j.useEffect(()=>{const S=()=>{p(window.innerWidth<=768)};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]);const L=()=>{if(!R.current)return{width:0,height:0};const S=R.current.getBoundingClientRect();return{width:S.width,height:S.height}};j.useEffect(()=>{const S=T=>{T.key==="Escape"&&c&&P()};return c&&(document.addEventListener("keydown",S),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",S),document.body.style.overflow="unset"}},[c]);const k=S=>{var F;const T=(F=S.target.files)==null?void 0:F[0];if(!T)return;const B=5,U=B*1024*1024;if(T.size>U){alert(`ファイルサイズは${B}MB以下にしてください。現在のサイズ: ${(T.size/1024/1024).toFixed(1)}MB`),E.current&&(E.current.value="");return}if(!T.type.startsWith("image/")){alert("画像ファイルを選択してください"),E.current&&(E.current.value="");return}const M=new FileReader;M.onload=V=>{var Z;const X=(Z=V.target)==null?void 0:Z.result;a(X),d(!0),l({x:25,y:25,size:50}),A(null)},M.readAsDataURL(T)},z=S=>{if(!D.current||!R.current)return;D.current.getBoundingClientRect();const T=R.current.getBoundingClientRect(),B=(S.clientX-T.left)/T.width*100,U=(S.clientY-T.top)/T.height*100;B>=i.x&&B<=i.x+i.size&&U>=i.y&&U<=i.y+i.size&&(m(!0),w({x:B-i.x,y:U-i.y}))},O=S=>{if(!(!h&&!g)&&R.current){if(g){const T=S.clientY-b.mouseY,B=L(),U=Math.min(B.width,B.height),M=T/U*100;let F=b.size+M;F=Math.max(10,Math.min(100,F));const V=F/100*U,X=(B.width-V)/B.width*100,Z=(B.height-V)/B.height*100;l(G=>({size:F,x:Math.min(G.x,X),y:Math.min(G.y,Z)}))}else if(h){const T=R.current.getBoundingClientRect(),B=(S.clientX-T.left)/T.width*100,U=(S.clientY-T.top)/T.height*100,M=L(),F=Math.min(M.width,M.height),V=i.size/100*F,X=(M.width-V)/M.width*100,Z=(M.height-V)/M.height*100,G=Math.max(0,Math.min(X,B-N.x)),ie=Math.max(0,Math.min(Z,U-N.y));l(ne=>({...ne,x:G,y:ie}))}}},xe=()=>{m(!1),y(!1)},ot=S=>{if(!D.current||!R.current)return;const T=S.touches[0],B=R.current.getBoundingClientRect(),U=(T.clientX-B.left)/B.width*100,M=(T.clientY-B.top)/B.height*100;U>=i.x&&U<=i.x+i.size&&M>=i.y&&M<=i.y+i.size&&(m(!0),w({x:U-i.x,y:M-i.y}))},at=S=>{if(!h&&!g||!R.current)return;S.preventDefault();const T=S.touches[0];if(g){const B=T.clientY-b.mouseY,U=L(),M=Math.min(U.width,U.height),F=B/M*100;let V=b.size+F;V=Math.max(10,Math.min(100,V));const X=V/100*M,Z=(U.width-X)/U.width*100,G=(U.height-X)/U.height*100;l(ie=>({size:V,x:Math.min(ie.x,Z),y:Math.min(ie.y,G)}))}else if(h){const B=R.current.getBoundingClientRect(),U=(T.clientX-B.left)/B.width*100,M=(T.clientY-B.top)/B.height*100,F=L(),V=Math.min(F.width,F.height),X=i.size/100*V,Z=(F.width-X)/F.width*100,G=(F.height-X)/F.height*100,ie=Math.max(0,Math.min(Z,U-N.x)),ne=Math.max(0,Math.min(G,M-N.y));l(be=>({...be,x:ie,y:ne}))}},it=()=>{m(!1),y(!1)},$=async()=>{if(R.current){f(!0),A(null);try{const S=document.createElement("canvas"),T=S.getContext("2d");if(!T)return;const B=R.current.naturalWidth/R.current.width,U=R.current.naturalHeight/R.current.height,M=Math.min(R.current.width,R.current.height),F=i.size/100*M,V=i.x/100*R.current.width,X=i.y/100*R.current.height,Z=256,G=Math.min(F*Math.min(B,U),Z);S.width=G,S.height=G,T.imageSmoothingEnabled=!0,T.imageSmoothingQuality="high",T.drawImage(R.current,V*B,X*U,F*B,F*U,0,0,G,G);const ie=await new Promise(ne=>{S.toBlob(be=>{be&&ne(be)},"image/jpeg",.85)});if(n){const ne=new File([ie],"icon.jpg",{type:"image/jpeg"}),be=await Ge.uploadUserIcon(ne,n);e(be.url),console.log("✅ アイコンをストレージにアップロードしました:",be.url)}else{const ne=S.toDataURL("image/jpeg",.85);e(ne),console.log("⚠️ ユーザー名が設定されていないため、ローカル保存を使用")}a(null),d(!1)}catch(S){console.error("トリミングエラー:",S),A("画像のアップロードに失敗しました。もう一度お試しください。")}finally{f(!1)}}},P=()=>{a(null),d(!1),E.current&&(E.current.value="")},q=S=>{S.target===S.currentTarget&&P()},se=async()=>{if(t&&n)try{await Ge.deleteImage(t),console.log("🗑️ アイコンをストレージから削除しました")}catch(S){console.warn("アイコン削除エラー（無視）:",S)}e(""),E.current&&(E.current.value="")},ee=S=>{S.preventDefault(),S.stopPropagation(),y(!0),C({size:i.size,mouseX:S.clientX,mouseY:S.clientY})},We=S=>{S.preventDefault(),S.stopPropagation();const T=S.touches[0];y(!0),C({size:i.size,mouseX:T.clientX,mouseY:T.clientY})},pe=S=>{S.key==="Enter"&&(S.preventDefault(),S.stopPropagation(),$())},Ne=()=>!c||!o?null:rs.createPortal(r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[99999] p-4",onClick:q,style:{position:"fixed",top:0,left:0,right:0,bottom:0},children:r.jsxs("div",{className:`bg-white rounded-xl shadow-2xl p-4 select-none ${x?"w-full h-full max-w-none max-h-none rounded-none":"max-w-2xl w-full max-h-[90vh] overflow-y-auto"}`,onClick:S=>S.stopPropagation(),onKeyDown:pe,tabIndex:0,style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"アイコンをトリミング"}),r.jsx("button",{type:"button",onClick:P,className:"text-gray-400 hover:text-gray-600 transition-colors p-2",disabled:u,children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),I&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600",children:I})}),{}.VITE_ENABLE_DEBUG_PANELS==="true"&&(()=>{L();const S=R.current?{width:R.current.naturalWidth,height:R.current.naturalHeight}:{width:0,height:0},T=L(),B=Math.min(T.width,T.height);return r.jsxs("div",{className:"absolute top-4 left-4 bg-black bg-opacity-50 text-white p-2 text-xs rounded z-20",children:["画像情報",r.jsxs("div",{children:["元解像度: ",S.width," × ",S.height]}),r.jsxs("div",{children:["表示サイズ: ",T.width," × ",T.height]}),r.jsxs("div",{children:["元縦横比: ",(S.width/S.height).toFixed(2)]}),r.jsxs("div",{children:["表示縦横比: ",(T.width/T.height).toFixed(2)]}),r.jsxs("div",{children:["短辺/長辺: ",Math.min(S.width,S.height)," / ",Math.max(S.width,S.height)]}),r.jsx("br",{}),"トリミング枠情報",r.jsxs("div",{children:["位置: ",i.x.toFixed(1),"%, ",i.y.toFixed(1),"%"]}),r.jsxs("div",{children:["サイズ: ",i.size,"%"]}),r.jsxs("div",{children:["ドラッグ中: ",h?"Yes":"No"]}),r.jsxs("div",{children:["リサイズ中: ",g?"Yes":"No"]}),r.jsx("div",{children:(()=>{const U=i.size/100*B;return`正方形サイズ: ${Math.round(U)}px × ${Math.round(U)}px`})()}),r.jsxs("div",{children:["実際幅: ",K.current?K.current.offsetWidth:0,"px"]}),r.jsx("br",{}),"ストレージ情報",r.jsxs("div",{children:["ユーザー名: ",n||"未設定"]}),r.jsxs("div",{children:["アップロード中: ",u?"Yes":"No"]})]})})(),r.jsx("div",{className:"mb-6",children:r.jsxs("div",{ref:D,className:`relative inline-block ${g?"cursor-se-resize":h?"cursor-grabbing":"cursor-move"} select-none`,style:{maxWidth:"100%",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},onMouseDown:z,onMouseMove:O,onMouseUp:xe,onMouseLeave:xe,onTouchStart:ot,onTouchMove:at,onTouchEnd:it,children:[r.jsx("img",{ref:R,src:o,alt:"トリミング対象",className:"max-w-full max-h-full object-contain rounded-lg select-none",style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",WebkitTouchCallout:"none",WebkitUserDrag:"none"},draggable:!1}),(()=>{var Lr,Rr;const S=L(),T=Math.min(S.width,S.height);if(S.width===0||S.height===0)return null;const B=(Lr=R.current)==null?void 0:Lr.getBoundingClientRect(),U=(Rr=D.current)==null?void 0:Rr.getBoundingClientRect();console.log("=== デバッグ情報 ==="),console.log("画像サイズ:",S),console.log("画像要素の位置:",B),console.log("コンテナの位置:",U);const M=i.size/100*T,F=i.x/100*S.width,V=i.y/100*S.height,X=(F+M/2)/S.width*100,Z=(V+M/2)/S.height*100,G=M/2,ie=G/S.width*100,ne=G/S.height*100,be=Math.max(ie,ne);console.log("トリミング枠:",{cropLeft:F,cropTop:V,squareSize:M,radiusPx:G}),console.log("マスク中心座標:",{centerX:X,centerY:Z}),console.log("半径計算:",{radiusPercentX:ie,radiusPercentY:ne,radiusPercent:be,画像サイズ:S});const zt=`radial-gradient(ellipse ${ie}% ${ne}% at ${X}% ${Z}%, transparent 97%, black 100%)`;return console.log("マスクスタイル:",zt),r.jsxs(r.Fragment,{children:[r.jsx("div",{className:`absolute inset-0 bg-black bg-opacity-50 pointer-events-none ${h||g?"":"transition-all duration-150"}`,style:{zIndex:5,WebkitMask:zt,mask:zt,backgroundColor:"rgba(0, 0, 0, 0.7)"}}),r.jsxs("div",{className:"absolute inset-0 pointer-events-none",style:{zIndex:4},children:[r.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{top:0,left:0,right:0,height:`${V}px`}}),r.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{bottom:0,left:0,right:0,height:`${S.height-V-M}px`}}),r.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{top:`${V}px`,left:0,width:`${F}px`,height:`${M}px`}}),r.jsx("div",{className:"absolute bg-black bg-opacity-40",style:{top:`${V}px`,right:0,width:`${S.width-F-M}px`,height:`${M}px`}})]}),r.jsx("div",{className:`absolute border-2 border-dashed border-white pointer-events-none ${h||g?"":"transition-all duration-150"}`,style:{left:`${F}px`,top:`${V}px`,width:`${M}px`,height:`${M}px`,zIndex:8,opacity:.8}}),r.jsxs("div",{ref:K,className:`absolute border-2 border-white ${h||g?"border-blue-400":""} transition-colors duration-150`,style:{left:`${F}px`,top:`${V}px`,width:`${M}px`,height:`${M}px`,cursor:g?"se-resize":h?"grabbing":"move",transition:h||g?"none":"all 0.15s ease",zIndex:10,pointerEvents:"auto",backgroundColor:"transparent"},title:`正方形サイズ: ${Math.round(M)}px × ${Math.round(M)}px`,children:[r.jsxs("div",{className:"relative w-full h-full",children:[r.jsx("div",{className:`absolute ${x?"border-l-2":"border-l"} border-white opacity-50`,style:{left:"33.333%",top:0,height:"100%"}}),r.jsx("div",{className:`absolute ${x?"border-l-2":"border-l"} border-white opacity-50`,style:{left:"66.666%",top:0,height:"100%"}}),r.jsx("div",{className:`absolute ${x?"border-t-2":"border-t"} border-white opacity-50`,style:{top:"33.333%",left:0,width:"100%"}}),r.jsx("div",{className:`absolute ${x?"border-t-2":"border-t"} border-white opacity-50`,style:{top:"66.666%",left:0,width:"100%"}})]}),r.jsx("div",{className:`absolute -top-1 -left-1 ${x?"w-4 h-4":"w-3 h-3"} bg-white border border-gray-400`,style:{zIndex:15}}),r.jsx("div",{className:`absolute -top-1 -right-1 ${x?"w-4 h-4":"w-3 h-3"} bg-white border border-gray-400`,style:{zIndex:15}}),r.jsx("div",{className:`absolute -bottom-1 -left-1 ${x?"w-4 h-4":"w-3 h-3"} bg-white border border-gray-400`,style:{zIndex:15}}),r.jsx("div",{className:`absolute -bottom-2 -right-2 ${x?"w-6 h-6":"w-5 h-5"} bg-blue-500 border-2 border-white rounded cursor-se-resize hover:bg-blue-600 transition-colors shadow-lg`,style:{zIndex:16},onMouseDown:ee,onTouchStart:We,title:"ドラッグしてサイズを変更"}),r.jsx("div",{className:"absolute inset-0 border-2 border-blue-400 rounded-full pointer-events-none opacity-75",style:{zIndex:12}})]})]})})()]})}),r.jsxs("div",{className:"flex justify-end space-x-3 relative z-20",children:[r.jsx("button",{type:"button",onClick:P,className:"px-6 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",disabled:u,children:"キャンセル"}),r.jsx("button",{type:"button",onClick:$,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 font-medium",disabled:u,children:u?"アップロード中...":"適用"})]})]})}),document.body);return r.jsxs("div",{className:`space-y-4 ${s}`,children:[t&&!c&&r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:t,alt:"ユーザーアイコン",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-200"}),r.jsx("button",{type:"button",onClick:se,className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-sm hover:bg-red-600 transition-colors",children:"×"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"アイコンが設定されています"}),r.jsx("button",{type:"button",onClick:()=>{var S;return(S=E.current)==null?void 0:S.click()},className:"text-sm text-blue-500 hover:text-blue-600",children:"変更する"})]})]}),!t&&!c&&r.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors",children:[r.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:k,className:"hidden"}),r.jsxs("button",{type:"button",onClick:()=>{var S;return(S=E.current)==null?void 0:S.click()},className:"flex flex-col items-center space-y-2 text-gray-600 hover:text-blue-500",children:[r.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),r.jsx("span",{className:"text-sm",children:"アイコンをアップロード"}),r.jsx("span",{className:"text-xs text-gray-400",children:"JPG, PNG (5MB以下)"})]})]}),r.jsx(Ne,{})]})}function Ha({message:e,type:t="success",duration:s=3e3,onClose:n}){const[o,a]=j.useState(!1);j.useEffect(()=>{a(!0);const c=setTimeout(()=>{a(!1),setTimeout(n,300)},s);return()=>clearTimeout(c)},[s,n]);const i=()=>{switch(t){case"success":return"bg-green-500 text-white";case"error":return"bg-red-500 text-white";case"info":return"bg-blue-500 text-white";default:return"bg-green-500 text-white"}},l=()=>{switch(t){case"success":return"✅";case"error":return"❌";case"info":return"ℹ️";default:return"✅"}};return r.jsx("div",{className:`fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transition-all duration-300 transform ${o?"translate-x-0 opacity-100":"translate-x-full opacity-0"} ${i()}`,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-lg",children:l()}),r.jsx("span",{className:"font-medium",children:e}),r.jsx("button",{onClick:()=>{a(!1),setTimeout(n,300)},className:"ml-3 text-white/80 hover:text-white transition-colors",children:"×"})]})})}function Va(){const{config:e,loading:t}=He();if(t||!(e!=null&&e.enableDebugPanels))return null;const[s,n]=j.useState(null),[o,a]=j.useState(null),[i,l]=j.useState(!1),[c,d]=j.useState(null),u=async()=>{l(!0),d(null);try{const[p,h]=await Promise.all([Ge.getStats(),Ke.getCacheStats()]);n(p),a(h)}catch(p){d(p instanceof Error?p.message:"統計情報の取得に失敗しました")}finally{l(!1)}},f=async()=>{l(!0),d(null);try{const p=await Ge.cleanupOldImages();alert(`${p}件の古い画像を削除しました`),await u()}catch(p){d(p instanceof Error?p.message:"クリーンアップに失敗しました")}finally{l(!1)}},x=()=>{const p=Ke.cleanupOldCache();alert(`${p}件の古いキャッシュを削除しました`),a(Ke.getCacheStats())};return j.useEffect(()=>{u()},[]),t||!(e!=null&&e.enableDebugPanels)?null:r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"画像ストレージデバッグ"}),c&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600",children:c})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Blob Storage統計"}),s?r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"総ファイル数:"}),r.jsx("span",{className:"font-medium",children:s.totalFiles})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"総サイズ:"}),r.jsxs("span",{className:"font-medium",children:[(s.totalSize/1024/1024).toFixed(2)," MB"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"ユーザーアイコン:"}),r.jsx("span",{className:"font-medium",children:s.userIcons})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"アルバムジャケット:"}),r.jsx("span",{className:"font-medium",children:s.albumCovers})]})]}):r.jsx("p",{className:"text-gray-500",children:"統計情報を読み込み中..."})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"外部画像キャッシュ統計"}),o?r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"キャッシュ済み画像:"}),r.jsx("span",{className:"font-medium",children:o.totalCached})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Spotify画像:"}),r.jsx("span",{className:"font-medium",children:o.spotifyImages})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Last.fm画像:"}),r.jsx("span",{className:"font-medium",children:o.lastfmImages})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"手動画像:"}),r.jsx("span",{className:"font-medium",children:o.manualImages})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"キャッシュサイズ:"}),r.jsxs("span",{className:"font-medium",children:[(o.totalSize/1024/1024).toFixed(2)," MB"]})]})]}):r.jsx("p",{className:"text-gray-500",children:"統計情報を読み込み中..."})]})]}),r.jsxs("div",{className:"mt-6 flex gap-3",children:[r.jsx("button",{onClick:u,disabled:i,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50",children:i?"更新中...":"統計を更新"}),r.jsx("button",{onClick:f,disabled:i,className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors disabled:opacity-50",children:"古い画像を削除"}),r.jsx("button",{onClick:x,className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"古いキャッシュを削除"})]}),r.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[r.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"設定状況"}),r.jsxs("div",{className:"text-xs space-y-1",children:[r.jsxs("div",{children:["BLOB_READ_WRITE_TOKEN: ",{}.BLOB_READ_WRITE_TOKEN?"✅ 設定済み":"❌ 未設定"]}),r.jsxs("div",{children:["NODE_ENV: ","production"]}),r.jsxs("div",{children:["VITE_BLOB_READ_WRITE_TOKEN: ",{}.VITE_BLOB_READ_WRITE_TOKEN?"✅ 設定済み":"❌ 未設定"]})]})]})]})}function Wa(){const e=ye(),[t,s]=j.useState(""),[n,o]=j.useState(null),[a,i]=j.useState(!0),[l,c]=j.useState(!1),[d,u]=j.useState(null),[f,x]=j.useState(!1);j.useEffect(()=>{p()},[]);const p=async()=>{console.log("🔍 checkAuth実行開始");const b=localStorage.getItem("musicard_user");if(console.log("🔍 localStorageから取得したユーザー:",b),!b){console.log("🔍 ユーザーが見つからないため、ログインページに遷移"),e("/login");return}console.log("🔍 ユーザー認証成功:",b),s(b),await h(b)},h=async b=>{try{let C=await Pe.loadUser(b);C||(C={username:b,displayName:b,bio:"",baseColor:Ie[0],themeColor:Be[0],socialLinks:{},favoriteGenres:[],songs:[],gridLayout:te[1],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),viewCount:0,isPublic:!0},await Pe.saveUser(C),console.log(`🆕 新規ユーザー「${b}」のプロフィールを作成しました`)),o(C)}catch(C){console.error("ユーザーデータの読み込みエラー:",C)}finally{i(!1)}},m=async()=>{if(n){c(!0);try{await Pe.saveUser({...n,updatedAt:new Date().toISOString()})?(console.log("✅ プロフィールを保存しました"),u({message:"プロフィールを保存しました！",type:"success"})):u({message:"保存に失敗しました",type:"error"})}catch(b){console.error("保存エラー:",b),u({message:"保存中にエラーが発生しました",type:"error"})}finally{c(!1)}}},g=()=>{console.log("🔍 handleLogout関数が呼び出されました"),confirm("ログアウトしますか？")?(console.log("🔍 ログアウト処理開始"),localStorage.removeItem("musicard_user"),localStorage.removeItem("musicard_login_time"),console.log("🔍 localStorage削除完了、ホームページに遷移:","/"),window.location.href="/",console.log("🔍 window.location.href実行完了")):console.log("🔍 ログアウトがキャンセルされました")},y=()=>{t&&e(`/users/${t}`,{state:{isPreview:!0}})},N=b=>{if(!n)return;const C={id:b.id||`${b.name}-${b.artist}`.replace(/\s+/g,"-").toLowerCase(),title:b.name,artist:b.artist,jacket:b.image,previewUrl:null,addedAt:new Date().toISOString()};o({...n,songs:[...n.songs,C]}),x(!1)},w=b=>{n&&o({...n,songs:n.songs.filter(C=>C.id!==b)})};return a?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})}):n?r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:[r.jsxs("div",{className:"container mx-auto px-4 py-8",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[n.displayName,"の音楽名刺"]}),r.jsxs("p",{className:"text-gray-600",children:["@",t]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:y,className:"bg-white text-blue-600 px-4 py-2 rounded-lg border border-blue-200 hover:bg-blue-50 transition-colors font-medium",children:"👁️ プレビュー"}),r.jsx("button",{onClick:m,disabled:l,className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-6 py-2 rounded-lg font-medium hover:from-blue-600 hover:to-cyan-600 transition-all disabled:opacity-50",children:l?"保存中...":"💾 保存"}),r.jsx("button",{onClick:g,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors",children:"ログアウト"})]})]}),{}.VITE_ENABLE_DEBUG_PANELS==="true"&&r.jsx(Va,{}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"基本情報"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロフィールアイコン"}),r.jsx(Us,{currentIcon:n.icon||"",onIconChange:b=>o({...n,icon:b}),username:t})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"表示名"}),r.jsx("input",{type:"text",value:n.displayName,onChange:b=>o({...n,displayName:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"自己紹介"}),r.jsx("textarea",{value:n.bio,onChange:b=>o({...n,bio:b.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"音楽の趣味について..."})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"ベースカラー"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"音楽名刺の基本となる背景色を選択してください。"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:Ie.map(b=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"radio",name:"baseColor",checked:n.baseColor.id===b.id,onChange:()=>o({...n,baseColor:b}),className:"sr-only"}),r.jsxs("div",{className:`relative p-4 rounded-xl border-2 transition-all ${n.baseColor.id===b.id?"border-blue-500 ring-2 ring-blue-500/20 shadow-lg scale-105":"border-gray-200 hover:border-gray-300 hover:scale-102"}`,children:[r.jsx("div",{className:`w-full h-8 rounded-lg ${b.background} mb-2 shadow-sm`}),r.jsx("p",{className:"text-center text-sm font-medium text-gray-800",children:b.name}),n.baseColor.id===b.id&&r.jsx("div",{className:"absolute top-2 right-2",children:r.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]})]},b.id))})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"テーマカラー"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"アイコンの枠線やボタンの色に反映されるテーマカラーを選択してください。"}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:Be.map(b=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"radio",name:"themeColor",checked:n.themeColor.id===b.id,onChange:()=>o({...n,themeColor:b}),className:"sr-only"}),r.jsxs("div",{className:`relative p-3 rounded-xl border-2 transition-all ${n.themeColor.id===b.id?"border-gray-400 ring-2 ring-blue-500/20 shadow-lg scale-105":"border-gray-200 hover:border-gray-300 hover:scale-102"}`,children:[r.jsx("div",{className:`w-full h-8 rounded-lg bg-gradient-to-r ${b.gradient} mb-2 shadow-sm`}),r.jsx("p",{className:"text-center text-sm font-medium text-gray-800",children:b.name}),n.themeColor.id===b.id&&r.jsx("div",{className:"absolute top-2 right-2",children:r.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]})]},b.id))})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"グリッドレイアウト"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"音楽名刺のグリッドレイアウトを選択してください"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:te.map(b=>{var C;return r.jsxs("button",{onClick:()=>o({...n,gridLayout:b}),className:`p-4 rounded-lg border-2 transition-all text-left ${((C=n.gridLayout)==null?void 0:C.id)===b.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:[r.jsx("div",{className:"font-medium text-sm mb-1",children:b.name}),r.jsxs("div",{className:"text-xs text-gray-500",children:[b.centerPositions.length===1?"中央1マス":"中央4マス","のアイコン配置"]}),r.jsx("div",{className:"mt-2 grid gap-0.5 w-12 h-12",style:{gridTemplateColumns:`repeat(${b.size}, 1fr)`,gridTemplateRows:`repeat(${b.size}, 1fr)`},children:Array.from({length:b.totalCells}).map((I,A)=>{const E=b.centerPositions.includes(A);return E&&b.centerPositions.length===4&&A!==b.centerPositions[0]?null:r.jsx("div",{className:`rounded-sm ${E?"bg-blue-400":"bg-gray-300"}`,style:E&&b.centerPositions.length===4?{gridColumn:`${b.centerPositions[0]%b.size+1} / span 2`,gridRow:`${Math.floor(b.centerPositions[0]/b.size)+1} / span 2`}:{}},A)})})]},b.id)})})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 flex flex-col h-full max-h-[calc(100vh-12rem)]",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["楽曲リスト (",n.songs.length,")"]}),r.jsxs("button",{onClick:()=>x(!0),className:"bg-blue-500 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors flex items-center gap-1",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"曲を追加"]})]}),n.songs.length===0?r.jsxs("div",{className:"text-center py-8 text-gray-500 flex-1 flex items-center justify-center flex-col",children:[r.jsx("div",{className:"text-4xl mb-4",children:"🎵"}),r.jsx("p",{children:"まだ楽曲が追加されていません"}),r.jsx("p",{className:"text-sm",children:"右上の「曲を追加」ボタンから楽曲を追加してみましょう"})]}):r.jsx("div",{className:"flex-1 min-h-0",children:r.jsx("div",{className:"h-full overflow-y-auto pr-2 space-y-3",children:n.songs.map(b=>r.jsxs("div",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[r.jsx("img",{src:b.jacket||"/default-cover.jpg",alt:b.title,className:"w-12 h-12 rounded object-cover"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-medium text-gray-900 truncate",children:b.title}),r.jsx("div",{className:"text-sm text-gray-500 truncate",children:b.artist})]}),r.jsx("button",{onClick:()=>{const C=b.id||`${b.title}-${b.artist}`.replace(/\s+/g,"-").toLowerCase();w(C)},className:"text-red-500 hover:text-red-700 p-1",title:"削除",children:"🗑️"})]},b.id))})})]})]}),f&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"楽曲を追加"}),r.jsx("button",{onClick:()=>x(!1),className:"text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx(vr,{onSelect:N,placeholder:"楽曲名やアーティスト名で検索...",username:t})]})}),r.jsxs("div",{className:"mt-8 bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"共有"}),r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[r.jsx("p",{className:"text-blue-700 mb-3",children:"あなたの音楽名刺URL:"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"text",value:`${window.location.origin}/users/${t}`,readOnly:!0,className:"flex-1 px-3 py-2 bg-white border border-gray-300 rounded text-sm"}),r.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/users/${t}`)},className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors",children:"📋 コピー"})]})]})]})]}),d&&r.jsx(Ha,{message:d.message,type:d.type,onClose:()=>u(null)})]}):r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-red-600",children:"プロフィールの読み込みに失敗しました"}),r.jsx("button",{onClick:()=>e("/login"),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded",children:"ログインページに戻る"})]})})}function Ja({title:e,artist:t,videoId:s,coverImage:n,onError:o}){const[a,i]=j.useState(!1),[l,c]=j.useState(!1),[d,u]=j.useState(0),[f]=j.useState(30),[x,p]=j.useState(1),[h,m]=j.useState(0),[g,y]=j.useState(!1),N=j.useRef(null),w=j.useRef(null),b=j.useRef(null),C=async()=>{try{y(!0);const k=Math.floor(Math.random()*30)+45;m(k),console.log(`🎵 サビ予測時間: ${k}秒`)}catch(k){console.error("サビ検出エラー:",k),m(0)}finally{y(!1)}},I=()=>{p(0);let k=0;b.current=setInterval(()=>{k+=.05,k>=1&&(k=1,clearInterval(b.current)),p(k)},50)},A=k=>{let z=x;b.current=setInterval(()=>{z-=.05,z<=0&&(z=0,clearInterval(b.current),k==null||k()),p(z)},50)},E=()=>{if(!s){o==null||o("YouTube動画IDが取得できませんでした");return}try{c(!1),i(!0),u(0),I(),w.current=setInterval(()=>{u(k=>{const z=k+1;return z>=f?(R(),f):z})},1e3),console.log(`▶️ YouTube試聴開始: ${e} - ${t}`),console.log(`🎥 Video ID: ${s}, Start: ${h}s`)}catch(k){console.error("YouTube再生エラー:",k),c(!0),i(!1),o==null||o("YouTube動画の再生に失敗しました")}},R=()=>{A(()=>{i(!1),u(0),w.current&&(clearInterval(w.current),w.current=null),b.current&&(clearInterval(b.current),b.current=null)}),console.log(`⏹️ YouTube試聴停止: ${e} - ${t}`)},D=()=>`https://www.youtube.com/embed/${s}?autoplay=1&start=${h}&end=${h+f}&controls=1&modestbranding=1&rel=0&showinfo=0&enablejsapi=1&origin=${window.location.origin}`,K=d/f*100,L=k=>{const z=Math.floor(k/60),O=k%60;return`${z}:${O.toString().padStart(2,"0")}`};return j.useEffect(()=>()=>{w.current&&clearInterval(w.current),b.current&&clearInterval(b.current)},[]),s?r.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden max-w-sm mx-auto",children:[r.jsx("div",{className:"relative aspect-video bg-black",children:a?r.jsxs("div",{className:"relative w-full h-full",children:[r.jsx("iframe",{ref:N,width:"100%",height:"100%",src:D(),title:`${e} by ${t}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"absolute inset-0",style:{opacity:x}}),r.jsx("button",{onClick:R,className:"absolute top-2 left-2 bg-black/70 text-white p-2 rounded-full hover:bg-black/90 transition-colors",children:r.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})})}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 p-2",children:r.jsxs("div",{className:"flex items-center gap-2 text-white text-xs",children:[r.jsx("span",{children:L(d)}),r.jsx("div",{className:"flex-1 bg-gray-600 rounded-full h-1 overflow-hidden",children:r.jsx("div",{className:"h-full bg-red-500 transition-all duration-1000 ease-linear",style:{width:`${K}%`}})}),r.jsx("span",{children:L(f)})]})})]}):r.jsxs("div",{className:"relative w-full h-full",children:[r.jsx("img",{src:n,alt:`${e} by ${t}`,className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:r.jsx("button",{onClick:E,disabled:l,className:`
                  w-16 h-16 rounded-full flex items-center justify-center transition-all duration-200
                  ${l?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700 hover:scale-110 shadow-lg"}
                `,children:l?r.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}):r.jsx("svg",{className:"w-8 h-8 text-white ml-1",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M8 5v14l11-7z"})})})}),r.jsx("div",{className:"absolute top-2 right-2 bg-black/70 rounded px-2 py-1",children:r.jsx("svg",{className:"w-6 h-4 text-red-500",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})})})]})}),r.jsxs("div",{className:"p-4",children:[r.jsx("h3",{className:"font-semibold text-gray-900 truncate mb-1",children:e}),r.jsx("p",{className:"text-sm text-gray-600 truncate mb-3",children:t}),r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsxs("button",{onClick:C,disabled:g,className:"flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-xs disabled:opacity-50",children:[g?r.jsx("div",{className:"w-3 h-3 border border-blue-500 border-t-transparent rounded-full animate-spin"}):r.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"サビ検出"]}),r.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[r.jsx("span",{children:"開始:"}),r.jsx("span",{className:"font-mono",children:L(h)})]})]}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),"30秒プレビュー"]}),a&&r.jsxs("span",{className:"text-red-500 font-medium flex items-center gap-1",children:[r.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),"再生中"]})]})]}),l&&r.jsx("div",{className:"px-4 pb-4",children:r.jsx("div",{className:"text-xs text-red-500 text-center bg-red-50 p-2 rounded",children:"YouTube動画の再生に失敗しました"})})]}):r.jsx("div",{className:"flex items-center justify-center p-4 bg-gray-100 rounded-lg",children:r.jsxs("div",{className:"text-center",children:[r.jsx("svg",{className:"w-8 h-8 text-gray-400 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})}),r.jsx("p",{className:"text-xs text-gray-500",children:"YouTube動画なし"})]})})}var st={},Ka=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},zs={},ae={};let Nr;const qa=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];ae.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};ae.getSymbolTotalCodewords=function(t){return qa[t]};ae.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};ae.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');Nr=t};ae.isKanjiModeEnabled=function(){return typeof Nr<"u"};ae.toSJIS=function(t){return Nr(t)};var _t={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+s)}}e.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},e.from=function(n,o){if(e.isValid(n))return n;try{return t(n)}catch{return o}}})(_t);function Fs(){this.buffer=[],this.length=0}Fs.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let s=0;s<t;s++)this.putBit((e>>>t-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var Ya=Fs;function nt(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}nt.prototype.set=function(e,t,s,n){const o=e*this.size+t;this.data[o]=s,n&&(this.reservedBit[o]=!0)};nt.prototype.get=function(e,t){return this.data[e*this.size+t]};nt.prototype.xor=function(e,t,s){this.data[e*this.size+t]^=s};nt.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var Ga=nt,Hs={};(function(e){const t=ae.getSymbolSize;e.getRowColCoords=function(n){if(n===1)return[];const o=Math.floor(n/7)+2,a=t(n),i=a===145?26:Math.ceil((a-13)/(2*o-2))*2,l=[a-7];for(let c=1;c<o-1;c++)l[c]=l[c-1]-i;return l.push(6),l.reverse()},e.getPositions=function(n){const o=[],a=e.getRowColCoords(n),i=a.length;for(let l=0;l<i;l++)for(let c=0;c<i;c++)l===0&&c===0||l===0&&c===i-1||l===i-1&&c===0||o.push([a[l],a[c]]);return o}})(Hs);var Vs={};const Xa=ae.getSymbolSize,Xr=7;Vs.getPositions=function(t){const s=Xa(t);return[[0,0],[s-Xr,0],[0,s-Xr]]};var Ws={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const a=o.size;let i=0,l=0,c=0,d=null,u=null;for(let f=0;f<a;f++){l=c=0,d=u=null;for(let x=0;x<a;x++){let p=o.get(f,x);p===d?l++:(l>=5&&(i+=t.N1+(l-5)),d=p,l=1),p=o.get(x,f),p===u?c++:(c>=5&&(i+=t.N1+(c-5)),u=p,c=1)}l>=5&&(i+=t.N1+(l-5)),c>=5&&(i+=t.N1+(c-5))}return i},e.getPenaltyN2=function(o){const a=o.size;let i=0;for(let l=0;l<a-1;l++)for(let c=0;c<a-1;c++){const d=o.get(l,c)+o.get(l,c+1)+o.get(l+1,c)+o.get(l+1,c+1);(d===4||d===0)&&i++}return i*t.N2},e.getPenaltyN3=function(o){const a=o.size;let i=0,l=0,c=0;for(let d=0;d<a;d++){l=c=0;for(let u=0;u<a;u++)l=l<<1&2047|o.get(d,u),u>=10&&(l===1488||l===93)&&i++,c=c<<1&2047|o.get(u,d),u>=10&&(c===1488||c===93)&&i++}return i*t.N3},e.getPenaltyN4=function(o){let a=0;const i=o.data.length;for(let c=0;c<i;c++)a+=o.data[c];return Math.abs(Math.ceil(a*100/i/5)-10)*t.N4};function s(n,o,a){switch(n){case e.Patterns.PATTERN000:return(o+a)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return a%3===0;case e.Patterns.PATTERN011:return(o+a)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(a/3))%2===0;case e.Patterns.PATTERN101:return o*a%2+o*a%3===0;case e.Patterns.PATTERN110:return(o*a%2+o*a%3)%2===0;case e.Patterns.PATTERN111:return(o*a%3+(o+a)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}e.applyMask=function(o,a){const i=a.size;for(let l=0;l<i;l++)for(let c=0;c<i;c++)a.isReserved(c,l)||a.xor(c,l,s(o,c,l))},e.getBestMask=function(o,a){const i=Object.keys(e.Patterns).length;let l=0,c=1/0;for(let d=0;d<i;d++){a(d),e.applyMask(d,o);const u=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(d,o),u<c&&(c=u,l=d)}return l}})(Ws);var Pt={};const we=_t,lt=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],ct=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Pt.getBlocksCount=function(t,s){switch(s){case we.L:return lt[(t-1)*4+0];case we.M:return lt[(t-1)*4+1];case we.Q:return lt[(t-1)*4+2];case we.H:return lt[(t-1)*4+3];default:return}};Pt.getTotalCodewordsCount=function(t,s){switch(s){case we.L:return ct[(t-1)*4+0];case we.M:return ct[(t-1)*4+1];case we.Q:return ct[(t-1)*4+2];case we.H:return ct[(t-1)*4+3];default:return}};var Js={},Bt={};const qe=new Uint8Array(512),jt=new Uint8Array(256);(function(){let t=1;for(let s=0;s<255;s++)qe[s]=t,jt[t]=s,t<<=1,t&256&&(t^=285);for(let s=255;s<512;s++)qe[s]=qe[s-255]})();Bt.log=function(t){if(t<1)throw new Error("log("+t+")");return jt[t]};Bt.exp=function(t){return qe[t]};Bt.mul=function(t,s){return t===0||s===0?0:qe[jt[t]+jt[s]]};(function(e){const t=Bt;e.mul=function(n,o){const a=new Uint8Array(n.length+o.length-1);for(let i=0;i<n.length;i++)for(let l=0;l<o.length;l++)a[i+l]^=t.mul(n[i],o[l]);return a},e.mod=function(n,o){let a=new Uint8Array(n);for(;a.length-o.length>=0;){const i=a[0];for(let c=0;c<o.length;c++)a[c]^=t.mul(o[c],i);let l=0;for(;l<a.length&&a[l]===0;)l++;a=a.slice(l)}return a},e.generateECPolynomial=function(n){let o=new Uint8Array([1]);for(let a=0;a<n;a++)o=e.mul(o,new Uint8Array([1,t.exp(a)]));return o}})(Js);const Ks=Js;function Sr(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}Sr.prototype.initialize=function(t){this.degree=t,this.genPoly=Ks.generateECPolynomial(this.degree)};Sr.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(t.length+this.degree);s.set(t);const n=Ks.mod(s,this.genPoly),o=this.degree-n.length;if(o>0){const a=new Uint8Array(this.degree);return a.set(n,o),a}return n};var Qa=Sr,qs={},ve={},Cr={};Cr.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var ge={};const Ys="[0-9]+",Za="[A-Z $%*+\\-./:]+";let Xe="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Xe=Xe.replace(/u/g,"\\u");const ei="(?:(?![A-Z0-9 $%*+\\-./:]|"+Xe+`)(?:.|[\r
]))+`;ge.KANJI=new RegExp(Xe,"g");ge.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");ge.BYTE=new RegExp(ei,"g");ge.NUMERIC=new RegExp(Ys,"g");ge.ALPHANUMERIC=new RegExp(Za,"g");const ti=new RegExp("^"+Xe+"$"),ri=new RegExp("^"+Ys+"$"),si=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");ge.testKanji=function(t){return ti.test(t)};ge.testNumeric=function(t){return ri.test(t)};ge.testAlphanumeric=function(t){return si.test(t)};(function(e){const t=Cr,s=ge;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(a,i){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!t.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?a.ccBits[0]:i<27?a.ccBits[1]:a.ccBits[2]},e.getBestModeForData=function(a){return s.testNumeric(a)?e.NUMERIC:s.testAlphanumeric(a)?e.ALPHANUMERIC:s.testKanji(a)?e.KANJI:e.BYTE},e.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},e.isValid=function(a){return a&&a.bit&&a.ccBits};function n(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(a,i){if(e.isValid(a))return a;try{return n(a)}catch{return i}}})(ve);(function(e){const t=ae,s=Pt,n=_t,o=ve,a=Cr,i=7973,l=t.getBCHDigit(i);function c(x,p,h){for(let m=1;m<=40;m++)if(p<=e.getCapacity(m,h,x))return m}function d(x,p){return o.getCharCountIndicator(x,p)+4}function u(x,p){let h=0;return x.forEach(function(m){const g=d(m.mode,p);h+=g+m.getBitsLength()}),h}function f(x,p){for(let h=1;h<=40;h++)if(u(x,h)<=e.getCapacity(h,p,o.MIXED))return h}e.from=function(p,h){return a.isValid(p)?parseInt(p,10):h},e.getCapacity=function(p,h,m){if(!a.isValid(p))throw new Error("Invalid QR Code version");typeof m>"u"&&(m=o.BYTE);const g=t.getSymbolTotalCodewords(p),y=s.getTotalCodewordsCount(p,h),N=(g-y)*8;if(m===o.MIXED)return N;const w=N-d(m,p);switch(m){case o.NUMERIC:return Math.floor(w/10*3);case o.ALPHANUMERIC:return Math.floor(w/11*2);case o.KANJI:return Math.floor(w/13);case o.BYTE:default:return Math.floor(w/8)}},e.getBestVersionForData=function(p,h){let m;const g=n.from(h,n.M);if(Array.isArray(p)){if(p.length>1)return f(p,g);if(p.length===0)return 1;m=p[0]}else m=p;return c(m.mode,m.getLength(),g)},e.getEncodedBits=function(p){if(!a.isValid(p)||p<7)throw new Error("Invalid QR Code version");let h=p<<12;for(;t.getBCHDigit(h)-l>=0;)h^=i<<t.getBCHDigit(h)-l;return p<<12|h}})(qs);var Gs={};const ir=ae,Xs=1335,ni=21522,Qr=ir.getBCHDigit(Xs);Gs.getEncodedBits=function(t,s){const n=t.bit<<3|s;let o=n<<10;for(;ir.getBCHDigit(o)-Qr>=0;)o^=Xs<<ir.getBCHDigit(o)-Qr;return(n<<10|o)^ni};var Qs={};const oi=ve;function Me(e){this.mode=oi.NUMERIC,this.data=e.toString()}Me.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};Me.prototype.getLength=function(){return this.data.length};Me.prototype.getBitsLength=function(){return Me.getBitsLength(this.data.length)};Me.prototype.write=function(t){let s,n,o;for(s=0;s+3<=this.data.length;s+=3)n=this.data.substr(s,3),o=parseInt(n,10),t.put(o,10);const a=this.data.length-s;a>0&&(n=this.data.substr(s),o=parseInt(n,10),t.put(o,a*3+1))};var ai=Me;const ii=ve,Jt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Oe(e){this.mode=ii.ALPHANUMERIC,this.data=e}Oe.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};Oe.prototype.getLength=function(){return this.data.length};Oe.prototype.getBitsLength=function(){return Oe.getBitsLength(this.data.length)};Oe.prototype.write=function(t){let s;for(s=0;s+2<=this.data.length;s+=2){let n=Jt.indexOf(this.data[s])*45;n+=Jt.indexOf(this.data[s+1]),t.put(n,11)}this.data.length%2&&t.put(Jt.indexOf(this.data[s]),6)};var li=Oe;const ci=ve;function De(e){this.mode=ci.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}De.getBitsLength=function(t){return t*8};De.prototype.getLength=function(){return this.data.length};De.prototype.getBitsLength=function(){return De.getBitsLength(this.data.length)};De.prototype.write=function(e){for(let t=0,s=this.data.length;t<s;t++)e.put(this.data[t],8)};var di=De;const ui=ve,hi=ae;function Ue(e){this.mode=ui.KANJI,this.data=e}Ue.getBitsLength=function(t){return t*13};Ue.prototype.getLength=function(){return this.data.length};Ue.prototype.getBitsLength=function(){return Ue.getBitsLength(this.data.length)};Ue.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let s=hi.toSJIS(this.data[t]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),e.put(s,13)}};var mi=Ue,Zs={exports:{}};(function(e){var t={single_source_shortest_paths:function(s,n,o){var a={},i={};i[n]=0;var l=t.PriorityQueue.make();l.push(n,0);for(var c,d,u,f,x,p,h,m,g;!l.empty();){c=l.pop(),d=c.value,f=c.cost,x=s[d]||{};for(u in x)x.hasOwnProperty(u)&&(p=x[u],h=f+p,m=i[u],g=typeof i[u]>"u",(g||m>h)&&(i[u]=h,l.push(u,h),a[u]=d))}if(typeof o<"u"&&typeof i[o]>"u"){var y=["Could not find a path from ",n," to ",o,"."].join("");throw new Error(y)}return a},extract_shortest_path_from_predecessor_list:function(s,n){for(var o=[],a=n;a;)o.push(a),s[a],a=s[a];return o.reverse(),o},find_path:function(s,n,o){var a=t.single_source_shortest_paths(s,n,o);return t.extract_shortest_path_from_predecessor_list(a,o)},PriorityQueue:{make:function(s){var n=t.PriorityQueue,o={},a;s=s||{};for(a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);return o.queue=[],o.sorter=s.sorter||n.default_sorter,o},default_sorter:function(s,n){return s.cost-n.cost},push:function(s,n){var o={value:s,cost:n};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(Zs);var fi=Zs.exports;(function(e){const t=ve,s=ai,n=li,o=di,a=mi,i=ge,l=ae,c=fi;function d(y){return unescape(encodeURIComponent(y)).length}function u(y,N,w){const b=[];let C;for(;(C=y.exec(w))!==null;)b.push({data:C[0],index:C.index,mode:N,length:C[0].length});return b}function f(y){const N=u(i.NUMERIC,t.NUMERIC,y),w=u(i.ALPHANUMERIC,t.ALPHANUMERIC,y);let b,C;return l.isKanjiModeEnabled()?(b=u(i.BYTE,t.BYTE,y),C=u(i.KANJI,t.KANJI,y)):(b=u(i.BYTE_KANJI,t.BYTE,y),C=[]),N.concat(w,b,C).sort(function(A,E){return A.index-E.index}).map(function(A){return{data:A.data,mode:A.mode,length:A.length}})}function x(y,N){switch(N){case t.NUMERIC:return s.getBitsLength(y);case t.ALPHANUMERIC:return n.getBitsLength(y);case t.KANJI:return a.getBitsLength(y);case t.BYTE:return o.getBitsLength(y)}}function p(y){return y.reduce(function(N,w){const b=N.length-1>=0?N[N.length-1]:null;return b&&b.mode===w.mode?(N[N.length-1].data+=w.data,N):(N.push(w),N)},[])}function h(y){const N=[];for(let w=0;w<y.length;w++){const b=y[w];switch(b.mode){case t.NUMERIC:N.push([b,{data:b.data,mode:t.ALPHANUMERIC,length:b.length},{data:b.data,mode:t.BYTE,length:b.length}]);break;case t.ALPHANUMERIC:N.push([b,{data:b.data,mode:t.BYTE,length:b.length}]);break;case t.KANJI:N.push([b,{data:b.data,mode:t.BYTE,length:d(b.data)}]);break;case t.BYTE:N.push([{data:b.data,mode:t.BYTE,length:d(b.data)}])}}return N}function m(y,N){const w={},b={start:{}};let C=["start"];for(let I=0;I<y.length;I++){const A=y[I],E=[];for(let R=0;R<A.length;R++){const D=A[R],K=""+I+R;E.push(K),w[K]={node:D,lastCount:0},b[K]={};for(let L=0;L<C.length;L++){const k=C[L];w[k]&&w[k].node.mode===D.mode?(b[k][K]=x(w[k].lastCount+D.length,D.mode)-x(w[k].lastCount,D.mode),w[k].lastCount+=D.length):(w[k]&&(w[k].lastCount=D.length),b[k][K]=x(D.length,D.mode)+4+t.getCharCountIndicator(D.mode,N))}}C=E}for(let I=0;I<C.length;I++)b[C[I]].end=0;return{map:b,table:w}}function g(y,N){let w;const b=t.getBestModeForData(y);if(w=t.from(N,b),w!==t.BYTE&&w.bit<b.bit)throw new Error('"'+y+'" cannot be encoded with mode '+t.toString(w)+`.
 Suggested mode is: `+t.toString(b));switch(w===t.KANJI&&!l.isKanjiModeEnabled()&&(w=t.BYTE),w){case t.NUMERIC:return new s(y);case t.ALPHANUMERIC:return new n(y);case t.KANJI:return new a(y);case t.BYTE:return new o(y)}}e.fromArray=function(N){return N.reduce(function(w,b){return typeof b=="string"?w.push(g(b,null)):b.data&&w.push(g(b.data,b.mode)),w},[])},e.fromString=function(N,w){const b=f(N,l.isKanjiModeEnabled()),C=h(b),I=m(C,w),A=c.find_path(I.map,"start","end"),E=[];for(let R=1;R<A.length-1;R++)E.push(I.table[A[R]].node);return e.fromArray(p(E))},e.rawSplit=function(N){return e.fromArray(f(N,l.isKanjiModeEnabled()))}})(Qs);const Mt=ae,Kt=_t,gi=Ya,xi=Ga,pi=Hs,bi=Vs,lr=Ws,cr=Pt,yi=Qa,vt=qs,wi=Gs,ji=ve,qt=Qs;function vi(e,t){const s=e.size,n=bi.getPositions(t);for(let o=0;o<n.length;o++){const a=n[o][0],i=n[o][1];for(let l=-1;l<=7;l++)if(!(a+l<=-1||s<=a+l))for(let c=-1;c<=7;c++)i+c<=-1||s<=i+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?e.set(a+l,i+c,!0,!0):e.set(a+l,i+c,!1,!0))}}function Ni(e){const t=e.size;for(let s=8;s<t-8;s++){const n=s%2===0;e.set(s,6,n,!0),e.set(6,s,n,!0)}}function Si(e,t){const s=pi.getPositions(t);for(let n=0;n<s.length;n++){const o=s[n][0],a=s[n][1];for(let i=-2;i<=2;i++)for(let l=-2;l<=2;l++)i===-2||i===2||l===-2||l===2||i===0&&l===0?e.set(o+i,a+l,!0,!0):e.set(o+i,a+l,!1,!0)}}function Ci(e,t){const s=e.size,n=vt.getEncodedBits(t);let o,a,i;for(let l=0;l<18;l++)o=Math.floor(l/3),a=l%3+s-8-3,i=(n>>l&1)===1,e.set(o,a,i,!0),e.set(a,o,i,!0)}function Yt(e,t,s){const n=e.size,o=wi.getEncodedBits(t,s);let a,i;for(a=0;a<15;a++)i=(o>>a&1)===1,a<6?e.set(a,8,i,!0):a<8?e.set(a+1,8,i,!0):e.set(n-15+a,8,i,!0),a<8?e.set(8,n-a-1,i,!0):a<9?e.set(8,15-a-1+1,i,!0):e.set(8,15-a-1,i,!0);e.set(n-8,8,1,!0)}function ki(e,t){const s=e.size;let n=-1,o=s-1,a=7,i=0;for(let l=s-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!e.isReserved(o,l-c)){let d=!1;i<t.length&&(d=(t[i]>>>a&1)===1),e.set(o,l-c,d),a--,a===-1&&(i++,a=7)}if(o+=n,o<0||s<=o){o-=n,n=-n;break}}}function Ei(e,t,s){const n=new gi;s.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),ji.getCharCountIndicator(c.mode,e)),c.write(n)});const o=Mt.getSymbolTotalCodewords(e),a=cr.getTotalCodewordsCount(e,t),i=(o-a)*8;for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const l=(i-n.getLengthInBits())/8;for(let c=0;c<l;c++)n.put(c%2?17:236,8);return Li(n,e,t)}function Li(e,t,s){const n=Mt.getSymbolTotalCodewords(t),o=cr.getTotalCodewordsCount(t,s),a=n-o,i=cr.getBlocksCount(t,s),l=n%i,c=i-l,d=Math.floor(n/i),u=Math.floor(a/i),f=u+1,x=d-u,p=new yi(x);let h=0;const m=new Array(i),g=new Array(i);let y=0;const N=new Uint8Array(e.buffer);for(let A=0;A<i;A++){const E=A<c?u:f;m[A]=N.slice(h,h+E),g[A]=p.encode(m[A]),h+=E,y=Math.max(y,E)}const w=new Uint8Array(n);let b=0,C,I;for(C=0;C<y;C++)for(I=0;I<i;I++)C<m[I].length&&(w[b++]=m[I][C]);for(C=0;C<x;C++)for(I=0;I<i;I++)w[b++]=g[I][C];return w}function Ri(e,t,s,n){let o;if(Array.isArray(e))o=qt.fromArray(e);else if(typeof e=="string"){let d=t;if(!d){const u=qt.rawSplit(e);d=vt.getBestVersionForData(u,s)}o=qt.fromString(e,d||40)}else throw new Error("Invalid data");const a=vt.getBestVersionForData(o,s);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=a;else if(t<a)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+a+`.
`);const i=Ei(t,s,o),l=Mt.getSymbolSize(t),c=new xi(l);return vi(c,t),Ni(c),Si(c,t),Yt(c,s,0),t>=7&&Ci(c,t),ki(c,i),isNaN(n)&&(n=lr.getBestMask(c,Yt.bind(null,c,s))),lr.applyMask(n,c),Yt(c,s,n),{modules:c,version:t,errorCorrectionLevel:s,maskPattern:n,segments:o}}zs.create=function(t,s){if(typeof t>"u"||t==="")throw new Error("No input text");let n=Kt.M,o,a;return typeof s<"u"&&(n=Kt.from(s.errorCorrectionLevel,Kt.M),o=vt.from(s.version),a=lr.from(s.maskPattern),s.toSJISFunc&&Mt.setToSJISFunction(s.toSJISFunc)),Ri(t,o,n,a)};var en={},kr={};(function(e){function t(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let n=s.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+s);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(a){return[a,a]}))),n.length===6&&n.push("F","F");const o=parseInt(n.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+n.slice(0,6).join("")}}e.getOptions=function(n){n||(n={}),n.color||(n.color={});const o=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,a=n.width&&n.width>=21?n.width:void 0,i=n.scale||4;return{width:a,scale:a?4:i,margin:o,color:{dark:t(n.color.dark||"#000000ff"),light:t(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},e.getScale=function(n,o){return o.width&&o.width>=n+o.margin*2?o.width/(n+o.margin*2):o.scale},e.getImageWidth=function(n,o){const a=e.getScale(n,o);return Math.floor((n+o.margin*2)*a)},e.qrToImageData=function(n,o,a){const i=o.modules.size,l=o.modules.data,c=e.getScale(i,a),d=Math.floor((i+a.margin*2)*c),u=a.margin*c,f=[a.color.light,a.color.dark];for(let x=0;x<d;x++)for(let p=0;p<d;p++){let h=(x*d+p)*4,m=a.color.light;if(x>=u&&p>=u&&x<d-u&&p<d-u){const g=Math.floor((x-u)/c),y=Math.floor((p-u)/c);m=f[l[g*i+y]?1:0]}n[h++]=m.r,n[h++]=m.g,n[h++]=m.b,n[h]=m.a}}})(kr);(function(e){const t=kr;function s(o,a,i){o.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=i,a.width=i,a.style.height=i+"px",a.style.width=i+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(a,i,l){let c=l,d=i;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),i||(d=n()),c=t.getOptions(c);const u=t.getImageWidth(a.modules.size,c),f=d.getContext("2d"),x=f.createImageData(u,u);return t.qrToImageData(x.data,a,c),s(f,d,u),f.putImageData(x,0,0),d},e.renderToDataURL=function(a,i,l){let c=l;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),c||(c={});const d=e.render(a,i,c),u=c.type||"image/png",f=c.rendererOpts||{};return d.toDataURL(u,f.quality)}})(en);var tn={};const Ii=kr;function Zr(e,t){const s=e.a/255,n=t+'="'+e.hex+'"';return s<1?n+" "+t+'-opacity="'+s.toFixed(2).slice(1)+'"':n}function Gt(e,t,s){let n=e+t;return typeof s<"u"&&(n+=" "+s),n}function Ai(e,t,s){let n="",o=0,a=!1,i=0;for(let l=0;l<e.length;l++){const c=Math.floor(l%t),d=Math.floor(l/t);!c&&!a&&(a=!0),e[l]?(i++,l>0&&c>0&&e[l-1]||(n+=a?Gt("M",c+s,.5+d+s):Gt("m",o,0),o=0,a=!1),c+1<t&&e[l+1]||(n+=Gt("h",i),i=0)):o++}return n}tn.render=function(t,s,n){const o=Ii.getOptions(s),a=t.modules.size,i=t.modules.data,l=a+o.margin*2,c=o.color.light.a?"<path "+Zr(o.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",d="<path "+Zr(o.color.dark,"stroke")+' d="'+Ai(i,a,o.margin)+'"/>',u='viewBox="0 0 '+l+" "+l+'"',x='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+u+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof n=="function"&&n(null,x),x};const Ti=Ka,dr=zs,rn=en,$i=tn;function Er(e,t,s,n,o){const a=[].slice.call(arguments,1),i=a.length,l=typeof a[i-1]=="function";if(!l&&!Ti())throw new Error("Callback required as last argument");if(l){if(i<2)throw new Error("Too few arguments provided");i===2?(o=s,s=t,t=n=void 0):i===3&&(t.getContext&&typeof o>"u"?(o=n,n=void 0):(o=n,n=s,s=t,t=void 0))}else{if(i<1)throw new Error("Too few arguments provided");return i===1?(s=t,t=n=void 0):i===2&&!t.getContext&&(n=s,s=t,t=void 0),new Promise(function(c,d){try{const u=dr.create(s,n);c(e(u,t,n))}catch(u){d(u)}})}try{const c=dr.create(s,n);o(null,e(c,t,n))}catch(c){o(c)}}st.create=dr.create;st.toCanvas=Er.bind(null,rn.render);st.toDataURL=Er.bind(null,rn.renderToDataURL);st.toString=Er.bind(null,function(e,t,s){return $i.render(e,s)});var sn={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function s(){for(var a="",i=0;i<arguments.length;i++){var l=arguments[i];l&&(a=o(a,n(l)))}return a}function n(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return s.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var i="";for(var l in a)t.call(a,l)&&a[l]&&(i=o(i,l));return i}function o(a,i){return i?a?a+" "+i:a+i:a}e.exports?(s.default=s,e.exports=s):window.classNames=s})()})(sn);var _i=sn.exports;const nn=ss(_i);var ur={exports:{}},hr={exports:{}},Qe=1e3,Ze=Qe*60,et=Ze*60,tt=et*24,Pi=tt*365.25,Bi=function(e,t){t=t||{};var s=typeof e;if(s==="string"&&e.length>0)return Mi(e);if(s==="number"&&isNaN(e)===!1)return t.long?Di(e):Oi(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Mi(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var s=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return s*Pi;case"days":case"day":case"d":return s*tt;case"hours":case"hour":case"hrs":case"hr":case"h":return s*et;case"minutes":case"minute":case"mins":case"min":case"m":return s*Ze;case"seconds":case"second":case"secs":case"sec":case"s":return s*Qe;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function Oi(e){return e>=tt?Math.round(e/tt)+"d":e>=et?Math.round(e/et)+"h":e>=Ze?Math.round(e/Ze)+"m":e>=Qe?Math.round(e/Qe)+"s":e+"ms"}function Di(e){return dt(e,tt,"day")||dt(e,et,"hour")||dt(e,Ze,"minute")||dt(e,Qe,"second")||e+" ms"}function dt(e,t,s){if(!(e<t))return e<t*1.5?Math.floor(e/t)+" "+s:Math.ceil(e/t)+" "+s+"s"}(function(e,t){t=e.exports=o.debug=o.default=o,t.coerce=c,t.disable=i,t.enable=a,t.enabled=l,t.humanize=Bi,t.names=[],t.skips=[],t.formatters={};var s;function n(d){var u=0,f;for(f in d)u=(u<<5)-u+d.charCodeAt(f),u|=0;return t.colors[Math.abs(u)%t.colors.length]}function o(d){function u(){if(u.enabled){var f=u,x=+new Date,p=x-(s||x);f.diff=p,f.prev=s,f.curr=x,s=x;for(var h=new Array(arguments.length),m=0;m<h.length;m++)h[m]=arguments[m];h[0]=t.coerce(h[0]),typeof h[0]!="string"&&h.unshift("%O");var g=0;h[0]=h[0].replace(/%([a-zA-Z%])/g,function(N,w){if(N==="%%")return N;g++;var b=t.formatters[w];if(typeof b=="function"){var C=h[g];N=b.call(f,C),h.splice(g,1),g--}return N}),t.formatArgs.call(f,h);var y=u.log||t.log||console.log.bind(console);y.apply(f,h)}}return u.namespace=d,u.enabled=t.enabled(d),u.useColors=t.useColors(),u.color=n(d),typeof t.init=="function"&&t.init(u),u}function a(d){t.save(d),t.names=[],t.skips=[];for(var u=(typeof d=="string"?d:"").split(/[\s,]+/),f=u.length,x=0;x<f;x++)u[x]&&(d=u[x].replace(/\*/g,".*?"),d[0]==="-"?t.skips.push(new RegExp("^"+d.substr(1)+"$")):t.names.push(new RegExp("^"+d+"$")))}function i(){t.enable("")}function l(d){var u,f;for(u=0,f=t.skips.length;u<f;u++)if(t.skips[u].test(d))return!1;for(u=0,f=t.names.length;u<f;u++)if(t.names[u].test(d))return!0;return!1}function c(d){return d instanceof Error?d.stack||d.message:d}})(hr,hr.exports);var Ui=hr.exports;(function(e,t){t=e.exports=Ui,t.log=o,t.formatArgs=n,t.save=a,t.load=i,t.useColors=s,t.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:l(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function s(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}t.formatters.j=function(c){try{return JSON.stringify(c)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}};function n(c){var d=this.useColors;if(c[0]=(d?"%c":"")+this.namespace+(d?" %c":" ")+c[0]+(d?"%c ":" ")+"+"+t.humanize(this.diff),!!d){var u="color: "+this.color;c.splice(1,0,u,"color: inherit");var f=0,x=0;c[0].replace(/%[a-zA-Z%]/g,function(p){p!=="%%"&&(f++,p==="%c"&&(x=f))}),c.splice(x,0,u)}}function o(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(c){try{c==null?t.storage.removeItem("debug"):t.storage.debug=c}catch{}}function i(){var c;try{c=t.storage.debug}catch{}return!c&&typeof process<"u"&&"env"in process&&(c={}.DEBUG),c}t.enable(i());function l(){try{return window.localStorage}catch{}}})(ur,ur.exports);var zi=ur.exports,es=zi("jsonp"),Fi=Wi,Hi=0;function Vi(){}function Wi(e,t,s){typeof t=="function"&&(s=t,t={}),t||(t={});var n=t.prefix||"__jp",o=t.name||n+Hi++,a=t.param||"callback",i=t.timeout!=null?t.timeout:6e4,l=encodeURIComponent,c=document.getElementsByTagName("script")[0]||document.head,d,u;i&&(u=setTimeout(function(){f(),s&&s(new Error("Timeout"))},i));function f(){d.parentNode&&d.parentNode.removeChild(d),window[o]=Vi,u&&clearTimeout(u)}function x(){window[o]&&f()}return window[o]=function(p){es("jsonp got",p),f(),s&&s(null,p)},e+=(~e.indexOf("?")?"&":"?")+a+"="+l(o),e=e.replace("?&","?"),es('jsonp req "%s"',e),d=document.createElement("script"),d.src=e,c.parentNode.insertBefore(d,c),x}const Ae=ss(Fi);var Ji=Object.defineProperty,Ki=Object.defineProperties,qi=Object.getOwnPropertyDescriptors,Nt=Object.getOwnPropertySymbols,on=Object.prototype.hasOwnProperty,an=Object.prototype.propertyIsEnumerable,ts=(e,t,s)=>t in e?Ji(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,oe=(e,t)=>{for(var s in t||(t={}))on.call(t,s)&&ts(e,s,t[s]);if(Nt)for(var s of Nt(t))an.call(t,s)&&ts(e,s,t[s]);return e},Ot=(e,t)=>Ki(e,qi(t)),Dt=(e,t)=>{var s={};for(var n in e)on.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&Nt)for(var n of Nt(e))t.indexOf(n)<0&&an.call(e,n)&&(s[n]=e[n]);return s};function Ut(e){return s=>{var n=s,{bgStyle:o={},borderRadius:a=0,iconFillColor:i="white",round:l=!1,size:c=64}=n,d=Dt(n,["bgStyle","borderRadius","iconFillColor","round","size"]);return r.jsxs("svg",Ot(oe({viewBox:"0 0 64 64",width:c,height:c},d),{children:[l?r.jsx("circle",{cx:"32",cy:"32",r:"32",fill:e.color,style:o}):r.jsx("rect",{width:"64",height:"64",rx:a,ry:a,fill:e.color,style:o}),r.jsx("path",{d:e.path,fill:i})]}))}}class Yi extends Error{constructor(t){super(t),this.name="AssertionError"}}function W(e,t){if(!e)throw new Yi(t)}function H(e){const t=Object.entries(e).filter(([,s])=>s!=null).map(([s,n])=>`${encodeURIComponent(s)}=${encodeURIComponent(String(n))}`);return t.length>0?`?${t.join("&")}`:""}const Gi=e=>!!e&&(typeof e=="object"||typeof e=="function")&&"then"in e&&typeof e.then=="function",Xi=(e,t)=>({left:window.outerWidth/2+(window.screenX||window.screenLeft||0)-e/2,top:window.outerHeight/2+(window.screenY||window.screenTop||0)-t/2}),Qi=(e,t)=>({top:(window.screen.height-t)/2,left:(window.screen.width-e)/2});function Zi(e,t,s){var n=t,{height:o,width:a}=n,i=Dt(n,["height","width"]);const l=oe({height:o,width:a,location:"no",toolbar:"no",status:"no",directories:"no",menubar:"no",scrollbars:"yes",resizable:"no",centerscreen:"yes",chrome:"yes"},i),c=window.open(e,"",Object.keys(l).map(d=>`${d}=${l[d]}`).join(", "));if(s){const d=window.setInterval(()=>{try{(c===null||c.closed)&&(window.clearInterval(d),s(c))}catch(u){console.error(u)}},1e3)}return c}function el(e){var t=e,{beforeOnClick:s,children:n,className:o,disabled:a,disabledStyle:i={opacity:.6},forwardedRef:l,htmlTitle:c,networkLink:d,networkName:u,onClick:f,onShareWindowClose:x,openShareDialogOnClick:p=!0,opts:h,resetButtonStyle:m=!0,style:g,title:y,url:N,windowHeight:w=400,windowPosition:b="windowCenter",windowWidth:C=550}=t,I=Dt(t,["beforeOnClick","children","className","disabled","disabledStyle","forwardedRef","htmlTitle","networkLink","networkName","onClick","onShareWindowClose","openShareDialogOnClick","opts","resetButtonStyle","style","title","url","windowHeight","windowPosition","windowWidth"]);const A=async D=>{const K=d(N,h);if(!a){if(D.preventDefault(),s){const L=s();Gi(L)&&await L}if(p){const L=oe({height:w,width:C},b==="windowCenter"?Xi(C,w):Qi(C,w));Zi(K,L,x)}f&&f(D,K)}},E=nn("react-share__ShareButton",{"react-share__ShareButton--disabled":!!a,disabled:!!a},o),R=oe(oe(m?{backgroundColor:"transparent",border:"none",padding:0,font:"inherit",color:"inherit",cursor:"pointer"}:{},g),a&&i);return r.jsx("button",Ot(oe({},I),{className:E,onClick:A,ref:l,style:R,title:c,children:n}))}function J(e,t,s,n){const o=(a,i)=>{const l=s(a),c=oe({},a);return Object.keys(l).forEach(u=>{delete c[u]}),r.jsx(el,Ot(oe(oe({},n),c),{forwardedRef:i,networkName:e,networkLink:t,opts:l}))};return o.displayName=`ShareButton-${e}`,j.forwardRef(o)}function tl(e,{title:t,separator:s}){return W(e,"bluesky.url"),"https://bsky.app/intent/compose"+H({text:t?t+s+e:e})}J("bluesky",tl,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function rl(e,{subject:t,body:s,separator:n}){return"mailto:"+H({subject:t,body:s?s+n+e:e})}J("email",rl,e=>({subject:e.subject,body:e.body,separator:e.separator||" "}),{openShareDialogOnClick:!1,onClick:(e,t)=>{window.location.href=t}});const sl=Ut({color:"#0965FE",path:"M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z"});function nl(e,{appId:t,redirectUri:s,to:n}){return"https://www.facebook.com/dialog/send"+H({link:e,redirect_uri:s||e,app_id:t,to:n})}J("facebookmessenger",nl,e=>({appId:e.appId,redirectUri:e.redirectUri,to:e.to}),{windowWidth:1e3,windowHeight:820});function ol(e,{hashtag:t}){return W(e,"facebook.url"),"https://www.facebook.com/sharer/sharer.php"+H({u:e,hashtag:t})}const al=J("facebook",ol,e=>({hashtag:e.hashtag}),{windowWidth:550,windowHeight:400});function il(){const e=j.useRef(!1);return j.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),j.useCallback(()=>e.current,[])}function ll(e){var t=e,{children:s=x=>x,className:n,getCount:o,url:a}=t,i=Dt(t,["children","className","getCount","url"]);const l=il(),[c,d]=j.useState(void 0),[u,f]=j.useState(!1);return j.useEffect(()=>{f(!0),o(a,x=>{l()&&(d(x),f(!1))})},[a]),r.jsx("span",Ot(oe({className:nn("react-share__ShareCount",n)},i),{children:!u&&c!==void 0&&s(c)}))}function Te(e){const t=s=>r.jsx(ll,oe({getCount:e},s));return t.displayName=`ShareCount(${e.name})`,t}function cl(e,t){const s=`https://graph.facebook.com/?id=${e}&fields=og_object{engagement}`;Ae(s,(n,o)=>{t(!n&&o&&o.og_object&&o.og_object.engagement?o.og_object.engagement.count:void 0)})}Te(cl);function dl(e,{title:t}){return W(e,"hatena.url"),`http://b.hatena.ne.jp/add?mode=confirm&url=${e}&title=${t}`}J("hatena",dl,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function ul(e,t){Ae("https://bookmark.hatenaapis.com/count/entry"+H({url:e}),(n,o)=>{t(o??void 0)})}Te(ul);function hl(e,{title:t,description:s}){return W(e,"instapaper.url"),"http://www.instapaper.com/hello2"+H({url:e,title:t,description:s})}J("instapaper",hl,e=>({title:e.title,description:e.description}),{windowWidth:500,windowHeight:500,windowPosition:"windowCenter"});const ml=Ut({color:"#00b800",path:"M52.62 30.138c0 3.693-1.432 7.019-4.42 10.296h.001c-4.326 4.979-14 11.044-16.201 11.972-2.2.927-1.876-.591-1.786-1.112l.294-1.765c.069-.527.142-1.343-.066-1.865-.232-.574-1.146-.872-1.817-1.016-9.909-1.31-17.245-8.238-17.245-16.51 0-9.226 9.251-16.733 20.62-16.733 11.37 0 20.62 7.507 20.62 16.733zM27.81 25.68h-1.446a.402.402 0 0 0-.402.401v8.985c0 .221.18.4.402.4h1.446a.401.401 0 0 0 .402-.4v-8.985a.402.402 0 0 0-.402-.401zm9.956 0H36.32a.402.402 0 0 0-.402.401v5.338L31.8 25.858a.39.39 0 0 0-.031-.04l-.002-.003-.024-.025-.008-.007a.313.313 0 0 0-.032-.026.255.255 0 0 1-.021-.014l-.012-.007-.021-.012-.013-.006-.023-.01-.013-.005-.024-.008-.014-.003-.023-.005-.017-.002-.021-.003-.021-.002h-1.46a.402.402 0 0 0-.402.401v8.985c0 .221.18.4.402.4h1.446a.401.401 0 0 0 .402-.4v-5.337l4.123 5.568c.028.04.063.072.101.099l.004.003a.236.236 0 0 0 .025.015l.012.006.019.01a.154.154 0 0 1 .019.008l.012.004.028.01.005.001a.442.442 0 0 0 .104.013h1.446a.4.4 0 0 0 .401-.4v-8.985a.402.402 0 0 0-.401-.401zm-13.442 7.537h-3.93v-7.136a.401.401 0 0 0-.401-.401h-1.447a.4.4 0 0 0-.401.401v8.984a.392.392 0 0 0 .123.29c.072.068.17.111.278.111h5.778a.4.4 0 0 0 .401-.401v-1.447a.401.401 0 0 0-.401-.401zm21.429-5.287c.222 0 .401-.18.401-.402v-1.446a.401.401 0 0 0-.401-.402h-5.778a.398.398 0 0 0-.279.113l-.005.004-.006.008a.397.397 0 0 0-.111.276v8.984c0 .108.043.206.112.278l.005.006a.401.401 0 0 0 .284.117h5.778a.4.4 0 0 0 .401-.401v-1.447a.401.401 0 0 0-.401-.401h-3.93v-1.519h3.93c.222 0 .401-.18.401-.402V29.85a.401.401 0 0 0-.401-.402h-3.93V27.93h3.93z"});function fl(e,{title:t}){return W(e,"line.url"),"https://social-plugins.line.me/lineit/share"+H({url:e,text:t})}const gl=J("line",fl,e=>({title:e.title}),{windowWidth:500,windowHeight:500});function xl(e,{title:t,summary:s,source:n}){return W(e,"linkedin.url"),"https://linkedin.com/shareArticle"+H({url:e,mini:"true",title:t,summary:s,source:n})}J("linkedin",xl,({title:e,summary:t,source:s})=>({title:e,summary:t,source:s}),{windowWidth:750,windowHeight:600});function pl(e,{title:t,description:s}){return W(e,"livejournal.url"),"https://www.livejournal.com/update.bml"+H({subject:t,event:s})}J("livejournal",pl,e=>({title:e.title,description:e.description}),{windowWidth:660,windowHeight:460});function bl(e,{title:t,description:s,imageUrl:n}){return W(e,"mailru.url"),"https://connect.mail.ru/share"+H({url:e,title:t,description:s,image_url:n})}J("mailru",bl,e=>({title:e.title,description:e.description,imageUrl:e.imageUrl}),{windowWidth:660,windowHeight:460});function yl(e,{title:t,description:s,image:n}){return W(e,"ok.url"),"https://connect.ok.ru/offer"+H({url:e,title:t,description:s,imageUrl:n})}J("ok",yl,e=>({title:e.title,description:e.description,image:e.image}),{windowWidth:588,windowHeight:480,windowPosition:"screenCenter"});function wl(e,t){window.OK||(window.OK={Share:{count:function(a,i){var l,c;(c=(l=window.OK.callbacks)[a])==null||c.call(l,i)}},callbacks:[]});const s="https://connect.ok.ru/dk",n=window.OK.callbacks.length;return window.ODKL={updateCount(o,a){var i,l;const c=o===""?0:parseInt(o.replace("react-share-",""),10);(l=(i=window.OK.callbacks)[c])==null||l.call(i,a===""?void 0:parseInt(a,10))}},window.OK.callbacks.push(t),Ae(s+H({"st.cmd":"extLike",uid:`react-share-${n}`,ref:e}))}Te(wl);function jl(e,{media:t,description:s,pinId:n}){return n?`https://pinterest.com/pin/${n}/repin/x/`:(W(e,"pinterest.url"),W(t,"pinterest.media"),"https://pinterest.com/pin/create/button/"+H({url:e,media:t,description:s}))}J("pinterest",jl,e=>({media:e.media,description:e.description,pinId:e.pinId}),{windowWidth:1e3,windowHeight:730});function vl(e,t){Ae("https://api.pinterest.com/v1/urls/count.json"+H({url:e}),(n,o)=>{t(o?o.count:void 0)})}Te(vl);function Nl(e,{title:t}){return W(e,"pocket.url"),"https://getpocket.com/save"+H({url:e,title:t})}J("pocket",Nl,e=>({title:e.title}),{windowWidth:500,windowHeight:500});function Sl(e,{title:t}){return W(e,"reddit.url"),"https://www.reddit.com/web/submit"+H({url:e,title:t})}J("reddit",Sl,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function Cl(e,{title:t}){return W(e,"gab.url"),"https://gab.com/compose"+H({url:e,text:t})}J("gab",Cl,e=>({title:e.title}),{windowWidth:660,windowHeight:640,windowPosition:"windowCenter"});function kl(e,t){const s=`https://www.reddit.com/api/info.json?limit=1&url=${e}`;Ae(s,{param:"jsonp"},(n,o)=>{t(!n&&o&&o.data&&o.data.children.length>0&&o.data.children[0].data.score?o.data.children[0].data.score:void 0)})}Te(kl);function El(e,{title:t}){return W(e,"telegram.url"),"https://telegram.me/share/url"+H({url:e,text:t})}J("telegram",El,e=>({title:e.title}),{windowWidth:550,windowHeight:400});function Ll(e,{title:t}){return W(e,"threads.url"),"https://threads.net/intent/post"+H({url:e,text:t})}J("threads",Ll,e=>({title:e.title}),{windowWidth:550,windowHeight:600});function Rl(e,{title:t,caption:s,tags:n,posttype:o}){return W(e,"tumblr.url"),"https://www.tumblr.com/widgets/share/tool"+H({canonicalUrl:e,title:t,caption:s,tags:n,posttype:o})}J("tumblr",Rl,e=>({title:e.title,tags:(e.tags||[]).join(","),caption:e.caption,posttype:e.posttype||"link"}),{windowWidth:660,windowHeight:460});function Il(e,t){return Ae("https://api.tumblr.com/v2/share/stats"+H({url:e}),(n,o)=>{t(!n&&o&&o.response?o.response.note_count:void 0)})}Te(Il);const Al=Ut({color:"#00aced",path:"M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"});function Tl(e,{title:t,via:s,hashtags:n=[],related:o=[]}){return W(e,"twitter.url"),W(Array.isArray(n),"twitter.hashtags is not an array"),W(Array.isArray(o),"twitter.related is not an array"),"https://twitter.com/intent/tweet"+H({url:e,text:t,via:s,hashtags:n.length>0?n.join(","):void 0,related:o.length>0?o.join(","):void 0})}const $l=J("twitter",Tl,e=>({hashtags:e.hashtags,title:e.title,via:e.via,related:e.related}),{windowWidth:550,windowHeight:400});function _l(e,{title:t,separator:s}){return W(e,"viber.url"),"viber://forward"+H({text:t?t+s+e:e})}J("viber",_l,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:660,windowHeight:460});function Pl(e,{title:t,image:s,noParse:n,noVkLinks:o}){return W(e,"vk.url"),"https://vk.com/share.php"+H({url:e,title:t,image:s,noparse:n?1:0,no_vk_links:o?1:0})}J("vk",Pl,e=>({title:e.title,image:e.image,noParse:e.noParse,noVkLinks:e.noVkLinks}),{windowWidth:660,windowHeight:460});function Bl(e,t){window.VK||(window.VK={}),window.VK.Share={count:(o,a)=>{var i,l;return(l=(i=window.VK.callbacks)==null?void 0:i[o])==null?void 0:l.call(i,a)}},window.VK.callbacks=[];const s="https://vk.com/share.php",n=window.VK.callbacks.length;return window.VK.callbacks.push(t),Ae(s+H({act:"count",index:n,url:e}))}Te(Bl);function Ml(e,{title:t,image:s}){return W(e,"weibo.url"),"http://service.weibo.com/share/share.php"+H({url:e,title:t,pic:s})}J("weibo",Ml,e=>({title:e.title,image:e.image}),{windowWidth:660,windowHeight:550,windowPosition:"screenCenter"});const Ol=Ut({color:"#25D366",path:"m42.32286,33.93287c-0.5178,-0.2589 -3.04726,-1.49644 -3.52105,-1.66732c-0.4712,-0.17346 -0.81554,-0.2589 -1.15987,0.2589c-0.34175,0.51004 -1.33075,1.66474 -1.63108,2.00648c-0.30032,0.33658 -0.60064,0.36247 -1.11327,0.12945c-0.5178,-0.2589 -2.17994,-0.80259 -4.14759,-2.56312c-1.53269,-1.37217 -2.56312,-3.05503 -2.86603,-3.57283c-0.30033,-0.5178 -0.03366,-0.80259 0.22524,-1.06149c0.23301,-0.23301 0.5178,-0.59547 0.7767,-0.90616c0.25372,-0.31068 0.33657,-0.5178 0.51262,-0.85437c0.17088,-0.36246 0.08544,-0.64725 -0.04402,-0.90615c-0.12945,-0.2589 -1.15987,-2.79613 -1.58964,-3.80584c-0.41424,-1.00971 -0.84142,-0.88027 -1.15987,-0.88027c-0.29773,-0.02588 -0.64208,-0.02588 -0.98382,-0.02588c-0.34693,0 -0.90616,0.12945 -1.37736,0.62136c-0.4712,0.5178 -1.80194,1.76053 -1.80194,4.27186c0,2.51134 1.84596,4.945 2.10227,5.30747c0.2589,0.33657 3.63497,5.51458 8.80262,7.74113c1.23237,0.5178 2.1903,0.82848 2.94111,1.08738c1.23237,0.38836 2.35599,0.33657 3.24402,0.20712c0.99159,-0.15534 3.04985,-1.24272 3.47963,-2.45956c0.44013,-1.21683 0.44013,-2.22654 0.31068,-2.45955c-0.12945,-0.23301 -0.46601,-0.36247 -0.98382,-0.59548m-9.40068,12.84407l-0.02589,0c-3.05503,0 -6.08417,-0.82849 -8.72495,-2.38189l-0.62136,-0.37023l-6.47252,1.68286l1.73463,-6.29129l-0.41424,-0.64725c-1.70875,-2.71846 -2.6149,-5.85116 -2.6149,-9.07706c0,-9.39809 7.68934,-17.06155 17.15993,-17.06155c4.58253,0 8.88029,1.78642 12.11655,5.02268c3.23625,3.21036 5.02267,7.50812 5.02267,12.06476c-0.0078,9.3981 -7.69712,17.06155 -17.14699,17.06155m14.58906,-31.58846c-3.93529,-3.80584 -9.1133,-5.95471 -14.62789,-5.95471c-11.36055,0 -20.60848,9.2065 -20.61625,20.52564c0,3.61684 0.94757,7.14565 2.75211,10.26282l-2.92557,10.63564l10.93337,-2.85309c3.0136,1.63108 6.4052,2.4958 9.85634,2.49839l0.01037,0c11.36574,0 20.61884,-9.2091 20.62403,-20.53082c0,-5.48093 -2.14111,-10.64081 -6.03239,-14.51915"});function Dl(){return/(android|iphone|ipad|mobile)/i.test(navigator.userAgent)}function Ul(e,{title:t,separator:s}){return W(e,"whatsapp.url"),"https://"+(Dl()?"api":"web")+".whatsapp.com/send"+H({text:t?t+s+e:e})}const zl=J("whatsapp",Ul,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:550,windowHeight:400});function Fl(e,{quote:t,hashtag:s}){return W(e,"workplace.url"),"https://work.facebook.com/sharer.php"+H({u:e,quote:t,hashtag:s})}J("workplace",Fl,e=>({quote:e.quote,hashtag:e.hashtag}),{windowWidth:550,windowHeight:400});function Hl({username:e,displayName:t,bio:s,className:n=""}){const[o,a]=j.useState(""),[i,l]=j.useState(!1),[c,d]=j.useState(!1),u=`${window.location.origin}/users/${e}`,f=`${t}の音楽名刺をチェック！ ${s?`"${s}"`:""}`;j.useEffect(()=>{(async()=>{try{const h=await st.toDataURL(u,{width:256,margin:2,color:{dark:"#000000",light:"#ffffff"}});a(h)}catch(h){console.error("QRコード生成エラー:",h)}})()},[u]);const x=async()=>{try{await navigator.clipboard.writeText(u),d(!0),setTimeout(()=>d(!1),2e3)}catch(p){console.error("クリップボードコピーエラー:",p)}};return r.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 ${n}`,children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"プロフィールを共有"]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロフィールURL"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"text",value:u,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-sm"}),r.jsx("button",{onClick:x,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c?"bg-green-100 text-green-800":"bg-blue-500 text-white hover:bg-blue-600"}`,children:c?"✓ コピー済み":"コピー"})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("button",{onClick:()=>l(!i),className:"flex items-center text-blue-600 hover:text-blue-800 text-sm font-medium",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"QRコードを",i?"非表示":"表示"]}),i&&o&&r.jsxs("div",{className:"mt-3 text-center",children:[r.jsx("img",{src:o,alt:"プロフィールQRコード",className:"mx-auto border border-gray-200 rounded-lg"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"スマートフォンでQRコードを読み取ってプロフィールにアクセス"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"SNSで共有"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx($l,{url:u,title:f,children:r.jsx(Al,{size:36,round:!0})}),r.jsx(al,{url:u,title:f,children:r.jsx(sl,{size:36,round:!0})}),r.jsx(gl,{url:u,title:f,children:r.jsx(ml,{size:36,round:!0})}),r.jsx(zl,{url:u,title:f,children:r.jsx(Ol,{size:36,round:!0})})]})]})]})}const Vl=[{title:"Shape of You",artist:"Ed Sheeran",jacket:"https://picsum.photos/300/300?random=1"},{title:"Blinding Lights",artist:"The Weeknd",jacket:"https://picsum.photos/300/300?random=2"},{title:"As It Was",artist:"Harry Styles",jacket:"https://picsum.photos/300/300?random=3"},{title:"Good 4 U",artist:"Olivia Rodrigo",jacket:"https://picsum.photos/300/300?random=4"}],Wl=[{title:"Pretender",artist:"Official髭男dism",jacket:"https://picsum.photos/300/300?random=5"},{title:"紅蓮華",artist:"LiSA",jacket:"https://picsum.photos/300/300?random=6"},{title:"猫",artist:"DISH//",jacket:"https://picsum.photos/300/300?random=7"}],Jl={alice:Vl,bob:Wl};function Kl({title:e,artist:t,previewUrl:s,coverImage:n,onPlay:o,onPause:a,onError:i}){const[l,c]=j.useState(!1),[d,u]=j.useState(0),[f,x]=j.useState(30),[p,h]=j.useState(!1),[m,g]=j.useState(!1),y=j.useRef(null),N=j.useRef(null),w=async()=>{if(!s){i==null||i("試聴用音源が利用できません");return}if(y.current)try{h(!0),g(!1),l?(y.current.pause(),c(!1),a==null||a()):(await y.current.play(),c(!0),o==null||o())}catch(E){console.error("再生エラー:",E),g(!0),i==null||i("音楽の再生に失敗しました")}finally{h(!1)}},b=()=>{y.current&&u(y.current.currentTime)},C=E=>{if(!y.current||!N.current)return;const R=N.current.getBoundingClientRect(),D=E.clientX-R.left,K=R.width,L=D/K*f;y.current.currentTime=L,u(L)},I=E=>{const R=Math.floor(E/60),D=Math.floor(E%60);return`${R}:${D.toString().padStart(2,"0")}`},A=f>0?d/f*100:0;return j.useEffect(()=>{const E=y.current;if(!E)return;const R=()=>{x(E.duration)},D=()=>{c(!1),u(0)},K=()=>{g(!0),c(!1),i==null||i("音楽ファイルの読み込みに失敗しました")};return E.addEventListener("loadedmetadata",R),E.addEventListener("timeupdate",b),E.addEventListener("ended",D),E.addEventListener("error",K),()=>{E.removeEventListener("loadedmetadata",R),E.removeEventListener("timeupdate",b),E.removeEventListener("ended",D),E.removeEventListener("error",K)}},[i]),j.useEffect(()=>{c(!1),u(0),g(!1)},[s]),s?r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-4 max-w-sm mx-auto",children:[r.jsx("audio",{ref:y,src:s,preload:"metadata"}),r.jsx("div",{className:"aspect-square mb-4 rounded-lg overflow-hidden bg-gray-200",children:r.jsx("img",{src:n,alt:`${e} by ${t}`,className:"w-full h-full object-cover"})}),r.jsxs("div",{className:"mb-4",children:[r.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:e}),r.jsx("p",{className:"text-sm text-gray-600 truncate",children:t})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("div",{className:"flex justify-center",children:r.jsx("button",{onClick:w,disabled:p||m,className:`
              w-12 h-12 rounded-full flex items-center justify-center transition-all duration-200
              ${p||m?"bg-gray-300 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 hover:scale-105 shadow-lg"}
            `,children:p?r.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):m?r.jsx("svg",{className:"w-6 h-6 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}):l?r.jsx("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):r.jsx("svg",{className:"w-6 h-6 text-white ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})})}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{ref:N,onClick:C,className:"h-2 bg-gray-200 rounded-full cursor-pointer overflow-hidden",children:r.jsx("div",{className:"h-full bg-blue-500 transition-all duration-200 rounded-full",style:{width:`${A}%`}})}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[r.jsx("span",{children:I(d)}),r.jsx("span",{children:I(f)})]})]})]}),m&&r.jsx("div",{className:"mt-2 text-xs text-red-500 text-center",children:"試聴に失敗しました"})]}):(console.warn(`⚠️ 試聴不可: "${e}" by "${t}"`),console.warn("💡 理由: Spotifyプレビューが提供されていません"),console.warn(`🔧 対処法: 
      1. 他の楽曲を試してください
      2. Spotify Premiumを検討してください  
      3. アーティストがプレビューを無効にしている可能性があります`),r.jsx("div",{className:"flex items-center justify-center p-4 bg-gray-100 rounded-lg",children:r.jsxs("div",{className:"text-center",children:[r.jsx("svg",{className:"w-8 h-8 text-gray-400 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 1.414L15.657 9.17l1.414 1.414a1 1 0 11-1.414 1.414L14.243 10.584l-1.414 1.414a1 1 0 11-1.414-1.414L12.829 9.17l-1.414-1.414a1 1 0 111.414-1.414L14.243 7.756l1.414-1.413z",clipRule:"evenodd"})}),r.jsx("p",{className:"text-xs text-gray-500",children:"試聴不可"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"プレビュー未提供"})]})}))}const ql="/api/youtube/search",mr={searchMusic:async(e,t=5)=>{try{const s=await fetch(`${ql}?query=${encodeURIComponent(e)}&maxResults=${t}`);if(!s.ok){const o=await s.json().catch(()=>({}));throw new Error(`YouTube検索失敗: ${s.status} ${o.error||""}`)}return(await s.json()).results||[]}catch(s){throw console.error("YouTube検索エラー:",s),s}},searchTrackByArtist:async(e,t,s=3)=>{const n=[`${e} ${t} official`,`${e} ${t} music video`,`${e} ${t} audio`,`${t} ${e}`];for(const o of n)try{const a=await mr.searchMusic(o,s);if(a.length>0)return a.map(l=>({...l,score:mr.calculateRelevanceScore(l,e,t)})).sort((l,c)=>c.score-l.score)}catch(a){console.warn(`クエリ失敗: ${o}`,a);continue}return[]},calculateRelevanceScore:(e,t,s)=>{let n=0;const o=e.title.toLowerCase(),a=e.channelTitle.toLowerCase(),i=t.toLowerCase(),l=s.toLowerCase();return o.includes(i)&&(n+=30),(a.includes(l)||o.includes(l))&&(n+=25),(a.includes("official")||o.includes("official"))&&(n+=20),(o.includes("music video")||o.includes("mv"))&&(n+=15),(o.includes("audio")||o.includes("lyric"))&&(n+=10),(o.includes("live")||o.includes("concert"))&&(n-=10),(o.includes("cover")||o.includes("remix"))&&(n-=5),n}};function Yl(){var xe,ot,at,it;const{username:e}=ns(),t=un(),s=ye(),[n,o]=j.useState(null),[a,i]=j.useState(!0);j.useState(null);const l=((xe=t.state)==null?void 0:xe.isPreview)===!0,[c,d]=j.useState(null),[u,f]=j.useState(!1),[x,p]=j.useState(!1),[h,m]=j.useState(!1),[g,y]=j.useState(!1),[N,w]=j.useState(!0),b=($,P)=>{const q=P.totalCells,se=P.centerPositions||[],ee=[];for(let S=0;S<q;S++)se.includes(S)||ee.push(S);const pe=[...ee].sort(()=>Math.random()-.5).slice(0,$.length),Ne={};return pe.forEach((S,T)=>{Ne[S]=T}),Ne},[C,I]=j.useState({});j.useEffect(()=>{e&&A(e)},[e]),j.useEffect(()=>{if(n&&n.songs&&n.gridLayout){const $=b(n.songs,n.gridLayout);I($),N&&setTimeout(()=>{w(!1)},100)}},[n]);const A=async $=>{try{const P=await Pe.loadUser($);if(P)o(P),console.log(`✅ ユーザー「${$}」のデータを読み込みました`),await Pe.incrementViewCount($);else{console.log(`⚠️ ユーザー「${$}」のデータが見つかりません`);const q=Jl[$];if(q){const se={username:$,displayName:$,bio:"",baseColor:Ie[0],themeColor:Be[0],socialLinks:{},favoriteGenres:[],songs:q.map(ee=>({...ee,id:`${ee.title}-${ee.artist}`.replace(/\s+/g,"-").toLowerCase(),previewUrl:null,addedAt:new Date().toISOString()})),gridLayout:te[1],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),viewCount:0,isPublic:!0};o(se),console.log(`📄 users.jsonからフォールバックデータを使用: ${$}`)}}}catch(P){console.error(`❌ ユーザーデータの読み込みに失敗: ${$}`,P)}finally{i(!1)}},E=async $=>{try{const P=localStorage.getItem("spotify_access_token");if(!P)return console.log("Spotifyトークンがありません。検索をスキップします。"),$;const q=await je.searchTracksAdvanced($.title,$.artist,P);if(q.length>0){const se=q[0];return{...$,spotify:{id:se.id,previewUrl:se.previewUrl,spotifyUrl:se.spotifyUrl}}}}catch(P){console.error("Spotify検索エラー:",P)}return $},R=async $=>{try{const P=await mr.searchMusic(`${$.title} ${$.artist}`);if(P.length>0){const q=P[0];return{...$,youtube:{videoId:q.videoId,title:q.title,channelTitle:q.channelTitle,embedUrl:q.embedUrl}}}}catch(P){console.error("YouTube検索エラー:",P)}return $},D=async $=>{let P=$;return $.spotify||(P=await E(P)),$.youtube||(P=await R(P)),P},K=async $=>{if(!x){p(!0);try{const P=await D($);d(P),f(!0)}catch(P){console.error("楽曲プレビューの取得に失敗しました:",P)}finally{p(!1)}}},L=()=>{f(!1),d(null)};if(a)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})});if(!n||!n.songs||n.songs.length===0)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[r.jsx("div",{className:"text-6xl mb-4",children:"🎵"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"ユーザーが見つかりません"}),r.jsxs("p",{className:"text-gray-600 mb-6",children:["お探しのユーザー「",e,"」は存在しないか、楽曲が登録されていません。"]}),r.jsxs("button",{onClick:()=>s("/"),className:"inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"ホームに戻る"]})]})});const k=n.themeColor||Be[0],z=n.baseColor||Ie[0],O=z.id==="light";return r.jsxs("div",{className:`min-h-screen relative overflow-hidden ${z.background}`,children:[!O&&r.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${k.gradient} opacity-30`}),r.jsxs("div",{className:"relative z-10",children:[r.jsxs("div",{className:"flex items-center justify-between p-6",children:[r.jsxs("button",{onClick:()=>s("/"),className:`flex items-center transition-all px-3 py-2 rounded-lg ${O?"text-gray-700 hover:bg-gray-200":"text-white hover:bg-white/10"}`,onMouseEnter:$=>{O||($.currentTarget.style.color=k.primaryHex)},onMouseLeave:$=>{O||($.currentTarget.style.color="white")},children:[r.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"ホームに戻る"]}),r.jsxs("div",{className:"flex gap-2",children:[l&&r.jsx("button",{onClick:()=>s("/dashboard"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all shadow-lg ${O?"bg-gray-200 text-gray-700 hover:bg-gray-300":`bg-gradient-to-r ${k.gradient} text-white hover:opacity-90`}`,children:"編集画面に戻る"}),(l||t.pathname.includes("/users/"))&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>m(!h),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${h?O?"bg-gray-300 text-gray-700 shadow-lg":`bg-gradient-to-r ${k.gradient} text-white shadow-lg`:O?`${z.surface} ${z.textPrimary} ${z.border} border hover:${z.surfaceHover}`:"bg-white/10 text-white border hover:border-transparent"}`,style:!h&&!O?{borderColor:k.primaryHex+"50"}:{},onMouseEnter:$=>{!h&&!O&&($.currentTarget.style.background=`linear-gradient(to right, ${k.primaryHex}, ${k.primaryHex})`)},onMouseLeave:$=>{!h&&!O&&($.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},children:"統計"}),r.jsx("button",{onClick:()=>y(!g),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${g?O?"bg-gray-300 text-gray-700 shadow-lg":`bg-gradient-to-r ${k.gradient} text-white shadow-lg`:O?`${z.surface} ${z.textPrimary} ${z.border} border hover:${z.surfaceHover}`:"bg-white/10 text-white border hover:border-transparent"}`,style:!g&&!O?{borderColor:k.primaryHex+"50"}:{},onMouseEnter:$=>{!g&&!O&&($.currentTarget.style.background=`linear-gradient(to right, ${k.primaryHex}, ${k.primaryHex})`)},onMouseLeave:$=>{!g&&!O&&($.currentTarget.style.background="rgba(255, 255, 255, 0.1)")},children:"共有"})]})]})]}),(h||g)&&r.jsx("div",{className:"px-6 mb-8",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h&&r.jsx("div",{className:`backdrop-blur-sm rounded-xl p-6 ${O?"bg-white/80 shadow-lg":"bg-white/10"}`}),g&&r.jsx("div",{className:`backdrop-blur-sm rounded-xl p-6 ${O?"bg-white/80 shadow-lg":"bg-white/10"}`,children:r.jsx(Hl,{username:n.username,displayName:n.displayName,bio:n.bio})})]})}),r.jsxs("div",{className:"flex flex-col items-center justify-center px-6 py-12",children:[r.jsx("div",{className:"w-full max-w-4xl",children:r.jsx("div",{className:"grid gap-2 aspect-square",style:{gridTemplateColumns:`repeat(${((ot=n.gridLayout)==null?void 0:ot.size)||te[1].size}, 1fr)`,gridTemplateRows:`repeat(${((at=n.gridLayout)==null?void 0:at.size)||te[1].size}, 1fr)`},children:Array.from({length:((it=n.gridLayout)==null?void 0:it.totalCells)||te[1].totalCells}).map(($,P)=>{var Ne,S,T,B;const q=((Ne=n.gridLayout)==null?void 0:Ne.centerPositions)||te[1].centerPositions,se=q.includes(P),ee=(((S=n.gridLayout)==null?void 0:S.size)||te[1].size)%2===1,We=C[P],pe=We!==void 0?n.songs[We]:null;return se&&q.length===4&&P!==q[0]?null:r.jsx("div",{className:`aspect-square relative overflow-hidden rounded-lg ${N?"animate-fade-in-scale":""}`,style:{...se&&q.length===4?{gridColumn:`${q[0]%(((T=n.gridLayout)==null?void 0:T.size)||te[1].size)+1} / span 2`,gridRow:`${Math.floor(q[0]/(((B=n.gridLayout)==null?void 0:B.size)||te[1].size))+1} / span 2`}:{},animationDelay:`${P*50}ms`},children:se?r.jsx("div",{className:`w-full h-full flex items-center justify-center backdrop-blur-sm ${O?"bg-white/80":"bg-black/10"}`,children:n.icon?r.jsx("img",{src:n.icon,alt:`${n.displayName}のアイコン`,className:`w-full h-full object-cover rounded-lg shadow-xl ${ee?"border-8":"border-4"}`,style:{borderColor:k.primaryHex,boxShadow:ee?`0 15px 35px -5px ${k.primaryHex}40, 0 15px 15px -5px ${k.primaryHex}30, inset 0 0 0 2px ${k.primaryHex}20`:`0 10px 25px -5px ${k.primaryHex}30, 0 10px 10px -5px ${k.primaryHex}20`}}):r.jsx("div",{className:`w-full h-full flex items-center justify-center rounded-lg shadow-xl ${ee?"border-8":"border-4"} ${O?"bg-gradient-to-br from-gray-100 to-gray-200":"bg-gradient-to-br from-white/20 to-white/10"}`,style:{borderColor:k.primaryHex,boxShadow:ee?`0 15px 35px -5px ${k.primaryHex}40, 0 15px 15px -5px ${k.primaryHex}30, inset 0 0 0 2px ${k.primaryHex}20`:`0 10px 25px -5px ${k.primaryHex}30, 0 10px 10px -5px ${k.primaryHex}20`},children:r.jsx("div",{className:`font-bold ${ee?"text-5xl":"text-4xl"} ${O?"text-gray-600":"text-white/60"}`,children:n.displayName.charAt(0).toUpperCase()})})}):pe?r.jsx("div",{onClick:()=>K(pe),className:`w-full h-full cursor-pointer transform hover:scale-105 transition-all duration-300 hover:shadow-2xl group ${x?"opacity-50 cursor-not-allowed":""}`,children:r.jsxs("div",{className:"relative w-full h-full",children:[r.jsx("img",{src:pe.jacket,alt:"",className:"w-full h-full object-cover rounded-lg shadow-lg"}),r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-300 rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"bg-white bg-opacity-90 rounded-full p-2 sm:p-3 transform scale-0 group-hover:scale-100 transition-transform duration-300",children:r.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-gray-800",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M8 5v14l11-7z"})})})}),r.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-0 group-hover:bg-opacity-90 transition-all duration-300 rounded-b-lg p-2 opacity-0 group-hover:opacity-100",children:[r.jsx("p",{className:"text-white text-xs font-medium truncate",children:pe.title}),r.jsx("p",{className:"text-white/80 text-xs truncate",children:pe.artist})]})]})}):r.jsx("div",{className:"w-full h-full"})},P)})})}),r.jsxs("div",{className:"text-center mt-12",children:[r.jsx("h1",{className:`text-3xl sm:text-4xl lg:text-5xl font-bold mb-4 ${z.textPrimary}`,children:n.displayName}),n.bio&&r.jsx("p",{className:`text-lg mb-4 ${z.textSecondary}`,children:n.bio}),r.jsxs("div",{className:`flex items-center justify-center gap-6 ${z.textSecondary}`,children:[r.jsxs("span",{children:["🎵 ",n.songs.length,"曲"]}),n.viewCount>0&&r.jsxs("span",{children:["👁️ ",n.viewCount,"回閲覧"]}),n.location&&r.jsxs("span",{children:["📍 ",n.location]})]}),Object.keys(n.socialLinks).length>0&&r.jsxs("div",{className:"flex gap-4 mt-8 justify-center",children:[n.socialLinks.twitter&&r.jsx("a",{href:n.socialLinks.twitter,target:"_blank",rel:"noopener noreferrer",className:`p-3 rounded-full transition-colors ${O?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20"}`,children:r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"})})}),n.socialLinks.instagram&&r.jsx("a",{href:n.socialLinks.instagram,target:"_blank",rel:"noopener noreferrer",className:`p-3 rounded-full transition-colors ${O?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20"}`,children:r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})})}),n.socialLinks.spotify&&r.jsx("a",{href:n.socialLinks.spotify,target:"_blank",rel:"noopener noreferrer",className:`p-3 rounded-full transition-colors ${O?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20"}`,children:r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"})})})]})]})]}),u&&c&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"楽曲プレイヤー"}),r.jsx("button",{onClick:L,className:"text-gray-500 hover:text-gray-700 transition-colors",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"text-center mb-6",children:[r.jsx("img",{src:c.jacket,alt:`${c.title} - ${c.artist}`,className:"w-40 h-40 mx-auto rounded-lg shadow-lg mb-4"}),r.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:c.title}),r.jsx("p",{className:"text-gray-600",children:c.artist})]}),c.spotify&&r.jsx("div",{className:"mb-4",children:r.jsx(Kl,{previewUrl:c.spotify.previewUrl,title:c.title,artist:c.artist,coverImage:c.jacket||"/default-cover.jpg"})}),c.youtube&&r.jsx("div",{className:"mb-4",children:r.jsx(Ja,{videoId:c.youtube.videoId,title:c.youtube.title,artist:c.artist,coverImage:c.jacket||"/default-cover.jpg"})}),!c.spotify&&!c.youtube&&r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{children:"プレビューが見つかりませんでした"})]})]})})]})]})}function Gl(){const e=ye(),[t,s]=j.useState({username:"",displayName:"",bio:"",baseColor:Ie[0],themeColor:Be[0],socialLinks:{},favoriteGenres:[],songs:[],gridLayout:te[0],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),viewCount:0,isPublic:!0}),[n,o]=j.useState(!1),[a,i]=j.useState({}),l=()=>{t.songs.length<20&&s(m=>({...m,songs:[...m.songs,{title:"",artist:"",jacket:"",genre:"",releaseYear:void 0}]}))},c=m=>{s(g=>({...g,songs:g.songs.filter((y,N)=>N!==m)}))},d=(m,g,y)=>{s(N=>({...N,songs:N.songs.map((w,b)=>b===m?{...w,[g]:y}:w)}))},u=(m,g)=>{d(m,"title",g.name),d(m,"artist",g.artist),d(m,"jacket",g.image||""),d(m,"isGeneratedImage",g.isGeneratedImage||!1)},f=m=>{s(g=>({...g,favoriteGenres:g.favoriteGenres.includes(m)?g.favoriteGenres.filter(y=>y!==m):[...g.favoriteGenres,m]}))},x=(m,g)=>{s(y=>({...y,socialLinks:{...y.socialLinks,[m]:g.trim()||void 0}}))},p=()=>{const m={};return t.username.trim()?/^[a-zA-Z0-9_-]+$/.test(t.username)||(m.username="ユーザー名は英数字、ハイフン、アンダースコアのみ使用可能です"):m.username="ユーザー名は必須です",t.displayName.trim()||(m.displayName="表示名は必須です"),t.songs.length===0&&(m.songs="最低1曲は追加してください"),t.songs.some(y=>!y.title||!y.artist)&&(m.songs="全ての楽曲のタイトルとアーティストを入力してください"),i(m),Object.keys(m).length===0},h=async m=>{if(m.preventDefault(),!!p()){o(!0);try{jr(t)?e(`/users/${t.username}`):i({submit:"データの保存に失敗しました"})}catch(g){console.error("データの保存に失敗しました:",g),i({submit:"データの保存に失敗しました"})}finally{o(!1)}}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:r.jsx("div",{className:"container mx-auto px-4 py-8",children:r.jsxs("div",{className:"max-w-3xl mx-auto",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"音楽名刺を作成"}),r.jsx("p",{className:"text-gray-600",children:"あなたの音楽の好みを世界に発信しましょう"})]}),r.jsxs("form",{onSubmit:h,className:"space-y-8",children:[r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"基本情報"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ユーザー名 *"}),r.jsx("input",{type:"text",value:t.username,onChange:m=>s(g=>({...g,username:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"example_user",required:!0}),a.username&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.username})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"表示名 *"}),r.jsx("input",{type:"text",value:t.displayName,onChange:m=>s(g=>({...g,displayName:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"山田太郎",required:!0}),a.displayName&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.displayName})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"自己紹介"}),r.jsx("textarea",{value:t.bio,onChange:m=>s(g=>({...g,bio:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"音楽が大好きです！様々なジャンルを聴きます。"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"居住地"}),r.jsx("input",{type:"text",value:t.location||"",onChange:m=>s(g=>({...g,location:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"東京都渋谷区"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"職業"}),r.jsx("input",{type:"text",value:t.occupation||"",onChange:m=>s(g=>({...g,occupation:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"エンジニア"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"外観設定"}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"プロフィール画像"}),r.jsx(Us,{currentIcon:t.icon,onIconChange:m=>s(g=>({...g,icon:m})),username:t.username})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ベースカラー"}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"音楽名刺の基本となる背景色を選択してください。"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:Ie.map(m=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"radio",name:"baseColor",checked:t.baseColor.id===m.id,onChange:()=>s(g=>({...g,baseColor:m})),className:"sr-only"}),r.jsxs("div",{className:`relative p-3 rounded-lg border-2 transition-all ${t.baseColor.id===m.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[r.jsx("div",{className:`w-full h-6 rounded-lg ${m.background} mb-2`}),r.jsx("p",{className:"text-sm font-medium text-gray-800",children:m.name})]})]},m.id))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"テーマカラー"}),r.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"アイコンの枠線やボタンの色に反映されます。"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:Be.map(m=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"radio",name:"themeColor",checked:t.themeColor.id===m.id,onChange:()=>s(g=>({...g,themeColor:m})),className:"sr-only"}),r.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${t.themeColor.id===m.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[r.jsx("div",{className:`w-full h-6 rounded-lg bg-gradient-to-r ${m.gradient} mb-2`}),r.jsx("p",{className:"text-sm font-medium text-gray-800",children:m.name})]})]},m.id))})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"SNSリンク"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Twitter"}),r.jsx("input",{type:"url",value:t.socialLinks.twitter||"",onChange:m=>x("twitter",m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://twitter.com/username"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Instagram"}),r.jsx("input",{type:"url",value:t.socialLinks.instagram||"",onChange:m=>x("instagram",m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://instagram.com/username"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Spotify"}),r.jsx("input",{type:"url",value:t.socialLinks.spotify||"",onChange:m=>x("spotify",m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://open.spotify.com/user/username"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),r.jsx("input",{type:"url",value:t.socialLinks.website||"",onChange:m=>x("website",m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"好きなジャンル"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"最大5つまで選択できます"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:Kr.map(m=>r.jsxs("label",{className:"cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:t.favoriteGenres.includes(m),onChange:()=>f(m),disabled:!t.favoriteGenres.includes(m)&&t.favoriteGenres.length>=5,className:"sr-only"}),r.jsx("div",{className:`p-3 rounded-lg border-2 transition-all text-center ${t.favoriteGenres.includes(m)?`border-${t.themeColor.primary} bg-${t.themeColor.primary}/10 text-${t.themeColor.primary}`:"border-gray-200 hover:border-gray-300 text-gray-700"} ${!t.favoriteGenres.includes(m)&&t.favoriteGenres.length>=5?"opacity-50 cursor-not-allowed":""}`,children:r.jsx("p",{className:"text-sm font-medium",children:m})})]},m))})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"お気に入りの楽曲"}),r.jsx("button",{type:"button",onClick:l,disabled:t.songs.length>=20,className:`px-4 py-2 rounded-lg font-medium transition-colors ${t.songs.length>=20?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:"楽曲を追加"})]}),a.songs&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600",children:a.songs})}),r.jsx("div",{className:"space-y-4",children:t.songs.map((m,g)=>r.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["楽曲 ",g+1]}),r.jsx("button",{type:"button",onClick:()=>c(g),className:"text-red-500 hover:text-red-700 transition-colors",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),r.jsx(vr,{onSelect:y=>u(g,y),placeholder:"曲名やアーティスト名を検索...",username:t.username}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ジャンル"}),r.jsxs("select",{value:m.genre||"",onChange:y=>d(g,"genre",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"選択してください"}),Kr.map(y=>r.jsx("option",{value:y,children:y},y))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"リリース年"}),r.jsx("input",{type:"number",value:m.releaseYear||"",onChange:y=>{const N=parseInt(y.target.value);d(g,"releaseYear",isNaN(N)?"":N)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"2023",min:"1900",max:new Date().getFullYear()})]})]}),m.jacket&&r.jsx("div",{className:"mt-3",children:r.jsx("img",{src:m.jacket,alt:`${m.title} - ${m.artist}`,className:"w-16 h-16 object-cover rounded-lg border border-gray-200"})})]},g))}),t.songs.length===0&&r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})}),r.jsx("p",{children:"楽曲を追加してください"})]})]}),r.jsxs("div",{className:"text-center",children:[a.submit&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600",children:a.submit})}),r.jsx("button",{type:"submit",disabled:n,className:`px-8 py-3 rounded-xl font-semibold transition-all ${n?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-cyan-500 text-white hover:from-blue-600 hover:to-cyan-600 hover:scale-105"} shadow-lg hover:shadow-xl`,children:n?"作成中...":"音楽名刺を作成"})]})]})]})})})}function Xl({className:e=""}){const[t,s]=j.useState({totalUsers:0,totalSongs:0,totalViews:0,storageSizeKB:0}),[n,o]=j.useState([]),[a,i]=j.useState(!1);j.useEffect(()=>{l()},[]);const l=()=>{s(Ma()),o(Ms())},c=()=>{$t()?(alert("✅ バックアップを作成しました"),l()):alert("❌ バックアップの作成に失敗しました")},d=()=>{confirm("バックアップから復元しますか？現在のデータは上書きされます。")&&($a()?(alert("✅ バックアップから復元しました"),l(),window.location.reload()):alert("❌ バックアップからの復元に失敗しました"))},u=()=>{try{const p=_a(),h=new Blob([p],{type:"application/json"}),m=URL.createObjectURL(h),g=document.createElement("a");g.href=m,g.download=`musicmeisi_backup_${new Date().toISOString().split("T")[0]}.json`,g.click(),URL.revokeObjectURL(m),alert("✅ データをエクスポートしました")}catch(p){console.error("エクスポートエラー:",p),alert("❌ データのエクスポートに失敗しました")}},f=p=>{var g;const h=(g=p.target.files)==null?void 0:g[0];if(!h)return;const m=new FileReader;m.onload=y=>{var N;try{const w=(N=y.target)==null?void 0:N.result;Pa(w)?(alert("✅ データをインポートしました"),l(),window.location.reload()):alert("❌ データのインポートに失敗しました")}catch(w){console.error("インポートエラー:",w),alert("❌ 無効なファイル形式です")}},m.readAsText(h),p.target.value=""},x=p=>p?new Date(p).toLocaleString("ja-JP"):"N/A";return r.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 ${e}`,children:[r.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 1.79 4 4 4h8c2.21 0 4-1.79 4-4V7M4 7V4a1 1 0 011-1h5l2 2h6a1 1 0 011 1v1M4 7h16"})}),"データ管理"]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.totalUsers}),r.jsx("div",{className:"text-sm text-blue-800",children:"総ユーザー数"})]}),r.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.totalSongs}),r.jsx("div",{className:"text-sm text-green-800",children:"総楽曲数"})]}),r.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.totalViews}),r.jsx("div",{className:"text-sm text-purple-800",children:"総閲覧数"})]}),r.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.storageSizeKB}),r.jsx("div",{className:"text-sm text-orange-800",children:"ストレージ (KB)"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[r.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"})}),"バックアップ"]}),r.jsxs("button",{onClick:d,className:"flex items-center justify-center gap-2 px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"復元"]}),r.jsxs("button",{onClick:u,className:"flex items-center justify-center gap-2 px-3 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"エクスポート"]}),r.jsxs("label",{className:"flex items-center justify-center gap-2 px-3 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm cursor-pointer",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),"インポート",r.jsx("input",{type:"file",accept:".json",onChange:f,className:"sr-only"})]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("button",{onClick:()=>i(!a),className:"flex items-center text-gray-600 hover:text-gray-800 text-sm font-medium",children:[r.jsx("svg",{className:`w-4 h-4 mr-2 transition-transform ${a?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),"ユーザー詳細を",a?"非表示":"表示"]})}),a&&r.jsxs("div",{className:"overflow-x-auto",children:[r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"border-b border-gray-200",children:[r.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"ユーザー名"}),r.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"表示名"}),r.jsx("th",{className:"text-right py-2 px-3 font-medium text-gray-700",children:"楽曲数"}),r.jsx("th",{className:"text-right py-2 px-3 font-medium text-gray-700",children:"閲覧数"}),r.jsx("th",{className:"text-left py-2 px-3 font-medium text-gray-700",children:"更新日時"})]})}),r.jsx("tbody",{children:n.map(p=>r.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[r.jsx("td",{className:"py-2 px-3 font-mono text-sm",children:p.username}),r.jsx("td",{className:"py-2 px-3",children:p.displayName}),r.jsx("td",{className:"py-2 px-3 text-right",children:p.songCount}),r.jsx("td",{className:"py-2 px-3 text-right",children:p.viewCount}),r.jsx("td",{className:"py-2 px-3 text-xs text-gray-500",children:x(p.updatedAt)})]},p.username))})]}),n.length===0&&r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("svg",{className:"w-12 h-12 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293L16 14H8l-2.707-1.707A1 1 0 004.586 13H2"})}),r.jsx("p",{children:"登録されているユーザーがいません"})]})]}),r.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"💡 使用方法"}),r.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[r.jsxs("li",{children:["• ",r.jsx("strong",{children:"バックアップ"}),": 現在のデータをブラウザ内に保存"]}),r.jsxs("li",{children:["• ",r.jsx("strong",{children:"復元"}),": バックアップからデータを復元"]}),r.jsxs("li",{children:["• ",r.jsx("strong",{children:"エクスポート"}),": データをJSONファイルとしてダウンロード"]}),r.jsxs("li",{children:["• ",r.jsx("strong",{children:"インポート"}),": JSONファイルからデータを読み込み"]})]})]})]})}function Ql(){const{config:e,loading:t}=He(),{config:s,loading:n}=wr();if(t||n)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"読み込み中..."})]})});if(!(e!=null&&e.enableAdminPanel))return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"アクセスできません"}),r.jsx("p",{className:"text-gray-600",children:"管理者機能は現在利用できません。"})]})});const o=ye(),[a,i]=j.useState([]),[l,c]=j.useState(!0),[d,u]=j.useState(!1),[f,x]=j.useState(!1);j.useEffect(()=>{p()},[]);const p=()=>{const w=localStorage.getItem("musicard_admin"),b=localStorage.getItem("musicard_admin_login_time");if(!w||!b){console.warn("🛡️ 管理者権限がありません"),o("/admin-login");return}const C=parseInt(b),I=Date.now(),A=24*60*60*1e3;if(I-C>A){console.warn("🛡️ 管理者セッションが期限切れです"),localStorage.removeItem("musicard_admin"),localStorage.removeItem("musicard_admin_login_time"),o("/admin-login");return}if(!((s==null?void 0:s.adminUsers)||["admin"]).includes(w)){console.warn("🛡️ 管理者権限が無効です"),o("/admin-login");return}x(!0),h()};j.useEffect(()=>{f&&h()},[f]);const h=()=>{try{const w=Ms();i(w)}catch(w){console.error("ユーザーデータの読み込みに失敗しました:",w)}finally{c(!1)}},m=w=>{confirm(`${w}の名刺を削除しますか？この操作は取り消せません。`)&&(Aa(w)?(h(),alert(`✅ ${w}の名刺を削除しました`)):alert(`❌ ${w}の削除に失敗しました`))},g=w=>{o(`/edit/${w}`)},y=()=>{confirm("管理者ログアウトしますか？")&&(localStorage.removeItem("musicard_admin"),localStorage.removeItem("musicard_admin_login_time"),o("/"))},N=w=>w?new Date(w).toLocaleString("ja-JP"):"N/A";return f?l?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"読み込み中..."})]})}):r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:r.jsxs("div",{className:"container mx-auto px-4 py-8",children:[r.jsxs("div",{className:"flex justify-between items-center mb-8",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"管理者パネル"}),r.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:"ADMIN"})]}),r.jsx("p",{className:"text-gray-600",children:"音楽名刺の管理とデータ統計"}),r.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["管理者: ",localStorage.getItem("musicard_admin")]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>u(!d),className:`px-4 py-2 rounded-lg font-medium transition-colors ${d?"bg-blue-600 text-white":"bg-white text-blue-600 border border-blue-200 hover:bg-blue-50"}`,children:"データ管理"}),r.jsx("button",{onClick:y,className:"bg-red-500 text-white px-6 py-2 rounded-lg font-medium hover:bg-red-600 transition-colors",children:"ログアウト"}),r.jsx(Ee,{to:"/",className:"bg-white text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-50 transition-colors border border-gray-200",children:"ホームに戻る"})]})]}),d&&r.jsx("div",{className:"mb-8",children:r.jsx(Xl,{})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-blue-600",children:a.length}),r.jsx("div",{className:"text-gray-600",children:"総ユーザー数"})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-green-600",children:a.reduce((w,b)=>w+b.songCount,0)}),r.jsx("div",{className:"text-gray-600",children:"総楽曲数"})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-purple-600",children:a.reduce((w,b)=>w+b.viewCount,0)}),r.jsx("div",{className:"text-gray-600",children:"総閲覧数"})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-orange-600",children:a.length>0?Math.round(a.reduce((w,b)=>w+b.songCount,0)/a.length):0}),r.jsx("div",{className:"text-gray-600",children:"平均楽曲数"})]})]}),r.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[r.jsx("div",{className:"p-6 border-b border-gray-200",children:r.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"登録ユーザー一覧"})}),a.length===0?r.jsxs("div",{className:"text-center py-16",children:[r.jsx("div",{className:"text-6xl mb-6",children:"🎵"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"名刺がまだありません"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"最初の音楽名刺を作成してみましょう"}),r.jsxs(Ee,{to:"/create",className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg font-medium hover:from-blue-600 hover:to-cyan-600 transition-all hover:scale-105 shadow-lg",children:[r.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"名刺を作成"]})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"ユーザー"}),r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"楽曲数"}),r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"閲覧数"}),r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"更新日"}),r.jsx("th",{className:"text-left py-3 px-6 font-medium text-gray-700",children:"操作"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map(w=>r.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"py-4 px-6",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center text-white font-semibold",children:w.displayName.charAt(0).toUpperCase()}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:w.displayName}),r.jsxs("div",{className:"text-sm text-gray-500 font-mono",children:["@",w.username]})]})]})}),r.jsx("td",{className:"py-4 px-6 text-sm text-gray-900",children:r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[w.songCount," 曲"]})}),r.jsx("td",{className:"py-4 px-6 text-sm text-gray-900",children:r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[w.viewCount," 回"]})}),r.jsx("td",{className:"py-4 px-6 text-sm text-gray-500",children:N(w.updatedAt)}),r.jsx("td",{className:"py-4 px-6",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx(Ee,{to:`/users/${w.username}`,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 transition-colors",children:"表示"}),r.jsx("button",{onClick:()=>g(w.username),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-green-700 bg-green-100 hover:bg-green-200 transition-colors",children:"編集"}),r.jsx("button",{onClick:()=>m(w.username),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 transition-colors",children:"削除"})]})})]},w.username))})]})})]}),r.jsxs("div",{className:"mt-8 bg-blue-50 rounded-xl p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:"💡 使用方法"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"名刺の管理"}),r.jsxs("ul",{className:"space-y-1",children:[r.jsx("li",{children:"• 「表示」で名刺ページを表示"}),r.jsx("li",{children:"• 「編集」で名刺内容を編集"}),r.jsx("li",{children:"• 「削除」で名刺を完全削除"})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"データ管理"}),r.jsxs("ul",{className:"space-y-1",children:[r.jsx("li",{children:"• 統計情報の確認"}),r.jsx("li",{children:"• データのバックアップ・復元"}),r.jsx("li",{children:"• エクスポート・インポート"})]})]})]})]})]})}):r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"管理者認証を確認中..."})]})})}const ut=[{id:"blue",name:"ブルー",gradient:"from-blue-500 to-blue-600",primary:"blue-500",secondary:"blue-100"},{id:"purple",name:"パープル",gradient:"from-purple-500 to-purple-600",primary:"purple-500",secondary:"purple-100"},{id:"green",name:"グリーン",gradient:"from-green-500 to-green-600",primary:"green-500",secondary:"green-100"},{id:"pink",name:"ピンク",gradient:"from-pink-500 to-pink-600",primary:"pink-500",secondary:"pink-100"},{id:"orange",name:"オレンジ",gradient:"from-orange-500 to-orange-600",primary:"orange-500",secondary:"orange-100"},{id:"indigo",name:"インディゴ",gradient:"from-indigo-500 to-indigo-600",primary:"indigo-500",secondary:"indigo-100"}];function Zl(){const{username:e}=ns(),t=ye(),[s,n]=j.useState([]),[o,a]=j.useState(""),[i,l]=j.useState(ut[0]),[c,d]=j.useState(!0),u=j.useCallback(g=>{try{const y=localStorage.getItem("musicmeisi_users");if(y){const N=JSON.parse(y);if(N[g]){const w=N[g];if(n(w.songs||w),a(w.icon||""),w.themeColor){const b=ut.find(C=>C.id===w.themeColor.id);l(b||ut[0])}}else alert("ユーザーが見つかりません"),t("/manage")}else alert("ユーザーデータが見つかりません"),t("/manage")}catch{alert("データの読み込みに失敗しました"),t("/manage")}finally{d(!1)}},[t]);j.useEffect(()=>{e&&u(e)},[e,u]);const f=()=>{n([...s,{title:"",artist:"",jacket:""}])},x=g=>{s.length>1&&n(s.filter((y,N)=>N!==g))},p=(g,y,N)=>{const w=[...s];w[g]={...w[g],[y]:N},n(w)},h=(g,y)=>{const N=[...s];N[g]={title:y.name,artist:y.artist,jacket:y.image||"",isGeneratedImage:y.isGeneratedImage},n(N)},m=async g=>{if(g.preventDefault(),!e){alert("ユーザー名が無効です");return}const y=s.filter(N=>N.title.trim()&&N.artist.trim());if(y.length===0){alert("少なくとも1つの楽曲情報を入力してください");return}try{const N=localStorage.getItem("musicmeisi_users"),w=N?JSON.parse(N):{};w[e]={username:e,icon:o,themeColor:i,songs:y,updatedAt:new Date().toISOString()},localStorage.setItem("musicmeisi_users",JSON.stringify(w)),alert("名刺が更新されました！"),t(`/users/${e}`)}catch{alert("エラーが発生しました。もう一度お試しください。")}};return c?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:r.jsx("div",{className:"text-blue-600 text-xl",children:"読み込み中..."})}):r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100",children:[r.jsx("div",{className:"sticky top-0 z-50 backdrop-blur-sm bg-white/80 border-b border-blue-200/50 shadow-sm",children:r.jsx("div",{className:"container mx-auto px-4 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h1",{className:"text-xl font-bold text-blue-900",children:[e,"の名刺を編集"]}),r.jsxs("button",{onClick:()=>t("/manage"),className:"inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 transition-colors duration-300",children:[r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"管理画面に戻る"]})]})})}),r.jsx("div",{className:"container mx-auto px-4 py-8",children:r.jsx("div",{className:"max-w-2xl mx-auto",children:r.jsxs("form",{onSubmit:m,className:"space-y-8",noValidate:!0,children:[r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-blue-200/50 shadow-lg",children:[r.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-6",children:"基本情報"}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-blue-700 text-sm font-medium mb-2",children:"ユーザー名"}),r.jsx("input",{type:"text",value:e,disabled:!0,className:"w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-blue-500 cursor-not-allowed"}),r.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"ユーザー名は変更できません"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-blue-700 text-sm font-medium mb-3",children:"名刺テーマカラー"}),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:ut.map(g=>r.jsxs("button",{type:"button",onClick:()=>l(g),className:`p-3 rounded-xl border-2 transition-all duration-300 ${i.id===g.id?"border-blue-500 shadow-lg scale-105":"border-blue-200 hover:border-blue-300"}`,children:[r.jsx("div",{className:`w-full h-8 bg-gradient-to-r ${g.gradient} rounded-lg mb-2`}),r.jsx("span",{className:"text-sm text-blue-700 font-medium",children:g.name})]},g.id))}),r.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"選択したカラーが名刺のアクセントカラーとして使用されます"})]})]}),r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-blue-200/50 shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-blue-900",children:"好きな音楽"}),r.jsx("button",{type:"button",onClick:f,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-300",children:"曲を追加"})]}),r.jsx("div",{className:"space-y-6",children:s.map((g,y)=>r.jsxs("div",{className:"bg-slate-700/50 rounded-xl p-4 border border-slate-600/50",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-white font-medium",children:["曲 ",y+1]}),s.length>1&&r.jsx("button",{type:"button",onClick:()=>x(y),className:"text-red-400 hover:text-red-300 transition-colors duration-300",children:r.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"音楽を検索"}),r.jsx(vr,{onSelect:N=>h(y,N),placeholder:"曲名やアーティスト名で検索...",className:"mb-3"}),r.jsx("p",{className:"text-slate-400 text-xs",children:"検索して自動入力するか、下記のフィールドに直接入力してください"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"曲名 *"}),r.jsx("input",{type:"text",value:g.title,onChange:N=>p(y,"title",N.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"曲名を入力"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"アーティスト *"}),r.jsx("input",{type:"text",value:g.artist,onChange:N=>p(y,"artist",N.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"アーティスト名を入力"})]})]})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx("label",{className:"block text-slate-300 text-sm font-medium mb-2",children:"ジャケット画像URL（任意）"}),r.jsx("input",{type:"text",value:g.jacket,onChange:N=>p(y,"jacket",N.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-slate-500 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"https://example.com/image.jpg"}),r.jsx("p",{className:"text-slate-400 text-xs mt-1",children:"未入力の場合はランダム画像が使用されます"})]})]},y))})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{type:"submit",className:"flex-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 rounded-xl font-semibold hover:from-purple-600 hover:to-pink-600 transition-all duration-300 hover:scale-105",children:"更新する"}),r.jsx("button",{type:"button",onClick:()=>t("/manage"),className:"px-8 py-4 bg-slate-700 text-white rounded-xl font-semibold hover:bg-slate-600 transition-all duration-300",children:"キャンセル"})]})]})})})]})}function ec(){const[e]=hn(),t=ye(),[s,n]=j.useState("loading"),[o,a]=j.useState(""),i=j.useRef(!1);return j.useEffect(()=>{(async()=>{var c,d,u;if(i.current){console.log("🔄 認証処理は既に実行済みです");return}i.current=!0;try{const f=e.get("code"),x=e.get("state"),p=e.get("error");if(console.log("🔍 コールバックパラメータ確認:"),console.log(`   code: ${f?"✅ あり":"❌ なし"}`),console.log(`   state: ${x?"✅ あり":"❌ なし"}`),console.log(`   error: ${p||"なし"}`),p)throw new Error(`Spotify認証エラー: ${p}`);if(!f)throw new Error("認証コードが見つかりません");if(!x)throw new Error("状態パラメータが見つかりません");const h=localStorage.getItem("spotify_current_state"),m=localStorage.getItem(`spotify_auth_${x}`);let g=null;if(m)try{g=JSON.parse(m).codeVerifier}catch(N){console.error("❌ 認証データ解析エラー:",N)}if(console.log("🔍 LocalStorage状態確認:"),console.log(`   受信したcode: ${f.substring(0,10)}...`),console.log(`   受信したstate: "${x}"`),console.log(`   保存されたstate: "${h}"`),console.log(`   code_verifier: ${g?"✅ 存在":"❌ なし"}`),console.log(`   state一致: ${h===x}`),h!==x)throw new Error("State parameter不一致 - セキュリティエラー");console.log("🔄 認証コードをアクセストークンに交換中...");const y=await As.getAccessToken(f,x);Ps(y),localStorage.removeItem("spotify_current_state"),localStorage.removeItem(`spotify_auth_${x}`),$s("spotify"),n("success"),a("Spotify認証が完了しました！PKCEフローによる安全な認証です。"),window.history.replaceState({},document.title,"/callback"),setTimeout(()=>{t("/")},3e3)}catch(f){console.error("❌ Spotify認証エラー:",f),n("error"),a(f.message||"Spotify認証に失敗しました"),((c=f.message)!=null&&c.includes("Token exchange failed")||(d=f.message)!=null&&d.includes("Failed to get access token"))&&(console.error("🔍 トークン交換エラーの詳細:"),console.error("   • 認証コードが既に使用済みの可能性"),console.error("   • Client IDが間違っている可能性"),console.error("   • Redirect URIが正確に設定されていない可能性"),console.error("   • 認証コードの有効期限（10分）が切れている可能性"),console.error("   • code_verifierが見つからない可能性")),(u=f.message)!=null&&u.includes("Invalid authorization code")&&(console.warn("⚠️ 認証コードが無効です。新しい認証を開始してください。"),setTimeout(()=>{t("/")},5e3))}})()},[t,e]),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:r.jsx("div",{className:"max-w-md mx-auto p-8",children:r.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-8 border border-blue-200/50 shadow-lg text-center",children:[s==="loading"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),r.jsx("h1",{className:"text-2xl font-bold text-blue-900 mb-4",children:"🎧 Spotify認証処理中..."}),r.jsxs("p",{className:"text-blue-600",children:["認証コードをアクセストークンに交換しています...",r.jsx("br",{}),r.jsx("span",{className:"text-sm text-blue-500",children:"重複処理を防止中"})]})]}),s==="success"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-12 h-12 mx-auto mb-4 text-green-500",children:r.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),r.jsx("h1",{className:"text-2xl font-bold text-green-700 mb-4",children:"🎉 認証完了！"}),r.jsx("p",{className:"text-blue-600 mb-4",children:o}),r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-4",children:r.jsxs("p",{className:"text-green-700 text-sm",children:["✅ 音楽検索でSpotifyが利用可能になりました",r.jsx("br",{}),"✅ PKCEフローによる安全な認証を実現",r.jsx("br",{}),"✅ Client Secretが不要なセキュアな実装",r.jsx("br",{}),"✅ より高精度な検索結果を提供",r.jsx("br",{}),"✅ 認証コードの重複使用を防止"]})}),r.jsx("p",{className:"text-blue-500 text-sm",children:"3秒後に自動的にホームページに戻ります..."})]}),s==="error"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-12 h-12 mx-auto mb-4 text-red-500",children:r.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),r.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-4",children:"❌ 認証に失敗しました"}),r.jsx("p",{className:"text-red-600 mb-4",children:o}),r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:r.jsxs("p",{className:"text-red-700 text-sm text-left",children:[r.jsx("strong",{children:"🔍 よくある解決方法:"}),r.jsx("br",{}),"• 認証コードの重複使用（ページリロード等）",r.jsx("br",{}),"• Spotify Developer Dashboardでredirect_uriを確認",r.jsx("br",{}),"• Client IDが正しく設定されているか確認",r.jsx("br",{}),"• ブラウザのキャッシュをクリアして再試行",r.jsx("br",{}),"• 認証コードの有効期限（10分）内に処理を完了",r.jsx("br",{}),"• code_verifierが失われた場合は新しい認証を開始"]})}),r.jsx("button",{onClick:()=>t("/"),className:"bg-blue-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-600 transition-colors duration-300",children:"ホームに戻る"})]})]})})})}function tc(){const[e,t]=j.useState(!1),[s,n]=j.useState(null),[o,a]=j.useState(null),i=async()=>{t(!0),a(null),n(null);try{const d=le();if(Object.keys(d).length===0){a("ローカルストレージにデータが見つかりません");return}console.log("📦 マイグレーション対象データ:",d);const u=await fetch("/api/db?action=migrate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({localStorageData:d})}),f=await u.json();u.ok?(n(f),console.log("✅ マイグレーション完了:",f)):a(f.error||"マイグレーションに失敗しました")}catch(d){console.error("❌ マイグレーションエラー:",d),a(d instanceof Error?d.message:"Unknown error")}finally{t(!1)}},c=(()=>{const d=le(),u=Object.keys(d).length,f=Object.values(d).reduce((x,p)=>{var h;return x+(((h=p.songs)==null?void 0:h.length)||0)},0);return{userCount:u,songCount:f}})();return r.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[r.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800",children:"📦 データマイグレーション"}),r.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"ローカルストレージの状況"}),r.jsxs("div",{className:"text-sm text-blue-700",children:[r.jsxs("p",{children:["ユーザー数: ",c.userCount,"人"]}),r.jsxs("p",{children:["楽曲数: ",c.songCount,"曲"]})]})]}),c.userCount===0?r.jsx("div",{className:"text-center py-8 text-gray-500",children:r.jsx("p",{children:"マイグレーション対象のデータがありません"})}):r.jsxs("div",{className:"space-y-4",children:[r.jsx("button",{onClick:i,disabled:e,className:`w-full py-3 px-4 rounded-lg font-semibold transition-colors ${e?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:e?r.jsxs("span",{className:"flex items-center justify-center",children:[r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"マイグレーション中..."]}):"🚀 データベースにマイグレーション"}),o&&r.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[r.jsx("p",{className:"text-red-800 font-semibold",children:"エラー"}),r.jsx("p",{className:"text-red-700 text-sm",children:o})]}),s&&r.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[r.jsx("p",{className:"text-green-800 font-semibold",children:"✅ マイグレーション完了"}),r.jsxs("div",{className:"text-green-700 text-sm space-y-1 mt-2",children:[r.jsxs("p",{children:["移行されたユーザー: ",s.migrated.users,"人"]}),r.jsxs("p",{children:["移行された楽曲: ",s.migrated.songs,"曲"]}),r.jsxs("p",{children:["データソース: ",s.sources.join(", ")]}),r.jsxs("div",{className:"mt-3 pt-3 border-t border-green-200",children:[r.jsx("p",{className:"font-semibold",children:"データベース統計:"}),r.jsxs("p",{children:["ユーザー: ",s.stats.users,"人"]}),r.jsxs("p",{children:["楽曲: ",s.stats.songs,"曲"]}),r.jsxs("p",{children:["セッション: ",s.stats.sessions,"件"]})]})]})]})]})]})}function rc(){const{config:e,loading:t}=He();return t?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"読み込み中..."})]})}):e!=null&&e.enableDataMigration?r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx(Ee,{to:"/",className:"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4",children:"← ホームに戻る"}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"データベースマイグレーション"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"ローカルストレージのデータをNeonデータベースに移行します"})]}),r.jsx(tc,{}),r.jsxs("div",{className:"mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"⚠️ 注意事項"}),r.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[r.jsx("li",{children:"• マイグレーションは一度だけ実行してください"}),r.jsx("li",{children:"• 既存のローカルストレージデータは保持されます"}),r.jsx("li",{children:"• 重複データは自動的にスキップされます"}),r.jsx("li",{children:"• マイグレーション後もローカルストレージは引き続き使用可能です"})]})]})]})}):r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"アクセスできません"}),r.jsx("p",{className:"text-gray-600",children:"このページは現在利用できません。"})]})})}function sc(){const{config:e,loading:t}=He();if(t||!(e!=null&&e.enableDebugPanels))return null;const[s,n]=j.useState(!1),[o,a]=j.useState(qr()),[i,l]=j.useState(0);j.useEffect(()=>{c()},[]);const c=async()=>{try{const u=await Pe.loadAllUsers();l(Object.keys(u).length),a(qr())}catch(u){console.error("ストレージ統計の読み込みエラー:",u)}},d=u=>{Ua(u),setTimeout(()=>{window.location.reload()},1e3)};return t||!(e!=null&&e.enableDebugPanels)?null:r.jsxs("div",{className:"fixed bottom-4 right-4 z-50",children:[r.jsx("button",{onClick:()=>n(!s),className:"bg-purple-600 text-white px-3 py-2 rounded-lg shadow-lg hover:bg-purple-700 transition-colors",title:"Storage Debug Panel",children:"🔧 Storage"}),s&&r.jsxs("div",{className:"absolute bottom-full right-0 mb-2 bg-white dark:bg-gray-800 border rounded-lg shadow-xl p-4 min-w-80",children:[r.jsxs("div",{className:"flex justify-between items-center mb-3",children:[r.jsx("h3",{className:"font-bold text-sm",children:"Storage Debug Panel"}),r.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),r.jsxs("div",{className:"space-y-2 text-xs",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Current Provider:"}),r.jsx("span",{className:"font-mono bg-gray-100 dark:bg-gray-700 px-1 rounded",children:o.current})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"User Count:"}),r.jsx("span",{className:"font-mono",children:i})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Environment:"}),r.jsx("span",{className:"font-mono text-xs",children:o.environment||"default"})]}),o.override&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Override:"}),r.jsx("span",{className:"font-mono text-orange-600",children:o.override})]})]}),r.jsxs("div",{className:"mt-4 pt-3 border-t",children:[r.jsx("div",{className:"text-xs font-semibold mb-2",children:"Switch Provider:"}),r.jsx("div",{className:"space-y-1",children:o.available.map(u=>r.jsxs("button",{onClick:()=>d(u),className:`w-full text-left px-2 py-1 rounded text-xs transition-colors ${o.current===u?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,disabled:o.current===u,children:[r.jsx("span",{className:"font-mono",children:u}),u==="localStorage"&&r.jsx("span",{className:"ml-2 text-green-600",children:"✓ 安定"}),u==="vercelBlob"&&r.jsx("span",{className:"ml-2 text-yellow-600",children:"⚠ 開発中"})]},u))})]}),r.jsx("div",{className:"mt-3 pt-2 border-t",children:r.jsx("button",{onClick:c,className:"w-full text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"🔄 Refresh Stats"})}),r.jsx("div",{className:"mt-2 text-xs text-gray-500 italic",children:"* プロバイダー切り替え後はページが自動リロードされます"})]})]})}function nc(){const{config:e,loading:t}=He();if(t||!(e!=null&&e.enableDataSourceIndicator))return null;const[s,n]=j.useState(null),[o,a]=j.useState(!0);j.useEffect(()=>{i()},[]);const i=async()=>{var d;a(!0);try{const u=le(),f={hasData:Object.keys(u).length>0,userCount:Object.keys(u).length,songCount:Object.values(u).reduce((h,m)=>{var g;return h+(((g=m.songs)==null?void 0:g.length)||0)},0)};let x={hasData:!1,userCount:0,songCount:0};try{const h=await fetch("/api/db?action=users");if(h.ok){const m=await h.json();x={hasData:m.totalUsers>0,userCount:m.totalUsers,songCount:((d=m.users)==null?void 0:d.reduce((g,y)=>g+(parseInt(y.song_count)||0),0))||0}}}catch(h){console.error("データベース確認エラー:",h),x.error=h instanceof Error?h.message:"Unknown error"}let p="unknown";if(f.hasData&&!x.hasData)p="localStorage";else if(!f.hasData&&x.hasData)p="database";else if(f.hasData&&x.hasData){const h=f.userCount+f.songCount,m=x.userCount+x.songCount;p=h>=m?"localStorage":"database"}n({localStorage:f,database:x,currentSource:p})}catch(u){console.error("データソース確認エラー:",u)}finally{a(!1)}};if(o)return r.jsx("div",{className:"fixed top-4 right-4 bg-white border border-gray-200 rounded-lg shadow-lg p-4 z-50",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),r.jsx("span",{className:"text-sm text-gray-600",children:"データソース確認中..."})]})});if(!s)return null;const l=d=>{switch(d){case"localStorage":return"bg-blue-100 text-blue-800 border-blue-200";case"database":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},c=d=>{switch(d){case"localStorage":return"💾";case"database":return"🗄️";default:return"❓"}};return r.jsxs("div",{className:"fixed top-4 right-4 bg-white border border-gray-200 rounded-lg shadow-lg p-4 z-50 max-w-sm",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"font-semibold text-gray-800",children:"データソース"}),r.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm",children:"🔄"})]}),r.jsx("div",{className:`mb-3 p-2 rounded border ${l(s.currentSource)}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{children:c(s.currentSource)}),r.jsxs("span",{className:"font-medium",children:[s.currentSource==="localStorage"&&"ローカルストレージ",s.currentSource==="database"&&"データベース",s.currentSource==="unknown"&&"データなし"]})]})}),r.jsx("div",{className:"mb-2",children:r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsxs("span",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"💾"}),r.jsx("span",{children:"ローカルストレージ"})]}),r.jsxs("span",{className:`px-2 py-1 rounded text-xs ${s.localStorage.hasData?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"}`,children:[s.localStorage.userCount,"ユーザー / ",s.localStorage.songCount,"曲"]})]})}),r.jsx("div",{className:"mb-2",children:r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsxs("span",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:"🗄️"}),r.jsx("span",{children:"データベース"})]}),r.jsxs("span",{className:`px-2 py-1 rounded text-xs ${s.database.hasData?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:[s.database.userCount,"ユーザー / ",s.database.songCount,"曲"]})]})}),s.database.error&&r.jsxs("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-xs text-red-700",children:["DB接続エラー: ",s.database.error]}),s.localStorage.hasData&&s.database.hasData&&r.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:r.jsx("a",{href:"/migration",className:"text-blue-600 hover:text-blue-800 text-xs underline",children:"📦 データマイグレーション"})})]})}function oc(){return r.jsxs(r.Fragment,{children:[r.jsxs(mn,{children:[r.jsx(ue,{path:"/",element:r.jsx(Ea,{})}),r.jsx(ue,{path:"/login",element:r.jsx(La,{})}),r.jsx(ue,{path:"/admin-login",element:r.jsx(Ra,{})}),r.jsx(ue,{path:"/dashboard",element:r.jsx(Wa,{})}),r.jsx(ue,{path:"/users/:username",element:r.jsx(Yl,{})}),r.jsx(ue,{path:"/create",element:r.jsx(Gl,{})}),r.jsx(ue,{path:"/admin",element:r.jsx(Ql,{})}),r.jsx(ue,{path:"/edit/:username",element:r.jsx(Zl,{})}),r.jsx(ue,{path:"/callback",element:r.jsx(ec,{})}),r.jsx(ue,{path:"/migration",element:r.jsx(rc,{})})]}),r.jsx(sc,{}),r.jsx(nc,{})]})}Xt.createRoot(document.getElementById("root")).render(r.jsx(dn.StrictMode,{children:r.jsx(fn,{children:r.jsx(oc,{})})}));
